<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Ứng dụng Pomodoro hỗ trợ học tập với tích hợp Gemini AI và giao diện hiện đại." />
    <title>Pomodoro Study App — Tích hợp Gemini AI (Giao diện mới)</title>
    <style>
    /*
    =============================================
    POMODORO STUDY APP — PHIÊN BẢN GIAO DIỆN TẬP TRUNG (v1.0)
    =============================================
    */

    :root {
      /* Theme Dark (Mặc định) - Cập nhật từ file 2 */
      --bg: #0f1222;
      --panel: #171a2e;
      --panel-rgb: 23, 26, 46; /* Thêm biến RGB cho panel */
      --muted: #212646;
      --text: #f4f6ff;
      --sub: #b7c1ff;
      --acc: #6c8cff;
      --acc-rgb: 108, 140, 255;
      --acc-2: #27d3a2;
      --purple: #a78bfa;
      --warn: #ffb020;
      --danger: #ff5c7a;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.054), 0px 4.3px 5.3px rgba(0, 0, 0, 0.077), 0px 8.1px 10px rgba(0, 0, 0, 0.095), 0px 14.5px 17.9px rgba(0, 0, 0, 0.113), 0px 27.2px 33.4px rgba(0, 0, 0, 0.136), 0px 65px 80px rgba(0, 0, 0, 0.19);
      --radius: 16px;
      --panel-opacity: 0.85;
      --gradient-border: linear-gradient(135deg, var(--acc), var(--acc-2));
    }
    
    /* === START: THÊM CÁC THEME MỚI === */
    [data-theme='light'] {
      --bg: #f5f0e8; --panel: #ffffff; --panel-rgb: 255, 255, 255; --muted: #eaddcf; --text: #4a4a4a; --sub: #8a817c; --acc: #d4a373; --acc-rgb: 212, 163, 115; --acc-2: #a3b18a; --warn: #e76f51; --danger: #d00000;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.024), 0px 4.3px 5.3px rgba(0, 0, 0, 0.037), 0px 8.1px 10px rgba(0, 0, 0, 0.045), 0px 14.5px 17.9px rgba(0, 0, 0, 0.053), 0px 27.2px 33.4px rgba(0, 0, 0, 0.066), 0px 65px 80px rgba(0, 0, 0, 0.09);
      --panel-opacity: 0.9;
      /* Ngăn nền tối mặc định khi không có ảnh */
      --bg-image: none;
    }

    [data-theme='pastel'] {
      --bg: #fde2e4; --panel: #fff1f2; --panel-rgb: 255, 241, 242; --muted: #fad2e1; --text: #595260; --sub: #8c7a8a; --acc: #c78283; --acc-rgb: 199, 130, 131; --acc-2: #7ec4cf; --warn: #f9bf45; --danger: #d7263d;
      --shadow: 0 5px 20px rgba(200,150,150,0.2);
      --panel-opacity: 0.9;
      /* Ngăn nền tối mặc định khi không có ảnh */
      --bg-image: none;
    }
    
    [data-theme='lofi'] {
      --bg: #2a2a3e; --panel: #3c3c52; --panel-rgb: 60, 60, 82; --muted: #4d4d66; --text: #e0e0ff; --sub: #a0a0c0; --acc: #ff8c69; --acc-rgb: 255, 140, 105; --acc-2: #69c6ff; --warn: #ffd700; --danger: #ff6961;
      /* === Replaced external GIF with inline data URI (offline-safe) === */
      --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9J2cnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAlJyBzdG9wLWNvbG9yPScjMmEyYTNlJy8+PHN0b3Agb2Zmc2V0PScxMDAlJyBzdG9wLWNvbG9yPScjM2MzYzUyJy8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9JzEwMCUnIGhlaWdodD0nMTAwJScgZmlsbD0ndXJsKCNnKScvPjwvc3ZnPg==');
      --panel-opacity: 0.8;
    }
    
    [data-theme='space'] {
        --bg: #000000; --panel: #1a1a2e; --panel-rgb: 26, 26, 46; --muted: #2a2a4e; --text: #e0e0ff; --sub: #b0b0e0; --acc: #00aaff; --acc-rgb: 0, 170, 255; --acc-2: #aaff00; --warn: #ffaa00; --danger: #ff0055;
        /* === Replaced external GIF with inline data URI (offline-safe) === */
        --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9J2cnIGN4PSc1MCUnIGN5PSc0MCUnIHI9JzcwJSc+PHN0b3Agb2Zmc2V0PScwJScgc3RvcC1jb2xvcj0nIzBiMGIxYScvPjxzdG9wIG9mZnNldD0nMTAwJScgc3RvcC1jb2xvcj0nIzAwMDAwMCcvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZpbGw9J3VybCgjZyknLz48L3N2Zz4=');
        --panel-opacity: 0.75;
    }
    /* === END: THÊM CÁC THEME MỚI === */

    *:focus-visible {
      outline: 2px solid var(--acc); outline-offset: 2px; border-radius: 4px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin:0; 
      font-family: system-ui, -apple-system, 'Segoe UI Variable', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Inter', sans-serif; 
      
      background-color: var(--bg);
      background-image: var(--bg-image, radial-gradient(1200px 800px at 10% -10%, #20285b 0%, #0f1222 50%, #0b0e1a 100%));
      
      background-size: cover; 
      background-position: center; 
      color:var(--text); 
      transition: background 0.5s ease, color 0.5s ease, filter 0.5s ease;
      text-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    a{color:var(--acc)}

    .app{display:flex; min-height:100vh}
    
    .app-nav {
        width: 60px;
        padding: 16px 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
        z-index: 100;
    }
    .nav-btn {
        background: transparent;
        border: none;
        color: var(--sub);
        width: 44px;
        height: 44px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all .2s ease;
        position: relative;
    }
    .nav-btn:hover { background: var(--muted); color: var(--text); }
    .nav-btn.active { background: var(--acc); color: white; }
    .nav-btn svg { width: 24px; height: 24px; }
    .nav-btn .tooltip {
        position: absolute;
        left: 110%;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        box-shadow: var(--shadow);
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        pointer-events: none;
        z-index: 200;
    }
    .nav-btn:hover .tooltip { opacity: 1; visibility: visible; }

    .app-content {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        max-height: 100vh;
    }

    .view { display: none; }
    .view.active { display: grid; gap: 24px; animation: fadeIn .3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .main.reloading { opacity: 0; transition: opacity 0.2s ease-out; }

    .panel-bg{
        background: rgba(23, 26, 46, var(--panel-opacity));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border:1px solid rgba(255,255,255,.08);
    }
    /* Thêm các quy tắc border cho theme light/pastel */
    [data-theme='light'] .panel-bg, [data-theme='pastel'] .panel-bg { border:1px solid rgba(0,0,0,0.05); }
    [data-theme='lofi'] .panel-bg { border:1px solid rgba(255,255,255,0.1); }
    [data-theme='space'] .panel-bg { border:1px solid rgba(255,255,255,0.12); }


header.app-header{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-radius:var(--radius); box-shadow:var(--shadow); margin-bottom: 24px; position: relative; z-index: 2000;}
    header .actions{display:flex; gap:8px; align-items:center}
    
    .btn {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text);
      border: none; /* Sửa đổi: bỏ border mặc định */
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,0.08);
      font-weight: 600;
      transition: all .15s ease;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        border: 2px solid transparent; border-radius: 12px; background: var(--gradient-border) border-box;
        -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: destination-out; mask-composite: exclude; opacity: 0; transition: opacity 0.3s ease;
    }
    .btn:hover::before { opacity: 1; }
    .btn:hover { background: rgba(255, 255, 255, 0.12); }
    .btn:active { transform: translateY(1px) scale(0.98); filter: brightness(1); }
    .btn:disabled { cursor: not-allowed; filter: brightness(0.8) saturate(0.5); }
    .btn.ghost { background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); }
    .btn.ghost:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); }
    .btn.acc { background: var(--acc); color: white; }
    .btn.warn { background: var(--warn); color: white; }
    .btn.danger { background: var(--danger); color: white; }
    .btn.small { padding: 6px 10px; font-size: 14px; border-radius: 9px; }
    .btn.small::before { border-radius: 9px; }
    .btn > svg { width: 16px; height: 16px; stroke-width: 2.5px; }

    /* === START: CẬP NHẬT GIAO DIỆN QUẢN LÝ CHỦ ĐỀ === */
    #view-topics { grid-template-columns: 1fr; }
    .topic-item { background:rgba(255,255,255,.04); border:1px solid var(--muted); border-radius:12px; padding:8px; margin-bottom:8px; } /* Sửa đổi */
    .topic-header, .sub-row { display:flex; align-items:center; gap:8px; position: relative; }
    .topic-header { cursor: pointer; }
    .topic-header .topic-actions { cursor: default; }
    .topic-header .topic-actions * { cursor: pointer; }
    .topic-item { cursor: pointer; }
    .topic-item .topic-actions { cursor: default; }
    .topic-item .topic-actions * { cursor: pointer; }
    .topic-title { flex:1; font-weight:600; cursor: pointer; }
    .chev { width:28px; height:28px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; flex-shrink: 0; cursor: pointer; }
    .chev .ico { display:inline-block; transition: transform .18s ease; }
    .chev[aria-expanded="false"] .ico { transform: rotate(-90deg); }
    .subtopics { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .subtopics.hidden { display:none; }
    
    .topic-actions, .sub-row .actions {
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        display: flex;
        gap: 6px;
        align-items: center;
    }
    .topic-item:hover .topic-actions, .topic-item:focus-within .topic-actions,
    .sub-row:hover .actions, .sub-row:focus-within .actions {
      opacity: 1;
      visibility: visible;
    }
    .actions-menu-btn {
        padding: 0;
        width: 28px;
        height: 28px;
        font-size: 1.2em;
        line-height: 1;
    }
    .actions-menu {
        position: absolute;
        top: 100%;
        right: 0;
        border-radius: 8px;
        padding: 6px;
        box-shadow: var(--shadow);
        z-index: 10;
        min-width: 150px;
        display: none;
        flex-direction: column;
        gap: 4px;
    }
    /* Nâng khối đang mở menu lên trên các khối khác */
    .topic-item.menu-active { position: relative; z-index: 20; }
    
    .actions-menu.show { display: flex; }
    .menu-item {
        background: transparent; border: none; color: var(--text);
        padding: 8px 10px; border-radius: 6px; text-align: left;
        width: 100%; cursor: pointer; transition: background .2s ease;
        display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500;
    }
    .menu-item:hover { background: var(--acc); color: white; }
    .menu-item.danger:hover { background: var(--danger); }
    /* === END: CẬP NHẬT GIAO DIỆN QUẢN LÝ CHỦ ĐỀ === */

    .subtopic-btn{
        flex:1; 
        text-align:left;
        background-color: rgba(0,0,0,0.02); /* Sửa đổi */
    }
    .subtopic-btn:hover {
        background-color: transparent; /* Hover transparent to avoid blue background */
    }
    .subtopic-btn.active{
        outline:2px solid var(--acc); 
    }
    .subtopic-btn.active:hover {
        background: transparent; /* Giữ nền trong suốt khi di chuột qua */
    }
    
    .panel{border-radius:var(--radius); padding:24px; box-shadow:var(--shadow)}

    .timer-header { display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; }
    .timer{display:grid; gap:16px; grid-template-columns: 1fr; align-items:center; text-align:center}
    .big-time{font-size: clamp(60px, 12vw, 96px); letter-spacing:1px; font-weight:700; color: var(--text)}
    .state{font-weight:700; letter-spacing:.6px}
    .state.work{color:var(--acc-2)} /* Sửa đổi màu */
    .state.break{color:var(--warn)}
    .state.long{color:var(--danger)} /* Sửa đổi màu */
    .controls{display:flex; flex-wrap:wrap; gap:12px; justify-content:center}    
    #btnStart { padding: 14px 28px; font-size: 1.2em; }
    #btnPause, #btnResume { padding: 12px 24px; font-size: 1.1em; }

    /* === START: TÙY CHỈNH DẢI PHÂN CÁCH MỀM MẠI HƠN === */
    #view-timer .panel-bg hr {
        border: none; /* Bỏ đường viền mặc định */
        height: 1px;  /* Đặt chiều cao cho đường kẻ */
        background-color: var(--muted); /* Sử dụng màu phụ của theme */
        opacity: 0.3; /* Làm cho nó mờ đi, hòa vào nền */
        margin-top: 0; /* Điều chỉnh lại khoảng cách */
    }
    /* === END: TÙY CHỈNH DẢI PHÂN CÁCH MỀM MẠI HƠN === */

    .stats-grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px}
    .stat-card{background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:14px; padding:12px; text-align:center} /* Sửa đổi */
    .stat-card h4{margin:4px 0 8px; color:var(--sub); font-weight:600; font-size: 14px;}
    .stat-value{font-size: 20px; font-weight: 600;}
    .tiny{font-size:12px; color:var(--sub)}
    .history{display:grid; gap:8px; max-height:300px; overflow:auto; padding-right:6px}
    .hist-item{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:start; background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:10px; padding:10px} /* Sửa đổi */

    .row{display:flex; gap:8px; align-items:center}
    .row > * {flex:1}
    input[type="text"], input[type="password"], input[type="number"], select, textarea{width:100%; background:rgba(255,255,255,0.04); color:var(--text); border:1px solid var(--muted); border-radius:10px; padding:10px; outline:none}
    textarea{min-height:80px; resize: vertical;}

    .toasts{position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:9999}
    .toast{
        background: var(--panel); /* Sửa đổi */
        border:1px solid var(--muted);
        color:var(--text);
        padding:10px 12px; border-radius:12px; box-shadow:var(--shadow);
        animation: toast-in .3s ease; transform-origin: bottom right;
    }
    @keyframes toast-in { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,var(--panel-opacity)); z-index:10000; backdrop-filter: blur(5px);} /* Nâng z-index để nằm trên header */
    .modal.show{display:flex}
    .modal-card{
        position: relative;
        z-index: 10001;
        width:min(720px, 94vw);
        border-radius:16px;
        padding:16px;
        box-shadow:var(--shadow);
        animation: modal-in .25s ease-out;
        max-height: 90vh;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }
    body.modal-open { overflow: hidden; }
    @keyframes modal-in { from { opacity: 0; transform: scale(0.92) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .modal-card h3{margin-top:0}
    .dashboard-table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    .dashboard-table th, .dashboard-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--muted); }
    .dashboard-table th { color: var(--sub); }

    .footer-note{font-size:12px; color:var(--sub)}
    .hidden{display:none !important}

    .notes-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; padding-right: 6px; }
    .note-item { background: rgba(255,255,255,0.04); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; cursor: pointer; } /* Sửa đổi */
    .note-content-wrapper { flex: 1; min-width: 0; }
    .note-content { white-space: pre-wrap; word-break: break-word; max-height: 60px; overflow: hidden; position: relative; transition: max-height 0.35s ease-in-out; }
    .note-content:not(.expanded)::after {
        content: ''; position: absolute; bottom: 0; right: 0; width: 100%; height: 20px; background: linear-gradient(to top, var(--panel) 20%, transparent);
    }
    .note-content.expanded { max-height: 500px; }
    .note-meta { font-size: 11px; color: var(--sub); margin-top: 4px; }
    
    .spinner { border: 2px solid var(--muted); border-top-color: var(--text); border-radius: 50%; width: 16px; height: 16px; animation: spin 1s linear infinite; } /* Sửa đổi */
    @keyframes spin { to { transform: rotate(360deg); } }

    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .panel-header h3 { margin: 0; }
    .panel-header .actions { display: flex; gap: 8px; }
    
    .aux-panel { margin-top: 24px; }
    .tab-nav { display: flex; gap: 4px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 16px; }
    .tab-btn { background: transparent; border: none; color: var(--sub); padding: 8px 16px; cursor: pointer; border-bottom: 2px solid transparent; transition: all .2s ease; font-weight: 600; }
    .tab-btn:hover { color: var(--text); }
    .tab-btn.active { color: var(--acc); border-bottom-color: var(--acc); }
    .tab-content {
      display: none;
      padding-top: 8px;
    }
    .tab-content.active {
      animation: fadeIn 0.25s ease-out;
    }
    #tasks.tab-content.active,
    #notes.tab-content.active,
    #ai.tab-content.active {
        display: block;
    }

    #settings-timer.tab-content.active,
    #settings-ui.tab-content.active,
    #settings-integrations.tab-content.active {
        display: flex;
    }

    .settings-row-toggle {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
    }
    .settings-row-toggle span {
      flex: 1;
      cursor: pointer;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle-switch .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--muted);
      transition: .3s;
      border-radius: 24px;
    }
    .toggle-switch .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    .toggle-switch input:checked + .slider {
      background-color: var(--acc-2);
    }
    .toggle-switch input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    .chat-messages { max-height: 250px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; padding: 4px; }
    .chat-msg { padding: 8px 12px; border-radius: 12px; max-width: 85%; word-break: break-word; }
    .chat-msg.user { background: var(--acc); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
    .chat-msg.model { background: var(--muted); align-self: flex-start; border-bottom-left-radius: 4px; }
    .chat-input-area { display: flex; gap: 8px; }

    .methods-list { list-style: none; padding: 0; }
    .method-item { align-items: flex-start; padding: 12px; display: flex; gap: 10px; border-radius: 8px; }
    .method-item:hover { background: rgba(0,0,0,0.03); } /* Sửa đổi */
    .method-item input[type="checkbox"] { width: 18px; height: 18px; margin-top: 2px; flex-shrink: 0;}
    .method-item label { flex: 1; }
    .method-item label.completed { text-decoration: line-through; color: var(--sub); }
    .method-item .content-wrapper { flex: 1; cursor: pointer; }
    .method-item .concept { font-size: 14px; color: var(--sub); margin-top: 8px; border-left: 2px solid var(--muted); padding-left: 12px; white-space: pre-wrap; word-break: break-word; }
    /* Highlight section titles and bold text inside method content */
    .method-content h4 {
        color: var(--acc-2);
        font-size: 1.1em;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    .method-content strong {
        color: var(--acc);
        font-weight: 600;
    }
    /* Apply the same highlight to the Guide view */
    #view-guide h4 { color: var(--acc-2); }
    #view-guide strong { color: var(--acc-2); }
    /* Show hand cursor to indicate clickability */
    .method-item, .method-item summary { cursor: pointer; }
    .subtopic-todo-list { list-style: none; padding: 0; margin: 0; max-height: 100px; overflow-y: auto; text-align: left; }
    .subtopic-todo-list li { display: flex; align-items: center; gap: 8px; padding: 4px; transition: all 0.2s ease-out; }
    .subtopic-todo-list li.removing { transform: translateX(100%); opacity: 0; }
    .subtopic-todo-list label { flex: 1; }

    #youtube-player-container { position: absolute; top: -9999px; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 10px; } /* Sửa đổi */
    ::-webkit-scrollbar-thumb { background: var(--muted); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
    ::-webkit-scrollbar-thumb:hover { background: var(--sub); background-clip: content-box; }
    
    .timer-circle-container {
        position: relative; width: clamp(250px, 40vw, 320px); height: clamp(250px, 40vw, 320px); margin: 24px auto; display: flex; align-items: center; justify-content: center;
    }
    .timer-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform: rotate(-90deg); }
    .timer-circle-bg, .timer-circle-progress { fill: none; stroke-width: 8; }
    .timer-circle-bg { stroke: var(--muted); } /* Sửa đổi */
    .timer-circle-progress { stroke: var(--acc); stroke-linecap: round; transition: stroke-dashoffset 0.3s linear, stroke 0.5s ease; }
    @keyframes flash { 0%, 100% { box-shadow: 0 0 10px 2px transparent; } 50% { box-shadow: 0 0 20px 8px currentColor; } }
    .timer-circle-container.finished { color: var(--acc-2); animation: flash 1s ease-out; }
    @keyframes breathing-effect { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    .timer-circle-container.breathing { animation: breathing-effect 3s ease-in-out infinite; }
    
    
    
    @media (max-width: 1024px) {
      .app-content { padding: 20px; }
      .panel { padding: 20px; }
      .timer-circle-container { width: clamp(220px, 50vw, 300px); height: clamp(220px, 50vw, 300px); }
    }

    @media (max-width: 768px) {
      .app { flex-direction: column; }
      .app-nav { width: 100%; height: 60px; flex-direction: row; justify-content: center; border-right: none; border-top: 1px solid rgba(255,255,255,.08); order: 2; padding: 0 16px; }
      .app-content { padding: 16px; order: 1; }
      .panel { padding: 16px; }
      .modal-card .tab-nav { overflow-x: auto; }
    }

    @media (max-width: 480px) {
      .app-nav { height: 50px; }
      .nav-btn { flex: 1; }
      header.app-header { flex-direction: column; align-items: stretch; gap: 8px; }
      .btn { padding: 8px 12px; }
      .timer-circle-container { width: clamp(180px, 80vw, 220px); height: clamp(180px, 80vw, 220px); margin: 16px auto; }
      .panel { padding: 12px; }
      .app-content { padding: 12px; }
    }

    #view-timer.no-subtopic-selected > .panel-bg:not(:first-child) { display: none; }
    #view-timer.no-subtopic-selected .timer-header > .presets { display: none; }
    #view-timer.no-subtopic-selected .timer { display: none; }

    header.app-header .actions #btnFullscreen { background: transparent; border: none; box-shadow: none; }
    header.app-header .actions #btnFullscreen:hover { background: var(--muted); filter: none; }
    header.app-header .actions #btnFullscreen:hover::before { opacity: 0; }

    input[type="text"], input[type="password"], input[type="number"], select, textarea {
        background: rgba(255,255,255,0.04) !important; /* Sửa đổi: chuyển sang nền trắng trong suốt */
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.1); /* Viền trắng mờ */
        transition: background .2s ease, border-color .2s ease;
    }
    input[type="text"]:focus, input[type="password"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
        background: rgba(255,255,255,0.06) !important; /* Tinh chỉnh: sát mẫu hơn */
        border-color: var(--acc);
    }
    /* === START: SỬA LỖI NỀN INPUT/SELECT TRÊN THEME SÁNG === */
    [data-theme='light'] input, [data-theme='light'] select, [data-theme='light'] textarea,
    [data-theme='pastel'] input, [data-theme='pastel'] select, [data-theme='pastel'] textarea {
        background: rgba(0, 0, 0, 0.05) !important; /* Dùng nền đen mờ thay vì trắng mờ */
        border-color: rgba(0, 0, 0, 0.1); /* Viền đen mờ trên theme sáng */
    }

    [data-theme='light'] input:focus, [data-theme='light'] select:focus, [data-theme='light'] textarea:focus,
    [data-theme='pastel'] input:focus, [data-theme='pastel'] select:focus, [data-theme='pastel'] textarea:focus {
        background: rgba(0, 0, 0, 0.07) !important; /* Tăng độ đậm khi focus */
    }
    /* === END: SỬA LỖI NỀN INPUT/SELECT TRÊN THEME SÁNG === */

    /* Cải thiện nền và màu chữ cho option trong select theo theme hiện tại */
    select option {
        background: var(--panel);
        color: var(--text);
    }
    
    ::placeholder { color: var(--sub); opacity: 0.7; } /* Sửa đổi */
    ::-ms-input-placeholder { color: var(--sub); }
    :-ms-input-placeholder { color: var(--sub); }

    
    
    .draggable-timer {
        position: fixed;
        bottom: 20px;
        right: 20px;
        color: var(--text);
        padding: 8px 16px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        font-size: 2em;
        font-weight: 600;
        cursor: move;
        user-select: none;
        z-index: 9998;
        opacity: 0;
        transform: scale(0.9);
        pointer-events: none;
        transition: opacity 0.35s ease, transform 0.35s ease;
    }
    body.bg-view-mode .draggable-timer {
        opacity: 1;
        transform: scale(1);
        pointer-events: auto;
    }
    .app-nav, .panel-bg, .app-header .actions > *, .app-header > .row {
        transition: opacity 0.35s ease, transform 0.35s ease, background 0.35s ease, border-color 0.35s ease, box-shadow 0.35s ease;
    }
    body.bg-view-mode .app-nav,
    body.bg-view-mode .view.active > .panel-bg {
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
    }
    body.bg-view-mode .app-header {
        background: transparent !important;
        border-color: transparent !important;
        box-shadow: none !important;
    }
    body.bg-view-mode .app-header .actions > *:not(#btnToggleBg),
    body.bg-view-mode .app-header > .row {
        opacity: 0;
        pointer-events: none;
    }
    body.bg-view-mode #btnToggleBg {
        opacity: 1;
        pointer-events: auto;
    }
    .sound-permission-bar {
      position: fixed; left: 50%; transform: translateX(-50%);
      bottom: 48px; z-index: 9999;
      border-radius: 12px; padding: 10px 14px;
      display: none; align-items: center; gap: 10px;
      box-shadow: var(--shadow);
    }
    .sound-permission-bar.show { display: flex; }
    .sound-permission-bar .msg { font-size: 14px; color: var(--text); }
    .draggable-timer { text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.9); }

    /* Giảm/loại bỏ bóng chữ cho theme sáng để tránh nhòe/lóa */
    body[data-theme='light'],
    body[data-theme='pastel'] { text-shadow: none; }
    body[data-theme='light'] .draggable-timer,
    body[data-theme='pastel'] .draggable-timer { text-shadow: none; }

    /* ============================================= */
/* ========================================================= */
/* START: THI?T L?P PANEL KI?U M?  ?C (FROSTED GLASS)        */
/* ========================================================= */

/* --- 1.  p d?ng hi?u ?ng n?n m? chung cho t?t c? c c panel --- */
.app-nav,
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    background: rgba(var(--panel-rgb), var(--panel-opacity));
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* --- 2.  ?nh nghia vi?n cho t?ng lo?i panel --- */
.app-nav {
    border-right: 1px solid rgba(255, 255, 255, 0.1);
}
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* --- 3. Tinh ch?nh vi?n cho c c theme S NG (Light/Pastel) --- */
[data-theme='light'] .app-nav,
[data-theme='light'] .panel-bg,
[data-theme='light'] .modal-card,
[data-theme='light'] .actions-menu,
[data-theme='light'] .nav-btn .tooltip,
[data-theme='light'] .draggable-timer,
[data-theme='light'] .sound-permission-bar,
[data-theme='light'] .toast,
[data-theme='light'] .topic-item,
[data-theme='light'] .stat-card,
[data-theme='light'] .hist-item,
[data-theme='light'] .method-item,
[data-theme='pastel'] .app-nav,
[data-theme='pastel'] .panel-bg,
[data-theme='pastel'] .modal-card,
[data-theme='pastel'] .actions-menu,
[data-theme='pastel'] .nav-btn .tooltip,
[data-theme='pastel'] .draggable-timer,
[data-theme='pastel'] .sound-permission-bar,
[data-theme='pastel'] .toast,
[data-theme='pastel'] .topic-item,
[data-theme='pastel'] .stat-card,
[data-theme='pastel'] .hist-item,
[data-theme='pastel'] .method-item {
    border-color: rgba(0, 0, 0, 0.1);
}

/* --- 4. S?a l?i hi?u ?ng fade-out c?a ghi ch  cho ph  h?p --- */
.note-content:not(.expanded)::after {
    background: linear-gradient(to top, rgba(var(--panel-rgb), 1) 20%, transparent);
}

/* --- C c quy t?c c n l?i gi? nguy n t? file g?c --- */
[data-theme='light'] .tab-nav,
[data-theme='pastel'] .tab-nav {
    border-bottom-color: rgba(0, 0, 0, 0.1);
}
.subtopic-btn {
    background-color: transparent;
}
.subtopic-btn:hover {
    background-color: transparent; /* Hover transparent to avoid blue background */
}
/* Khi nội dung mở, thêm đường phân cách ở trên nội dung */
.method-item > .method-content:not([hidden]) {
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    margin-top: 8px;
    padding-top: 8px;
}
    [data-theme='light'] .method-item > .method-content:not([hidden]),
    [data-theme='pastel'] .method-item > .method-content:not([hidden]) {
        border-top-color: rgba(0, 0, 0, 0.1);
    }

    /* Editor container (single pane, Rich Text) */
    .editor-container { height: 350px; }
    .editable-content { height: 100%; border: 1px solid var(--muted); border-radius: 10px; padding: 10px; overflow-y: auto; background: var(--bg); }
    .editable-content:focus-within { border-color: var(--acc); outline: none; }
    .editable-content h4 { color: var(--acc-2); font-size: 1.1em; margin-top: 1.5em; margin-bottom: 0.5em; }
    .editable-content strong, .editable-content b { color: var(--acc); font-weight: 600; }
    .editable-content ol, .editable-content ul { padding-left: 20px; }

    /* Editor toolbar for Methods modal */
    .editor-toolbar { display: flex; gap: 6px; margin-bottom: 6px; padding: 4px; background: var(--muted); border-radius: 8px; }
    .editor-toolbar button { font-weight: bold; width: 32px; height: 32px; padding: 0; }
    .editor-toolbar .btn.ghost:hover { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.15); }
    .editor-toolbar .btn.ghost.active { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.25); }
    .color-picker-wrapper { position: relative; }
    .color-palette { position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; padding: 6px; border-radius: 8px; border: 1px solid var(--muted); background: var(--panel); box-shadow: var(--shadow); z-index: 10; }
    .color-swatch { width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255, 255, 255, 0.5); cursor: pointer; transition: transform 0.15s ease; }
    .color-swatch:hover { transform: scale(1.15); }

    /* SỬA LỖI: Áp dụng Flexbox cho tiêu đề Kho Tri Thức */
    .method-item > div:first-child { /* <-- Sửa từ 'summary' thành thẻ div đầu tiên */
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    .method-item > div:first-child > .method-title { /* <-- Sửa để nhắm đúng vào class .method-title */
        flex: 1;
    }
    .method-item > div:first-child .topic-actions { /* <-- Sửa tương tự */
        margin-left: 8px;
    }
    .method-title { cursor: pointer; }
    .method-item:hover .topic-actions, .method-item:focus-within .topic-actions { opacity: 1; visibility: visible; }

    /* ========================================================= */
    /* START: SỬA LỖI TRÀN GIAO DIỆN VỚI VĂN BẢN DÀI (FLEXBOX FIX) */
    /* ========================================================= */
    .topic-title,
    .subtopic-btn,
    .note-content-wrapper,
    .subtopic-todo-list label,
    .method-title,
    .method-item > div:first-child { /* <--- Cho phép header Kho Tri Thức co lại */
        min-width: 0; /* Cho phép phần tử co lại nhỏ hơn nội dung của nó */
    }

    .topic-title,
    .subtopic-btn,
    .note-content,
    .subtopic-todo-list label,
    .hist-item > div,
    .method-title { /* <--- Bổ sung cho Kho Tri Thức */
        word-break: break-word;      /* Tự động ngắt các từ quá dài */
        overflow-wrap: break-word; /* Đảm bảo ngắt dòng cho chuỗi dài */
    }
    /* ========================================================= */
    /* END: SỬA LỖI TRÀN GIAO DIỆN VỚI VĂN BẢN DÀI (FLEXBOX FIX) */

    </style>
</head>
<body data-theme="default"> <div class="app" id="app">
    <nav class="app-nav">
        <button class="nav-btn active" id="navBtnTimer" data-view="timer" aria-label="Đồng hồ">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span class="tooltip">Đồng hồ</span>
        </button>
        <button class="nav-btn" id="navBtnTopics" data-view="topics" aria-label="Chủ đề">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
            <span class="tooltip">Chủ đề</span>
        </button>
        <button class="nav-btn" id="navBtnStats" data-view="stats" aria-label="Thống kê">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
            <span class="tooltip">Thống kê</span>
        </button>
        <button class="nav-btn" id="navBtnMethods" data-view="methods" aria-label="Kho Tri Thức">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.042 21.672L13.684 16.6s.408-1.947 1.25-3.25c.842-1.303 2.002-2.5 3.5-3.5s3.25-1.25 3.25-1.25l5.072 1.358c.27.072.358.42.128.628l-3.35 3.35a.499.499 0 0 1-.594.052l-2.07-1.486c-.44-.314-.82-.53-1.11-.665-.29-.135-.55-.22-.78-.245s-.45.045-.63.155c-.18.11-.3.29-.36.5-.06.21.02.48.18.78.16.3.385.68.665 1.11l1.486 2.07a.499.499 0 0 1-.052.594l-3.35 3.35c-.208.23-.556.142-.628-.128z"/><path d="M12 15l-3-3 3-3 3 3-3 3z"/><path d="M9.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/><path d="M5.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/></svg>
            <span class="tooltip">Kho Tri Thức</span>
        </button>
        <button class="nav-btn" id="btnSettings" style="margin-top: auto;" aria-label="Cài đặt">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            <span class="tooltip">Cài đặt</span>
        </button>
        <button class="nav-btn" id="navBtnGuide" data-view="guide" aria-label="Hướng dẫn">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            <span class="tooltip">Hướng dẫn</span>
        </button>
    </nav>

    <main class="app-content">
      <header class="app-header panel-bg">
        <div class="row" style="gap:12px; align-items:center; flex:0 1 auto">
          <strong>📚 Pomodoro Study App</strong>
          <span class="badge" id="selectedContext">Chưa chọn Chủ đề con</span>
        </div>
        <div class="actions">
          <button class="btn ghost small" id="btnDashboard" title="Dashboard Tổng quan">📊 Tổng Quan </button>
          <a href="https://forms.gle/EfFqBJFTbFtDo5H4A" target="_blank" rel="noopener noreferrer" class="btn ghost small" title="Gửi phản hồi của bạn">💬 Phản Hồi</a>
          <button class="btn ghost small" id="btnExport" title="Xuất JSON">⬇️ Xuất File</button>
          <label class="btn ghost small" for="importFile" title="Nhập JSON">⬆️ Nhập File</label>
          <input type="file" id="importFile" accept="application/json" style="display:none" />
          <button class="btn small" id="btnToggleBg" title="Ẩn/Hiện giao diện">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
          <button class="btn small" id="btnFullscreen" title="Toàn màn hình">↗️</button>
        </div>
      </header>
      

      <div id="view-timer" class="view active">
        <section class="panel panel-bg">
          <div class="timer-header">
            <div id="welcomePanel" class="hidden panel-bg" style="text-align:center; padding: 20px; border-radius: var(--radius); width: 100%;">
                <h3>Chào mừng đến với Pomodoro Study App!</h3>
                <p>Hãy bắt đầu bằng cách chọn một <strong>Chủ đề con</strong> hoặc tạo Chủ đề/Chủ đề con mới.</p>
                <button class="btn acc" id="btnHelpCreateTopic">＋ Tạo Chủ đề Mới</button>
            </div>
            <div class="presets" role="group" aria-label="Chọn chế độ preset">
                <button id="btnPresetA" class="btn small ghost" data-preset="A"></button>
                <button id="btnPresetB" class="btn small ghost" data-preset="B"></button>
                <button id="btnPresetC" class="btn small ghost" data-preset="C">🌊 Flow</button>
            </div>
          </div>
          <hr />
          <div class="timer" aria-live="polite">
            <div class="badge" id="stateBadge">TRẠNG THÁI</div>
            
            <div class="timer-circle-container">
              <svg class="timer-svg" viewBox="0 0 100 100">
                  <circle class="timer-circle-bg" cx="50" cy="50" r="45"></circle>
                  <circle class="timer-circle-progress" cx="50" cy="50" r="45"></circle>
              </svg>
              <div id="timeDisplay" class="big-time">00:00</div>
            </div>

            <div class="tiny" id="cycleInfo"></div>

            <div class="tiny" id="breakSuggestionDisplay" style="min-height: 1.5em; font-style: italic; opacity: 0.8; transition: opacity 0.3s ease;"></div>

            <div id="windDownChecklist" class="hidden" style="text-align: left; max-width: 300px; margin: 0 auto; padding: 0 10px;">
              <h4 style="margin: 8px 0 4px; color: var(--acc); text-align: center;">Checklist Hạ nhiệt</h4>
              <ul style="list-style: '✓ '; margin: 0; padding-left: 20px; color: var(--sub);">
                <li>Lưu công việc đang làm (Save/Commit).</li>
                <li>Ghi chú nhanh "Next step".</li>
                <li>Dọn dẹp không gian làm việc.</li>
              </ul>
            </div>
            
            <div class="controls">
              <button class="btn acc" id="btnStart" aria-label="Bắt đầu (Space)">▶️ Bắt đầu</button>
              <button class="btn warn hidden" id="btnFinishFlow" aria-label="Kết thúc phiên làm việc">🧘 Bắt đầu nghỉ</button>
              <button class="btn" id="btnPause" aria-label="Tạm dừng (Space)">⏸️ Tạm dừng</button>
              <button class="btn" id="btnResume" aria-label="Tiếp tục (Space)">⏵ Tiếp tục</button>
              <button class="btn warn" id="btnSkip" aria-label="Bỏ qua (N)">⏭️ Bỏ qua</button>
              <button class="btn danger" id="btnReset">↺ Đặt lại</button>
              <button class="btn acc small hidden" id="btnBreakEarly">🧘 Nghỉ sớm</button>
            </div>
            <div class="tiny">Phím tắt: <strong>Space</strong> = Bắt đầu/Tạm dừng/Tiếp tục, <strong>N</strong> = Tiếp theo/Bỏ qua</div>
          </div>
        </section>

        <section class="panel panel-bg aux-panel">
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="tasks">Nhiệm vụ</button>
                <button class="tab-btn" data-tab="notes">Ghi chú</button>
                <button class="tab-btn" data-tab="ai">Gemini AI</button>
            </nav>
            <div id="tasks" class="tab-content active">
                <h4 style="margin: 0 0 8px; color: var(--sub);">To-do cho chủ đề con này:</h4>
                <ul id="subtopicTasksList" class="subtopic-todo-list"></ul>
                <div class="row" style="gap:8px; margin-top: 8px;">
                    <input type="text" id="newSubtopicTaskInput" placeholder="Thêm một task mới..." />
                    <button id="btnAddSubtopicTask" class="btn small" style="flex: 0 1 auto;">Thêm</button>
                </div>
            </div>
            <div id="notes" class="tab-content">
                <div id="generalNotesList" class="notes-list"></div>
                <div class="add-note-area" style="margin-top: 12px;">
                    <textarea id="newGeneralNoteText" placeholder="Thêm ghi chú mới..."></textarea>
                    <div style="text-align: right; margin-top: 8px;">
                        <button class="btn acc small" id="btnAddGeneralNote">＋ Thêm ghi chú</button>
                    </div>
                </div>
            </div>
            <div id="ai" class="tab-content">
                <div class="panel-header" style="margin-bottom: 8px; padding: 0;">
                    <h4 style="margin:0;">Gemini cho: <span id="currentSubtopicNameChat">(chưa chọn)</span></h4>
                    <div class="actions">
                        <button id="btnClearChat" class="btn small danger" title="Xóa lịch sử">🗑️</button>
                    </div>
                </div>
                <div id="chatMessages" class="chat-messages"></div>
                <div id="aiPromptSuggestions" style="display: flex; gap: 6px; margin: 8px 0; flex-wrap: wrap;">
                  <button class="btn small ghost" data-prompt="Giải thích khái niệm chính của chủ đề này">Giải thích khái niệm</button>
                  <button class="btn small ghost" data-prompt="Tạo một dàn ý chi tiết cho chủ đề này">Tạo dàn ý</button>
                  <button class="btn small ghost" data-prompt="Liệt kê 5 câu hỏi ôn tập quan trọng về chủ đề này">Tạo câu hỏi ôn tập</button>
                </div>
                <div class="chat-input-area">
                  <input type="text" id="chatInput" placeholder="Hỏi Gemini điều gì đó..." />
                  <button id="btnSendMessage" class="btn acc">Gửi</button>
                </div>
            </div>
        </section>
      </div>

      <div id="view-topics" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin: 0;">Quản lý Chủ đề</h3>
                <button class="btn small acc" id="btnAddTopic" style="margin-left: auto;">＋ Thêm Chủ đề</button>
            </div>
            <div id="topicsList"></div>
            <div class="footer-note">Nhấp mũi tên để mở/đóng danh sách chủ đề con.</div>
        </div>
      </div>
      
      <div id="view-stats" class="view">
      <script>
        window.addEventListener('DOMContentLoaded', () => {
          try {
            const topicsView = document.querySelector('#view-topics');
            if (!topicsView) return;
            const header = topicsView.querySelector('.row h3');
            if (header) header.textContent = 'Quản lý Chủ đề';
            const addBtn = topicsView.querySelector('#btnAddTopic');
            if (addBtn) addBtn.textContent = '+ Thêm Chủ đề';
            const note = topicsView.querySelector('.footer-note');
            if (note) note.textContent = 'Nhấp mũi tên để mở/đóng danh sách chủ đề con.';
          } catch (e) {}
        });
      </script>
        <section class="panel panel-bg">
            <h3 style="margin:0 0 12px 0;">Thống kê & Lịch sử — <span id="currentSubtopicName">(chưa chọn)</span></h3>
            <div class="stats-grid">
              <div class="stat-card"><h4>Tổng thời gian</h4><div class="stat-value" id="statTotal">0 phút</div></div>
              <div class="stat-card"><h4>Phiên</h4><div class="stat-value" id="statSessions">0</div></div>
              <div class="stat-card"><h4>Nhiệm vụ Hoàn thành</h4><div class="stat-value" id="statTasks">0</div></div>
            </div>
            <div style="margin-top:12px">
              <h4 style="margin:4px 0 8px; color:var(--sub)">Lịch sử (LÀM VIỆC)</h4>
              <div class="history" id="historyList"></div>
            </div>
        </section>
      </div>
      
      <div id="view-methods" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin:0;">💡 Kho Tri Thức Cá Nhân Hóa</h3>
                <button class="btn small acc" id="btnAddMethod" style="margin-left: auto;">＋ Thêm tri thức</button>
            </div>
            <p class="tiny" style="margin-top: -8px; margin-bottom: 20px;">Nhấp vào từng mục để xem chi tiết.</p>
            <div class="methods-container"></div>
        </div>
      </div>

      <div id="view-guide" class="view">
          <div class="panel panel-bg">
              <h3 style="margin-top: 0;">📖 Khám Phá Pomodoro Study App</h3>
              <p>
                  Chào mừng bạn đến với không gian học tập được thiết kế dành riêng cho sự tập trung và hiệu quả. Hãy cùng khám phá những tính năng sẽ đồng hành cùng bạn trên hành trình chinh phục tri thức.
              </p>

              <h4>🚀 Khởi Đầu Nhanh Chỉ Trong 4 Bước</h4>
              <p>Để hành trình của bạn luôn mạch lạc, mọi thứ trong ứng dụng được sắp xếp theo cấu trúc <strong>Chủ đề Lớn → Chủ đề con</strong>.</p>
              <ol>
                  <li>Mở mục <strong>📚 Chủ đề</strong> từ thanh điều hướng bên cạnh.</li>
                  <li>Nhấn <strong>＋ Thêm Chủ đề</strong> để tạo một lĩnh vực lớn (ví dụ: "Tiếng Anh Giao Tiếp").</li>
                  <li>Bên cạnh chủ đề vừa tạo, nhấn <strong>＋ Thêm</strong> để tạo một chủ đề con, chi tiết hơn (ví dụ: "Bài 1: Luyện phát âm IPA").</li>
                  <li>Chọn chủ đề con đó. Giờ đây, bạn đã sẵn sàng để bắt đầu phiên học đầu tiên của mình!</li>
              </ol>

              <hr />
              <h4>✨ Những Tính Năng Đáng Chú Ý</h4>

              <h4>Các Chế Độ Đồng Hồ Linh Hoạt ⏱️</h4>
              <p>Ứng dụng không chỉ có Pomodoro. Hãy chọn phương pháp phù hợp với công việc của bạn:</p>
              <ul>
                  <li><strong>Pomodoro Cổ Điển (Kiểu A/B):</strong> Làm việc tập trung trong các phiên định sẵn (ví dụ: 25 phút làm, 5 phút nghỉ) để xây dựng kỷ luật và nhịp độ.</li>
                  <li><strong>Chế độ Flowtime (Kiểu 🌊 Flow):</strong> Dành cho công việc cần dòng chảy sâu. Đồng hồ sẽ đếm lên, cho phép bạn làm việc đến khi tự cảm thấy cần nghỉ. Thời gian nghỉ sẽ được đề xuất dựa trên thời gian bạn đã làm việc.</li>
                  <li><strong>Đệm "Hạ nhiệt" (Wind-down):</strong> Một khoảng đệm tùy chỉnh giữa lúc làm và lúc nghỉ, giúp bạn kết thúc công việc đang dở, ghi chú lại "bước tiếp theo" và chuyển trạng thái một cách mượt mà, không bị cắt ngang đột ngột.</li>
              </ul> 
              <h4>Kho Tri Thức Theo Từng Chủ Đề Con 💡</h4>
<p>
    Mỗi một <strong>Chủ đề con</strong> giờ đây sẽ có một "Kho Tri Thức" hoàn toàn riêng biệt. Tính năng này cho phép bạn xây dựng một thư viện kiến thức chuyên sâu, chỉ liên quan đến lĩnh vực bạn đang học.
</p>
<p>
    Ví dụ, các ghi chú và phương pháp học "Tiếng Anh Giao Tiếp" sẽ chỉ xuất hiện khi bạn chọn chủ đề con đó, và sẽ không bị lẫn với các công thức trong chủ đề con "Giải tích Toán học".
</p>
<p>
    Với trình soạn thảo mạnh mẽ, bạn vẫn có thể dễ dàng định dạng tiêu đề, in đậm, tạo danh sách và làm nổi bật những thông tin quan trọng nhất cho từng môn học của mình.
</p>

              <h4>Quản Lý Chủ Đề Trực Quan</h4>
              <p>Dễ dàng sắp xếp các mục tiêu học tập của bạn. Sử dụng thao tác <strong>kéo và thả</strong> để sắp xếp lại thứ tự các Chủ đề hoặc di chuyển một Chủ đề con sang một lĩnh vực khác một cách trực quan.</p>

              <h4>Nhiệm Vụ & Ghi Chú Tích Hợp 📝</h4>
              <p>Ngay trong màn hình đồng hồ, bạn có thể tạo danh sách việc cần làm (to-do) cho từng chủ đề con hoặc ghi lại những ý tưởng chợt nảy ra mà không làm gián đoạn dòng chảy công việc.</p>

              <h4>Chế Độ Zen 🧘</h4>
              <p>Khi cần tập trung tuyệt đối, hãy nhấn vào biểu tượng con mắt (👁️). Giao diện sẽ ẩn đi, chỉ để lại hình nền và chiếc đồng hồ. Trong chế độ này, bạn có thể <strong>kéo thả đồng hồ</strong> đến bất kỳ vị trí nào trên màn hình để có một không gian làm việc gọn gàng nhất.</p>

              <h4>Thống Kê & Cột Mốc 🏆</h4>
              <p>Theo dõi hành trình của bạn qua những con số biết nói. Ứng dụng sẽ tự động ghi nhận và chúc mừng khi bạn đạt được những cột mốc quan trọng về thời gian tập trung, biến mỗi nỗ lực thành một thành tựu đáng tự hào.</p>

              <hr />
              <h4>⌨️ Phím Tắt Thông Minh</h4>
              <ul>
                  <li><kbd>Space</kbd>: Bắt đầu / Tạm dừng / Tiếp tục phiên học.</li>
                  <li><kbd>N</kbd>: Bỏ qua phiên làm việc hoặc nghỉ hiện tại.</li>
                  <li><kbd>Esc</kbd>: Đóng các cửa sổ đang mở (như Cài đặt).</li>
              </ul>

              <hr />
              <h4>🛠️ Cài Đặt Nâng Cao & Tích Hợp</h4>

              <h4>Trợ Lý Gemini AI 🧠</h4>
              <p>Biến ứng dụng thành một người bạn đồng hành thông minh. Ngoài việc hỏi đáp, bạn còn có thể:</p>
              <ul>
                  <li><strong>Tự động Định dạng Thông minh:</strong> Khi soạn thảo trong mục "Phương pháp", hãy để AI tự động phân tích và định dạng văn bản thô của bạn—tự nhận diện tiêu đề, các ý chính cần in đậm và danh sách.</li>
                  <li><strong>Thiết lập:</strong> Truy cập Google AI Studio để tạo API Key miễn phí và dán vào ô "Gemini API Key" trong Cài đặt của ứng dụng.</li>
              </ul>

              <h4>Tùy Biến Giao Diện & Âm Thanh 🎨</h4>
              <p>Biến không gian học tập thành của riêng bạn:</p>
              <ul>
                  <li><strong>Nhiều Theme & Hình nền:</strong> Lựa chọn giữa các theme có sẵn (Sáng, Tối, Pastel...) hoặc <strong>tải lên hình nền của riêng bạn</strong> để tạo cảm hứng.</li>
                  <li><strong>Âm báo Tùy chỉnh:</strong> Bạn có thể <strong>tải lên các file âm thanh (.mp3, .wav...) của riêng mình</strong> để sử dụng làm chuông báo cho các phiên làm việc và nghỉ ngơi.</li>
              </ul>

              <h4>Nhạc Nền YouTube 🎶</h4>
              <p>Tạo không gian học tập hoàn hảo bằng cách phát một video hoặc danh sách phát YouTube làm nhạc nền. Dán đường dẫn (URL) vào ô "Nhạc nền YouTube" trong Cài đặt.</p>

              <h4>An Toàn Dữ Liệu: Sao Lưu & Phục Hồi 🛡️</h4>
              <p>Ứng dụng tự động sao lưu tiến trình của bạn mỗi ngày. Bạn có thể tùy chỉnh số ngày lưu giữ bản sao lưu và phục hồi dữ liệu từ một ngày trong quá khứ nếu cần. ⚠️ <strong>Cảnh báo:</strong> Phục hồi sẽ ghi đè toàn bộ dữ liệu hiện tại.</p>
          </div>
      </div>
    </main>
  </div>

  <div class="modal" id="modalMilestone" role="dialog" aria-modal="true" aria-labelledby="milestoneTitle">
    <div class="modal-card" style="width: min(600px, 94vw);">
        <h3 id="milestoneTitle">🎉 Chúc mừng Bạn!</h3>
        <p id="milestoneMessage" style="white-space: pre-wrap; line-height: 1.6;"></p>
        <div class="row" style="justify-content:flex-end; margin-top:12px">
            <button class="btn acc" id="btnMilestoneClose">Tiếp tục hành trình!</button>
        </div>
    </div>
  </div>
  <div class="modal" id="modalSettings" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="modal-card">
          <h3 id="settingsTitle">⚙️ Cài đặt</h3>
          <nav class="tab-nav">
              <button class="tab-btn active" data-tab="settings-timer">Đồng hồ</button>
              <button class="tab-btn" data-tab="settings-ui">Giao diện & Âm thanh</button>
              <button class="tab-btn" data-tab="settings-integrations">Tích hợp</button>
          </nav>
          <div class="settings-content">
              <div id="settings-timer" class="tab-content active" style="flex-direction:column; gap:20px;">
                  <div class="row" id="timerPresetSelector" style="margin-bottom:16px;">
                      <button class="btn acc" data-preset-target="A"> Kiểu A </button>
                      <button class="btn ghost" data-preset-target="B"> Kiểu B </button>
                      <button class="btn ghost" data-preset-target="C"> Kiểu C (Flow) </button>
                  </div>
                  <div id="settings-pomodoro">
                      <h4>Thời lượng Pomodoro</h4>
                      <div class="row">
                          <label>LÀM VIỆC (phút)<input type="number" id="set_work" min="1" /></label>
                          <label>HẠ NHIỆT (phút)<input type="number" id="set_winddown" min="0" /></label>
                          <label>NGHỈ NGẮN (phút)<input type="number" id="set_short" min="1" /></label>
                          <label>NGHỈ DÀI (phút)<input type="number" id="set_long" min="1" /></label>
                      </div>
                      <div class="row">
                          <label>Chu kỳ Pomodoro<input type="number" id="set_cycles" min="1" /></label>
                          <label>Chu kỳ nghỉ dài<input type="number" id="set_interval" min="2" /></label>
                      </div>
                  </div>
                  <div id="settings-flowtime" class="hidden">
                      <h4>Flowtime</h4>
                      <div class="row">
                          <label>Tỷ lệ nghỉ (Làm việc / X)
                              <input type="number" id="set_flowRatio" min="1" max="20" />
                          </label>
                      </div>
                      <p class="tiny" style="margin-top: 4px;">Gợi ý: Thời gian nghỉ = tổng thời gian làm việc / X. Mặc định là 5.</p>
                  </div>
                  <div class="settings-row-toggle">
                          <label for="set_autoStartNext">Tự động bắt đầu phiên tiếp theo</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_autoStartNext">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableWinddown">Bật Hạ nhiệt sau phiên làm</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableWinddown">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableSessionNotes">Nhắc ghi chú sau mỗi phiên</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableSessionNotes">
                              <span class="slider"></span>
                          </label>
                      </div>
              </div>
              <div id="settings-ui" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Giao diện</h4>
                      <div class="row">
                          <label>Theme Giao Diện
                                <select id="set_theme_color">
                                    <option value="default">Mặc định (Dark Blue)</option>
                                    <option value="light">Light - Trà Sữa</option>
                                    <option value="pastel">Pastel - Dễ thương</option>
                                    <option value="lofi">Lofi Study Room</option>
                                    <option value="space">Space Station</option>
                                </select>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 12px;">
                          <label>Chế độ hiển thị nền
                              <select id="set_backgroundMode">
                                  <option value="cover">Lấp đầy (Mặc định)</option>
                                  <option value="contain">Vừa vặn (Sắc nét)</option>
                                  <option value="auto">Kích thước gốc (Lặp lại)</option>
                              </select>
                          </label>
                      </div>
                      <div class="row">
                          <label>Hình nền
                              <label class="btn small ghost" for="uploadBg">Tải ảnh mới</label>
                              <input type="file" id="uploadBg" accept="image/*" class="hidden" />
                          </label>
                          <button class="btn small danger" id="btnClearBg">Xóa nền</button>
                      </div>
                      <div class="row">
                          <label style="flex: 1;">Độ trong suốt của nền</label>
                          <input type="range" id="set_panelOpacity" min="0.1" max="1" step="0.05" style="flex: 2;">
                      </div>
                      
                      
                   </div>
                  
                   <div>
                      <h4>Âm thanh</h4>
                      <div class="row">
                          <label>Âm lượng (0–1)<input type="number" id="set_volume" step="0.05" min="0" max="1"/></label>
                          <label>Kiểu âm báo
                              <select id="set_theme">
                                  <option value="beep">Beep</option>
                                  <option value="chime">Chime</option>
                              </select>
                          </label>
                           <button class="btn" id="btnTestSound" style="flex: 0 1 auto; align-self: center;">Test</button>
                      </div>
                      <div style="text-align: right; margin-top: 12px;">
                          <button class="btn ghost small" id="btnToggleCustomSounds">Tùy chỉnh âm báo</button>
                      </div>

                      <div id="customSoundsContainer" class="hidden" style="margin-top: 8px;">
                      <div class="row" style="display: flex; gap: 8px; justify-content: flex-end;">
                          <div>
                              <small>Âm báo hết LÀM VIỆC</small>
                              <label title="Âm báo hết LÀM VIỆC" class="btn small ghost" for="uploadSoundWork">LÀM VIỆC</label>
                              <input type="file" id="uploadSoundWork" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Âm báo hết NGHỈ NGẮN</small>
                              <label title="Âm báo hết NGHỈ NGẮN" class="btn small ghost" for="uploadSoundBreak">NGHỈ NGẮN</label>
                              <input type="file" id="uploadSoundBreak" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Âm báo hết NGHỈ DÀI</small>
                              <label title="Âm báo hết NGHỈ DÀI" class="btn small ghost" for="uploadSoundLong">NGHỈ DÀI</label>
                              <input type="file" id="uploadSoundLong" accept="audio/*" class="hidden" />
                          </div>
                      </div>
                      </div>
                      
                  </div>
              </div>
              <div id="settings-integrations" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Tích hợp AI</h4>
                      <label>Gemini API Key
                          <input type="password" id="set_apiKey" placeholder="Dán API Key của bạn vào đây..." />
                      </label>
                      <div class="tiny">Cần có để sử dụng các tính năng AI. Lấy key miễn phí tại <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a>.</div>
                  </div>
                  <div>
                      <h4>🎵 Nhạc nền YouTube</h4>
                      <div class="row" style="gap:8px; align-items:center;">
                          <input type="text" id="set_youtubeUrl" placeholder="Dán link YouTube vào đây..." style="flex:1;">
                          </div>
                      <div id="ytUrlFeedback" class="tiny" style="min-height: 1.2em; padding: 4px 0;"></div>
                      <div class="row" style="margin-top: 4px;">
                          <label style="flex: 0 1 auto; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                              <input type="checkbox" id="set_ytThumbAsBg">
                              <span>Dùng ảnh bìa video làm nền</span>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 8px;">
                          <button id="btnToggleYtSound" class="btn small" style="flex:0 1 auto;" title="Dừng sẽ không tự phát lại cho đến khi bạn bấm ▶️">▶️</button>
                          <input type="range" id="ytSoundVolume" min="0" max="100" step="1" value="80" style="flex:1;">
                      </div>
                      <div class="tiny" style="text-align:center; margin-top:4px;">Âm lượng</div>
                  </div>
                  <div>
                      <h4>🛡️ Cài đặt sao lưu</h4>
                      <div class="row">
                          <label>Số ngày sao lưu cần giữ lại
                               <input type="number" id="set_backupDays" min="1" max="30" />
                          </label>
                      </div>
                  </div>
                  <div>
                      <h4>🛡️ Phục hồi dữ liệu</h4>
                      <p class="tiny">Phục hồi dữ liệu từ một bản sao lưu tự động hàng ngày. Hành động này sẽ ghi đè lên dữ liệu hiện tại của bạn.</p>
                      <div class="row">
                          <select id="backupList" style="flex: 3;"></select>
                          <button id="btnRestoreBackup" class="btn warn small" style="flex: 1;">Phục hồi</button>
                      </div>
                  </div>
              </div>
          </div>
          <div class="row" style="margin-top:16px; justify-content:flex-end">
              <button class="btn ghost" id="btnDefaults">Mặc định</button>
              <button class="btn acc" id="btnSaveSettings">Lưu</button>
              <button class="btn" id="btnCloseSettings">Đóng</button>
          </div>
      </div>
  </div>

  <div class="modal" id="modalNote" role="dialog" aria-modal="true" aria-labelledby="noteTitle">
    <div class="modal-card">
      <h3 id="noteTitle">📝 Ghi chú cho phiên vừa hoàn thành</h3>
      <div class="row"><textarea id="noteText" placeholder="Bạn học được gì? Khó khăn? Next steps?"></textarea></div>
      <div class="row" style="justify-content:flex-end; margin-top:8px; gap: 12px;">
        <button class="btn" id="btnSummarizeNote">✨ Tóm tắt & Gợi ý</button>
        <button class="btn" id="btnSkipNote">Bỏ qua</button>
        <button class="btn acc" id="btnSaveNote">Lưu ghi chú</button>
      </div>
    </div>
  </div>

  <div class="modal" id="modalGeneric" role="dialog" aria-modal="true" aria-labelledby="genericTitle">
      <div class="modal-card" style="width: min(450px, 94vw);">
          <h3 id="genericTitle">Tiêu đề</h3>
          <p id="genericMessage" class="hidden"></p>
          <input type="text" id="genericInput" class="hidden" />
          <div class="row" style="justify-content:flex-end; margin-top:12px">
              <button class="btn" id="btnGenericCancel">Hủy</button>
              <button class="btn acc" id="btnGenericOk">OK</button>
          </div>
      </div>
  </div>
  
  <div class="modal" id="modalDashboard" role="dialog" aria-modal="true" aria-labelledby="dashboardTitle">
    <div class="modal-card" style="width: min(800px, 95vw);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h3 id="dashboardTitle">📊 Tổng quan</h3>
            <button class="btn ghost small" id="btnCloseDashboard">Đóng</button>
        </div>
        <p class="tiny">Tổng hợp thời gian và số phiên đã hoàn thành trên tất cả các chủ đề.</p>
        <div id="dashboardContent" style="max-height: 60vh; overflow-y: auto;"></div>
    </div>
  </div>

  <div class="modal" id="modalMethodEditor" role="dialog" aria-modal="true">
    <div class="modal-card" style="width: min(800px, 95vw);">
      <h3 id="methodEditorTitle">Chỉnh-sửa Phương-pháp</h3>
      
      <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
        <input type="hidden" id="methodEditorId">
        <label>Tiêu-đề<input type="text" id="methodEditorTitleInput"></label>
        
        <label>Nội-dung</label>
        <div class="editor-toolbar">
          <button id="toolH4" class="btn small ghost" title="Tiêu-đề nhỏ">H</button>
          <button id="toolBold" class="btn small ghost" title="In đậm">B</button>
          <button id="toolItalic" class="btn small ghost" title="In nghiêng">I</button>
          <button id="toolList" class="btn small ghost" title="Danh-sách">1.</button>
          <button id="toolBullet" class="btn small ghost" title="Danh sách chấm tròn">•</button>

          <div class="color-picker-wrapper">
            <button id="toolColor" class="btn small ghost" title="Màu chữ">A</button>
            <div class="color-palette hidden">
              <button class="color-swatch" style="background-color: var(--text);" data-color="var(--text)" title="Màu chữ mặc định"></button>
              <button class="color-swatch" style="background-color: var(--acc);" data-color="var(--acc)" title="Màu nhấn mạnh"></button>
              <button class="color-swatch" style="background-color: var(--acc-2);" data-color="var(--acc-2)" title="Màu tích cực"></button>
              <button class="color-swatch" style="background-color: var(--warn);" data-color="var(--warn)" title="Màu cảnh báo"></button>
              <button class="color-swatch" style="background-color: var(--danger);" data-color="var(--danger)" title="Màu nguy hiểm"></button>
              <button class="color-swatch" style="background-color: var(--purple);" data-color="var(--purple)" title="Màu tím"></button>
            </div>
          </div>
        </div>

        <div class="editor-container">
            <div id="methodEditorContentInput" class="editable-content" contenteditable="true"></div>
        </div>

      </div>

      <div class="row" style="justify-content:space-between; margin-top:16px">
        <button id="btnAutoFormat" class="btn small" disabled title="Tính năng này yêu cầu Gemini API Key">✨ Tự động định dạng</button>
        <div>
          <button class="btn" id="btnCancelMethodEditor">Hủy</button>
          <button class="btn acc" id="btnSaveMethod">Lưu</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toasts" id="toasts"></div>
  <audio id="audioWorkEnd"></audio>
  <audio id="audioBreakEnd"></audio>
  <audio id="audioLongEnd"></audio>
  <div id="youtube-player-container"></div>

  <div id="draggableTimer" class="draggable-timer">00:00</div>

  <div id="soundPermissionBar" class="sound-permission-bar" role="alert" aria-live="polite">
    <span class="msg">Nhấn "Bật âm thanh" để cho phép phát nhạc nền.</span>
    <button id="btnEnableSound" class="btn small acc">Bật âm thanh</button>
  </div>
<!-- YouTube Iframe API is loaded dynamically when needed -->
<!-- === START: Inline Minimal Sortable (Offline-Safe) === -->
<script>
// Minimal Sortable shim for offline single-file usage.
// Supports: draggable selector, cross-list via same group, onEnd callback.
(function(){
  if (window.Sortable) return; // Respect existing if loaded
  const DND = { src: null, from: null, selector: null, group: null };
  function makeDraggable(container, selector){
    Array.from(container.querySelectorAll(selector)).forEach(el => {
      try { el.setAttribute('draggable','true'); } catch(_) {}
    });
  }
  function closestItem(e, selector){
    const t = e.target && e.target.closest ? e.target.closest(selector) : null;
    return t || null;
  }
  function Sortable(container, opts){
    this.el = container;
    this.options = opts || {};
    const selector = this.options.draggable || '*';
    const group = this.options.group || null;
    makeDraggable(container, selector);
    const handleDragStart = (e) => {
      const item = closestItem(e, selector);
      if (!item) return;
      DND.src = item; DND.from = container; DND.selector = selector; DND.group = group;
      e.dataTransfer.effectAllowed = 'move';
      try { e.dataTransfer.setData('text/plain', ''); } catch(_) {}
    };
    const handleDragOver = (e) => {
      if (!DND.src) return;
      // Only allow drop if same selector and group matches (or no group)
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
    };
    const handleDrop = (e) => {
      if (!DND.src) return;
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
      const from = DND.from;
      const to = container;
      const children = Array.from(from.querySelectorAll(DND.selector));
      const oldIndex = children.indexOf(DND.src);
      if (target && DND.src && target !== DND.src) {
        to.insertBefore(DND.src, target);
      }
      const newChildren = Array.from(to.querySelectorAll(DND.selector));
      const newIndex = newChildren.indexOf(DND.src);
      if (typeof this.options.onEnd === 'function') {
        try { this.options.onEnd({ oldIndex, newIndex, from, to, item: DND.src }); } catch(_) {}
      }
      DND.src = null; DND.from = null; DND.selector = null; DND.group = null;
    };
    this._listeners = { handleDragStart, handleDragOver, handleDrop };
    container.addEventListener('dragstart', handleDragStart);
    container.addEventListener('dragover', handleDragOver);
    container.addEventListener('drop', handleDrop);
    this.destroy = () => {
      container.removeEventListener('dragstart', handleDragStart);
      container.removeEventListener('dragover', handleDragOver);
      container.removeEventListener('drop', handleDrop);
    };
  }
  window.Sortable = Sortable;
})();
</script>
<!-- === END: Inline Minimal Sortable === -->
  <script>
    const _0x336a98=_0x1a06;(function(_0x4b5d6a,_0x467bc4){const _0x465cfa=_0x1a06,_0x445b92=_0x4b5d6a();while(!![]){try{const _0x26ba01=-parseInt(_0x465cfa(0x379))/0x1*(-parseInt(_0x465cfa(0x2cc))/0x2)+-parseInt(_0x465cfa(0x48a))/0x3+parseInt(_0x465cfa(0x285))/0x4*(-parseInt(_0x465cfa(0x3e0))/0x5)+parseInt(_0x465cfa(0x492))/0x6+-parseInt(_0x465cfa(0x223))/0x7+parseInt(_0x465cfa(0x4c7))/0x8*(parseInt(_0x465cfa(0x28c))/0x9)+parseInt(_0x465cfa(0x269))/0xa*(parseInt(_0x465cfa(0x2a0))/0xb);if(_0x26ba01===_0x467bc4)break;else _0x445b92['push'](_0x445b92['shift']());}catch(_0x1a461b){_0x445b92['push'](_0x445b92['shift']());}}}(_0x5f4f,0x2cf5a),window[_0x336a98(0x4f1)](_0x336a98(0x46d),()=>{try{updateFullscreenButton();}catch(_0x1645e1){}}));const IS_FILE_PROTOCOL=window[_0x336a98(0x3cc)][_0x336a98(0x4b7)]===_0x336a98(0x49a);function startYtApiWatchdog(){const _0x58f62e=_0x336a98,_0x939c0a=document[_0x58f62e(0x461)](_0x58f62e(0x40e));if(!_0x939c0a)return;const _0x595fce=setTimeout(()=>{const _0x14a30a=_0x58f62e;try{(!window['YT']||!window['YT'][_0x14a30a(0x1f6)])&&(_0x939c0a['textContent']=_0x14a30a(0x286),_0x939c0a[_0x14a30a(0x225)]['color']=_0x14a30a(0x283));}catch(_0x10493b){}},0x5dc),_0x44f76a=setTimeout(()=>{const _0x337a3b=_0x58f62e;try{(!window['YT']||!window['YT']['Player'])&&(_0x939c0a[_0x337a3b(0x3fc)]=_0x337a3b(0x383),_0x939c0a[_0x337a3b(0x225)][_0x337a3b(0x354)]='var(--danger)');}catch(_0x192344){}},0x1b58);window['__ytApiWatchdog']={'cancel'(){clearTimeout(_0x595fce),clearTimeout(_0x44f76a);}};}(function(){const _0xf80756=_0x336a98,_0x4b8784={'timer.cycleInfo':({current:current=0x0,target:target=0x0}={})=>_0xf80756(0x1ea)+current+'/'+target,'timer.selectSubtopicPrompt':_0xf80756(0x2f1)};window['t']=function _0x172fe3(_0x11a806,_0x5d0822){const _0x178068=_0xf80756;try{const _0x49f74e=_0x4b8784[_0x11a806];if(typeof _0x49f74e===_0x178068(0x25b))return _0x49f74e(_0x5d0822||{});if(typeof _0x49f74e===_0x178068(0x448))return _0x49f74e;}catch(_0x2c293a){}return _0x11a806;},window[_0xf80756(0x442)]=function _0x406067(_0x4c631a){const _0x53f2d7=_0xf80756;try{localStorage[_0x53f2d7(0x401)]('lang',_0x4c631a||'vi');}catch(_0x53a59d){}return Promise[_0x53f2d7(0x1f5)]();};}());function ensureYouTubeAPI(){const _0x566bcc=_0x336a98;if(IS_FILE_PROTOCOL)return Promise['resolve'](![]);try{if(window['YT']&&window['YT'][_0x566bcc(0x1f6)])return Promise[_0x566bcc(0x1f5)](!![]);}catch(_0x523021){}if(window[_0x566bcc(0x46e)])return window[_0x566bcc(0x46e)];return startYtApiWatchdog(),window[_0x566bcc(0x46e)]=new Promise((_0x44dad5,_0x58dfb2)=>{const _0x4ffcab=_0x566bcc;try{const _0x510820=document[_0x4ffcab(0x41d)]('script');_0x510820['src']=_0x4ffcab(0x48d),_0x510820['async']=!![],_0x510820[_0x4ffcab(0x227)]=!![],_0x510820[_0x4ffcab(0x2de)]=()=>_0x44dad5(!![]),_0x510820['onerror']=()=>_0x58dfb2(new Error('Failed\x20to\x20load\x20YouTube\x20API')),document[_0x4ffcab(0x1fb)][_0x4ffcab(0x34d)](_0x510820);}catch(_0x52adbc){_0x58dfb2(_0x52adbc);}}),window[_0x566bcc(0x46e)];}const storageManager={'DB_NAME':_0x336a98(0x2c9),'DB_VERSION':0x1,'db':null,async 'initDB'(){return new Promise((_0x244c2b,_0xeb181b)=>{const _0x5bc297=_0x1a06;if(this['db'])return _0x244c2b(this['db']);const _0x5b6198=indexedDB[_0x5bc297(0x247)](this[_0x5bc297(0x474)],this[_0x5bc297(0x44a)]);_0x5b6198[_0x5bc297(0x2bc)]=_0x28be13=>{const _0x4a1f81=_0x5bc297,_0x3f19f0=_0x28be13[_0x4a1f81(0x253)][_0x4a1f81(0x200)];!_0x3f19f0[_0x4a1f81(0x3bc)]['contains'](_0x4a1f81(0x35e))&&_0x3f19f0[_0x4a1f81(0x38d)]('settings');!_0x3f19f0['objectStoreNames'][_0x4a1f81(0x3d4)](_0x4a1f81(0x38e))&&_0x3f19f0['createObjectStore'](_0x4a1f81(0x38e),{'keyPath':'id'});if(!_0x3f19f0[_0x4a1f81(0x3bc)]['contains'](_0x4a1f81(0x47c))){const _0x3c3e8b=_0x3f19f0[_0x4a1f81(0x38d)](_0x4a1f81(0x47c),{'keyPath':'id'});_0x3c3e8b[_0x4a1f81(0x3a6)](_0x4a1f81(0x4d1),_0x4a1f81(0x4cb));}!_0x3f19f0[_0x4a1f81(0x3bc)]['contains'](_0x4a1f81(0x202))&&_0x3f19f0[_0x4a1f81(0x38d)](_0x4a1f81(0x202),{'keyPath':_0x4a1f81(0x238)});},_0x5b6198[_0x5bc297(0x30c)]=_0x12a85f=>{const _0xfd11cf=_0x5bc297;this['db']=_0x12a85f[_0xfd11cf(0x253)][_0xfd11cf(0x200)],console[_0xfd11cf(0x502)]('IndexedDB\x20initialized\x20successfully.'),_0x244c2b(this['db']);},_0x5b6198[_0x5bc297(0x2ff)]=_0x30f905=>{const _0x1c8963=_0x5bc297;console['error'](_0x1c8963(0x24a),_0x30f905[_0x1c8963(0x253)][_0x1c8963(0x415)]),_0xeb181b(_0x30f905[_0x1c8963(0x253)]['error']);};});},async '_getStore'(_0x2270a6,_0x5c51ce='readonly'){const _0x338071=_0x336a98;await this[_0x338071(0x31c)]();const _0x22f2ac=this['db'][_0x338071(0x389)]([_0x2270a6],_0x5c51ce);return _0x22f2ac[_0x338071(0x37e)](_0x2270a6);},async 'getSettings'(){const _0x1da361=_0x336a98,_0x54d9ac=await this[_0x1da361(0x408)]('settings');return new Promise((_0x3d6ed1,_0xb9a92c)=>{const _0x4fec2d=_0x1da361,_0x2aa3e4=_0x54d9ac[_0x4fec2d(0x216)](_0x4fec2d(0x4eb));_0x2aa3e4[_0x4fec2d(0x30c)]=()=>_0x3d6ed1(_0x2aa3e4['result']),_0x2aa3e4[_0x4fec2d(0x2ff)]=()=>_0xb9a92c(_0x2aa3e4['error']);});},async 'updateSettings'(_0x4b602d){const _0x44b1ca=_0x336a98,_0x3fb4e1=await this['_getStore'](_0x44b1ca(0x35e),_0x44b1ca(0x40f));return new Promise((_0xa5e591,_0x1a3e11)=>{const _0x152e2e=_0x44b1ca,_0x59132e=_0x3fb4e1[_0x152e2e(0x2e8)](_0x4b602d,_0x152e2e(0x4eb));_0x59132e[_0x152e2e(0x30c)]=()=>_0xa5e591(_0x59132e[_0x152e2e(0x200)]),_0x59132e['onerror']=()=>_0x1a3e11(_0x59132e[_0x152e2e(0x258)]);});},async 'getAll'(_0x36724d){const _0x2c5548=_0x336a98,_0x104e26=await this[_0x2c5548(0x408)](_0x36724d);return new Promise((_0xf360c9,_0x53da0a)=>{const _0x14a005=_0x2c5548,_0x2ebf9b=_0x104e26['getAll']();_0x2ebf9b[_0x14a005(0x30c)]=()=>_0xf360c9(_0x2ebf9b[_0x14a005(0x200)]),_0x2ebf9b['onerror']=()=>_0x53da0a(_0x2ebf9b['error']);});},async 'update'(_0x19617d,_0x3e0056){const _0x34c7c2=_0x336a98,_0x2ea466=await this[_0x34c7c2(0x408)](_0x19617d,_0x34c7c2(0x40f));return new Promise((_0x3f5986,_0x66188e)=>{const _0x28b89a=_0x34c7c2,_0x4481c1=_0x2ea466[_0x28b89a(0x2e8)](_0x3e0056);_0x4481c1['onsuccess']=()=>_0x3f5986(_0x4481c1[_0x28b89a(0x200)]),_0x4481c1[_0x28b89a(0x2ff)]=()=>_0x66188e(_0x4481c1[_0x28b89a(0x258)]);});},async 'add'(_0x393d66,_0x283017){const _0x5ec653=_0x336a98,_0x3893c1=await this[_0x5ec653(0x408)](_0x393d66,_0x5ec653(0x40f));return new Promise((_0x10fe8b,_0x1d24a8)=>{const _0x59592d=_0x5ec653,_0x5c5e0f=_0x3893c1[_0x59592d(0x4b0)](_0x283017);_0x5c5e0f[_0x59592d(0x30c)]=()=>_0x10fe8b(_0x5c5e0f[_0x59592d(0x200)]),_0x5c5e0f[_0x59592d(0x2ff)]=()=>_0x1d24a8(_0x5c5e0f[_0x59592d(0x258)]);});},async 'delete'(_0x2c4aea,_0x3b627e){const _0x36d90e=_0x336a98,_0x355684=await this['_getStore'](_0x2c4aea,_0x36d90e(0x40f));return new Promise((_0xf2526f,_0x2af9db)=>{const _0xb9f10f=_0x36d90e,_0x4608f4=_0x355684['delete'](_0x3b627e);_0x4608f4[_0xb9f10f(0x30c)]=()=>_0xf2526f(_0x4608f4['result']),_0x4608f4[_0xb9f10f(0x2ff)]=()=>_0x2af9db(_0x4608f4[_0xb9f10f(0x258)]);});},async 'save'(_0x5a5d29){const _0x5b7ce6=_0x336a98;return await this[_0x5b7ce6(0x31c)](),new Promise((_0x56d680,_0x31099c)=>{const _0x5431f2=_0x5b7ce6,_0x504025=this['db'][_0x5431f2(0x389)]([_0x5431f2(0x35e),_0x5431f2(0x38e),_0x5431f2(0x47c)],_0x5431f2(0x40f)),_0x44931d=_0x504025[_0x5431f2(0x37e)](_0x5431f2(0x35e)),_0x1b30f4=_0x504025[_0x5431f2(0x37e)](_0x5431f2(0x38e)),_0x495468=_0x504025[_0x5431f2(0x37e)](_0x5431f2(0x47c));_0x44931d['put'](_0x5a5d29['settings'],_0x5431f2(0x4eb)),_0x1b30f4[_0x5431f2(0x2f2)](),_0x495468[_0x5431f2(0x2f2)](),_0x5a5d29['topics'][_0x5431f2(0x4ab)](_0x16c33d=>{const _0x2ec2e6=_0x5431f2,{subtopics:_0x10547c,..._0x26e235}=_0x16c33d;_0x1b30f4['put'](_0x26e235),(_0x10547c||[])[_0x2ec2e6(0x4ab)](_0x47386d=>_0x495468['put'](_0x47386d));}),_0x504025['oncomplete']=()=>_0x56d680(),_0x504025[_0x5431f2(0x2ff)]=_0x511637=>_0x31099c(_0x511637[_0x5431f2(0x253)][_0x5431f2(0x258)]);});},async 'autoBackup'(_0x589c1a){const _0x22784b=_0x336a98;await this[_0x22784b(0x31c)]();const _0x3a1e18=new Date()[_0x22784b(0x469)]()[_0x22784b(0x2d7)](0x0,0xa),_0x54a1b5=localStorage[_0x22784b(0x2c0)](_0x22784b(0x3b7));if(_0x3a1e18!==_0x54a1b5){console['log'](_0x22784b(0x210)+_0x3a1e18+_0x22784b(0x1f7));const _0x1e490e={'date':_0x3a1e18,'data':JSON['parse'](JSON['stringify'](_0x589c1a))},_0x10d592=this['db']['transaction']([_0x22784b(0x202)],'readwrite'),_0x2fe3cb=_0x10d592[_0x22784b(0x37e)](_0x22784b(0x202)),_0x56ba55=_0x2fe3cb[_0x22784b(0x2e8)](_0x1e490e);_0x56ba55[_0x22784b(0x30c)]=()=>{const _0x5ce5bb=_0x22784b;localStorage[_0x5ce5bb(0x401)](_0x5ce5bb(0x3b7),_0x3a1e18),console[_0x5ce5bb(0x502)]('Daily\x20backup\x20successful.'),this[_0x5ce5bb(0x489)](_0x589c1a?.[_0x5ce5bb(0x35e)]?.['backupDaysToKeep']||0x7);},_0x56ba55[_0x22784b(0x2ff)]=_0x2067ba=>{const _0x24d108=_0x22784b;console[_0x24d108(0x258)](_0x24d108(0x48c),_0x2067ba[_0x24d108(0x253)][_0x24d108(0x258)]);};}},async 'cleanupOldBackups'(_0x12c2e2){const _0x538c8a=_0x336a98;await this['initDB']();const _0x4c4a83=this['db'][_0x538c8a(0x389)]([_0x538c8a(0x202)],'readwrite'),_0x58a1ca=_0x4c4a83[_0x538c8a(0x37e)](_0x538c8a(0x202)),_0x519c1b=_0x58a1ca[_0x538c8a(0x4e2)]();_0x519c1b[_0x538c8a(0x30c)]=()=>{const _0x3c5417=_0x538c8a,_0x55accd=_0x519c1b['result'][_0x3c5417(0x499)]()[_0x3c5417(0x2f8)]();if(_0x55accd['length']>_0x12c2e2){const _0x3b3e0e=_0x55accd[_0x3c5417(0x2d7)](_0x12c2e2);_0x3b3e0e[_0x3c5417(0x4ab)](_0x15a19b=>{const _0x4dc846=_0x3c5417;_0x58a1ca[_0x4dc846(0x4b8)](_0x15a19b),console['log'](_0x4dc846(0x30e)+_0x15a19b);});}};},async 'getBackupList'(){const _0x468f88=_0x336a98;return await this[_0x468f88(0x31c)](),new Promise((_0x167302,_0x5f3c24)=>{const _0x2553b1=_0x468f88,_0x13f710=this['db']['transaction']([_0x2553b1(0x202)],'readonly'),_0x1c31d8=_0x13f710['objectStore'](_0x2553b1(0x202)),_0x30af09=_0x1c31d8[_0x2553b1(0x495)]();_0x30af09['onsuccess']=()=>_0x167302(_0x30af09[_0x2553b1(0x200)][_0x2553b1(0x499)]((_0x1487b5,_0x550fe9)=>_0x550fe9['date'][_0x2553b1(0x3a0)](_0x1487b5[_0x2553b1(0x238)]))),_0x30af09[_0x2553b1(0x2ff)]=_0x29010a=>_0x5f3c24(_0x29010a[_0x2553b1(0x253)]['error']);});},async 'restoreBackup'(_0x14f314){const _0x2a2848=_0x336a98;return await this[_0x2a2848(0x31c)](),new Promise((_0x35c7d4,_0x55667f)=>{const _0x2bffe6=_0x2a2848,_0x5ad0a6=this['db']['transaction']([_0x2bffe6(0x202)],_0x2bffe6(0x2e2)),_0x2eedcb=_0x5ad0a6[_0x2bffe6(0x37e)](_0x2bffe6(0x202)),_0x4a3140=_0x2eedcb[_0x2bffe6(0x216)](_0x14f314);_0x4a3140[_0x2bffe6(0x30c)]=()=>{const _0x2d00fe=_0x2bffe6;_0x4a3140['result']&&_0x4a3140[_0x2d00fe(0x200)][_0x2d00fe(0x407)]?(localStorage[_0x2d00fe(0x401)]('pomodoroData_v11',JSON[_0x2d00fe(0x22c)](_0x4a3140[_0x2d00fe(0x200)][_0x2d00fe(0x407)])),_0x35c7d4(_0x4a3140['result']['data'])):_0x55667f(new Error(_0x2d00fe(0x26c)));},_0x4a3140[_0x2bffe6(0x2ff)]=_0x9daef1=>_0x55667f(_0x9daef1['target'][_0x2bffe6(0x258)]);});},'exportData'(_0x1215b3){const _0x524534=_0x336a98;let _0x47f194={};try{_0x47f194=JSON['parse'](JSON[_0x524534(0x22c)](_0x1215b3||{}));}catch(_0x477a99){_0x47f194=_0x1215b3;}try{if(_0x47f194&&_0x47f194['settings'])_0x47f194[_0x524534(0x35e)][_0x524534(0x4d0)]='';}catch(_0x5b7c63){}const _0x3b5c65=new Blob([JSON[_0x524534(0x22c)](_0x47f194,null,0x2)],{'type':'application/json'}),_0x43b0ef=document[_0x524534(0x41d)]('a'),_0x500a8d=new Date(),_0x18b512=_0x4e6abf=>(''+_0x4e6abf)[_0x524534(0x2c5)](0x2,'0');_0x43b0ef[_0x524534(0x284)]=URL[_0x524534(0x4ec)](_0x3b5c65),_0x43b0ef[_0x524534(0x278)]=_0x524534(0x2b8)+_0x500a8d[_0x524534(0x1f9)]()+_0x18b512(_0x500a8d[_0x524534(0x311)]()+0x1)+_0x18b512(_0x500a8d[_0x524534(0x3a1)]())+'.json',_0x43b0ef[_0x524534(0x3b9)](),URL['revokeObjectURL'](_0x43b0ef['href']);},async 'importData'(_0x436741){const _0x341d88=_0x336a98,_0x2e46d2=await _0x436741[_0x341d88(0x4fa)](),_0x5a5b5d=JSON[_0x341d88(0x235)](_0x2e46d2);if(!_0x5a5b5d[_0x341d88(0x3b2)]||!_0x5a5b5d[_0x341d88(0x35e)]||!Array[_0x341d88(0x2d0)](_0x5a5b5d[_0x341d88(0x38e)]))throw new Error(_0x341d88(0x349));try{const _0x3658e6=window['data']&&window[_0x341d88(0x407)][_0x341d88(0x35e)]&&window[_0x341d88(0x407)][_0x341d88(0x35e)]['apiKey']||'';(!(_0x341d88(0x4d0)in _0x5a5b5d[_0x341d88(0x35e)])||_0x5a5b5d[_0x341d88(0x35e)][_0x341d88(0x4d0)]==='')&&(_0x5a5b5d[_0x341d88(0x35e)][_0x341d88(0x4d0)]=_0x3658e6);}catch(_0x271a31){}return localStorage['setItem'](_0x341d88(0x265),JSON[_0x341d88(0x22c)](_0x5a5b5d)),_0x5a5b5d;}},$=(_0x971379,_0x326613=document)=>_0x326613['querySelector'](_0x971379),breakSuggestions=['Hãy\x20đứng\x20dậy\x20vươn\x20vai\x20và\x20duỗi\x20người.',_0x336a98(0x2ae),_0x336a98(0x4d3),'Đi\x20dạo\x20một\x20vòng\x20ngắn\x20quanh\x20phòng.',_0x336a98(0x473),_0x336a98(0x2ef),_0x336a98(0x446),'Nhắm\x20mắt\x20và\x20thư\x20giãn\x20trong\x20một\x20phút.',_0x336a98(0x470),_0x336a98(0x325),'Đặt\x20tay\x20lên\x20ngực,\x20cảm\x20nhận\x20nhịp\x20tim\x20của\x20mình.',_0x336a98(0x4ba),_0x336a98(0x3da),_0x336a98(0x2af),_0x336a98(0x1ff),_0x336a98(0x364),'Kiểm\x20tra\x20và\x20chỉnh\x20lại\x20tư\x20thế\x20ngồi\x20cho\x20đúng.',_0x336a98(0x3ba),'Thả\x20lỏng\x20hai\x20chân,\x20lắc\x20nhẹ\x20cổ\x20chân\x20dưới\x20bàn.',_0x336a98(0x236),'Đếm\x20chậm\x20từng\x20nhịp\x20thở\x20đến\x20số\x2010.',_0x336a98(0x3e7),_0x336a98(0x486),_0x336a98(0x427),_0x336a98(0x2e6),_0x336a98(0x420),_0x336a98(0x321),_0x336a98(0x50c),_0x336a98(0x48b),'Bước\x20ra\x20ban\x20công,\x20tận\x20hưởng\x20ánh\x20sáng\x20tự\x20nhiên.',_0x336a98(0x30d),_0x336a98(0x374)],$$=(_0xc883c2,_0x5b1541=document)=>Array[_0x336a98(0x36a)](_0x5b1541['querySelectorAll'](_0xc883c2));function on(_0x128965,_0x3614cc,_0xf3ea0f){const _0x414da2=_0x336a98;if(!_0x128965){console['warn'](_0x414da2(0x481),_0x3614cc);return;}_0x128965[_0x414da2(0x4f1)](_0x3614cc,_0xf3ea0f);}const formatMMSS=_0x4c6571=>{const _0x4ab2d0=_0x336a98,_0x1344bc=Math[_0x4ab2d0(0x3ad)](_0x4c6571/0x3c)[_0x4ab2d0(0x44e)]()['padStart'](0x2,'0'),_0x922db2=Math[_0x4ab2d0(0x3ad)](_0x4c6571%0x3c)[_0x4ab2d0(0x44e)]()['padStart'](0x2,'0');return _0x1344bc+':'+_0x922db2;},uid=(_0x1a64bc='id')=>_0x1a64bc+'_'+Date[_0x336a98(0x291)]()+'_'+Math[_0x336a98(0x503)]()[_0x336a98(0x44e)](0x24)[_0x336a98(0x2d7)](0x2,0x9);let __releaseFocusTrap=null;function trapFocus(_0x5d3c79){const _0x344eda=_0x336a98;try{const _0x1eab62=_0x5d3c79[_0x344eda(0x42e)]('button,\x20[href],\x20input,\x20select,\x20textarea,\x20[tabindex]:not([tabindex=\x22-1\x22])');if(!_0x1eab62[_0x344eda(0x3fd)])return;const _0x1fa186=_0x1eab62[0x0],_0x51fac6=_0x1eab62[_0x1eab62[_0x344eda(0x3fd)]-0x1],_0x1881c5=_0x5cb975=>{const _0x41de6c=_0x344eda;if(_0x5cb975[_0x41de6c(0x375)]===_0x41de6c(0x405)){if(_0x5cb975['shiftKey']&&document[_0x41de6c(0x214)]===_0x1fa186)_0x5cb975[_0x41de6c(0x423)](),_0x51fac6[_0x41de6c(0x255)]();else!_0x5cb975[_0x41de6c(0x4c8)]&&document[_0x41de6c(0x214)]===_0x51fac6&&(_0x5cb975[_0x41de6c(0x423)](),_0x1fa186[_0x41de6c(0x255)]());}};_0x5d3c79[_0x344eda(0x4f1)](_0x344eda(0x4f5),_0x1881c5),_0x1fa186['focus'](),__releaseFocusTrap=()=>{const _0x22a669=_0x344eda;try{_0x5d3c79[_0x22a669(0x458)](_0x22a669(0x4f5),_0x1881c5);}catch(_0x1ea2e7){}};}catch(_0x3fbb13){}}function releaseFocus(){if(__releaseFocusTrap){try{__releaseFocusTrap();}catch(_0x5e5e1a){}__releaseFocusTrap=null;}}const todayISO=()=>new Date()[_0x336a98(0x469)]();function toast(_0xf206c0,_0x4919c8=0xa28){const _0x2f27e5=_0x336a98,_0x3a5877=$(_0x2f27e5(0x205)),_0x5cb192=document['createElement']('div');_0x5cb192[_0x2f27e5(0x314)]=_0x2f27e5(0x2aa),_0x5cb192[_0x2f27e5(0x3fc)]=_0xf206c0,_0x3a5877[_0x2f27e5(0x34d)](_0x5cb192),setTimeout(()=>{const _0x2043ea=_0x2f27e5;_0x5cb192[_0x2043ea(0x225)]['opacity']='0';},_0x4919c8-0x12c),setTimeout(()=>_0x3a5877['removeChild'](_0x5cb192),_0x4919c8);}function escapeHTML(_0x35a61e){const _0x5b9752=_0x336a98;return _0x35a61e[_0x5b9752(0x279)](/[&<>"']/g,_0x19f361=>({'&':_0x5b9752(0x30b),'<':_0x5b9752(0x302),'>':_0x5b9752(0x31a),'\x22':'&quot;','\x27':_0x5b9752(0x4e4)}[_0x19f361]));}function formatDaysHoursMinutes(_0x48be9d){const _0x360f1f=_0x336a98;if(!_0x48be9d||_0x48be9d<0x1)return'0\x20phút';const _0x46798e=Math[_0x360f1f(0x3ad)](_0x48be9d/0x3c),_0x15cec8=_0x48be9d%0x3c,_0x2f9e96=_0x15cec8[_0x360f1f(0x44e)]()[_0x360f1f(0x2c5)](0x2,'0');return _0x46798e+_0x360f1f(0x424)+_0x2f9e96+_0x360f1f(0x510);}function formatGeminiResponse(_0x556df9){const _0x43f439=_0x336a98;return _0x556df9[_0x43f439(0x279)](/(\*\*|__|\*|_|#+\s*)/g,'');}function parseSimpleMarkdown(_0x3710a0){const _0x5a7802=_0x336a98,_0x2c8445=(_0x3710a0||'')['split']('\x0a');let _0xa6d45e='',_0x1b47ac=null;const _0x3c7d8=()=>{const _0x467b83=_0x1a06;_0x1b47ac&&(_0xa6d45e+=_0x1b47ac==='ol'?'</ol>':_0x467b83(0x45e),_0x1b47ac=null);};for(let _0x539773 of _0x2c8445){let _0x35a39f=(_0x539773||'')[_0x5a7802(0x3a2)]();if(!_0x35a39f){_0x3c7d8();continue;}if(_0x35a39f[_0x5a7802(0x2e5)](_0x5a7802(0x20a)))_0x3c7d8(),_0xa6d45e+=_0x5a7802(0x4a6)+escapeHTML(_0x35a39f['substring'](0x5))+_0x5a7802(0x4ae);else{if(/^\d+\.\s/[_0x5a7802(0x385)](_0x35a39f)){_0x1b47ac!=='ol'&&(_0x3c7d8(),_0xa6d45e+=_0x5a7802(0x3d8),_0x1b47ac='ol');const _0x34fd7b=_0x35a39f[_0x5a7802(0x3ff)](_0x35a39f[_0x5a7802(0x476)]('\x20')+0x1);_0xa6d45e+=_0x5a7802(0x298)+escapeHTML(_0x34fd7b)+'</li>';}else _0x35a39f[_0x5a7802(0x2e5)]('-\x20')?(_0x1b47ac!=='ul'&&(_0x3c7d8(),_0xa6d45e+='<ul>',_0x1b47ac='ul'),_0xa6d45e+=_0x5a7802(0x298)+escapeHTML(_0x35a39f[_0x5a7802(0x3ff)](0x2))+_0x5a7802(0x39f)):(_0x3c7d8(),_0x35a39f=escapeHTML(_0x35a39f)[_0x5a7802(0x279)](/\*\*(.*?)\*\*/g,_0x5a7802(0x34f))['replace'](/_(.*?)_/g,_0x5a7802(0x3c1)),_0xa6d45e+=_0x5a7802(0x387)+_0x35a39f+_0x5a7802(0x30a));}}return _0x3c7d8(),_0xa6d45e;}function wrapTextInMarkdown(_0x40becf,_0x353f5b,_0x3846b7=''){const _0x3b664f=_0x336a98;if(!_0x40becf)return;const _0x5b8be5=_0x40becf[_0x3b664f(0x242)]||0x0,_0x367156=_0x40becf['selectionEnd']||0x0,_0x8af446=_0x40becf[_0x3b664f(0x301)][_0x3b664f(0x3ff)](_0x5b8be5,_0x367156),_0x39647e=_0x353f5b+_0x8af446+(_0x3846b7||_0x353f5b);_0x40becf[_0x3b664f(0x230)](_0x39647e,_0x5b8be5,_0x367156,_0x3b664f(0x23e)),_0x40becf['focus']();}function updateEditorPreview(){const _0x285470=_0x336a98,_0x4248a9=$(_0x285470(0x2df)),_0x3ab141=$(_0x285470(0x3f2));if(!_0x4248a9||!_0x3ab141)return;const _0x5e3f34=_0x4248a9[_0x285470(0x301)]||'';_0x3ab141[_0x285470(0x1ed)]=parseSimpleMarkdown(_0x5e3f34);}function normalizeDataStructure(_0x3a038c){const _0x119526=_0x336a98;if(!_0x3a038c||typeof _0x3a038c!==_0x119526(0x4b6))return;const _0x15e7e7=_0x3a038c[_0x119526(0x35e)]||{},_0x40db17={...defaults[_0x119526(0x35e)],..._0x15e7e7,'durations':{...defaults['settings']['durations'],..._0x15e7e7[_0x119526(0x4f2)]||{}}};if(!Array[_0x119526(0x2d0)](_0x40db17[_0x119526(0x34a)]))_0x40db17[_0x119526(0x34a)]=[];_0x3a038c['settings']=_0x40db17,_0x3a038c['topics']=Array[_0x119526(0x2d0)](_0x3a038c[_0x119526(0x38e)])?_0x3a038c[_0x119526(0x38e)]:[],_0x3a038c[_0x119526(0x38e)]['forEach'](_0x3227da=>{const _0x3738b5=_0x119526;_0x3227da[_0x3738b5(0x47c)]=Array[_0x3738b5(0x2d0)](_0x3227da[_0x3738b5(0x47c)])?_0x3227da[_0x3738b5(0x47c)]:[],_0x3227da[_0x3738b5(0x47c)]['forEach'](_0x433f1d=>{const _0xca2f01=_0x3738b5;_0x433f1d[_0xca2f01(0x44b)]=_0x433f1d[_0xca2f01(0x44b)]||[],_0x433f1d[_0xca2f01(0x215)]=_0x433f1d[_0xca2f01(0x215)]||[],_0x433f1d[_0xca2f01(0x299)]=_0x433f1d[_0xca2f01(0x299)]||[],_0x433f1d[_0xca2f01(0x4b1)]=_0x433f1d['chatHistory']||[],_0x433f1d[_0xca2f01(0x257)]=Array[_0xca2f01(0x2d0)](_0x433f1d[_0xca2f01(0x257)])?_0x433f1d['methods']:[],_0x433f1d[_0xca2f01(0x3b6)]=_0x433f1d[_0xca2f01(0x3b6)]||{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},_0x433f1d[_0xca2f01(0x3e9)]=_0x433f1d[_0xca2f01(0x3e9)]||[],_0x433f1d['timerState']=_0x433f1d['timerState']||{'state':_0xca2f01(0x49f),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0};});});}function extractYouTubeID(_0x3885c6){if(!_0x3885c6)return null;const _0x252fc4=/^.*(?:youtu.be\/|shorts\/|live\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([A-Za-z0-9_-]{11}).*/,_0x71e411=_0x3885c6['match'](_0x252fc4);return _0x71e411?_0x71e411[0x1]:null;}function _0x1a06(_0x2fb8f1,_0x5f4e3a){const _0x5f4fe8=_0x5f4f();return _0x1a06=function(_0x1a0664,_0x32dd0e){_0x1a0664=_0x1a0664-0x1ea;let _0xe0f25a=_0x5f4fe8[_0x1a0664];return _0xe0f25a;},_0x1a06(_0x2fb8f1,_0x5f4e3a);}let sessionYoutubeUrl='';function getActiveYoutubeUrl(){const _0x2b5a0a=_0x336a98;try{if(sessionYoutubeUrl)return sessionYoutubeUrl;const _0x15853e=document[_0x2b5a0a(0x461)](_0x2b5a0a(0x36e)),_0x28e57a=(_0x15853e&&_0x15853e[_0x2b5a0a(0x301)]?_0x15853e[_0x2b5a0a(0x301)]:'')[_0x2b5a0a(0x3a2)]();return _0x28e57a;}catch(_0x45562d){return'';}}function getActiveVideoId(){return extractYouTubeID(getActiveYoutubeUrl());}function handleYoutubeUrlInput(){const _0x2bf3fe=_0x336a98,_0x3acd48=$(_0x2bf3fe(0x4cf)),_0x4d0303=$(_0x2bf3fe(0x32b)),_0x1a001e=$(_0x2bf3fe(0x425)),_0x14423f=_0x3acd48[_0x2bf3fe(0x301)]['trim'](),_0x484c44=extractYouTubeID(_0x14423f);if(_0x484c44){_0x4d0303[_0x2bf3fe(0x3fc)]=_0x2bf3fe(0x2eb),_0x4d0303[_0x2bf3fe(0x225)][_0x2bf3fe(0x354)]='var(--acc-2)',_0x1a001e[_0x2bf3fe(0x3ee)]=![],sessionYoutubeUrl=_0x14423f;try{ytUserPaused=![];}catch(_0x3d5d85){}try{const _0x594f28='https://img.youtube.com/vi/'+_0x484c44+_0x2bf3fe(0x38f),_0x411c10=new Image();_0x411c10[_0x2bf3fe(0x2de)]=async()=>{const _0x4a7cde=_0x2bf3fe;data[_0x4a7cde(0x35e)][_0x4a7cde(0x2d1)]=_0x594f28;try{await saveData();}catch(_0x135e7a){}applyCustomBg();},_0x411c10[_0x2bf3fe(0x2ff)]=async()=>{const _0x3c1cc7=_0x2bf3fe,_0x1f94e7='https://img.youtube.com/vi/'+_0x484c44+'/hqdefault.jpg';data[_0x3c1cc7(0x35e)]['customBg']=_0x1f94e7;try{await saveData();}catch(_0x38636e){}applyCustomBg();},_0x411c10[_0x2bf3fe(0x3b1)]=_0x594f28;}catch(_0x4c7b19){}try{if(IS_FILE_PROTOCOL){const _0x3d8fc3=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x484c44,{'autoplay':0x1,'mute':_0x3d8fc3});try{setTimeout(()=>{const _0x534c73=_0x2bf3fe;try{fallbackPostMessage(_0x534c73(0x337));}catch(_0x4049eb){}},0xfa);}catch(_0x50808b){}!_ytUnlocked&&showSoundPermission();try{setTimeout(()=>{const _0x57fa33=_0x2bf3fe,_0x57952d=document[_0x57fa33(0x461)](_0x57fa33(0x40e));if(_0x57952d)_0x57952d[_0x57fa33(0x3fc)]=_0x57fa33(0x4ed);},0x1f4);}catch(_0xa49f2b){}}else ensureYouTubeAPI()[_0x2bf3fe(0x493)](()=>{const _0x5d9bde=_0x2bf3fe;updateYouTubePlayer();try{if(_ytUnlocked)ytFadeInPlay();else ytPlayer&&ytPlayer[_0x5d9bde(0x2b4)]&&ytPlayer['playVideo']&&(ytPlayer[_0x5d9bde(0x2b4)](),ytPlayer[_0x5d9bde(0x337)](),_ytPrimed=!![],showSoundPermission());}catch(_0xf6bd16){}})[_0x2bf3fe(0x2dd)](()=>{});}catch(_0x504f69){}}else{if(_0x14423f===''){_0x4d0303[_0x2bf3fe(0x3fc)]='',_0x1a001e[_0x2bf3fe(0x3ee)]=!![];if(IS_FILE_PROTOCOL)try{fallbackStop();}catch(_0x3e3273){}else ytPlayer&&ytPlayer[_0x2bf3fe(0x254)]&&ytPlayer[_0x2bf3fe(0x254)]();}else _0x4d0303[_0x2bf3fe(0x3fc)]=_0x2bf3fe(0x4bf),_0x4d0303[_0x2bf3fe(0x225)]['color']=_0x2bf3fe(0x209),_0x1a001e[_0x2bf3fe(0x3ee)]=!![];}}function applyTheme(_0x4498de){const _0x205b31=_0x336a98,_0x338195=_0x4498de||data['settings']['theme']||'default';document[_0x205b31(0x3d0)][_0x205b31(0x497)][_0x205b31(0x250)]=_0x338195;const _0x39c93a=[_0x205b31(0x331),'space'][_0x205b31(0x2c3)](_0x338195),_0xff6c0e=_0x338195===_0x205b31(0x23f)||_0x338195===_0x205b31(0x431),_0x308a1b=data[_0x205b31(0x35e)][_0x205b31(0x2d1)],_0x21c4c5=()=>{const _0x2903af=_0x205b31;try{document[_0x2903af(0x3d0)][_0x2903af(0x225)][_0x2903af(0x42a)]='';}catch(_0x44c13e){}};if(_0x308a1b&&!data[_0x205b31(0x35e)][_0x205b31(0x4b9)])document[_0x205b31(0x3d0)]['style'][_0x205b31(0x2c1)](_0x205b31(0x454),_0x205b31(0x26b)+_0x308a1b+')'),_0x21c4c5();else{if(_0x308a1b&&data[_0x205b31(0x35e)][_0x205b31(0x4b9)])document[_0x205b31(0x3d0)][_0x205b31(0x225)][_0x205b31(0x2c1)](_0x205b31(0x454),'url('+_0x308a1b+')'),_0x21c4c5();else{if(_0x39c93a)document[_0x205b31(0x3d0)][_0x205b31(0x225)]['removeProperty'](_0x205b31(0x454)),_0x21c4c5();else _0xff6c0e?(document[_0x205b31(0x3d0)]['style'][_0x205b31(0x2c1)]('--bg-image',_0x205b31(0x234)),_0x21c4c5()):(document[_0x205b31(0x3d0)][_0x205b31(0x225)][_0x205b31(0x2c1)](_0x205b31(0x454),''),document[_0x205b31(0x3d0)][_0x205b31(0x225)]['backgroundImage']=_0x205b31(0x266));}}}const defaults={'version':0x1,'settings':{'apiKey':'','currentView':_0x336a98(0x490),'preset':'A','autoStartNext':!![],'soundOn':!![],'volume':0.8,'soundTheme':_0x336a98(0x244),'theme':_0x336a98(0x35a),'cyclesA':0x4,'longBreakIntervalA':0x4,'cyclesB':0x4,'longBreakIntervalB':0x4,'flowtimeBreakRatio':0x5,'enableWinddown':!![],'enableSessionNotes':!![],'durations':{'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},'selectedTopicId':'','selectedSubtopicId':'','collapsedTopics':{},'customBg':'','customSounds':{'work_end':'','break_end':'','long_end':''},'youtubeUrl':'','youtubeVolume':0x50,'useYtThumbnailAsBg':!![],'panelOpacity':0.85,'panelBlur':0xa,'backgroundMode':_0x336a98(0x2bf),'backupDaysToKeep':0x7,'achievedMilestones':[],'methods':[{'id':uid('m'),'title':_0x336a98(0x2b2),'content':'<p>Nguyên\x20tắc\x20cốt\x20lõi\x20của\x20kỹ\x20thuật\x20này\x20dựa\x20trên\x20một\x20ý\x20tưởng\x20duy\x20nhất:\x20\x22Nếu\x20bạn\x20không\x20thể\x20giải\x20thích\x20một\x20chủ\x20đề\x20một\x20cách\x20đơn\x20giản,\x20bạn\x20chưa\x20thực\x20sự\x20hiểu\x20nó.\x22\x20Mục\x20tiêu\x20là\x20biến\x20kiến\x20thức\x20phức\x20tạp\x20thành\x20lời\x20giải\x20thích\x20đơn\x20giản\x20đến\x20mức\x20một\x20đứa\x20trẻ\x20cũng\x20có\x20thể\x20hiểu.</p><h4>Quy\x20Trình\x204\x20Bước\x20Tinh\x20Gọn</h4><ol><li><strong>Học:</strong>\x20Chọn\x20một\x20chủ\x20đề\x20và\x20viết\x20ra\x20tất\x20cả\x20những\x20gì\x20bạn\x20biết\x20về\x20nó.</li><li><strong>Dạy:</strong>\x20Giả\x20vờ\x20dạy\x20lại\x20chủ\x20đề\x20này\x20bằng\x20ngôn\x20ngữ\x20đơn\x20giản\x20nhất\x20có\x20thể.\x20Viết\x20hoặc\x20nói\x20to\x20ra.</li><li><strong>Tìm\x20&\x20Sửa\x20Lỗi:</strong>\x20Bất\x20cứ\x20khi\x20nào\x20bạn\x20bị\x20\x22kẹt\x22,\x20phải\x20dùng\x20thuật\x20ngữ\x20phức\x20tạp,\x20hoặc\x20không\x20thể\x20giải\x20thích\x20trôi\x20chảy,\x20bạn\x20đã\x20tìm\x20thấy\x20lỗ\x20hổng\x20kiến\x20thức\x20của\x20mình.\x20Hãy\x20quay\x20lại\x20tài\x20liệu\x20gốc\x20để\x20học\x20lại\x20cho\x20đến\x20khi\x20lấp\x20được\x20lỗ\x20hổng\x20đó.</li><li><strong>Đơn\x20Giản\x20Hóa:</strong>\x20Sắp\x20xếp\x20lại\x20lời\x20giải\x20thích\x20cuối\x20cùng,\x20sử\x20dụng\x20các\x20ví\x20dụ\x20hoặc\x20phép\x20ví\x20von\x20đơn\x20giản\x20để\x20nó\x20trở\x20nên\x20mạch\x20lạc\x20và\x20dễ\x20hiểu\x20nhất.</li></ol><h4>Cốt\x20Lõi</h4><p>Kỹ\x20thuật\x20Feynman\x20buộc\x20bạn\x20phải\x20chuyển\x20từ\x20việc\x20tiếp\x20thu\x20thụ\x20động\x20(đọc,\x20nghe)\x20sang\x20chủ\x20động\x20xử\x20lý\x20thông\x20tin.\x20Quá\x20trình\x20\x22bị\x20kẹt\x22\x20khi\x20giải\x20thích\x20chính\x20là\x20công\x20cụ\x20chẩn\x20đoán\x20mạnh\x20mẽ\x20nhất,\x20nó\x20chỉ\x20ra\x20chính\x20xác\x20điểm\x20bạn\x20còn\x20yếu.</p><p><i>Cách\x20nhanh\x20nhất\x20để\x20kiểm\x20tra\x20và\x20củng\x20cố\x20sự\x20hiểu\x20biết\x20của\x20bạn\x20là\x20thử\x20dạy\x20lại\x20nó\x20cho\x20người\x20khác\x20một\x20cách\x20đơn\x20giản.</i></p>'},{'id':uid('m'),'title':_0x336a98(0x37a),'content':'<p>Benjamin\x20Franklin\x20đã\x20tự\x20rèn\x20luyện\x20kỹ\x20năng\x20viết\x20từ\x20kém\x20cỏi\x20trở\x20nên\x20bậc\x20thầy\x20bằng\x20một\x20phương\x20pháp\x20chủ\x20động,\x20thay\x20vì\x20chỉ\x20đọc\x20một\x20cách\x20thụ\x20động.\x20Cốt\x20lõi\x20của\x20phương\x20pháp\x20này\x20là\x20phân\x20tích,\x20tái\x20tạo,\x20và\x20so\x20sánh\x20với\x20một\x20bài\x20viết\x20chất\x20lượng\x20cao.</p><p>Đây\x20là\x20một\x20ví\x20dụ\x20kinh\x20điển\x20của\x20\x22Luyện\x20tập\x20có\x20Chủ\x20đích\x22:\x20tập\x20trung\x20vào\x20điểm\x20yếu,\x20có\x20mục\x20tiêu\x20rõ\x20ràng\x20và\x20nhận\x20phản\x20hồi\x20ngay\x20lập\x20tức.</p><h4>Quy\x20Trình\x203\x20Bước\x20Cốt\x20Lõi</h4><ol><li><strong>Phân\x20Tích\x20(Deconstruct):</strong>\x20Đọc\x20một\x20bài\x20viết\x20mẫu\x20xuất\x20sắc.\x20Sau\x20đó,\x20chỉ\x20ghi\x20lại\x20những\x20ý\x20chính\x20của\x20từng\x20đoạn\x20hoặc\x20từng\x20câu\x20ra\x20một\x20tờ\x20giấy\x20riêng.</li><li><strong>Tái\x20Tạo\x20(Reconstruct):</strong>\x20Vài\x20ngày\x20sau,\x20khi\x20đã\x20quên\x20đi\x20văn\x20phong\x20của\x20bản\x20gốc,\x20hãy\x20dùng\x20những\x20ghi\x20chú\x20ý\x20chính\x20đó\x20để\x20viết\x20lại\x20toàn\x20bộ\x20bài\x20viết\x20bằng\x20ngôn\x20ngữ\x20và\x20cách\x20diễn\x20đạt\x20của\x20chính\x20bạn.</li><li><strong>So\x20Sánh\x20&\x20Sửa\x20Lỗi\x20(Compare\x20&\x20Correct):</strong>\x20Đối\x20chiếu\x20trực\x20tiếp\x20bài\x20viết\x20của\x20bạn\x20với\x20bản\x20gốc.\x20Đây\x20là\x20bước\x20quan\x20trọng\x20nhất.\x20Nó\x20giúp\x20bạn\x20phát\x20hiện\x20ngay\x20lập\x20tức\x20những\x20lỗi\x20sai\x20về\x20từ\x20vựng,\x20cấu\x20trúc\x20câu,\x20và\x20cách\x20sắp\x20xếp\x20ý\x20tưởng\x20để\x20sửa\x20chữa.</li></ol><p>Franklin\x20còn\x20thực\x20hành\x20các\x20biến\x20thể\x20nâng\x20cao\x20như\x20xáo\x20trộn\x20thứ\x20tự\x20các\x20ý\x20chính\x20để\x20rèn\x20luyện\x20tư\x20duy\x20logic,\x20hoặc\x20chuyển\x20văn\x20xuôi\x20thành\x20thơ\x20để\x20làm\x20giàu\x20vốn\x20từ.</p><h4>Nguyên\x20Tắc\x20Vàng</h4><p>Thành\x20công\x20của\x20phương\x20pháp\x20này\x20không\x20đến\x20từ\x20việc\x20lặp\x20lại\x20vô\x20thức,\x20mà\x20đến\x20từ\x20vòng\x20lặp\x20phản\x20hồi\x20trực\x20tiếp.\x20Việc\x20so\x20sánh\x20với\x20bản\x20gốc\x20buộc\x20bạn\x20phải\x20đối\x20mặt\x20và\x20sửa\x20chữa\x20những\x20điểm\x20yếu\x20cụ\x20thể\x20của\x20mình,\x20biến\x20việc\x20học\x20từ\x20một\x20quá\x20trình\x20mơ\x20hồ\x20thành\x20một\x20bài\x20tập\x20có\x20thể\x20đo\x20lường\x20được.</p><p><i>Để\x20viết\x20giỏi\x20hơn,\x20đừng\x20chỉ\x20đọc.\x20Hãy\x20chọn\x20một\x20bài\x20viết\x20hay,\x20phân\x20tích\x20nó,\x20cố\x20gắng\x20viết\x20lại,\x20và\x20so\x20sánh\x20để\x20tìm\x20ra\x20lỗi\x20sai.</i></p>'},{'id':uid('m'),'title':'Nguyên\x20Tắc\x2080/20\x20Để\x20Chinh\x20Phục\x20Lĩnh\x20Vực\x20Mới','content':_0x336a98(0x259)},{'id':uid('m'),'title':_0x336a98(0x303),'content':'<p>Gợi\x20nhớ\x20chủ\x20động\x20là\x20hành\x20động\x20nỗ\x20lực\x20truy\x20xuất\x20thông\x20tin\x20từ\x20não\x20bộ\x20mà\x20không\x20nhìn\x20vào\x20tài\x20liệu.\x20Đây\x20là\x20phương\x20pháp\x20học\x20hiệu\x20quả\x20vượt\x20trội\x20so\x20với\x20việc\x20đọc\x20lại,\x20highlight\x20hay\x20tóm\x20tắt\x20một\x20cách\x20thụ\x20động.</p><h4>Nguyên\x20Tắc\x2020/80</h4><p><strong>20%\x20Cốt\x20lõi:</strong>\x20Hành\x20động\x20\x22vắt\x20óc\x22\x20để\x20nhớ\x20lại\x20thông\x20tin\x20sẽ\x20củng\x20cố\x20các\x20liên\x20kết\x20thần\x20kinh,\x20giúp\x20chuyển\x20kiến\x20thức\x20vào\x20bộ\x20nhớ\x20dài\x20hạn.\x20Cảm\x20giác\x20khó\x20khăn\x20khi\x20cố\x20gắng\x20nhớ\x20chính\x20là\x20dấu\x20hiệu\x20của\x20việc\x20học\x20tập\x20hiệu\x20quả\x20đang\x20diễn\x20ra.</p><p><strong>80%\x20Kết\x20quả:</strong>\x20Bạn\x20sẽ\x20ghi\x20nhớ\x20kiến\x20thức\x20sâu\x20và\x20lâu\x20hơn,\x20đồng\x20thời\x20biết\x20chính\x20xác\x20mình\x20đang\x20yếu\x20ở\x20đâu.</p><h4>Các\x20Phương\x20Pháp\x20Quan\x20Trọng\x20Nhất</h4><ul><li><strong>Tự\x20Kiểm\x20Tra\x20(Self-testing):</strong>\x20Thay\x20vì\x20đọc\x20lại\x20ghi\x20chú,\x20hãy\x20che\x20chúng\x20đi\x20và\x20tự\x20đặt\x20câu\x20hỏi\x20cho\x20mình.\x20Ví\x20dụ:\x20Dùng\x20flashcards\x20(thẻ\x20ghi\x20nhớ)\x20và\x20luôn\x20trả\x20lời\x20trước\x20khi\x20lật\x20xem\x20đáp\x20án.</li><li><strong>Kỹ\x20thuật\x20\x22Blurting\x22:</strong>\x20Sau\x20khi\x20học\x20một\x20chủ\x20đề,\x20hãy\x20đóng\x20sách\x20lại\x20và\x20viết\x20ra\x20giấy\x20mọi\x20thứ\x20bạn\x20có\x20thể\x20nhớ.\x20Sau\x20đó,\x20so\x20sánh\x20với\x20tài\x20liệu\x20gốc\x20để\x20lấp\x20đầy\x20những\x20lỗ\x20hổng\x20kiến\x20thức.</li><li><strong>Dạy\x20lại\x20cho\x20người\x20khác:</strong>\x20Giải\x20thích\x20một\x20khái\x20niệm\x20cho\x20người\x20khác\x20buộc\x20bạn\x20phải\x20truy\x20xuất,\x20đơn\x20giản\x20hóa\x20và\x20sắp\x20xếp\x20lại\x20thông\x20tin\x20một\x20cách\x20mạch\x20lạc.</li></ul><p><i>Tóm\x20lại:\x20Đừng\x20chỉ\x20đọc\x20lại.\x20Hãy\x20dừng\x20lại,\x20che\x20tài\x20liệu\x20đi,\x20và\x20tự\x20hỏi:\x20\x22Mình\x20thực\x20sự\x20nhớ\x20được\x20gì?\x22</i></p>'},{'id':uid('m'),'title':'Lặp\x20Lại\x20Ngắt\x20Quãng\x20(Spaced\x20Repetition):\x20Học\x20Đúng\x20Thời\x20Điểm','content':_0x336a98(0x25e)}]},'topics':[]};let data,editingPreset='A',AUDIO_CTX=null;function _0x5f4f(){const _0x494db6=['from','btn\x20small\x20ghost\x20actions-menu-btn','cycleIndex','--panel-opacity','set_youtubeUrl','resume','btn\x20small\x20danger\x20method-delete','durationMinutes','#set_enableSessionNotes','transition','Tự\x20nhắc:\x20Nghỉ\x20ngơi\x20đúng\x20cách\x20là\x20để\x20làm\x20việc\x20tốt\x20hơn!','key','scrollTop','Gửi','max','293153hqutvx','Phương\x20Pháp\x20Viết\x20của\x20Benjamin\x20Franklin:\x20Học\x20Viết\x20Bằng\x20Cách\x20Tái\x20Tạo','customSounds','offsetHeight','#set_backupDays','objectStore','strokeDasharray','https:','#view-methods\x20.methods-container','long','Không\x20tải\x20được\x20API\x20YouTube.\x20Kiểm\x20tra\x20mạng\x20hoặc\x20tải\x20lại\x20trang.','badge\x20state\x20break','test','#welcomePanel\x20p','<p>','.tab-btn','transaction','#set_theme_color','LÀM\x20VIỆC\x20(FLOW)','#btnAutoFormat','createObjectStore','topics','/maxresdefault.jpg','#btnAddSubtopicTask','#btnFullscreen','exponentialRampToValueAtTime','.method-item','reloading','ArrowUp','modalMethodEditor','match','totalMinutes','Lỗi\x20phát\x20âm\x20thanh:','formatBlock','youtube-player-container','#view-methods','auto','classList','</li>','localeCompare','getDate','trim','triangle','#btnSaveMethod','#btnStart','createIndex','<span\x20class=\x22ico\x22>▾</span>','subtopic','chime','_sortable','#btnSendMessage','start','floor','revokeObjectURL','btn\x20small','.nav-btn[data-view=\x22','src','version','clientX','chev\x20btn\x20small\x20ghost','Nửa\x20nghìn\x20giờ\x20tập\x20trung.\x20Bạn\x20đã\x20dành\x20một\x20khoảng\x20thời\x20gian\x20đáng\x20kể\x20để\x20theo\x20đuổi\x20điều\x20quan\x20trọng\x20với\x20mình.\x20Mức\x20độ\x20chuyên\x20tâm\x20này\x20chắc\x20chắn\x20đang\x20tạo\x20ra\x20những\x20kết\x20quả\x20sâu\x20sắc\x20và\x20khác\x20biệt.\x20Thật\x20đáng\x20ngưỡng\x20mộ.','stats','lastBackupDate','Nghỉ\x20','click','Nhẹ\x20nhàng\x20nhắm\x20mắt\x20và\x20mỉm\x20cười\x20với\x20chính\x20mình.','interval','objectStoreNames','</label>','Tên\x20Chủ\x20đề\x20mới?','Lỗi:\x20','#customSoundsContainer','<i>$1</i>','pause','removing','blockReason','cueVideoById','HẠ\x20NHIỆT','filter','remaining','#set_short','sessionsCompleted','span','location','#audioBreakEnd','scrollHeight','isNaN','body','#audioLongEnd','file','Không\x20thể\x20lưu\x20thay\x20đổi.','contains','title','documentElement','wind_down','<ol>','#toolItalic','Massage\x20nhẹ\x20hai\x20bên\x20thái\x20dương.','#newSubtopicTaskInput','json','foreColor','unshift','Chúc\x20mừng\x20bạn\x20đã\x20làm\x20được\x20điều\x20khó\x20nhất:\x20Bắt\x20đầu\x20và\x20duy\x20trì.\x0a\x0a20\x20giờ\x20không\x20chỉ\x20là\x20thời\x20gian,\x20đó\x20là\x2020\x20giờ\x20bạn\x20đã\x20chiến\x20thắng\x20sự\x20xao\x20nhãng.\x20Bạn\x20đang\x20xây\x20dựng\x20một\x20nền\x20tảng\x20vững\x20chắc\x20cho\x20sự\x20kỷ\x20luật.\x20Hãy\x20tự\x20hào\x20về\x20khởi\x20đầu\x20này.','389525jndsuY','code','#stateBadge','#chatInput','backgroundSize','Hãy\x20chọn\x20một\x20Chủ\x20đề\x20con\x20trước\x20khi\x20bắt\x20đầu','.method-edit','Làm\x20động\x20tác\x20“thở\x20dài”\x20sâu\x20một\x20lần,\x20thả\x20lỏng\x20vai.','isConnected','sessions','#statTasks','sub-row','#uploadSoundLong','#set_winddown','disabled','menu-active','Đã\x20lưu\x20âm\x20báo\x20hết\x20NGHỈ\x20DÀI.','#draggableTimer','#editorPreview','_startTick','#btnSkipNote','input','pointerdown','finished','Gửi\x20bạn,\x201.000\x20giờ\x20(Chuyển\x20hóa)','0\x20phút','createOscillator','innerHeight','textContent','length','getPlayerState','substring','Tên\x20Chủ\x20đề\x20con\x20mới?','setItem','longBreakIntervalB','hours','role','Tab','yt-fallback','data','_getStore','.actions-menu.show','#btnRestoreBackup','Bạn\x20có\x20chắc\x20muốn\x20chuyển\x20sang\x20Kiểu\x20','(chưa\x20chọn)','createGain','ytUrlFeedback','readwrite','Dựa\x20vào\x20thông\x20tin\x20sau:\x0a-\x20Chủ\x20đề:\x20\x22','soundPermissionBar','timer.selectSubtopicPrompt','.timer-circle-container','message','errorCode','gain','topic-actions','Vui\x20lòng\x20nhập\x20Gemini\x20API\x20Key\x20trong\x20phần\x20Cài\x20đặt.','map','Lỗi:\x20Đã\x20vượt\x20quá\x20hạn\x20mức\x20yêu\x20cầu\x20tới\x20Gemini.\x20Vui\x20lòng\x20thử\x20lại\x20sau\x20ít\x20phút.','Escape','sid','createElement','topic-title','insertUnorderedList','Chớp\x20mắt\x20liên\x20tục\x2010\x20lần\x20để\x20tránh\x20khô\x20mắt.','__ytApiWatchdog','#genericTitle','preventDefault','\x20tiếng\x20','#btnToggleYtSound','Bạn\x20có\x20chắc\x20muốn\x20xóa\x20toàn\x20bộ\x20lịch\x20sử\x20chat\x20của\x20chủ\x20đề\x20con\x20này?','Nhớ\x20uống\x20một\x20ngụm\x20nước\x20nhé!','100\x20giờ!\x20Đây\x20không\x20còn\x20là\x20một\x20thử\x20nghiệm\x20nữa,\x20mà\x20là\x20một\x20sự\x20đầu\x20tư\x20nghiêm\x20túc\x20cho\x20mục\x20tiêu\x20của\x20bạn.\x0a\x0aHãy\x20dành\x20một\x20chút\x20thời\x20gian\x20để\x20nhìn\x20lại:\x20100\x20giờ\x20tập\x20trung\x20này\x20đã\x20giúp\x20bạn\x20tiến\x20xa\x20đến\x20đâu?\x20Năng\x20lượng\x20bạn\x20bỏ\x20ra\x20đang\x20định\x20hình\x20nên\x20kết\x20quả.','💡\x20Gợi\x20ý:\x20','backgroundImage','bottom','workMinutes','enableWinddown','querySelectorAll','<div\x20class=\x22spinner\x22></div>','A_winddown','pastel','#set_apiKey','<div\x20class=\x22tiny\x22>Chưa\x20có\x20tin\x20nhắn\x20nào.</div>','Chưa\x20có\x20ghi\x20chú\x20để\x20tóm\x20tắt.','<div\x20class=\x22tiny\x22>Chưa\x20có\x20tóm\x20tắt\x20nào.</div>','#milestoneTitle','#aiPromptSuggestions\x20button','Gửi\x20bạn,\x205.000+\x20giờ\x20(Di\x20sản)','\x22?\x20Mọi\x20chủ\x20đề\x20con\x20và\x20dữ\x20liệu\x20liên\x20quan\x20sẽ\x20bị\x20mất.','Gửi\x20bạn,\x20250\x20giờ\x20(Bền\x20bỉ)','(Không\x20tạo\x20được\x20tóm\x20tắt)','toLocaleString','menu-item','left','Thêm\x20Tri\x20thức\x20mới','getVolume','badge\x20state\x20long','loadLanguage','\x22?\x20Mọi\x20dữ\x20liệu\x20liên\x20quan\x20sẽ\x20bị\x20mất.','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M9.88\x209.88a3\x203\x200\x201\x200\x204.24\x204.24\x22/><path\x20d=\x22M10.73\x205.08A10.43\x2010.43\x200\x200\x201\x2012\x205c7\x200\x2010\x207\x2010\x207a13.16\x2013.16\x200\x200\x201-1.67\x202.68\x22/><path\x20d=\x22M6.61\x206.61A13.526\x2013.526\x200\x200\x200\x202\x2012s3\x207\x2010\x207a9.74\x209.74\x200\x200\x200\x205.39-1.61\x22/><line\x20x1=\x222\x22\x20y1=\x222\x22\x20x2=\x2222\x22\x20y2=\x2222\x22/></svg>','acc','Nghe\x20một\x20bản\x20nhạc\x20yêu\x20thích.','#selectedContext','string','#milestoneMessage','DB_VERSION','tasks','getPropertyValue','createdAt','toString','newIndex','method-item','Đổi\x20tên\x20Chủ\x20đề\x20con','_onFinishSegment','#modalDashboard','--bg-image','position','var(--acc)','B_long','removeEventListener','topic-item','#genericMessage','text/plain','getSettings','abs','</ul>','.topic-item','.method-item\x20.method-content','getElementById','.presets\x20button','Đang\x20phát\x20nhạc\x20nền...','\x20phút\x20theo\x20Flowtime\x20(','#set_theme','lastPersist','SẴN\x20SÀNG','collapsedTopics','toISOString','Gửi\x20bạn,\x20100\x20giờ\x20cống\x20hiến\x20(Cam\x20kết)','#set_panelOpacity','/hqdefault.jpg','load','__ytApiPromise','#btnCloseDashboard','Lắc\x20nhẹ\x20cổ\x20tay\x20và\x20vai\x20trong\x2030\x20giây.','#toolList','user','Thực\x20hiện\x20vài\x20động\x20tác\x20hít\x20thở\x20sâu.','DB_NAME','bg-view-mode','indexOf','#audioWorkEnd','#btnDashboard','AI\x20không\x20thể\x20định\x20dạng\x20lúc\x20này.','beforeunload','var(--muted)','subtopics','.color-picker-wrapper','#set_enableWinddown','Vui\x20lòng\x20nhập\x20ghi\x20chú\x20trước\x20khi\x20tóm\x20tắt.','timerState','Missing\x20element','importData','<option\x20value=\x22\x22>--\x20Chọn\x20ngày\x20để\x20phục\x20hồi\x20--</option>','.actions-menu-btn','</div>','Lắng\x20nghe\x20hơi\x20thở\x20ra\x20vào\x20qua\x20mũi.','<tr><td>','img.youtube.com/vi/','cleanupOldBackups','595467LyzVsn','Nạp\x20năng\x20lượng\x20bằng\x20một\x20món\x20ăn\x20nhẹ\x20lành\x20mạnh.','Backup\x20failed:','https://www.youtube.com/iframe_api','execCommand','Lỗi\x20lưu\x20file.','timer','hist-item','1460154UqEHxl','then','http:','getAll','linearRampToValueAtTime','dataset','unMute','sort','file:','Không\x20nhận\x20được\x20nội\x20dung\x20hợp\x20lệ\x20từ\x20AI.','relative','sine','Ẩn\x20giao\x20diện','idle','Nhập\x20thất\x20bại:\x20','segmentTotal','append','#dashboardContent','Đã\x20xóa\x20lịch\x20sử\x20chat.','.color-swatch','<h4>','presetTarget','#subtopicTasksList','#modalGeneric','break','forEach','A_long','tasksCompleted','</h4>','block','add','chatHistory','<div\x20class=\x22tiny\x22>Chưa\x20có\x20dữ\x20liệu</div>','\x20|\x20<strong>Tổng\x20phiên:</strong>\x20','repeat','flatMap','object','protocol','delete','useYtThumbnailAsBg','Mở\x20cửa\x20sổ\x20cho\x20không\x20khí\x20mới\x20vào\x20phòng.','#modalNote','command','oldIndex','exitFullscreen','❌\x20Link\x20không\x20hợp\x20lệ\x20hoặc\x20không\x20được\x20hỗ\x20trợ.','\x22\x0a\x0aHãy\x20tạo\x20một\x20bản\x20tóm\x20tắt\x20ngắn\x20gọn\x20về\x20những\x20gì\x20đã\x20làm\x20và\x20đề\x20xuất\x20một\x20bước\x20hợp\x20lý\x20tiếp\x20theo.\x20Định\x20dạng\x20câu\x20trả\x20lời\x20như\x20sau:\x0a\x0a---\x0a**✨\x20Tóm\x20tắt\x20AI:**\x0a[Tóm\x20tắt\x20ở\x20đây]\x0a\x0a**🚀\x20Gợi\x20ý\x20tiếp\x20theo:**\x0a[Gợi\x20ý\x20ở\x20đây]','volume','restoreBackup','updateSettings','soundOn','long_end','paused','64FqdOXG','shiftKey','autoBackup','top','topicId','postMessage','Xác\x20nhận\x20phục\x20hồi','onYouTubeIframeAPIReady','#set_youtubeUrl','apiKey','by_topic','#set_backgroundMode','Nhìn\x20ra\x20xa\x20qua\x20cửa\x20sổ\x20trong\x2020\x20giây.','var(--warn)','mousedown','note','Gửi\x20bạn,\x205\x20giờ\x20đầu\x20tiên\x20(Khởi\x20động)','Đã\x20dừng\x20nhạc\x20nền.','var(--acc-2)','absolute','flex','Xuất','</tbody></table>','#btnBreakEarly','.app-content','undefined','#methodEditorTitleInput','getAllKeys','<div>','&#39;','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Chưa\x20có\x20tri\x20thức\x20nào\x20trong\x20Chủ\x20đề\x20con\x20này.</p>','preset','all','.subtopics','setValueAtTime','content','main_settings','createObjectURL','Đang\x20phát','currentView','Phục\x20hồi\x20dữ\x20liệu\x20thành\x20công!\x20Tải\x20lại\x20trang...','Bạn\x20có\x20chắc\x20muốn\x20xóa\x20tóm\x20tắt\x20này?','addEventListener','durations','menu-item\x20danger','remove','keydown','badge','join','work_end','#btnToggleBg','text','#btnPresetC','#windDownChecklist','Phiên\x20đã\x20hoàn\x20thành!\x20Nhấn\x20Bắt\x20đầu\x20để\x20bắt\x20đầu\x20phiên\x20tiếp\x20theo.','isContentEditable','btnToggleYtSound','#btnSaveNote','oncomplete','log','random','BUFFERING','mode','Lỗi\x20lưu\x20dữ\x20liệu:\x20','bold','stopPropagation','\x20|\x20<strong>Tổng\x20nhiệm\x20vụ:</strong>\x20','longBreakIntervalA','#uploadSoundBreak','Nắn\x20nhẹ\x20các\x20khớp\x20ngón\x20tay\x20sau\x20khi\x20gõ\x20phím.','#topicsList','.tab-content','API\x20response\x20structure\x20is\x20unexpected:','\x20phút','Chu\x20kỳ\x20','#settings-pomodoro','getIframe','innerHTML','Xóa','Gửi\x20bạn,\x2020\x20giờ\x20(Nền\x20tảng)','.modal','#timerPresetSelector\x20button','cyclesA','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Vui\x20lòng\x20chọn\x20một\x20Chủ\x20đề\x20con\x20để\x20xem\x20Kho\x20Tri\x20Thức.</p>','#set_interval','resolve','Player','...','Đổi\x20tên\x20Chủ\x20đề','getFullYear','reduce','head','topic-header','push','\x20(B)','Đếm\x20ngược\x20từ\x2020\x20đến\x200\x20thật\x20chậm\x20rãi.','result','#set_cycles','backups','#btnAddTopic','Đã\x20tắt\x20nền\x20YouTube\x20để\x20hợp\x20với\x20theme\x20sáng.','#toasts','candidates','#btnResume','#set_volume','var(--danger)','####\x20','querySelector','fullscreenchange','Tóm\x20tắt','\x20·\x20','persistTimerState','Creating\x20backup\x20for\x20','<div\x20class=\x22hist-meta\x22>','#genericInput','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Tuyệt\x20vời!\x20Không\x20còn\x20task\x20nào.</li>','activeElement','generalNotes','get','prompt','type','method-content','Lỗi\x20HTTP:\x20','innerWidth','tid','note-content-wrapper','50\x20giờ\x20tập\x20trung!\x20Thói\x20quen\x20của\x20bạn\x20đang\x20tạo\x20ra\x20động\x20lực.\x20Sự\x20nhất\x20quán\x20nhỏ\x20bé\x20mỗi\x20ngày\x20đang\x20cộng\x20hưởng\x20thành\x20những\x20bước\x20tiến\x20lớn.\x20Bạn\x20đang\x20đi\x20đúng\x20hướng,\x20hãy\x20tiếp\x20tục\x20phát\x20huy.','breathing','splice','<div\x20class=\x22tiny\x22>Vui\x20lòng\x20chọn\x20một\x20chủ\x20đề\x20con.</div>','button','1563170aSDPKe','connect','style','parts','defer','pomodoro_files','active','div','btn\x20subtopic-btn','stringify','save','Gửi\x20bạn,\x20500\x20giờ\x20(Chuyên\x20tâm)','name','setRangeText','AI\x20đã\x20định\x20dạng\x20xong!','requestFullscreen','panelOpacity','none','parse','Chú\x20ý\x20đến\x20cảm\x20giác\x20nhiệt\x20độ,\x20ánh\x20sáng\x20trong\x20phòng.','#btnFinishFlow','date','#breakSuggestionDisplay','updateUI','sess','currentConfig','ArrowRight','end','light','Đã\x20cập\x20nhật\x20hình\x20nền.','#modalSettings','selectionStart','Vui\x20lòng\x20chọn\x20một\x20Chủ\x20đề\x20con\x20trước.','beep','isCompleted','Lỗi:\x20Không\x20thể\x20bật\x20chế\x20độ\x20toàn\x20màn\x20hình:\x20','open','currentDurations','Chưa\x20có\x20link\x20hợp\x20lệ.\x20Dán\x20link\x20rồi\x20bấm\x20▶️.','IndexedDB\x20error:','enableSessionNotes','A_work','#btnHelpCreateTopic','winddown','lang','theme','AutoBackup\x20error:','#btnSettings','target','stopVideo','focus','aria-expanded','methods','error','<p>Để\x20không\x20bị\x20choáng\x20ngợp\x20khi\x20học\x20một\x20lĩnh\x20vực\x20mới,\x20hãy\x20tập\x20trung\x20vào\x2020%\x20kiến\x20thức\x20cốt\x20lõi\x20mang\x20lại\x2080%\x20kết\x20quả\x20(Liều\x20lượng\x20Hiệu\x20quả\x20Tối\x20thiểu).</p><h4>20%\x20cốt\x20lõi:\x20Áp\x20dụng\x20Khung\x20Phân\x20tích\x205\x20Bước\x20để\x20xác\x20định\x2020%\x20quan\x20trọng\x20nhất:</h4><ol><li><strong>Xác\x20định\x20Kết\x20quả:</strong>\x20Mục\x20tiêu\x20cuối\x20cùng\x20của\x20bạn\x20là\x20gì?\x20(ví\x20dụ:\x20xây\x20dựng\x20được\x20một\x20trang\x20web).</li><li><strong>Phân\x20tích\x20Nền\x20tảng:</strong>\x20Tìm\x203-5\x20nguyên\x20lý\x20bất\x20biến\x20của\x20ngành.</li><li><strong>Nhận\x20diện\x20Lỗi\x20sai\x20Phổ\x20biến:</strong>\x20Học\x20cách\x20tránh\x20những\x20lỗi\x20mà\x20người\x20mới\x20hay\x20mắc\x20phải.</li><li><strong>Tìm\x20\x22Yếu\x20tố\x20Nhân\x22:</strong>\x20Kỹ\x20năng\x20nào\x20sẽ\x20giúp\x20học\x20mọi\x20thứ\x20khác\x20dễ\x20dàng\x20hơn?\x20(ví\x20dụ:\x20nhạc\x20lý\x20trong\x20âm\x20nhạc).</li><li><strong>Lập\x20bản\x20đồ\x20Ứng\x20dụng\x20Thực\x20tiễn:</strong>\x20Tập\x20trung\x20vào\x2020%\x20công\x20việc\x20chiếm\x2080%\x20thời\x20gian\x20thực\x20tế\x20của\x20ngành.</li></ol>','backgroundRepeat','function','A_short','values','<p>Nếu\x20Gợi\x20nhớ\x20chủ\x20động\x20là\x20về\x20cách\x20học,\x20thì\x20Lặp\x20lại\x20ngắt\x20quãng\x20là\x20về\x20thời\x20điểm\x20học.\x20Đây\x20là\x20một\x20hệ\x20thống\x20lên\x20lịch\x20ôn\x20tập\x20để\x20đưa\x20thông\x20tin\x20vào\x20trí\x20nhớ\x20dài\x20hạn\x20một\x20cách\x20hiệu\x20quả\x20nhất.</p><h4>Nguyên\x20Tắc\x20Cốt\x20Lõi:\x20Chống\x20Lại\x20Sự\x20Lãng\x20Quên\x20🧠</h4><p>Phương\x20pháp\x20này\x20dựa\x20trên\x20\x22Đường\x20cong\x20Lãng\x20quên\x22,\x20cho\x20thấy\x20chúng\x20ta\x20quên\x20thông\x20tin\x20nhanh\x20nhất\x20ngay\x20sau\x20khi\x20học.\x20Lặp\x20lại\x20ngắt\x20quãng\x20hoạt\x20động\x20bằng\x20cách\x20yêu\x20cầu\x20bạn\x20ôn\x20tập\x20lại\x20một\x20thông\x20tin\x20ngay\x20trước\x20khi\x20bạn\x20sắp\x20quên\x20nó.</p><p>Mỗi\x20lần\x20ôn\x20tập\x20thành\x20công\x20sẽ\x20làm\x20cho\x20khoảng\x20thời\x20gian\x20bạn\x20nhớ\x20thông\x20tin\x20đó\x20dài\x20ra.\x20Lần\x20đầu\x20bạn\x20có\x20thể\x20quên\x20sau\x201\x20ngày,\x20nhưng\x20sau\x20khi\x20ôn\x20tập,\x20bạn\x20sẽ\x20nhớ\x20được\x20trong\x203\x20ngày,\x20rồi\x201\x20tuần,\x201\x20tháng,\x20và\x20cứ\x20thế\x20xa\x20dần.</p><h4>Công\x20Cụ\x20Hiệu\x20Quả\x20Nhất:\x20Phần\x20Mềm\x20SRS\x20📱</h4><p>Thay\x20vì\x20tự\x20lên\x20lịch\x20thủ\x20công,\x20cách\x20hiệu\x20quả\x20nhất\x20là\x20sử\x20dụng\x20các\x20phần\x20mềm\x20Lặp\x20lại\x20ngắt\x20quãng\x20(Spaced\x20Repetition\x20Software\x20-\x20SRS).\x20Anki\x20được\x20xem\x20là\x20tiêu\x20chuẩn\x20vàng.\x20Nó\x20tự\x20động\x20hóa\x20hoàn\x20toàn\x20việc\x20lên\x20lịch\x20ôn\x20tập\x20cho\x20hàng\x20ngàn\x20thẻ\x20ghi\x20nhớ\x20dựa\x20trên\x20độ\x20khó\x20mà\x20bạn\x20tự\x20đánh\x20giá,\x20đảm\x20bảo\x20bạn\x20luôn\x20ôn\x20tập\x20vào\x20thời\x20điểm\x20tối\x20ưu\x20nhất.</p><h4>Sai\x20Lầm\x20Lớn\x20Nhất\x20Cần\x20Tránh\x20❌</h4><p>Lý\x20do\x20số\x20một\x20khiến\x20mọi\x20người\x20thất\x20bại\x20với\x20phương\x20pháp\x20này\x20là\x20\x22Quá\x20tải\x20Lịch\x20ôn\x20tập\x22\x20(Review\x20Overload).\x20Điều\x20này\x20xảy\x20ra\x20khi\x20bạn\x20tạo\x20quá\x20nhiều\x20thẻ\x20mới\x20mỗi\x20ngày\x20hoặc\x20bỏ\x20lỡ\x20vài\x20ngày\x20ôn\x20tập,\x20dẫn\x20đến\x20một\x20lượng\x20thẻ\x20tồn\x20đọng\x20khổng\x20lồ\x20gây\x20nản\x20chí.</p><p><strong>Giải\x20pháp\x20(20%\x20hành\x20động,\x2080%\x20kết\x20quả):</strong>\x20Hãy\x20nhất\x20quán.\x20Đặt\x20ra\x20giới\x20hạn\x20thực\x20tế\x20về\x20số\x20lượng\x20thẻ\x20mới\x20mỗi\x20ngày\x20(ví\x20dụ:\x2010-20\x20thẻ)\x20và\x20duy\x20trì\x20việc\x20ôn\x20tập\x20hàng\x20ngày.\x20Thà\x20học\x20ít\x20mà\x20đều\x20còn\x20hơn\x20học\x20dồn.</p><h4>Sự\x20Kết\x20Hợp\x20Sống\x20Còn:\x20AR\x20+\x20SR</h4><p>Lặp\x20lại\x20ngắt\x20quãng\x20(SR)\x20và\x20Gợi\x20nhớ\x20chủ\x20động\x20(AR)\x20là\x20hai\x20mặt\x20của\x20cùng\x20một\x20đồng\x20xu\x20và\x20không\x20thể\x20tách\x20rời.\x20SR\x20cung\x20cấp\x20lịch\x20trình\x20KHI\x20NÀO\x20nên\x20ôn\x20tập.\x20AR\x20là\x20hành\x20động\x20bạn\x20thực\x20hiện\x20KHI\x20ôn\x20tập.\x20Sự\x20kết\x20hợp\x20này\x20đảm\x20bảo\x20nỗ\x20lực\x20gợi\x20nhớ\x20của\x20bạn\x20xảy\x20ra\x20vào\x20\x22điểm\x20ngọt\x22\x20của\x20trí\x20nhớ.\x20Sử\x20dụng\x20Anki\x20chính\x20là\x20cách\x20triển\x20khai\x20kỹ\x20thuật\x20kết\x20hợp\x20này\x20một\x20cách\x20hiệu\x20quả\x20nhất.</p>','#importFile','#set_ytThumbAsBg','Chào\x20mừng\x20đến\x20Câu\x20lạc\x20bộ\x201000\x20giờ.\x0a\x0aCon\x20số\x20này\x20không\x20chỉ\x20đo\x20lường\x20thời\x20gian,\x20nó\x20đại\x20diện\x20cho\x20sự\x20chuyển\x20hóa.\x20Sự\x20tập\x20trung\x20đã\x20trở\x20thành\x20một\x20phần\x20con\x20người\x20bạn,\x20một\x20\x27siêu\x20năng\x20lực\x27\x20bạn\x20có\x20thể\x20triệu\x20hồi.\x20Hành\x20trình\x20của\x20bạn\x20thực\x20sự\x20truyền\x20cảm\x20hứng.','altKey','Đã\x20khôi\x20phục\x20mặc\x20định','Chưa\x20chọn\x20Chủ\x20đề\x20con','pomodoroData_v11','radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)','youtubeVolume','currentTime','30RzvFrR','prevState','url(','Không\x20tìm\x20thấy\x20bản\x20sao\x20lưu.','destination','height','https://www.youtube.com/embed/','#noteText','\x22\x20title=\x22Hoàn\x20thành\x20task\x22>\x20<label\x20for=\x22','note-content','method-title','cyclesB','round','input,select,textarea','warn','download','replace','Lỗi\x20từ\x20Gemini:\x20','origin','Sửa\x20tên\x20Chủ\x20đề','Lỗi\x20mạng\x20khi\x20kết\x20nối\x20đến\x20Gemini.\x20Vui\x20lòng\x20kiểm\x20tra\x20kết\x20nối\x20internet.','strokeDashoffset','getBoundingClientRect','#btnReset','toLowerCase','scroll','var(--sub)','href','8MWXdIP','Đang\x20tải\x20API\x20YouTube...','#set_work','beginBreak','#historyList','.nav-btn','ghost','67050KCDWeE','select','Dùng\x20AI\x20để\x20tự\x20động\x20định\x20dạng\x20văn\x20bản','reset','Thêm\x20Chủ\x20đề\x20con','now','find','\x22\x0a-\x20Ghi\x20chú\x20của\x20người\x20dùng\x20sau\x20một\x20phiên\x20làm\x20việc:\x20\x22','#btnCancelMethodEditor','contentWindow','#btnAddMethod','mousemove','<li>','summaries','#view-','#ytSoundVolume','closest','#cycleInfo','allow','break_end','607387wJPHsM','Chủ\x20đề\x20con:\x20','Đã\x20chuyển\x20sang\x20Kiểu\x20','blob:','.actions-menu','#set_long','<div\x20class=\x22tiny\x22>Chưa\x20có\x20ghi\x20chú.</div>','.nav-btn[data-view]','findIndex','<div><span\x20class=\x22tiny\x22>(chưa\x20có\x20ghi\x20chú)</span></div>','toast','hidden','actions','Lỗi\x20khởi\x20tạo:\x20','Uống\x20một\x20ly\x20nước\x20để\x20giữ\x20đủ\x20nước.','Xem\x20một\x20tấm\x20ảnh\x20dễ\x20thương\x20hoặc\x20làm\x20bạn\x20vui.','Thêm\x20tùy\x20chọn','Xóa\x20Chủ\x20đề','Kỹ\x20Thuật\x20Feynman:\x20Hiểu\x20Sâu\x20Bằng\x20Cách\x20Giải\x20Thích\x20Đơn\x20Giản','fixed','mute','note-item','tickHandle','#modalMethodEditor','pomodoro_backup_','Lỗi:\x20Gemini\x20API\x20Key\x20không\x20hợp\x20lệ\x20hoặc\x20đã\x20bị\x20thay\x20đổi.\x20Vui\x20lòng\x20kiểm\x20tra\x20lại\x20trong\x20Cài\x20đặt.','sum','setVolume','onupgradeneeded','autoplay;\x20encrypted-media;\x20picture-in-picture','#statSessions','cover','getItem','setProperty','#btnGenericCancel','includes','#methodEditorTitle','padStart','B_short','state','Hãy\x20bắt\x20đầu\x20bằng\x20cách\x20chọn\x20một\x20<strong>Chủ\x20đề\x20con</strong>\x20hoặc\x20tạo\x20Chủ\x20đề.','PomodoroAppDB','btn\x20small\x20ghost\x20method-edit','right','2kyAHnp','no-subtopic-selected','Xác\x20nhận\x20xóa','Sửa\x20tên\x20Chủ\x20đề\x20con','isArray','customBg','stop','#modalMilestone','status','Đã\x20xóa\x20tóm\x20tắt.','\x20(A)','slice','soundTheme','work','long_break','#welcomePanel','beginWindDown','catch','onload','#methodEditorContentInput','beginWork','update','readonly','short','Đã\x20lưu\x20cài\x20đặt','startsWith','Đứng\x20lên\x20và\x20đi\x20lại\x20vài\x20bước\x20để\x20máu\x20lưu\x20thông.','toLocaleDateString','put','exportData','#btnCloseSettings','OK.\x20Link\x20hợp\x20lệ.\x20Đang\x20chuẩn\x20bị\x20phát...','#currentSubtopicName','textarea','badge\x20state\x20work','Sắp\x20xếp\x20lại\x20không\x20gian\x20làm\x20việc\x20của\x20bạn.','Phân\x20tích\x20và\x20định\x20dạng\x20lại\x20đoạn\x20văn\x20bản\x20sau\x20đây\x20thành\x20mã\x20HTML\x20sạch.\x20Sử\x20dụng\x20các\x20thẻ\x20sau:\x0a-\x20Dùng\x20<h4>\x20cho\x20các\x20tiêu\x20đề\x20chính.\x0a-\x20Dùng\x20<strong>\x20để\x20nhấn\x20mạnh\x20các\x20thuật\x20ngữ\x20hoặc\x20ý\x20tưởng\x20quan\x20trọng.\x0a-\x20Dùng\x20<i>\x20cho\x20các\x20câu\x20ghi\x20chú\x20hoặc\x20trích\x20dẫn.\x0a-\x20Dùng\x20<ol>\x20và\x20<li>\x20cho\x20các\x20danh\x20sách\x20có\x20thứ\x20tự.\x0a-\x20Dùng\x20<ul>\x20và\x20<li>\x20cho\x20các\x20danh\x20sách\x20không\x20có\x20thứ\x20tự.\x0a-\x20Bọc\x20các\x20đoạn\x20văn\x20thông\x20thường\x20trong\x20thẻ\x20<p>.\x0aVăn\x20bản\x20cần\x20định\x20dạng:\x0a\x0a\x22','Vui\x20lòng\x20chọn\x20một\x20Chủ\x20đề\x20con\x20trước\x20khi\x20thực\x20hiện\x20thao\x20tác.','clear','#btnSaveSettings','pauseVideo','cancel','cyclesTarget','cycles','reverse','Cần\x20có\x20nội\x20dung\x20để\x20AI\x20định\x20dạng.','vi-VN','topic','Space','onclick','autoStartNext','onerror','Chọn\x20một\x20chủ\x20đề\x20con\x20trước.','value','&lt;','Gợi\x20Nhớ\x20Chủ\x20Động\x20(Active\x20Recall):\x20Nguyên\x20Tắc\x20Cốt\x20Lõi\x20Để\x20Học\x20Sâu','methodId','skip','#btnToggleCustomSounds','Nội\x20dung\x20bị\x20chặn\x20vì:\x20','Initialization\x20error:','Âm\x20thanh\x20đã\x20được\x20bật!','</p>','&amp;','onsuccess','Kiểm\x20tra\x20nhịp\x20thở\x20–\x20nếu\x20gấp\x20gáp,\x20hãy\x20làm\x20chậm\x20lại.','Deleted\x20old\x20backup:\x20','https://www.youtube.com','Sortable','getMonth','backupDaysToKeep','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M2\x2012s3-7\x2010-7\x2010\x207\x2010\x207-3\x207-10\x207-10-7-10-7Z\x22/><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x223\x22/></svg>','className','mouseup','topicsList','italic','setPreset','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22dashboard-table\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead><tr><th>Chủ\x20đề</th><th>Chủ\x20đề\x20con</th><th>Thời\x20gian</th><th>Phiên</th><th>Nhiệm\x20vụ</th></tr></thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','&gt;','display','initDB','-9999px','PLAYING','</td></tr>','clientY','Rửa\x20mặt\x20hoặc\x20vỗ\x20nhẹ\x20lên\x20mặt\x20để\x20tỉnh\x20táo\x20hơn.','</td><td>','Toàn\x20màn\x20hình','<p\x20class=\x22tiny\x22><strong>Tổng\x20thời\x20gian:</strong>\x20','Thả\x20lỏng\x20toàn\x20thân,\x20cảm\x20nhận\x20hơi\x20thở.','promptFeedback','Xóa\x20tri\x20thức\x20\x22','Failed\x20to\x20delete\x20summary:','.view','tab','#ytUrlFeedback','show','#set_autoStartNext','note-meta','model','width','lofi','actions-menu','space','iframe','#toolBold','no-repeat','playVideo','#view-timer','selectedTopicId','#methodEditorId','btn\x20small\x20danger','finishFlowSession','Enter','.color-palette','.method-content','toggle','.timer-circle-progress','ENDED','AudioContext','Đến\x20giờ\x20hạ\x20nhiệt.\x20Hãy\x20kết\x20thúc\x20công\x20việc\x20và\x20chuẩn\x20bị\x20nghỉ\x20ngơi.','Chỉnh-sửa\x20Tri\x20thức','expanded','B_winddown','task','Tệp\x20không\x20đúng\x20định\x20dạng','achievedMilestones','selectedSubtopicId','#btnClearChat','appendChild','change','<strong>$1</strong>','#backupList','backgroundMode','#toolH4','item','color','B_work','LÀM\x20VIỆC','#uploadBg','flowtimeBreakRatio','PlayerState','default','Đã\x20nhập\x20dữ\x20liệu\x20thành\x20công!','#btnAddGeneralNote','files','settings','TẠM\x20DỪNG','https://img.youtube.com/vi/','#btnGenericOk','Tóm\x20tắt\x20thất\x20bại.','?\x20Dữ\x20liệu\x20hiện\x20tại\x20sẽ\x20bị\x20ghi\x20đè.','Tự\x20hỏi\x20bản\x20thân:\x20“Mình\x20cảm\x20thấy\x20thế\x20nào\x20lúc\x20này?”','sound_unlocked','?\x20Thao\x20tác\x20này\x20sẽ\x20dừng\x20và\x20đặt\x20lại\x20phiên\x20làm\x20việc\x20hiện\x20tại.','#btnSkip','min','checked'];_0x5f4f=function(){return _0x494db6;};return _0x5f4f();}function ensureAudio(){const _0x37f29c=_0x336a98;if(!AUDIO_CTX)AUDIO_CTX=new(window[(_0x37f29c(0x343))]||window['webkitAudioContext'])();}function tone(_0x48379e=0x370,_0xfe718=0xc8,_0x432df5=0.2,_0x28741a='sine',_0x359e72=0x0){const _0x3ec834=_0x336a98;ensureAudio();const _0x5346d9=AUDIO_CTX,_0x21de05=_0x5346d9[_0x3ec834(0x3fa)](),_0x5e1aa7=_0x5346d9[_0x3ec834(0x40d)]();_0x21de05[_0x3ec834(0x218)]=_0x28741a,_0x21de05['frequency'][_0x3ec834(0x301)]=_0x48379e,_0x21de05[_0x3ec834(0x224)](_0x5e1aa7),_0x5e1aa7[_0x3ec834(0x224)](_0x5346d9[_0x3ec834(0x26d)]);const _0x1e8f89=_0x5346d9[_0x3ec834(0x268)]+_0x359e72;_0x5e1aa7[_0x3ec834(0x416)][_0x3ec834(0x4e9)](0x0,_0x1e8f89),_0x5e1aa7[_0x3ec834(0x416)][_0x3ec834(0x496)](_0x432df5,_0x1e8f89+0.01),_0x5e1aa7['gain'][_0x3ec834(0x392)](0.0001,_0x1e8f89+_0xfe718/0x3e8),_0x21de05[_0x3ec834(0x3ac)](_0x1e8f89),_0x21de05[_0x3ec834(0x2d2)](_0x1e8f89+_0xfe718/0x3e8+0.05);}function playSound(_0x596873){const _0x529f19=_0x336a98;if(!data[_0x529f19(0x35e)][_0x529f19(0x4c4)])return;const _0x31d103=Math['max'](0x0,Math[_0x529f19(0x368)](0x1,data['settings'][_0x529f19(0x4c1)]??0.8)),_0x49b5bd=data[_0x529f19(0x35e)][_0x529f19(0x37b)]?.[_0x596873];let _0x477779;if(_0x596873==='work_end')_0x477779=$(_0x529f19(0x477));else{if(_0x596873===_0x529f19(0x29f))_0x477779=$(_0x529f19(0x3cd));else{if(_0x596873===_0x529f19(0x4c5))_0x477779=$(_0x529f19(0x3d1));}}if(_0x49b5bd&&_0x477779){_0x49b5bd[_0x529f19(0x2e5)]('data:')||_0x49b5bd[_0x529f19(0x2e5)]('http')||_0x49b5bd[_0x529f19(0x2e5)](_0x529f19(0x2a3))?(_0x477779[_0x529f19(0x3b1)]=_0x49b5bd,_0x477779[_0x529f19(0x4c1)]=_0x31d103,_0x477779['play']()[_0x529f19(0x2dd)](_0x22a456=>console['error'](_0x529f19(0x399),_0x22a456))):getStoredFileUrl(_0x49b5bd)[_0x529f19(0x493)](_0x45df76=>{const _0x57d852=_0x529f19;_0x45df76&&(_0x477779['src']=_0x45df76,_0x477779[_0x57d852(0x4c1)]=_0x31d103,_0x477779['play']()[_0x57d852(0x2dd)](_0x13d522=>console['error'](_0x57d852(0x399),_0x13d522)));});return;}const _0x4ca79a=data['settings'][_0x529f19(0x2d8)]||_0x529f19(0x244);if(_0x4ca79a===_0x529f19(0x244)){if(_0x596873===_0x529f19(0x4f8))tone(0x370,0xfa,_0x31d103),tone(0x294,0xb4,_0x31d103*0.8,_0x529f19(0x49d),0.22);else{if(_0x596873==='break_end')tone(0x294,0xdc,_0x31d103*0.9);else _0x596873===_0x529f19(0x4c5)&&(tone(0x208,0xc8,_0x31d103),tone(0x30c,0xc8,_0x31d103,_0x529f19(0x49d),0.22),tone(0x410,0xdc,_0x31d103,'sine',0.44));}}else{if(_0x596873===_0x529f19(0x4f8))tone(0x4b0,0xa0,_0x31d103*0.9,_0x529f19(0x3a3)),tone(0x384,0xdc,_0x31d103*0.8,'triangle',0.18);else{if(_0x596873===_0x529f19(0x29f))tone(0x370,0xf0,_0x31d103*0.8,_0x529f19(0x3a3));else _0x596873===_0x529f19(0x4c5)&&(tone(0x258,0xdc,_0x31d103*0.9,'triangle'),tone(0x3b6,0xf0,_0x31d103*0.9,'triangle',0.22),tone(0x4b0,0xf0,_0x31d103,'triangle',0.44));}}}async function saveData(){const _0x3e308b=_0x336a98;try{await storageManager[_0x3e308b(0x22d)](data);}catch(_0x5c3bb8){console['error']('Failed\x20to\x20save\x20data:',_0x5c3bb8),toast(_0x3e308b(0x506)+_0x5c3bb8[_0x3e308b(0x414)]);}}async function ensureValidSelection(){const _0x4e7027=_0x336a98,_0x46f40e=data[_0x4e7027(0x35e)];if(!data[_0x4e7027(0x38e)]||data[_0x4e7027(0x38e)][_0x4e7027(0x3fd)]===0x0){_0x46f40e[_0x4e7027(0x339)]='',_0x46f40e[_0x4e7027(0x34b)]='',await saveData();return;}const _0x339815=data['topics']['find'](_0x1d880b=>_0x1d880b['id']===_0x46f40e['selectedTopicId']),_0x1f892b=_0x339815?.[_0x4e7027(0x47c)][_0x4e7027(0x292)](_0x4582db=>_0x4582db['id']===_0x46f40e[_0x4e7027(0x34b)]);if(!_0x339815||!_0x1f892b){const _0x1fbc42=data['topics'][0x0],_0x454950=_0x1fbc42?.['subtopics']?.[0x0];_0x46f40e['selectedTopicId']=_0x1fbc42?.['id']||'',_0x46f40e['selectedSubtopicId']=_0x454950?.['id']||'',await saveData();}}function showInputModal(_0x2ece15,_0x20c36d,_0x178df0=''){const _0x3f6c93=_0x336a98;$(_0x3f6c93(0x422))[_0x3f6c93(0x3fc)]=_0x2ece15,$(_0x3f6c93(0x45a))[_0x3f6c93(0x39e)][_0x3f6c93(0x4b0)](_0x3f6c93(0x2ab));const _0x30d96b=$(_0x3f6c93(0x212));_0x30d96b['value']=_0x178df0,_0x30d96b[_0x3f6c93(0x39e)]['remove'](_0x3f6c93(0x2ab)),$(_0x3f6c93(0x4a9))[_0x3f6c93(0x39e)][_0x3f6c93(0x4b0)](_0x3f6c93(0x32c));try{trapFocus($(_0x3f6c93(0x4a9)));}catch(_0x30de7a){}_0x30d96b['focus'](),_0x30d96b['select']();const _0x4c16b8=()=>{const _0x17fcf3=_0x3f6c93;_0x20c36d(_0x30d96b[_0x17fcf3(0x301)]),_0x33e7a4();},_0x416ad5=()=>_0x33e7a4(),_0x3b8b2e=_0xc5654a=>{const _0x5e6865=_0x3f6c93;if(_0xc5654a[_0x5e6865(0x375)]==='Enter')_0x4c16b8();if(_0xc5654a[_0x5e6865(0x375)]===_0x5e6865(0x41b))_0x416ad5();};$(_0x3f6c93(0x361))[_0x3f6c93(0x2fd)]=_0x4c16b8,$(_0x3f6c93(0x2c2))['onclick']=_0x416ad5,_0x30d96b['onkeydown']=_0x3b8b2e;function _0x33e7a4(){const _0x1883e5=_0x3f6c93;$(_0x1883e5(0x4a9))['classList'][_0x1883e5(0x4f4)](_0x1883e5(0x32c)),$(_0x1883e5(0x361))['onclick']=null,$(_0x1883e5(0x2c2))[_0x1883e5(0x2fd)]=null,_0x30d96b['onkeydown']=null;try{releaseFocus();}catch(_0xb788b2){}}}function showConfirmModal(_0x1eb05b,_0x23c85d,_0x5e3785){const _0x34aa02=_0x336a98;$(_0x34aa02(0x422))[_0x34aa02(0x3fc)]=_0x1eb05b;const _0x5dd6b2=$('#genericMessage');_0x5dd6b2['textContent']=_0x23c85d,_0x5dd6b2[_0x34aa02(0x39e)][_0x34aa02(0x4f4)](_0x34aa02(0x2ab)),$(_0x34aa02(0x212))[_0x34aa02(0x39e)][_0x34aa02(0x4b0)](_0x34aa02(0x2ab)),$(_0x34aa02(0x4a9))[_0x34aa02(0x39e)][_0x34aa02(0x4b0)](_0x34aa02(0x32c));try{trapFocus($(_0x34aa02(0x4a9)));}catch(_0xdeba50){}const _0x26cc4b=()=>{_0x5e3785(!![]),_0x58419d();},_0x1c3b8b=()=>{_0x5e3785(![]),_0x58419d();};$('#btnGenericOk')[_0x34aa02(0x2fd)]=_0x26cc4b,$(_0x34aa02(0x2c2))[_0x34aa02(0x2fd)]=_0x1c3b8b;function _0x58419d(){const _0x1d1f78=_0x34aa02;$(_0x1d1f78(0x4a9))['classList']['remove'](_0x1d1f78(0x32c)),$(_0x1d1f78(0x361))[_0x1d1f78(0x2fd)]=null,$(_0x1d1f78(0x2c2))[_0x1d1f78(0x2fd)]=null;try{releaseFocus();}catch(_0x5b0959){}}}let pendingNoteSessionId=null;function openNoteModal(_0x406979){const _0x5a91ef=_0x336a98;pendingNoteSessionId=_0x406979||null;const _0x16c116=$(_0x5a91ef(0x4bb));if(!_0x16c116)return;const _0x48f6f0=$(_0x5a91ef(0x270));if(_0x48f6f0)try{_0x48f6f0[_0x5a91ef(0x301)]='';}catch(_0x44c7f1){}_0x16c116[_0x5a91ef(0x39e)]['add'](_0x5a91ef(0x32c));try{trapFocus(_0x16c116);}catch(_0x5e8474){}}function closeNoteModal(){const _0x3178ac=_0x336a98,_0x45bbd6=$(_0x3178ac(0x4bb));if(!_0x45bbd6)return;_0x45bbd6[_0x3178ac(0x39e)][_0x3178ac(0x4f4)](_0x3178ac(0x32c)),pendingNoteSessionId=null;try{releaseFocus();}catch(_0x2add56){}}async function switchView(_0x1e7ba6){const _0x43d9ff=_0x336a98;$$(_0x43d9ff(0x329))[_0x43d9ff(0x4ab)](_0x98c6f1=>_0x98c6f1[_0x43d9ff(0x39e)][_0x43d9ff(0x4f4)](_0x43d9ff(0x229))),$(_0x43d9ff(0x29a)+_0x1e7ba6)[_0x43d9ff(0x39e)][_0x43d9ff(0x4b0)](_0x43d9ff(0x229)),$$(_0x43d9ff(0x28a))[_0x43d9ff(0x4ab)](_0x39c9d8=>_0x39c9d8[_0x43d9ff(0x39e)][_0x43d9ff(0x4f4)](_0x43d9ff(0x229)));const _0x24ffe6=$(_0x43d9ff(0x3b0)+_0x1e7ba6+'\x22]');if(_0x24ffe6)_0x24ffe6[_0x43d9ff(0x39e)]['add'](_0x43d9ff(0x229));data['settings'][_0x43d9ff(0x4ee)]=_0x1e7ba6,await saveData(),_0x1e7ba6==='stats'&&renderDashboard();}function closeAllMenus(){const _0x5367a1=_0x336a98;$$(_0x5367a1(0x409))[_0x5367a1(0x4ab)](_0x3afc66=>_0x3afc66[_0x5367a1(0x39e)][_0x5367a1(0x4f4)](_0x5367a1(0x32c))),$$('.topic-item.menu-active')[_0x5367a1(0x4ab)](_0x3a79d0=>_0x3a79d0[_0x5367a1(0x39e)]['remove'](_0x5367a1(0x3ef)));}function renderTopics(){const _0x28cf27=_0x336a98,_0x510c6f=$(_0x28cf27(0x50d));if(!_0x510c6f)return;_0x510c6f[_0x28cf27(0x1ed)]='';const _0x2c67f7=data[_0x28cf27(0x35e)][_0x28cf27(0x468)]||{};data[_0x28cf27(0x38e)][_0x28cf27(0x4ab)](_0x4ddae7=>{const _0x222e74=_0x28cf27,_0x5aaaf6=document['createElement'](_0x222e74(0x22a));_0x5aaaf6[_0x222e74(0x314)]=_0x222e74(0x459),_0x5aaaf6[_0x222e74(0x497)][_0x222e74(0x21c)]=_0x4ddae7['id'];const _0x398c76=document[_0x222e74(0x41d)](_0x222e74(0x22a));_0x398c76['className']=_0x222e74(0x1fc);const _0xffb8a2=!!_0x2c67f7[_0x4ddae7['id']],_0x542284=document[_0x222e74(0x41d)](_0x222e74(0x222));_0x542284['className']=_0x222e74(0x3b4),_0x542284['setAttribute'](_0x222e74(0x256),String(!_0xffb8a2)),_0x542284[_0x222e74(0x1ed)]=_0x222e74(0x3a7);const _0x4770d8=document['createElement'](_0x222e74(0x22a));_0x4770d8[_0x222e74(0x314)]=_0x222e74(0x41e),_0x4770d8['textContent']=_0x4ddae7[_0x222e74(0x22f)];const _0x31b74a=document[_0x222e74(0x41d)]('div');_0x31b74a[_0x222e74(0x314)]=_0x222e74(0x417);const _0x4d319a=document[_0x222e74(0x41d)](_0x222e74(0x222));_0x4d319a['className']=_0x222e74(0x3af),_0x4d319a[_0x222e74(0x1ed)]='＋\x20Thêm',_0x4d319a[_0x222e74(0x3d5)]=_0x222e74(0x290);const _0x25b263=document['createElement'](_0x222e74(0x22a));_0x25b263[_0x222e74(0x225)][_0x222e74(0x455)]=_0x222e74(0x49c);const _0x574896=document['createElement']('button');_0x574896[_0x222e74(0x314)]=_0x222e74(0x36b),_0x574896[_0x222e74(0x1ed)]='...',_0x574896['title']=_0x222e74(0x2b0);const _0x3f996b=document[_0x222e74(0x41d)](_0x222e74(0x22a));_0x3f996b[_0x222e74(0x314)]=_0x222e74(0x332);const _0x15c3fb=document['createElement'](_0x222e74(0x222));_0x15c3fb[_0x222e74(0x314)]=_0x222e74(0x43d),_0x15c3fb[_0x222e74(0x1ed)]=_0x222e74(0x27c);const _0x1324e9=document[_0x222e74(0x41d)]('button');_0x1324e9[_0x222e74(0x314)]=_0x222e74(0x4f3),_0x1324e9[_0x222e74(0x1ed)]=_0x222e74(0x2b1),_0x3f996b['append'](_0x15c3fb,_0x1324e9),_0x25b263[_0x222e74(0x4a2)](_0x574896,_0x3f996b),_0x31b74a[_0x222e74(0x4a2)](_0x4d319a,_0x25b263),_0x398c76[_0x222e74(0x4a2)](_0x542284,_0x4770d8,_0x31b74a),_0x542284[_0x222e74(0x4f1)](_0x222e74(0x3b9),async _0x1ebadf=>{const _0x512e53=_0x222e74;_0x1ebadf[_0x512e53(0x508)]();const _0x5a72d4=!!_0x2c67f7[_0x4ddae7['id']];_0x5a72d4?delete _0x2c67f7[_0x4ddae7['id']]:_0x2c67f7[_0x4ddae7['id']]=!![],data[_0x512e53(0x35e)][_0x512e53(0x468)]=_0x2c67f7,await storageManager[_0x512e53(0x4c3)](data['settings']),renderTopics();});const _0x27d316=async()=>{const _0x3b231b=_0x222e74,_0x207580=!!_0x2c67f7[_0x4ddae7['id']];_0x207580?delete _0x2c67f7[_0x4ddae7['id']]:_0x2c67f7[_0x4ddae7['id']]=!![],data[_0x3b231b(0x35e)][_0x3b231b(0x468)]=_0x2c67f7,await storageManager[_0x3b231b(0x4c3)](data[_0x3b231b(0x35e)]),renderTopics();};_0x398c76['addEventListener'](_0x222e74(0x3b9),async _0x4e1099=>{const _0x5c9f6b=_0x222e74,_0x8bd843=_0x4e1099['target'];if(_0x8bd843&&_0x8bd843[_0x5c9f6b(0x29c)]){if(_0x8bd843[_0x5c9f6b(0x29c)](_0x5c9f6b(0x2a4))||_0x8bd843[_0x5c9f6b(0x29c)](_0x5c9f6b(0x484))||_0x8bd843[_0x5c9f6b(0x29c)](_0x5c9f6b(0x222))||_0x8bd843[_0x5c9f6b(0x29c)](_0x5c9f6b(0x276)))return;}_0x4e1099[_0x5c9f6b(0x508)](),await _0x27d316();}),_0x4770d8['addEventListener']('click',async _0x26e126=>{const _0x8187f2=_0x222e74;_0x26e126[_0x8187f2(0x508)](),await _0x27d316();}),_0x5aaaf6[_0x222e74(0x4f1)](_0x222e74(0x3b9),async _0x27a455=>{const _0x16a706=_0x222e74,_0x4175ef=_0x27a455[_0x16a706(0x253)];if(_0x4175ef&&_0x4175ef[_0x16a706(0x29c)]){if(_0x4175ef[_0x16a706(0x29c)](_0x16a706(0x4e8)))return;if(_0x4175ef[_0x16a706(0x29c)](_0x16a706(0x2a4))||_0x4175ef[_0x16a706(0x29c)](_0x16a706(0x484))||_0x4175ef[_0x16a706(0x29c)](_0x16a706(0x222))||_0x4175ef[_0x16a706(0x29c)](_0x16a706(0x276)))return;}await _0x27d316();});const _0x1c2a6c=document[_0x222e74(0x41d)](_0x222e74(0x22a));_0x1c2a6c[_0x222e74(0x314)]=_0x222e74(0x47c)+(_0xffb8a2?'\x20hidden':''),_0x1c2a6c['dataset'][_0x222e74(0x21c)]=_0x4ddae7['id'],_0x4ddae7[_0x222e74(0x47c)][_0x222e74(0x4ab)](_0x235f7d=>{const _0x4e8290=_0x222e74,_0x571078=document[_0x4e8290(0x41d)]('div');_0x571078['className']=_0x4e8290(0x3eb),_0x571078[_0x4e8290(0x497)][_0x4e8290(0x41c)]=_0x235f7d['id'];const _0x29c04d=document[_0x4e8290(0x41d)]('button');_0x29c04d[_0x4e8290(0x314)]=_0x4e8290(0x22b),_0x29c04d[_0x4e8290(0x3fc)]='•\x20'+_0x235f7d[_0x4e8290(0x22f)],_0x29c04d['dataset'][_0x4e8290(0x41c)]=_0x235f7d['id'],_0x29c04d[_0x4e8290(0x497)][_0x4e8290(0x21c)]=_0x4ddae7['id'];if(data[_0x4e8290(0x35e)]['selectedSubtopicId']===_0x235f7d['id'])_0x29c04d[_0x4e8290(0x39e)][_0x4e8290(0x4b0)]('active');const _0x1e1e3c=document[_0x4e8290(0x41d)](_0x4e8290(0x22a));_0x1e1e3c[_0x4e8290(0x314)]=_0x4e8290(0x2ac);const _0x21e973=document[_0x4e8290(0x41d)](_0x4e8290(0x22a));_0x21e973[_0x4e8290(0x225)][_0x4e8290(0x455)]=_0x4e8290(0x49c);const _0x59a00f=document[_0x4e8290(0x41d)]('button');_0x59a00f[_0x4e8290(0x314)]='btn\x20small\x20ghost\x20actions-menu-btn',_0x59a00f['innerHTML']=_0x4e8290(0x1f7),_0x59a00f[_0x4e8290(0x3d5)]=_0x4e8290(0x2b0);const _0x534ff7=document[_0x4e8290(0x41d)](_0x4e8290(0x22a));_0x534ff7[_0x4e8290(0x314)]=_0x4e8290(0x332);const _0x38f90b=document[_0x4e8290(0x41d)](_0x4e8290(0x222));_0x38f90b[_0x4e8290(0x314)]=_0x4e8290(0x43d),_0x38f90b[_0x4e8290(0x1ed)]=_0x4e8290(0x2cf);const _0x176401=document[_0x4e8290(0x41d)]('button');_0x176401[_0x4e8290(0x314)]=_0x4e8290(0x4f3),_0x176401[_0x4e8290(0x1ed)]='Xóa\x20Chủ\x20đề\x20con',_0x534ff7[_0x4e8290(0x4a2)](_0x38f90b,_0x176401),_0x21e973[_0x4e8290(0x4a2)](_0x59a00f,_0x534ff7),_0x1e1e3c['append'](_0x21e973),_0x571078[_0x4e8290(0x4a2)](_0x29c04d,_0x1e1e3c),_0x1c2a6c[_0x4e8290(0x34d)](_0x571078),_0x29c04d['addEventListener']('click',()=>selectSubtopic(_0x4ddae7['id'],_0x235f7d['id'])),_0x59a00f[_0x4e8290(0x4f1)](_0x4e8290(0x3b9),_0x57596a=>{const _0x2b2b47=_0x4e8290;_0x57596a[_0x2b2b47(0x508)]();const _0x287b97=_0x534ff7['classList'][_0x2b2b47(0x3d4)](_0x2b2b47(0x32c));closeAllMenus(),_0x287b97?_0x5aaaf6[_0x2b2b47(0x39e)][_0x2b2b47(0x4f4)](_0x2b2b47(0x3ef)):(_0x534ff7[_0x2b2b47(0x39e)][_0x2b2b47(0x4b0)](_0x2b2b47(0x32c)),_0x5aaaf6[_0x2b2b47(0x39e)]['add'](_0x2b2b47(0x3ef)));}),_0x38f90b[_0x4e8290(0x4f1)](_0x4e8290(0x3b9),()=>showInputModal(_0x4e8290(0x451),async _0xd11400=>{const _0x23beb8=_0x4e8290;if(!_0xd11400)return;_0x235f7d['name']=_0xd11400,await storageManager[_0x23beb8(0x2e1)](_0x23beb8(0x47c),_0x235f7d),renderAll();},_0x235f7d['name'])),_0x176401['addEventListener']('click',()=>showConfirmModal(_0x4e8290(0x2ce),'Bạn\x20có\x20chắc\x20muốn\x20xóa\x20Chủ\x20đề\x20con\x20\x22'+_0x235f7d[_0x4e8290(0x22f)]+_0x4e8290(0x443),async _0xb14945=>{const _0x4bfad8=_0x4e8290;if(!_0xb14945)return;_0x4ddae7['subtopics']=_0x4ddae7[_0x4bfad8(0x47c)][_0x4bfad8(0x3c7)](_0x4a0f26=>_0x4a0f26['id']!==_0x235f7d['id']);const _0x37ad90=data[_0x4bfad8(0x35e)];_0x37ad90['selectedSubtopicId']===_0x235f7d['id']&&(_0x37ad90[_0x4bfad8(0x34b)]='',_0x37ad90[_0x4bfad8(0x339)]='',ensureValidSelection()),await storageManager[_0x4bfad8(0x4b8)](_0x4bfad8(0x47c),_0x235f7d['id']),renderAll();}));}),_0x574896['addEventListener']('click',_0xd22f68=>{const _0x13001c=_0x222e74;_0xd22f68[_0x13001c(0x508)]();const _0x111b4f=_0x3f996b['classList']['contains']('show');closeAllMenus(),_0x111b4f?_0x5aaaf6[_0x13001c(0x39e)][_0x13001c(0x4f4)](_0x13001c(0x3ef)):(_0x3f996b[_0x13001c(0x39e)][_0x13001c(0x4b0)](_0x13001c(0x32c)),_0x5aaaf6['classList']['add']('menu-active'));}),_0x4d319a[_0x222e74(0x4f1)](_0x222e74(0x3b9),()=>showInputModal(_0x222e74(0x400),async _0x5bf561=>{const _0x26a9b5=_0x222e74;if(!_0x5bf561)return;const _0x416926={'id':uid('s'),'topicId':_0x4ddae7['id'],'name':_0x5bf561,'tasks':[],'generalNotes':[],'summaries':[],'chatHistory':[],'methods':[],'stats':{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},'sessions':[],'timerState':{'state':_0x26a9b5(0x49f),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0}};_0x4ddae7[_0x26a9b5(0x47c)][_0x26a9b5(0x1fd)](_0x416926),await storageManager[_0x26a9b5(0x4b0)](_0x26a9b5(0x47c),_0x416926),renderTopics();})),_0x15c3fb[_0x222e74(0x4f1)](_0x222e74(0x3b9),()=>showInputModal(_0x222e74(0x1f8),async _0x18dda7=>{const _0x631d4a=_0x222e74;if(!_0x18dda7)return;_0x4ddae7[_0x631d4a(0x22f)]=_0x18dda7,await storageManager[_0x631d4a(0x2e1)](_0x631d4a(0x38e),_0x4ddae7),renderTopics();},_0x4ddae7[_0x222e74(0x22f)])),_0x1324e9['addEventListener'](_0x222e74(0x3b9),()=>showConfirmModal(_0x222e74(0x2ce),'Bạn\x20có\x20chắc\x20muốn\x20xóa\x20Chủ\x20đề\x20\x22'+_0x4ddae7[_0x222e74(0x22f)]+_0x222e74(0x439),async _0x41dd85=>{const _0x57980e=_0x222e74;if(!_0x41dd85)return;data[_0x57980e(0x38e)]=data[_0x57980e(0x38e)][_0x57980e(0x3c7)](_0x29f013=>_0x29f013['id']!==_0x4ddae7['id']),delete _0x2c67f7[_0x4ddae7['id']];data[_0x57980e(0x35e)]['selectedTopicId']===_0x4ddae7['id']&&(data[_0x57980e(0x35e)][_0x57980e(0x339)]='',data[_0x57980e(0x35e)][_0x57980e(0x34b)]='',ensureValidSelection());await storageManager[_0x57980e(0x4b8)](_0x57980e(0x38e),_0x4ddae7['id']);for(const _0x2ad485 of _0x4ddae7[_0x57980e(0x47c)]){await storageManager['delete']('subtopics',_0x2ad485['id']);}renderAll();})),_0x4d319a[_0x222e74(0x4f1)](_0x222e74(0x3b9),_0x151807=>_0x151807[_0x222e74(0x508)]()),_0x15c3fb[_0x222e74(0x4f1)](_0x222e74(0x3b9),_0x22400d=>_0x22400d[_0x222e74(0x508)]()),_0x1324e9[_0x222e74(0x4f1)](_0x222e74(0x3b9),_0x51197a=>_0x51197a['stopPropagation']()),_0x5aaaf6['append'](_0x398c76,_0x1c2a6c),_0x510c6f['appendChild'](_0x5aaaf6);});if(window[_0x28cf27(0x310)]){const _0x335a69=document['getElementById'](_0x28cf27(0x316));if(_0x335a69){if(_0x335a69[_0x28cf27(0x3aa)])try{_0x335a69[_0x28cf27(0x3aa)]['destroy']();}catch(_0x2ffae5){}_0x335a69[_0x28cf27(0x3aa)]=new Sortable(_0x335a69,{'animation':0x96,'draggable':_0x28cf27(0x45f),'onEnd':async function(_0x9a0eb6){const _0x5a4ba1=_0x28cf27;if(_0x9a0eb6[_0x5a4ba1(0x4bd)]===_0x9a0eb6[_0x5a4ba1(0x44f)])return;const _0xc89343=data[_0x5a4ba1(0x38e)]['splice'](_0x9a0eb6[_0x5a4ba1(0x4bd)],0x1)[0x0];data[_0x5a4ba1(0x38e)][_0x5a4ba1(0x220)](_0x9a0eb6[_0x5a4ba1(0x44f)],0x0,_0xc89343),await saveData(),renderTopics();}}),_0x335a69[_0x28cf27(0x42e)](_0x28cf27(0x4e8))[_0x28cf27(0x4ab)](_0xfc263f=>{new Sortable(_0xfc263f,{'group':'subtopics-group','animation':0x96,'draggable':'.sub-row','onEnd':async function(_0x32fa10){const _0x245598=_0x1a06,_0x4642e4=_0x32fa10[_0x245598(0x36a)]?.[_0x245598(0x497)]?.[_0x245598(0x21c)]||_0x32fa10['from']?.[_0x245598(0x29c)](_0x245598(0x45f))?.[_0x245598(0x497)]?.[_0x245598(0x21c)],_0x697241=_0x32fa10['to']?.['dataset']?.[_0x245598(0x21c)]||_0x32fa10['to']?.['closest'](_0x245598(0x45f))?.['dataset']?.['tid'],_0x41a18d=data[_0x245598(0x38e)]['find'](_0x4ccf1d=>_0x4ccf1d['id']===_0x4642e4),_0xee336c=data[_0x245598(0x38e)][_0x245598(0x292)](_0x4925b6=>_0x4925b6['id']===_0x697241);if(!_0x41a18d||!_0xee336c)return;let _0x357c5e=null;const _0x4bc349=_0x32fa10[_0x245598(0x353)]?.[_0x245598(0x497)]?.[_0x245598(0x41c)]||_0x32fa10[_0x245598(0x353)]?.[_0x245598(0x20b)]('.subtopic-btn')?.[_0x245598(0x497)]?.[_0x245598(0x41c)];if(_0x4bc349){const _0x49bed8=_0x41a18d[_0x245598(0x47c)]['findIndex'](_0x21c8a7=>_0x21c8a7['id']===_0x4bc349);if(_0x49bed8>=0x0)_0x357c5e=_0x41a18d['subtopics']['splice'](_0x49bed8,0x1)[0x0];}!_0x357c5e&&(_0x357c5e=_0x41a18d[_0x245598(0x47c)][_0x245598(0x220)](_0x32fa10[_0x245598(0x4bd)],0x1)[0x0]);if(!_0x357c5e)return;_0x357c5e[_0x245598(0x4cb)]=_0xee336c['id'],_0xee336c[_0x245598(0x47c)]['splice'](_0x32fa10['newIndex'],0x0,_0x357c5e),data[_0x245598(0x35e)][_0x245598(0x34b)]===_0x357c5e['id']&&(data[_0x245598(0x35e)][_0x245598(0x339)]=_0xee336c['id']),await saveData(),renderTopics();}});});}}}function selectSubtopic(_0x476295,_0x37c3b5){const _0x7b67d5=_0x336a98,_0x55a99d=$(_0x7b67d5(0x4df)),_0x163638=getCurrentSubtopic();_0x163638&&timer[_0x7b67d5(0x2c7)]!==_0x7b67d5(0x49f)&&(_0x163638['timerState']={'state':timer[_0x7b67d5(0x2c7)],'prevState':timer[_0x7b67d5(0x26a)],'remaining':timer[_0x7b67d5(0x3c8)],'segmentTotal':timer[_0x7b67d5(0x4a1)],'cycleIndex':timer[_0x7b67d5(0x36c)]}),_0x55a99d[_0x7b67d5(0x39e)]['add'](_0x7b67d5(0x394)),setTimeout(async()=>{const _0x1ec7ed=_0x7b67d5;data[_0x1ec7ed(0x35e)]['selectedTopicId']=_0x476295,data[_0x1ec7ed(0x35e)][_0x1ec7ed(0x34b)]=_0x37c3b5;const _0x399da0=getCurrentSubtopic();_0x399da0[_0x1ec7ed(0x480)]?(timer[_0x1ec7ed(0x2c7)]=_0x399da0[_0x1ec7ed(0x480)][_0x1ec7ed(0x2c7)],timer[_0x1ec7ed(0x26a)]=_0x399da0[_0x1ec7ed(0x480)][_0x1ec7ed(0x26a)]||null,timer[_0x1ec7ed(0x3c8)]=_0x399da0['timerState'][_0x1ec7ed(0x3c8)],timer[_0x1ec7ed(0x4a1)]=_0x399da0[_0x1ec7ed(0x480)][_0x1ec7ed(0x4a1)],timer[_0x1ec7ed(0x36c)]=_0x399da0[_0x1ec7ed(0x480)]['cycleIndex']):timer[_0x1ec7ed(0x28f)](),await saveData(),timer[_0x1ec7ed(0x23a)](),renderAll(),switchView(_0x1ec7ed(0x490)),_0x55a99d[_0x1ec7ed(0x39e)]['remove'](_0x1ec7ed(0x394));},0xc8);}function getCurrentSubtopic(){const _0x46fb95=_0x336a98,_0x1f496b=data[_0x46fb95(0x35e)][_0x46fb95(0x339)],_0x57a977=data[_0x46fb95(0x35e)][_0x46fb95(0x34b)];if(!_0x1f496b||!_0x57a977)return null;const _0x29776d=data[_0x46fb95(0x38e)][_0x46fb95(0x292)](_0x4a5259=>_0x4a5259['id']===_0x1f496b);if(!_0x29776d)return null;return _0x29776d[_0x46fb95(0x47c)][_0x46fb95(0x292)](_0x14274e=>_0x14274e['id']===_0x57a977)||null;}function renderContextBadge(){const _0x1ae1cd=_0x336a98,_0xb4cd55=getCurrentSubtopic(),_0x3f4c4d=_0xb4cd55?_0xb4cd55[_0x1ae1cd(0x22f)]:_0x1ae1cd(0x40c),_0x3a4ec9=$(_0x1ae1cd(0x447)),_0x2ca23b=$(_0x1ae1cd(0x2ec)),_0x2222b4=$('#currentSubtopicNameChat');if(_0x3a4ec9)_0x3a4ec9[_0x1ae1cd(0x3fc)]=_0xb4cd55?_0x1ae1cd(0x2a1)+_0xb4cd55[_0x1ae1cd(0x22f)]:_0x1ae1cd(0x264);if(_0x2ca23b)_0x2ca23b[_0x1ae1cd(0x3fc)]=_0x3f4c4d;if(_0x2222b4)_0x2222b4['textContent']=_0x3f4c4d;}function renderSubtopicTasks(){const _0x389bbd=_0x336a98,_0x585258=getCurrentSubtopic(),_0x49d5ae=$(_0x389bbd(0x4a8)),_0x161621=$(_0x389bbd(0x3db));if(!_0x49d5ae||!_0x161621)return;const _0x3bf723=_0x161621['parentElement'];if(!_0x585258){_0x49d5ae[_0x389bbd(0x1ed)]='<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Chọn\x20chủ\x20đề\x20con\x20để\x20xem\x20to-do\x20list.</li>',_0x3bf723[_0x389bbd(0x39e)]['add']('hidden');return;}_0x3bf723[_0x389bbd(0x39e)][_0x389bbd(0x4f4)]('hidden'),_0x49d5ae[_0x389bbd(0x1ed)]='';const _0x4fa2bd=_0x585258[_0x389bbd(0x44b)]?_0x585258[_0x389bbd(0x44b)][_0x389bbd(0x3c7)](_0x2e3979=>!_0x2e3979['isCompleted']):[];_0x4fa2bd['length']===0x0&&(_0x49d5ae[_0x389bbd(0x1ed)]=_0x389bbd(0x213)),_0x4fa2bd[_0x389bbd(0x4ab)](_0x2189b3=>{const _0x1a9721=_0x389bbd,_0x59d2c6=document[_0x1a9721(0x41d)]('li');_0x59d2c6[_0x1a9721(0x1ed)]='<input\x20type=\x22checkbox\x22\x20id=\x22'+_0x2189b3['id']+_0x1a9721(0x271)+_0x2189b3['id']+'\x22>'+escapeHTML(_0x2189b3[_0x1a9721(0x4fa)])+_0x1a9721(0x3bd),_0x59d2c6[_0x1a9721(0x20b)](_0x1a9721(0x3f5))[_0x1a9721(0x4f1)]('change',_0x23994e=>toggleSubtopicTask(_0x23994e[_0x1a9721(0x253)]['id'],_0x59d2c6)),_0x49d5ae[_0x1a9721(0x34d)](_0x59d2c6);});}async function addSubtopicTask(){const _0xc789db=_0x336a98,_0x4bc731=getCurrentSubtopic();if(!_0x4bc731){toast(t(_0xc789db(0x412)));return;}const _0x42ac0e=$(_0xc789db(0x3db)),_0x19a471=_0x42ac0e['value'][_0xc789db(0x3a2)]();if(_0x19a471){if(!_0x4bc731['tasks'])_0x4bc731[_0xc789db(0x44b)]=[];_0x4bc731[_0xc789db(0x44b)]['push']({'id':uid(_0xc789db(0x348)),'text':_0x19a471,'isCompleted':![],'createdAt':todayISO()}),await saveData(),renderSubtopicTasks(),_0x42ac0e[_0xc789db(0x301)]='';}_0x42ac0e[_0xc789db(0x255)]();}async function toggleSubtopicTask(_0x5292d8,_0x3f6cb8){const _0x3d3ae3=_0x336a98,_0x47a31e=getCurrentSubtopic();if(!_0x47a31e||!_0x47a31e[_0x3d3ae3(0x44b)])return;const _0x295e7c=_0x47a31e['tasks'][_0x3d3ae3(0x292)](_0x166a2f=>_0x166a2f['id']===_0x5292d8);_0x295e7c&&(_0x295e7c[_0x3d3ae3(0x245)]=!![],_0x47a31e[_0x3d3ae3(0x3b6)][_0x3d3ae3(0x4ad)]=(_0x47a31e[_0x3d3ae3(0x3b6)][_0x3d3ae3(0x4ad)]||0x0)+0x1,await saveData(),_0x3f6cb8[_0x3d3ae3(0x39e)]['add'](_0x3d3ae3(0x3c3)),setTimeout(()=>{renderSubtopicTasks(),renderStatsHistory();},0xc8));}const timer={'state':_0x336a98(0x49f),'prevState':null,'tickHandle':null,'endAt':null,'remaining':0x0,'segmentTotal':0x0,'cyclesTarget':0x4,'cycleIndex':0x0,'mode':'A','persistInterval':0x3c*0x3e8,'lastPersist':0x0,async 'setPreset'(_0x1851b2,{silent:silent=![]}={}){const _0x30b3df=_0x336a98,_0x585dee=data[_0x30b3df(0x35e)];this[_0x30b3df(0x505)]=_0x1851b2,this[_0x30b3df(0x2f6)]=_0x1851b2==='A'?_0x585dee[_0x30b3df(0x1f2)]:_0x1851b2==='B'?_0x585dee[_0x30b3df(0x274)]:0x0,_0x585dee[_0x30b3df(0x4e6)]=_0x1851b2,await saveData(),this[_0x30b3df(0x2c7)]==='idle'&&this[_0x30b3df(0x28f)]();},'currentDurations'(){const _0x13c101=_0x336a98,_0x3f7646=data['settings'][_0x13c101(0x4f2)];if(this[_0x13c101(0x505)]==='A')return{'work':_0x3f7646[_0x13c101(0x24c)],'short':_0x3f7646[_0x13c101(0x25c)],'long':_0x3f7646['A_long'],'winddown':_0x3f7646[_0x13c101(0x430)]??0x0};if(this[_0x13c101(0x505)]==='B')return{'work':_0x3f7646[_0x13c101(0x355)],'short':_0x3f7646['B_short'],'long':_0x3f7646[_0x13c101(0x457)],'winddown':_0x3f7646[_0x13c101(0x347)]??0x0};return{'work':0x0,'short':0x0,'long':0x0,'winddown':0x0};},'currentConfig'(){const _0x521525=_0x336a98,_0x7975bd=data[_0x521525(0x35e)];if(this[_0x521525(0x505)]==='A')return{'cycles':_0x7975bd[_0x521525(0x1f2)],'interval':_0x7975bd[_0x521525(0x50a)]};if(this[_0x521525(0x505)]==='B')return{'cycles':_0x7975bd[_0x521525(0x274)],'interval':_0x7975bd[_0x521525(0x402)]};return{'cycles':0x0,'interval':0x0};},'updateUI'(){const _0x41b74a=_0x336a98,_0x41e0c4=$(_0x41b74a(0x3e2)),_0x461d2c=$(_0x41b74a(0x341)),_0x5793ef=$(_0x41b74a(0x413));if(!_0x41e0c4||!_0x461d2c||!_0x5793ef)return;const _0x275efe=this[_0x41b74a(0x505)]==='C';$(_0x41b74a(0x3a5))[_0x41b74a(0x39e)][_0x41b74a(0x340)](_0x41b74a(0x2ab),this[_0x41b74a(0x2c7)]!==_0x41b74a(0x49f)||_0x275efe&&this[_0x41b74a(0x2c7)]==='work'),$(_0x41b74a(0x237))['classList'][_0x41b74a(0x340)](_0x41b74a(0x2ab),!(_0x275efe&&this[_0x41b74a(0x2c7)]===_0x41b74a(0x2d9))),$('#btnPause')[_0x41b74a(0x39e)][_0x41b74a(0x340)]('hidden',![_0x41b74a(0x2d9),_0x41b74a(0x4aa),'long_break'][_0x41b74a(0x2c3)](this['state'])),$(_0x41b74a(0x207))[_0x41b74a(0x39e)][_0x41b74a(0x340)](_0x41b74a(0x2ab),this['state']!==_0x41b74a(0x4c6));let _0x5a704c=_0x41b74a(0x47b);if(this[_0x41b74a(0x2c7)]==='work')_0x41e0c4[_0x41b74a(0x3fc)]=_0x275efe?_0x41b74a(0x38b):_0x41b74a(0x356),_0x41e0c4[_0x41b74a(0x314)]=_0x41b74a(0x2ee),_0x5a704c=_0x41b74a(0x456);else{if(this[_0x41b74a(0x2c7)]===_0x41b74a(0x4aa))_0x41e0c4['textContent']='NGHỈ\x20NGẮN',_0x41e0c4[_0x41b74a(0x314)]=_0x41b74a(0x384),_0x5a704c=_0x41b74a(0x4d4);else{if(this[_0x41b74a(0x2c7)]===_0x41b74a(0x2da))_0x41e0c4['textContent']='NGHỈ\x20DÀI',_0x41e0c4['className']=_0x41b74a(0x441),_0x5a704c='var(--danger)';else{if(this[_0x41b74a(0x2c7)]===_0x41b74a(0x3d7)){_0x41e0c4['textContent']=_0x41b74a(0x3c6),_0x41e0c4[_0x41b74a(0x314)]=_0x41b74a(0x2ee),_0x5a704c=_0x41b74a(0x4d9);try{$(_0x41b74a(0x4fc))[_0x41b74a(0x39e)][_0x41b74a(0x4f4)](_0x41b74a(0x2ab)),$(_0x41b74a(0x4de))[_0x41b74a(0x39e)][_0x41b74a(0x4f4)](_0x41b74a(0x2ab));}catch(_0x2902c5){}}else this['state']===_0x41b74a(0x4c6)?(_0x41e0c4[_0x41b74a(0x3fc)]=_0x41b74a(0x35f),_0x41e0c4['className']=_0x41b74a(0x4f6)):(_0x41e0c4['textContent']=_0x41b74a(0x467),_0x41e0c4[_0x41b74a(0x314)]='badge');}}}[_0x41b74a(0x2d9),'break','long_break',_0x41b74a(0x3d7)]['includes'](this['state'])?_0x5793ef[_0x41b74a(0x39e)]['add'](_0x41b74a(0x21f)):_0x5793ef[_0x41b74a(0x39e)][_0x41b74a(0x4f4)]('breathing');_0x461d2c[_0x41b74a(0x225)]['stroke']=_0x5a704c,_0x5793ef[_0x41b74a(0x39e)]['remove'](_0x41b74a(0x3f7));const _0x5decd2=$('#timeDisplay');if(_0x5decd2)_0x5decd2[_0x41b74a(0x3fc)]=formatMMSS(this['remaining']);const _0x45de65=_0x461d2c['r']['baseVal'][_0x41b74a(0x301)],_0x23e11f=0x2*Math['PI']*_0x45de65,_0x4a7dd2=this[_0x41b74a(0x4a1)]>0x0?_0x23e11f-this[_0x41b74a(0x3c8)]/this[_0x41b74a(0x4a1)]*_0x23e11f:_0x23e11f;_0x461d2c[_0x41b74a(0x225)][_0x41b74a(0x37f)]=_0x23e11f,_0x461d2c[_0x41b74a(0x225)][_0x41b74a(0x27e)]=isNaN(_0x4a7dd2)?_0x23e11f:_0x4a7dd2;const _0x4f77cf=$(_0x41b74a(0x29d));if(_0x4f77cf){const _0x66c59a=this[_0x41b74a(0x23c)]();_0x4f77cf['textContent']=t('timer.cycleInfo',{'current':this['cycleIndex'],'target':_0x66c59a[_0x41b74a(0x2f7)]}),_0x4f77cf['classList'][_0x41b74a(0x340)](_0x41b74a(0x2ab),_0x275efe);}const _0x288e9c=$(_0x41b74a(0x239));_0x288e9c&&_0x288e9c[_0x41b74a(0x39e)][_0x41b74a(0x340)](_0x41b74a(0x2ab),_0x275efe&&this[_0x41b74a(0x2c7)]===_0x41b74a(0x2d9));const _0x21f602=$(_0x41b74a(0x3f1));if(_0x21f602)_0x21f602['textContent']=formatMMSS(this[_0x41b74a(0x3c8)]);if(this[_0x41b74a(0x2c7)]!==_0x41b74a(0x3d7))try{$(_0x41b74a(0x4fc))[_0x41b74a(0x39e)][_0x41b74a(0x4b0)](_0x41b74a(0x2ab)),$('#btnBreakEarly')[_0x41b74a(0x39e)][_0x41b74a(0x4b0)](_0x41b74a(0x2ab));}catch(_0x7aa85b){}},'persistTimerState'(_0xbfa270=![]){const _0x52baac=_0x336a98;try{const _0x77f28b=getCurrentSubtopic();if(!_0x77f28b)return;const _0x5a5949={'state':this[_0x52baac(0x2c7)],'prevState':this[_0x52baac(0x26a)],'remaining':this[_0x52baac(0x3c8)],'segmentTotal':this['segmentTotal'],'cycleIndex':this[_0x52baac(0x36c)]};_0x77f28b[_0x52baac(0x480)]=_0x5a5949;try{localStorage['setItem']('timerState_'+_0x77f28b['id'],JSON[_0x52baac(0x22c)](_0x5a5949));}catch(_0x4d32ab){}this[_0x52baac(0x466)]=Date[_0x52baac(0x291)]();}catch(_0x5d979){}},'_startTick'(){const _0xcbcae2=_0x336a98;if(this[_0xcbcae2(0x2b6)])clearInterval(this[_0xcbcae2(0x2b6)]);if(this['mode']==='C'&&this['state']===_0xcbcae2(0x2d9)){this[_0xcbcae2(0x2b6)]=setInterval(()=>{const _0x4afcbe=_0xcbcae2;this[_0x4afcbe(0x3c8)]+=0x1,this['updateUI'](),this[_0x4afcbe(0x20f)]();},0x3e8);return;}this[_0xcbcae2(0x2b6)]=setInterval(()=>{const _0x44dc55=_0xcbcae2;this['remaining']>0x0&&(this['remaining']-=0x1,this['updateUI'](),this['persistTimerState']()),this[_0x44dc55(0x3c8)]<=0x0&&(clearInterval(this[_0x44dc55(0x2b6)]),this[_0x44dc55(0x2b6)]=null,this[_0x44dc55(0x452)]());},0x3e8);},'_onFinishSegment'(){const _0x238e5e=_0x336a98;if(this[_0x238e5e(0x2c7)]==='work'){const _0x5a7423=getCurrentSubtopic();if(_0x5a7423){const _0x29e4b8=this['currentDurations']()['work'];_0x5a7423[_0x238e5e(0x3b6)][_0x238e5e(0x398)]=(_0x5a7423[_0x238e5e(0x3b6)][_0x238e5e(0x398)]||0x0)+_0x29e4b8,_0x5a7423['stats']['sessionsCompleted']=(_0x5a7423['stats'][_0x238e5e(0x3ca)]||0x0)+0x1;const _0x5ed73f={'id':uid('sess'),'dateISO':todayISO(),'durationMinutes':_0x29e4b8,'mode':this['mode'],'note':''};if(!_0x5a7423[_0x238e5e(0x3e9)])_0x5a7423[_0x238e5e(0x3e9)]=[];_0x5a7423['sessions'][_0x238e5e(0x3de)](_0x5ed73f);if(data?.[_0x238e5e(0x35e)]?.[_0x238e5e(0x24b)]!==![])try{openNoteModal(_0x5ed73f['id']);}catch(_0x50d238){}saveData(),renderStatsHistory(),checkAndShowMilestones();}this['cycleIndex']++;}if(typeof data!==_0x238e5e(0x4e0)&&data&&data[_0x238e5e(0x35e)]&&data[_0x238e5e(0x35e)][_0x238e5e(0x42d)]===![]&&this[_0x238e5e(0x2c7)]===_0x238e5e(0x2d9))playSound(_0x238e5e(0x4f8));else(this['state']===_0x238e5e(0x3d7)||this[_0x238e5e(0x2c7)]===_0x238e5e(0x4aa)||this['state']===_0x238e5e(0x2da))&&playSound(_0x238e5e(0x29f));const _0x247e5a=$(_0x238e5e(0x413));if(_0x247e5a)_0x247e5a['classList']['add'](_0x238e5e(0x3f7));if(data[_0x238e5e(0x35e)]['autoStartNext']){if(this['state']===_0x238e5e(0x2d9))data[_0x238e5e(0x35e)][_0x238e5e(0x42d)]===![]?this['beginBreak']():this[_0x238e5e(0x2dc)]();else this[_0x238e5e(0x2c7)]===_0x238e5e(0x3d7)?this[_0x238e5e(0x288)]():this['beginWork']();}else this[_0x238e5e(0x2b6)]&&(clearInterval(this[_0x238e5e(0x2b6)]),this['tickHandle']=null),this['state']=_0x238e5e(0x49f),this[_0x238e5e(0x26a)]=null,this[_0x238e5e(0x23a)](),toast(_0x238e5e(0x4fd));},'beginWindDown'(){const _0xfb26a0=_0x336a98;if(data?.['settings']?.['enableWinddown']===![]){this[_0xfb26a0(0x288)]();return;}this[_0xfb26a0(0x26a)]=this['state'],this[_0xfb26a0(0x2c7)]=_0xfb26a0(0x3d7);const _0x315183=(this[_0xfb26a0(0x248)]()[_0xfb26a0(0x24e)]||0x0)*0x3c;if(_0x315183<=0x0){this['beginBreak']();return;}this[_0xfb26a0(0x4a1)]=_0x315183,this[_0xfb26a0(0x3c8)]=_0x315183;try{playSound(_0xfb26a0(0x29f));}catch(_0x2ece1c){}try{toast(_0xfb26a0(0x344));}catch(_0xff4a46){}this[_0xfb26a0(0x3f3)](),this['updateUI']();},'beginWork'(){const _0x2f9b6f=_0x336a98;this[_0x2f9b6f(0x26a)]=this[_0x2f9b6f(0x2c7)],this[_0x2f9b6f(0x2c7)]=_0x2f9b6f(0x2d9);if(this[_0x2f9b6f(0x505)]==='C'){this[_0x2f9b6f(0x4a1)]=0x0;if(this[_0x2f9b6f(0x26a)]!==_0x2f9b6f(0x4c6))this['remaining']=0x0;}else{const _0x54c475=this[_0x2f9b6f(0x248)]()[_0x2f9b6f(0x2d9)]*0x3c;this[_0x2f9b6f(0x4a1)]=_0x54c475;if(this['prevState']!==_0x2f9b6f(0x4c6))this['remaining']=_0x54c475;}const _0x1fc2dd=$(_0x2f9b6f(0x239));_0x1fc2dd&&(_0x1fc2dd[_0x2f9b6f(0x3fc)]=''),this[_0x2f9b6f(0x3f3)](),this[_0x2f9b6f(0x23a)]();},'finishFlowSession'(){const _0x24d57b=_0x336a98;if(this[_0x24d57b(0x505)]!=='C'||this['state']!==_0x24d57b(0x2d9))return;this['tickHandle']&&(clearInterval(this[_0x24d57b(0x2b6)]),this[_0x24d57b(0x2b6)]=null);const _0x585040=Math[_0x24d57b(0x378)](0x1,parseInt(data[_0x24d57b(0x35e)]['flowtimeBreakRatio']??0x5,0xa)),_0x525a52=Math[_0x24d57b(0x378)](0x0,this['remaining']|0x0),_0x3b4173=Math[_0x24d57b(0x378)](0x3c,Math['floor'](_0x525a52/_0x585040));try{const _0x582865=getCurrentSubtopic();if(_0x582865){const _0x5f47bc=Math[_0x24d57b(0x378)](0x1,Math['round'](_0x525a52/0x3c));_0x582865[_0x24d57b(0x3b6)][_0x24d57b(0x398)]=(_0x582865[_0x24d57b(0x3b6)][_0x24d57b(0x398)]||0x0)+_0x5f47bc,_0x582865[_0x24d57b(0x3b6)][_0x24d57b(0x3ca)]=(_0x582865[_0x24d57b(0x3b6)][_0x24d57b(0x3ca)]||0x0)+0x1;const _0x2bf26a={'id':uid(_0x24d57b(0x23b)),'dateISO':todayISO(),'durationMinutes':_0x5f47bc,'mode':this[_0x24d57b(0x505)],'note':''};if(!_0x582865['sessions'])_0x582865[_0x24d57b(0x3e9)]=[];_0x582865[_0x24d57b(0x3e9)][_0x24d57b(0x3de)](_0x2bf26a),saveData(),renderStatsHistory(),data?.[_0x24d57b(0x35e)]?.[_0x24d57b(0x24b)]!==![]&&openNoteModal(_0x2bf26a['id']);}}catch(_0x584105){}this[_0x24d57b(0x2c7)]=_0x24d57b(0x4aa),this[_0x24d57b(0x4a1)]=_0x3b4173,this['remaining']=_0x3b4173,this[_0x24d57b(0x3f3)](),this[_0x24d57b(0x23a)](),this[_0x24d57b(0x20f)](!![]);try{toast(_0x24d57b(0x3b8)+Math[_0x24d57b(0x275)](_0x3b4173/0x3c)+_0x24d57b(0x464)+_0x585040+').');}catch(_0x324cec){}},'beginBreak'(){const _0x5f3e3a=_0x336a98;this[_0x5f3e3a(0x26a)]=this[_0x5f3e3a(0x2c7)];const _0x264105=this[_0x5f3e3a(0x23c)](),_0x511822=this[_0x5f3e3a(0x248)]();if(this['cycleIndex']>0x0&&this['cycleIndex']%_0x264105[_0x5f3e3a(0x3bb)]===0x0){this[_0x5f3e3a(0x2c7)]='long_break';const _0x2438ed=_0x511822[_0x5f3e3a(0x382)]*0x3c;this[_0x5f3e3a(0x4a1)]=_0x2438ed;if(this[_0x5f3e3a(0x26a)]!==_0x5f3e3a(0x4c6))this[_0x5f3e3a(0x3c8)]=_0x2438ed;toast('Tuyệt\x20vời!\x20Đã\x20đến\x20lúc\x20nghỉ\x20dài.');}else{this[_0x5f3e3a(0x2c7)]=_0x5f3e3a(0x4aa);const _0x67cf64=_0x511822[_0x5f3e3a(0x2e3)]*0x3c;this['segmentTotal']=_0x67cf64;if(this[_0x5f3e3a(0x26a)]!==_0x5f3e3a(0x4c6))this['remaining']=_0x67cf64;}const _0x304a7d=$('#breakSuggestionDisplay');if(_0x304a7d){const _0x5836b1=Math['floor'](Math['random']()*breakSuggestions[_0x5f3e3a(0x3fd)]);_0x304a7d[_0x5f3e3a(0x3fc)]=_0x5f3e3a(0x429)+breakSuggestions[_0x5836b1];}this[_0x5f3e3a(0x3f3)](),this[_0x5f3e3a(0x23a)]();},async 'start'(){const _0x4173e7=_0x336a98;if(!getCurrentSubtopic()){toast(_0x4173e7(0x3e5));return;}ensureAudio();if(this[_0x4173e7(0x505)]==='C'&&this[_0x4173e7(0x2c7)]==='idle')this[_0x4173e7(0x2c7)]=_0x4173e7(0x2d9),this[_0x4173e7(0x3c8)]=0x0,this[_0x4173e7(0x4a1)]=0x0,this[_0x4173e7(0x36c)]=0x0,this['_startTick'](),this['updateUI']();else{if(this[_0x4173e7(0x2c7)]===_0x4173e7(0x49f))this[_0x4173e7(0x36c)]=this['cycleIndex']||0x0,this[_0x4173e7(0x2e0)]();else this[_0x4173e7(0x2c7)]===_0x4173e7(0x4c6)&&this[_0x4173e7(0x36f)]();}await this[_0x4173e7(0x20f)](!![]);},async 'pause'(){const _0x10e1df=_0x336a98;this[_0x10e1df(0x2b6)]&&(clearInterval(this[_0x10e1df(0x2b6)]),this['tickHandle']=null),this[_0x10e1df(0x26a)]=this[_0x10e1df(0x2c7)],this[_0x10e1df(0x2c7)]=_0x10e1df(0x4c6),this[_0x10e1df(0x23a)](),await this[_0x10e1df(0x20f)](!![]);},async 'resume'(){const _0x4542d7=_0x336a98;if(this[_0x4542d7(0x2c7)]!=='paused')return;this[_0x4542d7(0x2c7)]=this[_0x4542d7(0x26a)]||_0x4542d7(0x2d9),this[_0x4542d7(0x3f3)](),this['updateUI'](),await this[_0x4542d7(0x20f)](!![]);},async 'skip'(){const _0x4effc9=_0x336a98;if(this[_0x4effc9(0x505)]==='C'&&this[_0x4effc9(0x2c7)]===_0x4effc9(0x2d9)){this[_0x4effc9(0x33c)](),await this[_0x4effc9(0x20f)](!![]);return;}this[_0x4effc9(0x2c7)]===_0x4effc9(0x2d9)?(this[_0x4effc9(0x2b6)]&&(clearInterval(this[_0x4effc9(0x2b6)]),this['tickHandle']=null),this[_0x4effc9(0x3c8)]=0x0,this[_0x4effc9(0x452)]()):(this['remaining']=0x0,this[_0x4effc9(0x2b6)]&&(clearInterval(this[_0x4effc9(0x2b6)]),this[_0x4effc9(0x2b6)]=null),this[_0x4effc9(0x452)]()),await this[_0x4effc9(0x20f)](!![]);},async 'reset'(){const _0x2cd2a9=_0x336a98;this['tickHandle']&&(clearInterval(this[_0x2cd2a9(0x2b6)]),this[_0x2cd2a9(0x2b6)]=null);this[_0x2cd2a9(0x2c7)]=_0x2cd2a9(0x49f),this[_0x2cd2a9(0x26a)]=null,this['remaining']=0x0,this[_0x2cd2a9(0x4a1)]=0x0,this[_0x2cd2a9(0x36c)]=0x0;const _0x8892e7=$(_0x2cd2a9(0x239));_0x8892e7&&(_0x8892e7[_0x2cd2a9(0x3fc)]=''),this[_0x2cd2a9(0x23a)](),await this['persistTimerState'](!![]);}};async function deleteSummary(_0x206d84){const _0x122a7d=_0x336a98;showConfirmModal(_0x122a7d(0x2ce),_0x122a7d(0x4f0),async _0x5e69d7=>{const _0x4894ab=_0x122a7d;if(!_0x5e69d7)return;const _0x518887=getCurrentSubtopic();if(!_0x518887||!_0x518887[_0x4894ab(0x299)])return;const _0x52a848=[..._0x518887[_0x4894ab(0x299)]];_0x518887[_0x4894ab(0x299)]=_0x518887['summaries'][_0x4894ab(0x3c7)](_0x20a256=>_0x20a256['id']!==_0x206d84);try{await storageManager[_0x4894ab(0x2e1)](_0x4894ab(0x47c),_0x518887),renderSummaries(),toast(_0x4894ab(0x2d5));}catch(_0x300127){console[_0x4894ab(0x258)](_0x4894ab(0x328),_0x300127),_0x518887[_0x4894ab(0x299)]=_0x52a848,toast(_0x4894ab(0x3d3));}});}function exportSummary(_0x6ae5bb){const _0x2cc665=_0x336a98,_0x67f14d=new Blob([_0x6ae5bb[_0x2cc665(0x4ea)]],{'type':_0x2cc665(0x45b)}),_0x4d872a=document[_0x2cc665(0x41d)]('a'),_0x1471bc=new Date(_0x6ae5bb['createdAt']),_0x4d5581=_0x8c0d10=>(''+_0x8c0d10)[_0x2cc665(0x2c5)](0x2,'0');_0x4d872a[_0x2cc665(0x284)]=URL[_0x2cc665(0x4ec)](_0x67f14d),_0x4d872a[_0x2cc665(0x278)]='summary_'+_0x1471bc['getFullYear']()+_0x4d5581(_0x1471bc[_0x2cc665(0x311)]()+0x1)+_0x4d5581(_0x1471bc[_0x2cc665(0x3a1)]())+'.txt',_0x4d872a[_0x2cc665(0x3b9)](),URL[_0x2cc665(0x3ae)](_0x4d872a[_0x2cc665(0x284)]);}function renderStatsHistory(){const _0x4a6b64=_0x336a98,_0x13270b=getCurrentSubtopic(),_0x3560ea=$('#statTotal'),_0x51bbb4=$(_0x4a6b64(0x2be)),_0x1e563c=$(_0x4a6b64(0x3ea)),_0x40d3a5=$(_0x4a6b64(0x289));if(!_0x3560ea||!_0x51bbb4||!_0x1e563c||!_0x40d3a5)return;if(!_0x13270b){_0x3560ea[_0x4a6b64(0x3fc)]=_0x4a6b64(0x3f9),_0x51bbb4[_0x4a6b64(0x3fc)]='0',_0x1e563c[_0x4a6b64(0x3fc)]='0',_0x40d3a5[_0x4a6b64(0x1ed)]=_0x4a6b64(0x4b2);return;}const _0x327258=_0x13270b['stats']&&_0x13270b[_0x4a6b64(0x3b6)][_0x4a6b64(0x398)]?_0x13270b[_0x4a6b64(0x3b6)][_0x4a6b64(0x398)]:0x0,_0x2dc912=_0x13270b['stats']&&_0x13270b[_0x4a6b64(0x3b6)][_0x4a6b64(0x3ca)]?_0x13270b[_0x4a6b64(0x3b6)][_0x4a6b64(0x3ca)]:0x0,_0x164497=_0x13270b[_0x4a6b64(0x44b)]?_0x13270b[_0x4a6b64(0x44b)][_0x4a6b64(0x3c7)](_0x38f425=>_0x38f425[_0x4a6b64(0x245)])[_0x4a6b64(0x3fd)]:0x0;_0x3560ea[_0x4a6b64(0x3fc)]=formatDaysHoursMinutes(_0x327258),_0x51bbb4[_0x4a6b64(0x3fc)]=String(_0x2dc912),_0x1e563c[_0x4a6b64(0x3fc)]=String(_0x164497),_0x40d3a5['innerHTML']='';const _0x4d3a4e=Array['isArray'](_0x13270b['sessions'])?_0x13270b[_0x4a6b64(0x3e9)]:[];if(_0x4d3a4e[_0x4a6b64(0x3fd)]===0x0){_0x40d3a5[_0x4a6b64(0x1ed)]='<div\x20class=\x22tiny\x22>Chưa\x20có\x20phiên\x20nào</div>';return;}_0x4d3a4e[_0x4a6b64(0x4ab)](_0xf57b7e=>{const _0x3391ad=_0x4a6b64,_0x384097=document[_0x3391ad(0x41d)]('div');_0x384097[_0x3391ad(0x314)]=_0x3391ad(0x491);const _0x21c7e6=document[_0x3391ad(0x41d)](_0x3391ad(0x22a)),_0xc6025b=_0xf57b7e['dateISO']?new Date(_0xf57b7e['dateISO']):new Date(),_0x4e3f58=_0xf57b7e['durationMinutes']!=null?_0xf57b7e[_0x3391ad(0x371)]:_0xf57b7e[_0x3391ad(0x42c)]||0x0,_0x7bc8f6=_0x3391ad(0x211)+_0xc6025b['toLocaleString']()+_0x3391ad(0x20e)+_0x4e3f58+'\x27\x20·\x20Mode\x20'+(_0xf57b7e['mode']||'')+'</div>';let _0x4ac610='';if(_0xf57b7e['note'])_0x4ac610=_0x3391ad(0x4e3)+escapeHTML(_0xf57b7e['note'])+_0x3391ad(0x485);else data?.['settings']?.[_0x3391ad(0x24b)]!==![]&&(_0x4ac610=_0x3391ad(0x2a9));_0x21c7e6['innerHTML']=_0x7bc8f6+_0x4ac610,_0x384097[_0x3391ad(0x34d)](_0x21c7e6),_0x40d3a5[_0x3391ad(0x34d)](_0x384097);});}function renderGeneralNotes(){const _0x29e567=_0x336a98,_0x1531cd=$('#generalNotesList');if(!_0x1531cd)return;const _0x4c03e0=getCurrentSubtopic();if(!_0x4c03e0){_0x1531cd['innerHTML']=_0x29e567(0x221);return;}_0x4c03e0['generalNotes']=_0x4c03e0[_0x29e567(0x215)]||[];if(_0x4c03e0['generalNotes'][_0x29e567(0x3fd)]===0x0){_0x1531cd[_0x29e567(0x1ed)]=_0x29e567(0x2a6);return;}_0x1531cd[_0x29e567(0x1ed)]='',_0x4c03e0[_0x29e567(0x215)]['forEach'](_0x2ced5d=>{const _0x7419ff=_0x29e567,_0x5a4db6=document['createElement'](_0x7419ff(0x22a));_0x5a4db6['className']=_0x7419ff(0x2b5);const _0x24efb3=document[_0x7419ff(0x41d)](_0x7419ff(0x22a));_0x24efb3[_0x7419ff(0x314)]=_0x7419ff(0x272),_0x24efb3[_0x7419ff(0x3fc)]=typeof _0x2ced5d===_0x7419ff(0x448)?_0x2ced5d:_0x2ced5d[_0x7419ff(0x4fa)]||'';const _0x304c21=document[_0x7419ff(0x41d)](_0x7419ff(0x22a));_0x304c21[_0x7419ff(0x314)]=_0x7419ff(0x32e),_0x304c21[_0x7419ff(0x3fc)]=_0x2ced5d[_0x7419ff(0x44d)]?new Date(_0x2ced5d[_0x7419ff(0x44d)])[_0x7419ff(0x43c)]():'';const _0x3f3c59=document[_0x7419ff(0x41d)](_0x7419ff(0x22a)),_0x27b833=document[_0x7419ff(0x41d)]('button');_0x27b833[_0x7419ff(0x314)]=_0x7419ff(0x33b),_0x27b833['textContent']=_0x7419ff(0x1ee),_0x27b833[_0x7419ff(0x2fd)]=async _0x3cd516=>{const _0xb46c9f=_0x7419ff;_0x3cd516['stopPropagation']();const _0x481976=getCurrentSubtopic();if(!_0x481976)return;_0x481976[_0xb46c9f(0x215)]=(_0x481976[_0xb46c9f(0x215)]||[])[_0xb46c9f(0x3c7)](_0x4ada26=>(_0x4ada26['id']||_0x4ada26)!==(_0x2ced5d['id']||_0x2ced5d)),await saveData(),renderGeneralNotes();},_0x3f3c59['appendChild'](_0x27b833);const _0x1dfc00=document[_0x7419ff(0x41d)](_0x7419ff(0x22a));_0x1dfc00[_0x7419ff(0x314)]=_0x7419ff(0x21d),_0x1dfc00['append'](_0x24efb3,_0x304c21),_0x5a4db6['append'](_0x1dfc00,_0x3f3c59),_0x1531cd[_0x7419ff(0x34d)](_0x5a4db6);});}function renderMethods(){const _0x244570=_0x336a98,_0xb824b3=document[_0x244570(0x20b)](_0x244570(0x381));if(!_0xb824b3)return;_0xb824b3['innerHTML']='';const _0x23d201=getCurrentSubtopic();if(!_0x23d201){_0xb824b3[_0x244570(0x1ed)]=_0x244570(0x1f3);return;}const _0x1e54d4=Array[_0x244570(0x2d0)](_0x23d201[_0x244570(0x257)])?_0x23d201[_0x244570(0x257)]:[];if(_0x1e54d4['length']===0x0){_0xb824b3[_0x244570(0x1ed)]=_0x244570(0x4e5);return;}_0x1e54d4[_0x244570(0x4ab)](_0x4a80bb=>{const _0x460399=_0x244570,_0x599730=document['createElement']('div');_0x599730['className']=_0x460399(0x450),_0x599730[_0x460399(0x497)][_0x460399(0x304)]=_0x4a80bb['id'];const _0x502f7c=document[_0x460399(0x41d)](_0x460399(0x22a)),_0xdc55e4=document[_0x460399(0x41d)](_0x460399(0x3cb));_0xdc55e4['className']=_0x460399(0x273),_0xdc55e4[_0x460399(0x3fc)]=_0x4a80bb[_0x460399(0x3d5)]||'Chưa\x20có\x20tiêu\x20đề',_0xdc55e4[_0x460399(0x4f1)](_0x460399(0x3b9),_0x285f2=>{const _0x520e61=_0x460399;_0x285f2[_0x520e61(0x423)](),_0x285f2[_0x520e61(0x508)]();const _0x200ee1=_0x599730[_0x520e61(0x20b)](_0x520e61(0x33f));if(!_0x200ee1)return;const _0x3511dd=_0x200ee1[_0x520e61(0x2ab)];_0xb824b3[_0x520e61(0x42e)](_0x520e61(0x460))['forEach'](_0x4a1c89=>{const _0x1c2ae6=_0x520e61;_0x4a1c89[_0x1c2ae6(0x2ab)]=!![];}),_0x200ee1[_0x520e61(0x2ab)]=!_0x3511dd;});const _0x3c0085=document[_0x460399(0x41d)](_0x460399(0x22a));_0x3c0085['className']='topic-actions';const _0x37468d=document[_0x460399(0x41d)](_0x460399(0x222));_0x37468d[_0x460399(0x314)]=_0x460399(0x2ca),_0x37468d['textContent']='Sửa',_0x37468d[_0x460399(0x497)]['id']=_0x4a80bb['id'];const _0x2c1a6b=document[_0x460399(0x41d)](_0x460399(0x222));_0x2c1a6b[_0x460399(0x314)]=_0x460399(0x370),_0x2c1a6b['textContent']=_0x460399(0x1ee),_0x2c1a6b[_0x460399(0x497)]['id']=_0x4a80bb['id'],_0x3c0085[_0x460399(0x4a2)](_0x37468d,_0x2c1a6b),_0x502f7c[_0x460399(0x4a2)](_0xdc55e4,_0x3c0085);const _0x83b41f=document['createElement'](_0x460399(0x22a));_0x83b41f['className']=_0x460399(0x219),_0x83b41f[_0x460399(0x1ed)]=_0x4a80bb[_0x460399(0x4ea)]||'',_0x83b41f[_0x460399(0x2ab)]=!![],_0x599730[_0x460399(0x4a2)](_0x502f7c,_0x83b41f),_0xb824b3['appendChild'](_0x599730),_0x599730[_0x460399(0x4f1)](_0x460399(0x3b9),_0x437168=>{const _0x525330=_0x460399,_0x206247=_0x437168[_0x525330(0x253)];if(!_0x206247)return;if(_0x206247[_0x525330(0x29c)](_0x525330(0x222))||_0x206247[_0x525330(0x29c)]('a')||_0x206247[_0x525330(0x29c)](_0x525330(0x47d))||_0x206247[_0x525330(0x29c)](_0x525330(0x33e)))return;const _0xc4f0bb=_0x83b41f['hidden'];_0xb824b3['querySelectorAll'](_0x525330(0x460))[_0x525330(0x4ab)](_0x3e8adf=>{const _0xb56e96=_0x525330;_0x3e8adf[_0xb56e96(0x2ab)]=!![];}),_0x83b41f[_0x525330(0x2ab)]=!_0xc4f0bb;});});const _0xa12554=_0xb824b3[_0x244570(0x42e)](_0x244570(0x393));_0xa12554[_0x244570(0x4ab)](_0x49efd8=>{const _0x201638=_0x244570;_0x49efd8[_0x201638(0x4f1)](_0x201638(0x340),()=>{const _0x268b96=_0x201638;_0x49efd8[_0x268b96(0x247)]&&_0xa12554['forEach'](_0x4251f3=>{if(_0x4251f3!==_0x49efd8)_0x4251f3['open']=![];});});}),window[_0x244570(0x310)]&&new Sortable(_0xb824b3,{'animation':0x96,'draggable':_0x244570(0x393),'onEnd':async function(_0x718547){const _0x156033=_0x244570;if(_0x718547[_0x156033(0x4bd)]===_0x718547[_0x156033(0x44f)])return;const _0x1e9609=getCurrentSubtopic();if(!_0x1e9609||!Array[_0x156033(0x2d0)](_0x1e9609[_0x156033(0x257)]))return;const _0x2a19a2=_0x1e9609[_0x156033(0x257)][_0x156033(0x220)](_0x718547[_0x156033(0x4bd)],0x1)[0x0];_0x1e9609[_0x156033(0x257)]['splice'](_0x718547[_0x156033(0x44f)],0x0,_0x2a19a2),await saveData();}});}function addGeneralNote(){showInputModal('Thêm\x20ghi\x20chú',async _0x200fa2=>{const _0x68d549=_0x1a06;if(!_0x200fa2)return;const _0x1e74c2=getCurrentSubtopic();if(!_0x1e74c2){toast(_0x68d549(0x300));return;}_0x1e74c2[_0x68d549(0x215)]=_0x1e74c2['generalNotes']||[],_0x1e74c2[_0x68d549(0x215)]['unshift']({'id':uid('gn'),'text':_0x200fa2,'createdAt':todayISO()}),await saveData(),renderGeneralNotes();},'');}async function summarizeNotes(){const _0x5d9ff8=_0x336a98,_0x2582ca=getCurrentSubtopic();if(!_0x2582ca){toast('Chọn\x20chủ\x20đề\x20con\x20trước.');return;}const _0xf7300=(_0x2582ca['generalNotes']||[])[_0x5d9ff8(0x419)](_0x511111=>typeof _0x511111===_0x5d9ff8(0x448)?_0x511111:_0x511111[_0x5d9ff8(0x4fa)]||'')[_0x5d9ff8(0x3c7)](Boolean);if(_0xf7300['length']===0x0){toast(_0x5d9ff8(0x434));return;}const _0x4fc466=$('#btnSummarize');_0x4fc466&&(_0x4fc466[_0x5d9ff8(0x3ee)]=!![],_0x4fc466[_0x5d9ff8(0x1ed)]='<div\x20class=\x22spinner\x22></div>');try{const _0xdddb96='Tóm\x20tắt\x20các\x20ghi\x20chú\x20sau\x20theo\x20gạch\x20đầu\x20dòng,\x20ngắn\x20gọn,\x20rõ\x20ràng:\x0a\x0a'+_0xf7300[_0x5d9ff8(0x4f7)]('\x0a-\x20'),_0x448d32=await callGeminiAPI(_0xdddb96);if(!_0x2582ca[_0x5d9ff8(0x299)])_0x2582ca['summaries']=[];_0x2582ca[_0x5d9ff8(0x299)]['unshift']({'id':uid(_0x5d9ff8(0x2ba)),'content':_0x448d32||_0x5d9ff8(0x43b),'createdAt':todayISO()}),await saveData(),renderSummaries();}catch(_0x12b053){console[_0x5d9ff8(0x258)](_0x12b053),toast(_0x5d9ff8(0x362));}finally{_0x4fc466&&(_0x4fc466[_0x5d9ff8(0x3ee)]=![],_0x4fc466['textContent']=_0x5d9ff8(0x20d));}}function renderSummaries(){const _0x5b1fbc=_0x336a98,_0x50b327=$('#summariesList');if(!_0x50b327)return;const _0x21b05e=getCurrentSubtopic();if(!_0x21b05e){_0x50b327[_0x5b1fbc(0x1ed)]='<div\x20class=\x22tiny\x22>Vui\x20lòng\x20chọn\x20một\x20chủ\x20đề\x20con\x20để\x20xem\x20tóm\x20tắt.</div>';return;}_0x50b327[_0x5b1fbc(0x1ed)]='';if(!_0x21b05e['summaries']||_0x21b05e[_0x5b1fbc(0x299)][_0x5b1fbc(0x3fd)]===0x0){_0x50b327[_0x5b1fbc(0x1ed)]=_0x5b1fbc(0x435);return;}_0x21b05e[_0x5b1fbc(0x299)][_0x5b1fbc(0x4ab)](_0xfa2b76=>{const _0x1aae8c=_0x5b1fbc,_0x37890c=document[_0x1aae8c(0x41d)]('div');_0x37890c['className']=_0x1aae8c(0x2b5);const _0x429598=document[_0x1aae8c(0x41d)](_0x1aae8c(0x22a));_0x429598['className']=_0x1aae8c(0x21d);const _0x4d34f1=document[_0x1aae8c(0x41d)]('div');_0x4d34f1[_0x1aae8c(0x314)]='note-content',_0x4d34f1[_0x1aae8c(0x3fc)]=_0xfa2b76[_0x1aae8c(0x4ea)];const _0x381a0c=document[_0x1aae8c(0x41d)](_0x1aae8c(0x22a));_0x381a0c[_0x1aae8c(0x314)]=_0x1aae8c(0x32e),_0x381a0c[_0x1aae8c(0x3fc)]=new Date(_0xfa2b76[_0x1aae8c(0x44d)])[_0x1aae8c(0x43c)](),_0x429598[_0x1aae8c(0x4a2)](_0x4d34f1,_0x381a0c);const _0x1cf7e0=document['createElement'](_0x1aae8c(0x22a)),_0x4dc956=document[_0x1aae8c(0x41d)](_0x1aae8c(0x222));_0x4dc956[_0x1aae8c(0x314)]=_0x1aae8c(0x3af),_0x4dc956['textContent']=_0x1aae8c(0x4dc),_0x4dc956[_0x1aae8c(0x2fd)]=_0x3129cc=>{const _0x501e00=_0x1aae8c;_0x3129cc[_0x501e00(0x508)](),exportSummary(_0xfa2b76);};const _0xfb01bf=document[_0x1aae8c(0x41d)]('button');_0xfb01bf['className']=_0x1aae8c(0x33b),_0xfb01bf['textContent']=_0x1aae8c(0x1ee),_0xfb01bf['onclick']=_0xb339fa=>{const _0x5cde45=_0x1aae8c;_0xb339fa[_0x5cde45(0x508)](),deleteSummary(_0xfa2b76['id']);},_0x1cf7e0[_0x1aae8c(0x4a2)](_0x4dc956,_0xfb01bf),_0x37890c[_0x1aae8c(0x4a2)](_0x429598,_0x1cf7e0),_0x37890c[_0x1aae8c(0x4f1)](_0x1aae8c(0x3b9),()=>_0x4d34f1[_0x1aae8c(0x39e)][_0x1aae8c(0x340)](_0x1aae8c(0x346))),_0x50b327['appendChild'](_0x37890c);});}function loadEditingPresetFields(){const _0x286ebc=_0x336a98,_0x4e069e=data['settings'],_0x53cd53=_0x4e069e['durations'],_0x48c7f3=$(_0x286ebc(0x1eb)),_0xb8f58f=$('#settings-flowtime');if(_0x48c7f3&&_0xb8f58f){const _0x2c12a7=editingPreset==='C';_0x48c7f3[_0x286ebc(0x39e)][_0x286ebc(0x340)](_0x286ebc(0x2ab),_0x2c12a7),_0xb8f58f[_0x286ebc(0x39e)][_0x286ebc(0x340)]('hidden',!_0x2c12a7);}if(editingPreset==='A'){$(_0x286ebc(0x287))[_0x286ebc(0x301)]=_0x53cd53[_0x286ebc(0x24c)];if($(_0x286ebc(0x3ed)))$(_0x286ebc(0x3ed))[_0x286ebc(0x301)]=_0x53cd53[_0x286ebc(0x430)]??0x0;$('#set_short')[_0x286ebc(0x301)]=_0x53cd53[_0x286ebc(0x25c)],$(_0x286ebc(0x2a5))[_0x286ebc(0x301)]=_0x53cd53[_0x286ebc(0x4ac)],$(_0x286ebc(0x201))['value']=_0x4e069e['cyclesA'],$(_0x286ebc(0x1f4))[_0x286ebc(0x301)]=_0x4e069e['longBreakIntervalA'];}else{if(editingPreset==='B'){$(_0x286ebc(0x287))[_0x286ebc(0x301)]=_0x53cd53[_0x286ebc(0x355)];if($(_0x286ebc(0x3ed)))$('#set_winddown')['value']=_0x53cd53[_0x286ebc(0x347)]??0x0;$('#set_short')[_0x286ebc(0x301)]=_0x53cd53[_0x286ebc(0x2c6)],$('#set_long')['value']=_0x53cd53['B_long'],$(_0x286ebc(0x201))[_0x286ebc(0x301)]=_0x4e069e[_0x286ebc(0x274)],$('#set_interval')[_0x286ebc(0x301)]=_0x4e069e['longBreakIntervalB'];}else{if(editingPreset==='C'){const _0x44d473=$('#set_flowRatio');if(_0x44d473)_0x44d473[_0x286ebc(0x301)]=_0x4e069e[_0x286ebc(0x358)]??0x5;}}}}function highlightPresetSelector(){const _0x1ed78e=_0x336a98;$$('#timerPresetSelector\x20button')[_0x1ed78e(0x4ab)](_0x203e9f=>{const _0x4f3298=_0x1ed78e,_0x338b6e=_0x203e9f[_0x4f3298(0x497)][_0x4f3298(0x4a7)]===editingPreset;_0x203e9f['classList'][_0x4f3298(0x340)](_0x4f3298(0x445),_0x338b6e),_0x203e9f[_0x4f3298(0x39e)]['toggle']('ghost',!_0x338b6e);});}function openSettings(){const _0xa73132=_0x336a98,_0x5d2db1=data[_0xa73132(0x35e)];editingPreset=_0x5d2db1['preset'],$(_0xa73132(0x432))[_0xa73132(0x301)]=_0x5d2db1[_0xa73132(0x4d0)]||'',loadEditingPresetFields(),highlightPresetSelector(),$(_0xa73132(0x208))[_0xa73132(0x301)]=_0x5d2db1[_0xa73132(0x4c1)]??0.8,$(_0xa73132(0x465))['value']=_0x5d2db1[_0xa73132(0x2d8)]||_0xa73132(0x244),$(_0xa73132(0x38a))[_0xa73132(0x301)]=_0x5d2db1[_0xa73132(0x250)]||_0xa73132(0x35a);const _0x435ed8=getActiveYoutubeUrl();$(_0xa73132(0x4cf))[_0xa73132(0x301)]=_0x435ed8||'';const _0x30d1ca=extractYouTubeID(_0x435ed8);$('#btnToggleYtSound')[_0xa73132(0x3ee)]=!_0x30d1ca;$(_0xa73132(0x32b))&&($('#ytUrlFeedback')['textContent']='');$(_0xa73132(0x29b))[_0xa73132(0x301)]=_0x5d2db1[_0xa73132(0x267)]||0x50,$('#set_ytThumbAsBg')[_0xa73132(0x369)]=!!_0x5d2db1['useYtThumbnailAsBg'],$(_0xa73132(0x46b))[_0xa73132(0x301)]=_0x5d2db1[_0xa73132(0x233)]||0.85;$(_0xa73132(0x4d2))&&($(_0xa73132(0x4d2))[_0xa73132(0x301)]=_0x5d2db1['backgroundMode']||_0xa73132(0x2bf));$('#set_autoStartNext')&&($(_0xa73132(0x32d))[_0xa73132(0x369)]=!!_0x5d2db1[_0xa73132(0x2fe)]);$(_0xa73132(0x47e))&&($(_0xa73132(0x47e))[_0xa73132(0x369)]=_0x5d2db1['enableWinddown']!==![]);$(_0xa73132(0x372))&&($(_0xa73132(0x372))[_0xa73132(0x369)]=_0x5d2db1['enableSessionNotes']!==![]);$(_0xa73132(0x37d))&&($(_0xa73132(0x37d))['value']=_0x5d2db1['backupDaysToKeep']||0x7);const _0x6f2964=$('#backupList');_0x6f2964&&storageManager['getBackupList']()[_0xa73132(0x493)](_0x61bc7a=>{const _0x796674=_0xa73132;_0x6f2964[_0x796674(0x1ed)]=_0x796674(0x483),_0x61bc7a&&_0x61bc7a[_0x796674(0x3fd)]>0x0?_0x61bc7a['forEach'](_0x546114=>{const _0x3617f5=_0x796674,_0x3d4e8f=document[_0x3617f5(0x41d)]('option');_0x3d4e8f['value']=_0x546114[_0x3617f5(0x238)],_0x3d4e8f[_0x3617f5(0x3fc)]='Bản\x20sao\x20lưu\x20ngày:\x20'+new Date(_0x546114[_0x3617f5(0x238)])['toLocaleDateString'](_0x3617f5(0x2fa)),_0x6f2964[_0x3617f5(0x34d)](_0x3d4e8f);}):_0x6f2964[_0x796674(0x1ed)]='<option\x20value=\x22\x22>Không\x20có\x20bản\x20sao\x20lưu\x20nào</option>';});$(_0xa73132(0x241))[_0xa73132(0x39e)][_0xa73132(0x4b0)](_0xa73132(0x32c));try{trapFocus($('#modalSettings'));}catch(_0x15c69c){}}function closeSettings(){const _0x1c8d14=_0x336a98;$(_0x1c8d14(0x241))[_0x1c8d14(0x39e)][_0x1c8d14(0x4f4)](_0x1c8d14(0x32c));try{releaseFocus();}catch(_0x1c73c2){}}async function setDefaults(){const _0x27b241=_0x336a98;data[_0x27b241(0x35e)]['durations']={'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},data[_0x27b241(0x35e)]['cyclesA']=0x4,data[_0x27b241(0x35e)][_0x27b241(0x50a)]=0x4,data[_0x27b241(0x35e)]['cyclesB']=0x4,data['settings'][_0x27b241(0x402)]=0x4,data[_0x27b241(0x35e)][_0x27b241(0x358)]=0x5,data[_0x27b241(0x35e)][_0x27b241(0x4e6)]='A',data[_0x27b241(0x35e)][_0x27b241(0x4c1)]=0.8,data[_0x27b241(0x35e)][_0x27b241(0x2d8)]='beep',await saveData(),openSettings(),toast(_0x27b241(0x263));}async function saveSettings(){const _0x4fb104=_0x336a98,_0x384d34=data[_0x4fb104(0x35e)];_0x384d34[_0x4fb104(0x4d0)]=$(_0x4fb104(0x432))['value'][_0x4fb104(0x3a2)]();const _0x2af44e=_0x384d34[_0x4fb104(0x4f2)];if(editingPreset==='A')_0x2af44e[_0x4fb104(0x24c)]=clampInt($(_0x4fb104(0x287))[_0x4fb104(0x301)],0x1,0x3e7),_0x2af44e[_0x4fb104(0x430)]=clampInt($(_0x4fb104(0x3ed))[_0x4fb104(0x301)],0x0,0x3e7),_0x2af44e['A_short']=clampInt($(_0x4fb104(0x3c9))['value'],0x1,0x3e7),_0x2af44e[_0x4fb104(0x4ac)]=clampInt($(_0x4fb104(0x2a5))[_0x4fb104(0x301)],0x1,0x3e7),_0x384d34['cyclesA']=clampInt($(_0x4fb104(0x201))[_0x4fb104(0x301)],0x1,0xc),_0x384d34[_0x4fb104(0x50a)]=clampInt($(_0x4fb104(0x1f4))['value'],0x2,0xc);else{if(editingPreset==='B')_0x2af44e[_0x4fb104(0x355)]=clampInt($('#set_work')[_0x4fb104(0x301)],0x1,0x3e7),_0x2af44e['B_winddown']=clampInt($('#set_winddown')[_0x4fb104(0x301)],0x0,0x3e7),_0x2af44e['B_short']=clampInt($(_0x4fb104(0x3c9))['value'],0x1,0x3e7),_0x2af44e[_0x4fb104(0x457)]=clampInt($(_0x4fb104(0x2a5))[_0x4fb104(0x301)],0x1,0x3e7),_0x384d34[_0x4fb104(0x274)]=clampInt($(_0x4fb104(0x201))['value'],0x1,0xc),_0x384d34[_0x4fb104(0x402)]=clampInt($('#set_interval')[_0x4fb104(0x301)],0x2,0xc);else{if(editingPreset==='C'){const _0x7503b8=$('#set_flowRatio');if(_0x7503b8)_0x384d34[_0x4fb104(0x358)]=clampInt(_0x7503b8['value'],0x1,0x14);}}}_0x384d34[_0x4fb104(0x4c1)]=clampFloat($(_0x4fb104(0x208))[_0x4fb104(0x301)],0x0,0x1,0.8),_0x384d34[_0x4fb104(0x2d8)]=$('#set_theme')[_0x4fb104(0x301)]==='chime'?_0x4fb104(0x3a9):'beep',_0x384d34[_0x4fb104(0x250)]=$(_0x4fb104(0x38a))[_0x4fb104(0x301)],_0x384d34[_0x4fb104(0x233)]=parseFloat($(_0x4fb104(0x46b))[_0x4fb104(0x301)])||0.85;$(_0x4fb104(0x4d2))&&(_0x384d34['backgroundMode']=$(_0x4fb104(0x4d2))[_0x4fb104(0x301)]);_0x384d34[_0x4fb104(0x2fe)]=!!($(_0x4fb104(0x32d))&&$(_0x4fb104(0x32d))[_0x4fb104(0x369)]),_0x384d34[_0x4fb104(0x42d)]=!!($(_0x4fb104(0x47e))&&$(_0x4fb104(0x47e))[_0x4fb104(0x369)]),_0x384d34[_0x4fb104(0x24b)]=!!($(_0x4fb104(0x372))&&$(_0x4fb104(0x372))['checked']);$(_0x4fb104(0x37d))&&(_0x384d34[_0x4fb104(0x312)]=clampInt($('#set_backupDays')['value'],0x1,0x1e));_0x384d34[_0x4fb104(0x250)]==='light'||_0x384d34[_0x4fb104(0x250)]===_0x4fb104(0x431)?(_0x384d34['useYtThumbnailAsBg']=![],typeof _0x384d34[_0x4fb104(0x2d1)]===_0x4fb104(0x448)&&_0x384d34['customBg']['includes'](_0x4fb104(0x488))&&(_0x384d34['customBg']='')):_0x384d34[_0x4fb104(0x4b9)]=!![];const _0x1c7c4a=$(_0x4fb104(0x4cf))[_0x4fb104(0x301)]['trim']();_0x384d34[_0x4fb104(0x4b9)]=$(_0x4fb104(0x260))[_0x4fb104(0x369)],_0x384d34[_0x4fb104(0x267)]=parseInt($(_0x4fb104(0x29b))[_0x4fb104(0x301)],0xa),sessionYoutubeUrl=_0x1c7c4a;try{if(!IS_FILE_PROTOCOL){if(ytPlayer&&ytPlayer[_0x4fb104(0x2bb)])ytPlayer['setVolume'](_0x384d34[_0x4fb104(0x267)]);}else try{fallbackPostMessage(_0x4fb104(0x2bb),[_0x384d34['youtubeVolume']]);}catch(_0x4493fe){}}catch(_0x501f6b){}await saveData(),applyTheme(),applyCustomBg(),applyPanelOpacity(),updatePresetButtonsText(),timer['setPreset'](_0x384d34[_0x4fb104(0x4e6)],{'silent':!![]}),closeSettings(),toast(_0x4fb104(0x2e4));}function clampInt(_0x5dceaa,_0xde9e5d,_0x29fa0b){const _0x541a20=_0x336a98;_0x5dceaa=parseInt(_0x5dceaa||0x0,0xa);if(isNaN(_0x5dceaa))_0x5dceaa=_0xde9e5d;return Math['max'](_0xde9e5d,Math[_0x541a20(0x368)](_0x29fa0b,_0x5dceaa));}function clampFloat(_0x2dc39d,_0x467146,_0x42e848,_0x8053aa){const _0x30d866=_0x336a98;_0x2dc39d=parseFloat(_0x2dc39d);if(Number[_0x30d866(0x3cf)](_0x2dc39d))_0x2dc39d=_0x8053aa;return Math[_0x30d866(0x378)](_0x467146,Math[_0x30d866(0x368)](_0x42e848,_0x2dc39d));}const dbPromise=new Promise((_0x3d1d72,_0x360902)=>{const _0x2f5d3d=_0x336a98,_0xcfc68a=indexedDB[_0x2f5d3d(0x247)](_0x2f5d3d(0x228),0x1);_0xcfc68a[_0x2f5d3d(0x2bc)]=_0x4e5fad=>_0x4e5fad[_0x2f5d3d(0x253)][_0x2f5d3d(0x200)]['createObjectStore']('files'),_0xcfc68a['onsuccess']=_0x59a011=>_0x3d1d72(_0x59a011[_0x2f5d3d(0x253)][_0x2f5d3d(0x200)]),_0xcfc68a[_0x2f5d3d(0x2ff)]=_0x2cb2f9=>_0x360902(_0x2cb2f9);}),fileCache={};function handleFileUpload(_0x55adef,_0x218095){const _0x48739e=_0x336a98;if(!_0x55adef)return;dbPromise[_0x48739e(0x493)](_0x593eff=>{const _0x436b72=_0x48739e,_0x385993=uid(_0x436b72(0x3d2)),_0x277e1a=_0x593eff['transaction']('files',_0x436b72(0x40f));_0x277e1a['objectStore'](_0x436b72(0x35d))[_0x436b72(0x2e8)](_0x55adef,_0x385993),_0x277e1a[_0x436b72(0x501)]=()=>_0x218095(_0x385993),_0x277e1a['onerror']=()=>toast(_0x436b72(0x48f));});}function getStoredFileUrl(_0x3b2291){const _0x3536b4=_0x336a98;if(!_0x3b2291)return Promise[_0x3536b4(0x1f5)]('');if(fileCache[_0x3b2291])return Promise[_0x3536b4(0x1f5)](fileCache[_0x3b2291]);return dbPromise[_0x3536b4(0x493)](_0x1d3ac4=>new Promise(_0x42b7cc=>{const _0x563f72=_0x3536b4,_0x11fb82=_0x1d3ac4[_0x563f72(0x389)](_0x563f72(0x35d),'readonly'),_0x2aabbf=_0x11fb82[_0x563f72(0x37e)](_0x563f72(0x35d))[_0x563f72(0x216)](_0x3b2291);_0x2aabbf[_0x563f72(0x30c)]=_0x5e4aa2=>{const _0xb07244=_0x563f72,_0x529fc8=_0x5e4aa2[_0xb07244(0x253)][_0xb07244(0x200)];if(_0x529fc8){const _0x29bb78=URL[_0xb07244(0x4ec)](_0x529fc8);fileCache[_0x3b2291]=_0x29bb78,_0x42b7cc(_0x29bb78);}else _0x42b7cc('');},_0x2aabbf[_0x563f72(0x2ff)]=()=>_0x42b7cc('');}));}function applyCustomBg(){const _0x5dbc15=_0x336a98,_0x56eecd=data[_0x5dbc15(0x35e)],_0x25e70b=_0x56eecd[_0x5dbc15(0x2d1)],_0x6c94e5=_0x56eecd[_0x5dbc15(0x250)],_0x391fa9=[_0x5dbc15(0x331),_0x5dbc15(0x333)]['includes'](_0x6c94e5),_0x468750=_0x6c94e5===_0x5dbc15(0x23f)||_0x6c94e5===_0x5dbc15(0x431),_0x3ab00a=_0x56eecd[_0x5dbc15(0x351)]||_0x5dbc15(0x2bf);document[_0x5dbc15(0x3d0)][_0x5dbc15(0x225)][_0x5dbc15(0x3e4)]=_0x3ab00a,document[_0x5dbc15(0x3d0)][_0x5dbc15(0x225)][_0x5dbc15(0x25a)]=_0x3ab00a===_0x5dbc15(0x39d)?_0x5dbc15(0x4b4):_0x5dbc15(0x336);const _0x3675b5=()=>{const _0x5b6ab3=_0x5dbc15;try{document[_0x5b6ab3(0x3d0)][_0x5b6ab3(0x225)]['backgroundImage']='';}catch(_0x174f0e){}};if(_0x25e70b){const _0x3189ec=_0x25e70b[_0x5dbc15(0x2e5)]('data:')||_0x25e70b[_0x5dbc15(0x2e5)]('http')||_0x25e70b[_0x5dbc15(0x2e5)]('blob:')?Promise['resolve'](_0x25e70b):getStoredFileUrl(_0x25e70b);_0x3189ec[_0x5dbc15(0x493)](_0x2c8b84=>{const _0x546492=_0x5dbc15;_0x2c8b84?document[_0x546492(0x3d0)][_0x546492(0x225)][_0x546492(0x2c1)](_0x546492(0x454),_0x546492(0x26b)+_0x2c8b84+')'):document[_0x546492(0x3d0)][_0x546492(0x225)][_0x546492(0x2c1)](_0x546492(0x454),_0x468750?_0x546492(0x234):''),_0x3675b5();});}else!_0x391fa9?_0x468750?(document[_0x5dbc15(0x3d0)][_0x5dbc15(0x225)][_0x5dbc15(0x2c1)](_0x5dbc15(0x454),_0x5dbc15(0x234)),_0x3675b5()):document[_0x5dbc15(0x3d0)][_0x5dbc15(0x225)][_0x5dbc15(0x2c1)](_0x5dbc15(0x454),_0x5dbc15(0x266)):(document['body']['style']['removeProperty']('--bg-image'),_0x3675b5());}function applyPanelOpacity(){const _0x3317a1=_0x336a98;document[_0x3317a1(0x3d6)][_0x3317a1(0x225)][_0x3317a1(0x2c1)](_0x3317a1(0x36d),data[_0x3317a1(0x35e)][_0x3317a1(0x233)]);}function renderDashboard(){const _0x13c9f1=_0x336a98,_0x9f0b36=data['topics'][_0x13c9f1(0x4b5)](_0xffc562=>_0xffc562[_0x13c9f1(0x47c)][_0x13c9f1(0x419)](_0x17512b=>({'topic':_0xffc562[_0x13c9f1(0x22f)],'subtopic':_0x17512b['name'],'m':_0x17512b[_0x13c9f1(0x3b6)][_0x13c9f1(0x398)]||0x0,'c':_0x17512b['stats'][_0x13c9f1(0x3ca)]||0x0,'t':_0x17512b[_0x13c9f1(0x3b6)]['tasksCompleted']||0x0}))),_0x36679b=_0x9f0b36['reduce']((_0x3de912,_0x2b2c1e)=>_0x3de912+_0x2b2c1e['m'],0x0),_0x4d318f=_0x9f0b36[_0x13c9f1(0x1fa)]((_0x31f2bd,_0x321726)=>_0x31f2bd+_0x321726['c'],0x0),_0x216ed1=_0x9f0b36[_0x13c9f1(0x1fa)]((_0x1659a5,_0x272f56)=>_0x1659a5+_0x272f56['t'],0x0);let _0x1bb019=_0x13c9f1(0x324)+formatDaysHoursMinutes(_0x36679b)+_0x13c9f1(0x4b3)+_0x4d318f+_0x13c9f1(0x509)+_0x216ed1+_0x13c9f1(0x319);_0x9f0b36[_0x13c9f1(0x4ab)](_0x316496=>{const _0x4a4d01=_0x13c9f1;_0x1bb019+=_0x4a4d01(0x487)+escapeHTML(_0x316496[_0x4a4d01(0x2fb)])+_0x4a4d01(0x322)+escapeHTML(_0x316496[_0x4a4d01(0x3a8)])+_0x4a4d01(0x322)+formatDaysHoursMinutes(_0x316496['m'])+_0x4a4d01(0x322)+_0x316496['c']+_0x4a4d01(0x322)+_0x316496['t']+_0x4a4d01(0x31f);}),_0x1bb019+=_0x13c9f1(0x4dd);const _0x5c110a=$(_0x13c9f1(0x4a3));if(_0x5c110a)_0x5c110a[_0x13c9f1(0x1ed)]=_0x1bb019;}function getMilestones(){const _0x2661df=_0x336a98;return[{'hours':0x5,'title':_0x2661df(0x4d7),'message':'Năm\x20giờ\x20tập\x20trung!\x20Bạn\x20đã\x20vượt\x20qua\x20rào\x20cản\x20lớn\x20nhất:\x20sự\x20trì\x20hoãn.\x20Mỗi\x20phút\x20bạn\x20dành\x20ra\x20đều\x20là\x20một\x20lời\x20khẳng\x20định\x20cho\x20mục\x20tiêu\x20của\x20mình.\x20Hãy\x20giữ\x20vững\x20ngọn\x20lửa\x20này!'},{'hours':0x14,'title':_0x2661df(0x1ef),'message':_0x2661df(0x3df)},{'hours':0x32,'title':'Gửi\x20bạn,\x2050\x20giờ\x20(Động\x20lực)','message':_0x2661df(0x21e)},{'hours':0x64,'title':_0x2661df(0x46a),'message':_0x2661df(0x428)},{'hours':0xfa,'title':_0x2661df(0x43a),'message':'250\x20giờ\x20là\x20minh\x20chứng\x20cho\x20sự\x20bền\x20bỉ\x20đáng\x20kinh\x20ngạc.\x20Bạn\x20đã\x20đối\x20mặt\x20với\x20những\x20ngày\x20khó\x20khăn,\x20những\x20lúc\x20mất\x20tập\x20trung,\x20nhưng\x20bạn\x20vẫn\x20quay\x20trở\x20lại.\x20Sức\x20mạnh\x20thực\x20sự\x20nằm\x20ở\x20chính\x20sự\x20kiên\x20trì\x20này.'},{'hours':0x1f4,'title':_0x2661df(0x22e),'message':_0x2661df(0x3b5)},{'hours':0x3e8,'title':_0x2661df(0x3f8),'message':_0x2661df(0x261)},{'hours':0x1388,'title':_0x2661df(0x438),'message':'5.000\x20giờ\x20tập\x20trung\x20có\x20chủ\x20đích.\x20Đây\x20là\x20một\x20thành\x20tựu\x20mà\x20rất\x20ít\x20người\x20đạt\x20được.\x0a\x0aTại\x20cột\x20mốc\x20này,\x20câu\x20hỏi\x20không\x20còn\x20là\x20\x27Làm\x20thế\x20nào\x20để\x20tập\x20trung?\x27,\x20mà\x20là\x20\x27Sự\x20tập\x20trung\x20này\x20sẽ\x20được\x20dùng\x20để\x20tạo\x20ra\x20giá\x20trị\x20gì?\x27.\x20Bạn\x20không\x20chỉ\x20làm\x20việc,\x20bạn\x20đang\x20tạo\x20ra\x20di\x20sản.'}][_0x2661df(0x499)]((_0x55b7b4,_0x43c714)=>_0x43c714[_0x2661df(0x403)]-_0x55b7b4[_0x2661df(0x403)]);}async function checkAndShowMilestones(){const _0x1541d4=_0x336a98;if(!data||!data[_0x1541d4(0x35e)])return;if(!Array[_0x1541d4(0x2d0)](data[_0x1541d4(0x35e)]['achievedMilestones']))data['settings'][_0x1541d4(0x34a)]=[];const _0x528ef2=data['topics'][_0x1541d4(0x1fa)]((_0x196c79,_0x1099c7)=>{const _0x2539e6=_0x1541d4;return _0x196c79+_0x1099c7[_0x2539e6(0x47c)][_0x2539e6(0x1fa)]((_0x1162e0,_0x434895)=>{const _0x5ca3a5=_0x2539e6;return _0x1162e0+(_0x434895[_0x5ca3a5(0x3b6)][_0x5ca3a5(0x398)]||0x0);},0x0);},0x0),_0x5c222a=_0x528ef2/0x3c,_0x1000ef=getMilestones(),_0x52c8ff=Array[_0x1541d4(0x2d0)](data[_0x1541d4(0x35e)][_0x1541d4(0x34a)])?data['settings'][_0x1541d4(0x34a)]:[],_0x23c7c3=_0x1000ef[_0x1541d4(0x3c7)](_0x5b4fce=>_0x5c222a>=_0x5b4fce[_0x1541d4(0x403)]&&!_0x52c8ff[_0x1541d4(0x2c3)](_0x5b4fce[_0x1541d4(0x403)]));if(_0x23c7c3[_0x1541d4(0x3fd)]===0x0)return![];const _0x470d19=_0x23c7c3[_0x1541d4(0x1fa)]((_0x2dfcdf,_0x2d20e9)=>_0x2dfcdf&&_0x2dfcdf['hours']>_0x2d20e9[_0x1541d4(0x403)]?_0x2dfcdf:_0x2d20e9,null);if(!_0x470d19)return![];$(_0x1541d4(0x436))[_0x1541d4(0x3fc)]=_0x470d19[_0x1541d4(0x3d5)],$(_0x1541d4(0x449))['textContent']=_0x470d19[_0x1541d4(0x414)],$(_0x1541d4(0x2d3))[_0x1541d4(0x39e)][_0x1541d4(0x4b0)](_0x1541d4(0x32c));try{trapFocus($(_0x1541d4(0x2d3)));}catch(_0x2d017f){}return data[_0x1541d4(0x35e)][_0x1541d4(0x34a)]['push'](_0x470d19['hours']),await saveData(),!![];}async function seedAchievedMilestones(){const _0x547cd6=_0x336a98;if(!data||!data[_0x547cd6(0x35e)])return;!Array[_0x547cd6(0x2d0)](data[_0x547cd6(0x35e)][_0x547cd6(0x34a)])&&(data['settings'][_0x547cd6(0x34a)]=[],await saveData());}async function handleSendMessage(){const _0x29cc22=_0x336a98,_0x4cd73d=$(_0x29cc22(0x3ab)),_0x2c5514=$(_0x29cc22(0x3e3)),_0x2e52da=_0x2c5514[_0x29cc22(0x301)][_0x29cc22(0x3a2)](),_0x5643e4=getCurrentSubtopic();if(!_0x2e52da)return;if(!_0x5643e4){toast(t('timer.selectSubtopicPrompt'));return;}_0x2c5514[_0x29cc22(0x301)]='',_0x4cd73d[_0x29cc22(0x3ee)]=!![],_0x4cd73d['innerHTML']=_0x29cc22(0x42f),_0x5643e4[_0x29cc22(0x4b1)][_0x29cc22(0x1fd)]({'role':_0x29cc22(0x472),'text':_0x2e52da}),renderChat();const _0xdf767e=await callGeminiAPI(_0x2e52da);_0xdf767e&&(_0x5643e4[_0x29cc22(0x4b1)][_0x29cc22(0x1fd)]({'role':_0x29cc22(0x32f),'text':_0xdf767e}),await saveData(),renderChat()),_0x4cd73d[_0x29cc22(0x3ee)]=![],_0x4cd73d[_0x29cc22(0x1ed)]=_0x29cc22(0x377);}function renderChat(){const _0x512bcc=_0x336a98,_0x52a23a=getCurrentSubtopic(),_0xeb2098=$('#chatMessages'),_0x1f311c=$(_0x512bcc(0x3e3)),_0x4843b4=$(_0x512bcc(0x3ab));if(!_0xeb2098||!_0x1f311c||!_0x4843b4)return;if(!_0x52a23a){_0xeb2098[_0x512bcc(0x1ed)]='<div\x20class=\x22tiny\x22>Chọn\x20chủ\x20đề\x20con\x20để\x20bắt\x20đầu\x20chat.</div>',_0x1f311c[_0x512bcc(0x3ee)]=!![],_0x4843b4[_0x512bcc(0x3ee)]=!![];return;}_0x1f311c['disabled']=![],_0x4843b4[_0x512bcc(0x3ee)]=![],_0xeb2098['innerHTML']='';if(!_0x52a23a[_0x512bcc(0x4b1)]||_0x52a23a[_0x512bcc(0x4b1)][_0x512bcc(0x3fd)]===0x0){_0xeb2098[_0x512bcc(0x1ed)]=_0x512bcc(0x433);return;}_0x52a23a['chatHistory'][_0x512bcc(0x4ab)](_0x2fe52e=>{const _0x43da0e=_0x512bcc,_0x44f41c=document[_0x43da0e(0x41d)](_0x43da0e(0x22a));_0x44f41c[_0x43da0e(0x314)]='chat-msg\x20'+_0x2fe52e[_0x43da0e(0x404)],_0x44f41c['textContent']=_0x2fe52e[_0x43da0e(0x4fa)],_0xeb2098[_0x43da0e(0x34d)](_0x44f41c);}),_0xeb2098[_0x512bcc(0x376)]=_0xeb2098[_0x512bcc(0x3ce)];}async function handleSummarizeNote(){const _0x5bb347=_0x336a98,_0x29e5f5=$('#btnSummarizeNote'),_0x26308f=$(_0x5bb347(0x270)),_0x4df557=_0x26308f[_0x5bb347(0x301)][_0x5bb347(0x3a2)](),_0x5bb24b=getCurrentSubtopic();if(!_0x4df557){toast(_0x5bb347(0x47f));return;}const _0x5db57e=_0x29e5f5[_0x5bb347(0x1ed)];_0x29e5f5['innerHTML']=_0x5bb347(0x42f),_0x29e5f5[_0x5bb347(0x3ee)]=!![];const _0x440ab0=_0x5bb347(0x410)+(_0x5bb24b?.[_0x5bb347(0x22f)]||'không\x20rõ')+_0x5bb347(0x293)+_0x4df557+_0x5bb347(0x4c0),_0x2c1b60=await callGeminiAPI(_0x440ab0);_0x2c1b60&&(_0x26308f[_0x5bb347(0x301)]+='\x0a\x0a'+_0x2c1b60),_0x29e5f5[_0x5bb347(0x1ed)]=_0x5db57e,_0x29e5f5[_0x5bb347(0x3ee)]=![];}function clearChat(){const _0x1ad4ab=_0x336a98,_0x254919=getCurrentSubtopic();if(!_0x254919){toast(t('timer.selectSubtopicPrompt'));return;}showConfirmModal('Xác\x20nhận\x20xóa',_0x1ad4ab(0x426),async _0x36c903=>{const _0xf7f3ab=_0x1ad4ab;_0x36c903&&(_0x254919[_0xf7f3ab(0x4b1)]=[],await saveData(),renderChat(),toast(_0xf7f3ab(0x4a4)));});}let ytPlayer,ytUserPaused=![],ytFallbackFrame=null,ytFallbackIsPlaying=![];function buildFallbackSrc(_0x24a4eb,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x3e685c=_0x336a98,_0x485818=new URLSearchParams({'autoplay':String(autoplay),'mute':String(mute),'controls':'0','playsinline':'1','loop':'1','playlist':_0x24a4eb,'enablejsapi':'1','origin':_0x3e685c(0x30f)})['toString']();return _0x3e685c(0x26f)+_0x24a4eb+'?'+_0x485818;}function ensureFallbackFrame(){const _0x393589=_0x336a98,_0x51f435=document[_0x393589(0x461)](_0x393589(0x39b));if(!_0x51f435)return null;if(ytFallbackFrame&&ytFallbackFrame['isConnected'])return ytFallbackFrame;const _0x138b36=document['createElement'](_0x393589(0x334));return _0x138b36['id']=_0x393589(0x406),_0x138b36[_0x393589(0x330)]='1',_0x138b36[_0x393589(0x26e)]='1',_0x138b36[_0x393589(0x225)][_0x393589(0x455)]=_0x393589(0x4da),_0x138b36['style'][_0x393589(0x4ca)]=_0x393589(0x31d),_0x138b36[_0x393589(0x225)]['left']=_0x393589(0x31d),_0x138b36[_0x393589(0x29e)]=_0x393589(0x2bd),_0x51f435[_0x393589(0x1ed)]='',_0x51f435[_0x393589(0x34d)](_0x138b36),ytFallbackFrame=_0x138b36,_0x138b36;}function fallbackLoadVideo(_0x37aa57,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x3a9e5d=_0x336a98,_0x18d057=document[_0x3a9e5d(0x461)](_0x3a9e5d(0x39b));if(!_0x18d057)return;_0x18d057[_0x3a9e5d(0x1ed)]='';const _0x4c1b78=document['createElement'](_0x3a9e5d(0x334));_0x4c1b78['id']=_0x3a9e5d(0x406),_0x4c1b78[_0x3a9e5d(0x330)]='1',_0x4c1b78[_0x3a9e5d(0x26e)]='1',_0x4c1b78[_0x3a9e5d(0x225)][_0x3a9e5d(0x455)]=_0x3a9e5d(0x4da),_0x4c1b78['style'][_0x3a9e5d(0x4ca)]=_0x3a9e5d(0x31d),_0x4c1b78[_0x3a9e5d(0x225)][_0x3a9e5d(0x43e)]='-9999px',_0x4c1b78['allow']=_0x3a9e5d(0x2bd),_0x4c1b78[_0x3a9e5d(0x3b1)]=buildFallbackSrc(_0x37aa57,{'autoplay':autoplay,'mute':mute}),_0x18d057['appendChild'](_0x4c1b78),ytFallbackFrame=_0x4c1b78,ytFallbackIsPlaying=!!autoplay;try{const _0x5c1e09=document[_0x3a9e5d(0x461)]('btnToggleYtSound');if(_0x5c1e09)_0x5c1e09[_0x3a9e5d(0x3fc)]=ytFallbackIsPlaying?'⏸️':'▶️';}catch(_0x4470fd){}}function fallbackPostMessage(_0x5d14fc,_0x273df8=[]){const _0x48ef7a=_0x336a98;try{if(!ytFallbackFrame||!ytFallbackFrame[_0x48ef7a(0x295)])return;ytFallbackFrame[_0x48ef7a(0x295)][_0x48ef7a(0x4cc)](JSON[_0x48ef7a(0x22c)]({'event':_0x48ef7a(0x4bc),'func':_0x5d14fc,'args':_0x273df8}),_0x48ef7a(0x30f));}catch(_0x5ea57e){}}function fallbackPlay(){const _0x5d5fdf=_0x336a98;fallbackPostMessage(_0x5d5fdf(0x337));}function fallbackStop(){const _0x4f8b9a=_0x336a98;try{ytFallbackFrame&&(ytFallbackFrame[_0x4f8b9a(0x3b1)]='about:blank',ytFallbackIsPlaying=![]);}catch(_0x323385){}}function fallbackPause(){fallbackStop();}function fallbackUnMute(){const _0x28b943=_0x336a98;fallbackPostMessage(_0x28b943(0x498));}function fallbackMute(){const _0x27fedd=_0x336a98;fallbackPostMessage(_0x27fedd(0x2b4));}window[_0x336a98(0x4ce)]=function(){const _0x1898f5=_0x336a98;if(IS_FILE_PROTOCOL){try{window[_0x1898f5(0x421)]&&window[_0x1898f5(0x421)][_0x1898f5(0x2f5)]();}catch(_0x361d89){}return;}const _0x19e219={'height':'1','width':'1','playerVars':{'autoplay':0x0,'controls':0x0,'playsinline':0x1},'events':{'onReady':onPlayerReady,'onStateChange':onPlayerStateChange},'host':_0x1898f5(0x30f)};(window[_0x1898f5(0x3cc)][_0x1898f5(0x4b7)]===_0x1898f5(0x494)||window[_0x1898f5(0x3cc)][_0x1898f5(0x4b7)]===_0x1898f5(0x380))&&(_0x19e219[_0x1898f5(0x27b)]=window['location']['origin']);ytPlayer=new YT[(_0x1898f5(0x1f6))](_0x1898f5(0x39b),_0x19e219);try{window['__ytApiWatchdog']&&window[_0x1898f5(0x421)][_0x1898f5(0x2f5)]();const _0x16e143=document[_0x1898f5(0x461)](_0x1898f5(0x40e));_0x16e143&&(_0x16e143[_0x1898f5(0x3fc)]='');}catch(_0x3844c3){}};let _ytPrimed=![],_ytUnlocked=![];try{_ytUnlocked=localStorage[_0x336a98(0x2c0)](_0x336a98(0x365))==='1';}catch(_0x1c0752){}function showSoundPermission(){const _0x438cd1=_0x336a98,_0x516ff4=document[_0x438cd1(0x461)]('soundPermissionBar');if(!_0x516ff4)return;if(_ytUnlocked){_0x516ff4[_0x438cd1(0x39e)]['remove'](_0x438cd1(0x32c));return;}_0x516ff4['classList'][_0x438cd1(0x4b0)](_0x438cd1(0x32c));}function hideSoundPermission(){const _0x5cbef8=_0x336a98,_0x375d35=document[_0x5cbef8(0x461)](_0x5cbef8(0x411));if(!_0x375d35)return;_0x375d35['classList'][_0x5cbef8(0x4f4)](_0x5cbef8(0x32c));}function unlockAudioChain(){const _0x1ebda5=_0x336a98;try{if(AUDIO_CTX&&typeof AUDIO_CTX[_0x1ebda5(0x36f)]===_0x1ebda5(0x25b))AUDIO_CTX[_0x1ebda5(0x36f)]();}catch(_0x48fd88){}try{if(IS_FILE_PROTOCOL)fallbackUnMute(),fallbackPlay();else ytPlayer&&ytPlayer[_0x1ebda5(0x498)]&&(ytPlayer[_0x1ebda5(0x498)](),ytPlayer[_0x1ebda5(0x337)]());}catch(_0x1671c4){}_ytUnlocked=!![];try{localStorage[_0x1ebda5(0x401)](_0x1ebda5(0x365),'1');}catch(_0x1e7c4e){}hideSoundPermission(),toast(_0x1ebda5(0x309));}function onPlayerReady(_0x1b43e1){const _0x515a75=_0x336a98;try{const _0xc3f75d=ytPlayer&&ytPlayer['getIframe']?ytPlayer[_0x515a75(0x1ec)]():null;_0xc3f75d&&_0xc3f75d['setAttribute'](_0x515a75(0x29e),'autoplay;\x20encrypted-media;\x20picture-in-picture');}catch(_0x465820){}try{if(ytPlayer&&ytPlayer['setVolume'])ytPlayer[_0x515a75(0x2bb)](data&&data[_0x515a75(0x35e)]&&data[_0x515a75(0x35e)][_0x515a75(0x267)]||0x50);}catch(_0x462df6){}try{const _0x15fd0c=getActiveVideoId&&getActiveVideoId();if(_0x15fd0c&&ytPlayer&&ytPlayer['mute']&&ytPlayer[_0x515a75(0x337)]){ytPlayer[_0x515a75(0x2b4)](),ytPlayer[_0x515a75(0x337)](),_ytPrimed=!![];const _0x28250d=()=>{const _0x1f6df8=_0x515a75;if(_ytUnlocked)return;try{unlockAudioChain();}catch(_0x4b90de){}window[_0x1f6df8(0x458)](_0x1f6df8(0x3f6),_0x28250d,!![]),window[_0x1f6df8(0x458)](_0x1f6df8(0x4f5),_0x28250d,!![]);};window[_0x515a75(0x4f1)](_0x515a75(0x3f6),_0x28250d,!![]),window[_0x515a75(0x4f1)](_0x515a75(0x4f5),_0x28250d,!![]),showSoundPermission();}}catch(_0x26940e){}updateYouTubePlayer();}function onPlayerStateChange(_0x37de90){const _0x4b9a32=_0x336a98,_0x565c24=$(_0x4b9a32(0x425));_0x37de90[_0x4b9a32(0x407)]==YT[_0x4b9a32(0x359)][_0x4b9a32(0x31e)]?(_0x565c24[_0x4b9a32(0x3fc)]='⏸️',hideSoundPermission()):_0x565c24[_0x4b9a32(0x3fc)]='▶️';if(_0x37de90[_0x4b9a32(0x407)]===YT[_0x4b9a32(0x359)][_0x4b9a32(0x342)]){if(!ytUserPaused)ytPlayer[_0x4b9a32(0x337)]();}}async function ytFadeTo(_0x36d926,_0x25aedf=0xfa){const _0x316be5=_0x336a98;try{if(!ytPlayer||!ytPlayer[_0x316be5(0x440)]||!ytPlayer['setVolume'])return;ytPlayer[_0x316be5(0x498)]();const _0x1521c8=ytPlayer[_0x316be5(0x440)](),_0x104490=_0x36d926-_0x1521c8;if(Math[_0x316be5(0x45d)](_0x104490)<0x1||_0x25aedf<=0x0){ytPlayer[_0x316be5(0x2bb)](_0x36d926);return;}const _0x3c1a70=performance[_0x316be5(0x291)]();await new Promise(_0x19b498=>{const _0x150e3f=_0x12b3ba=>{const _0x23d1f9=_0x1a06,_0x429079=Math[_0x23d1f9(0x368)](0x1,(_0x12b3ba-_0x3c1a70)/_0x25aedf),_0x56a8de=Math['round'](_0x1521c8+_0x104490*_0x429079);ytPlayer['setVolume'](_0x56a8de);if(_0x429079<0x1)requestAnimationFrame(_0x150e3f);else _0x19b498();};requestAnimationFrame(_0x150e3f);});}catch(_0x489313){}}async function ytFadeInPlay(_0x1838be=0xdc){const _0x223458=_0x336a98;try{const _0x4c4fdf=Math['max'](0x0,Math[_0x223458(0x368)](0x64,data&&data[_0x223458(0x35e)]&&data[_0x223458(0x35e)][_0x223458(0x267)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;ytPlayer[_0x223458(0x498)](),ytPlayer[_0x223458(0x337)]();try{ytPlayer[_0x223458(0x2bb)](0x0);}catch(_0x8c07d4){}await ytFadeTo(_0x4c4fdf,_0x1838be);}else{const _0x33762a=getActiveVideoId();_0x33762a&&fallbackLoadVideo(_0x33762a,{'autoplay':0x1,'mute':0x0});}}catch(_0x2e0dd2){}}async function ytFadeOutPause(_0x529822=0xb4){const _0x43c777=_0x336a98;try{const _0x530ff5=Math[_0x43c777(0x378)](0x0,Math[_0x43c777(0x368)](0x64,data&&data[_0x43c777(0x35e)]&&data[_0x43c777(0x35e)]['youtubeVolume']||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;await ytFadeTo(0x0,_0x529822);try{ytPlayer[_0x43c777(0x2f4)](),ytPlayer['setVolume'](_0x530ff5);}catch(_0x38e1af){}}else try{fallbackPause();}catch(_0x6ada86){}}catch(_0x21ab3a){}}async function updateYouTubePlayer(){const _0x29381b=_0x336a98,_0x391166=getActiveVideoId();if(data['settings'][_0x29381b(0x4b9)]&&_0x391166){const _0x35a737=_0x29381b(0x360)+_0x391166+_0x29381b(0x38f),_0x53eab6=new Image();_0x53eab6[_0x29381b(0x2de)]=async()=>{const _0x13d547=_0x29381b;data[_0x13d547(0x35e)]['customBg']=_0x35a737,await saveData(),applyCustomBg();},_0x53eab6[_0x29381b(0x2ff)]=async()=>{const _0x40a33b=_0x29381b,_0x5b5ba7=_0x40a33b(0x360)+_0x391166+_0x40a33b(0x46c);data[_0x40a33b(0x35e)][_0x40a33b(0x2d1)]=_0x5b5ba7,await saveData(),applyCustomBg();},_0x53eab6[_0x29381b(0x3b1)]=_0x35a737;}else!_0x391166&&(data[_0x29381b(0x35e)][_0x29381b(0x2d1)]='',await saveData(),applyCustomBg());if(IS_FILE_PROTOCOL){if(!_0x391166){fallbackStop(),hideSoundPermission();return;}const _0x4fe5bb=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x391166,{'autoplay':0x1,'mute':_0x4fe5bb});!_ytUnlocked&&showSoundPermission();return;}if(!ytPlayer||!ytPlayer[_0x29381b(0x3c5)]){try{ensureYouTubeAPI();}catch(_0x4101fe){}return;}if(!_0x391166){if(ytPlayer[_0x29381b(0x254)])ytPlayer['stopVideo']();hideSoundPermission();return;}ytPlayer[_0x29381b(0x3c5)](_0x391166),ytPlayer[_0x29381b(0x2bb)](data[_0x29381b(0x35e)][_0x29381b(0x267)]);}function toggleYtSound(){const _0x1ad0c3=_0x336a98;if(!_ytUnlocked){try{ensureAudio();}catch(_0xc9279b){}try{unlockAudioChain();}catch(_0x14dfe6){}return;}if(IS_FILE_PROTOCOL){const _0x569e82=getActiveVideoId();if(!ytFallbackFrame||!ytFallbackFrame[_0x1ad0c3(0x3e8)]){if(!_0x569e82){toast(_0x1ad0c3(0x249));return;}fallbackLoadVideo(_0x569e82,{'autoplay':0x1,'mute':0x0}),ytFallbackIsPlaying=!![];try{const _0x3fd828=document['getElementById'](_0x1ad0c3(0x4ff));if(_0x3fd828)_0x3fd828[_0x1ad0c3(0x3fc)]='⏸️';}catch(_0x3d5a96){}toast(_0x1ad0c3(0x463));return;}if(ytFallbackIsPlaying)fallbackPostMessage('pauseVideo'),ytFallbackIsPlaying=![],toast(_0x1ad0c3(0x4d8));else{if(!_0x569e82){toast(_0x1ad0c3(0x249));return;}fallbackPostMessage('playVideo'),ytFallbackIsPlaying=!![],toast(_0x1ad0c3(0x463));}try{const _0x161d4a=document[_0x1ad0c3(0x461)](_0x1ad0c3(0x4ff));if(_0x161d4a)_0x161d4a['textContent']=ytFallbackIsPlaying?'⏸️':'▶️';}catch(_0xc722a5){}return;}if(!ytPlayer||typeof ytPlayer[_0x1ad0c3(0x3fe)]!==_0x1ad0c3(0x25b)){try{ensureYouTubeAPI();}catch(_0x5c8d0a){}return;}const _0x53426e=ytPlayer[_0x1ad0c3(0x3fe)]();_0x53426e===YT[_0x1ad0c3(0x359)][_0x1ad0c3(0x31e)]||_0x53426e===YT[_0x1ad0c3(0x359)][_0x1ad0c3(0x504)]?(ytFadeOutPause(),ytUserPaused=!![],toast(_0x1ad0c3(0x4d8))):(ytFadeInPlay(),ytUserPaused=![],toast(_0x1ad0c3(0x463)));}function bindEvents(){const _0x702c64=_0x336a98;try{const _0xf8e7de=document['querySelector'](_0x702c64(0x386));_0xf8e7de&&(_0xf8e7de[_0x702c64(0x1ed)]=_0x702c64(0x2c8));}catch(_0x41d8b1){}on($(_0x702c64(0x4f9)),_0x702c64(0x3b9),toggleBackgroundView),on($('#btnMilestoneClose'),_0x702c64(0x3b9),()=>{const _0x4d2dfb=_0x702c64;$(_0x4d2dfb(0x2d3))['classList'][_0x4d2dfb(0x4f4)](_0x4d2dfb(0x32c));try{releaseFocus();}catch(_0x9382e1){}}),on($('#btnAddTopic'),_0x702c64(0x3b9),()=>showInputModal(_0x702c64(0x3be),async _0xd6dd27=>{const _0x51de9c=_0x702c64;if(!_0xd6dd27)return;data[_0x51de9c(0x38e)][_0x51de9c(0x1fd)]({'id':uid('t'),'name':_0xd6dd27,'subtopics':[]}),await saveData(),renderTopics();})),on($('#btnExport'),_0x702c64(0x3b9),()=>storageManager[_0x702c64(0x2e9)](data)),on($(_0x702c64(0x25f)),_0x702c64(0x34e),_0x152ccb=>{const _0x221f9b=_0x702c64,_0x1c9152=_0x152ccb['target'][_0x221f9b(0x35d)][0x0];if(!_0x1c9152)return;storageManager[_0x221f9b(0x482)](_0x1c9152)[_0x221f9b(0x493)](async _0x5b51e4=>{const _0x267319=_0x221f9b;data=_0x5b51e4,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),toast(_0x267319(0x35b)),renderAll();})[_0x221f9b(0x2dd)](_0x1172f4=>toast(_0x221f9b(0x4a0)+_0x1172f4['message'])),_0x152ccb[_0x221f9b(0x253)][_0x221f9b(0x301)]=null;}),on($(_0x702c64(0x40a)),_0x702c64(0x3b9),()=>{const _0x481970=_0x702c64,_0x4cbde9=$(_0x481970(0x350)),_0x1824a2=_0x4cbde9?_0x4cbde9[_0x481970(0x301)]:'';if(!_0x1824a2){toast('Vui\x20lòng\x20chọn\x20một\x20bản\x20sao\x20lưu.');return;}showConfirmModal(_0x481970(0x4cd),'Bạn\x20có\x20chắc\x20muốn\x20phục\x20hồi\x20dữ\x20liệu\x20từ\x20ngày\x20'+new Date(_0x1824a2)[_0x481970(0x2e7)]()+_0x481970(0x363),_0x1b7005=>{const _0x5bcd96=_0x481970;_0x1b7005&&storageManager[_0x5bcd96(0x4c2)](_0x1824a2)['then'](_0x591258=>{const _0x3c99dc=_0x5bcd96;data=_0x591258,toast(_0x3c99dc(0x4ef)),setTimeout(()=>window[_0x3c99dc(0x3cc)]['reload'](),0x5dc);})[_0x5bcd96(0x2dd)](_0x28b831=>{const _0x157a7c=_0x5bcd96;toast(_0x157a7c(0x3bf)+_0x28b831[_0x157a7c(0x414)]);});});}),on($('#set_theme_color'),_0x702c64(0x3f5),_0x5750a0=>{const _0x3f0190=_0x702c64,_0x408dd4=_0x5750a0[_0x3f0190(0x253)][_0x3f0190(0x301)];applyTheme(_0x408dd4);if(_0x408dd4==='light'||_0x408dd4==='pastel'){const _0x63ebc=$(_0x3f0190(0x260));_0x63ebc&&(_0x63ebc[_0x3f0190(0x369)]=![],toast(_0x3f0190(0x204),0x7d0));try{document[_0x3f0190(0x3d0)][_0x3f0190(0x225)][_0x3f0190(0x2c1)]('--bg-image',_0x3f0190(0x234));}catch(_0xc1e11c){}}else{const _0x315b8f=$(_0x3f0190(0x260));_0x315b8f&&(_0x315b8f[_0x3f0190(0x369)]=!![]);try{updateYouTubePlayer();}catch(_0x3a52dd){}}}),on($(_0x702c64(0x252)),_0x702c64(0x3b9),openSettings),on($(_0x702c64(0x24d)),_0x702c64(0x3b9),()=>{const _0x5b1d5c=_0x702c64;switchView('topics'),$(_0x5b1d5c(0x203))['click']();}),on($(_0x702c64(0x478)),_0x702c64(0x3b9),()=>{const _0x3a1623=_0x702c64;renderDashboard(),$(_0x3a1623(0x453))[_0x3a1623(0x39e)][_0x3a1623(0x4b0)](_0x3a1623(0x32c));}),on($(_0x702c64(0x46f)),'click',()=>{const _0x48e0b6=_0x702c64;$(_0x48e0b6(0x453))[_0x48e0b6(0x39e)]['remove'](_0x48e0b6(0x32c));}),on($(_0x702c64(0x2ea)),'click',closeSettings),on($(_0x702c64(0x2f3)),_0x702c64(0x3b9),saveSettings),on($('#btnDefaults'),_0x702c64(0x3b9),setDefaults),on($('#btnTestSound'),_0x702c64(0x3b9),()=>{const _0x3c3e1a=_0x702c64;ensureAudio(),playSound(_0x3c3e1a(0x4f8));}),on($(_0x702c64(0x306)),_0x702c64(0x3b9),_0x18e3c7=>{const _0x566a56=_0x702c64;_0x18e3c7[_0x566a56(0x423)]();const _0x3deaf9=$(_0x566a56(0x3c0));if(_0x3deaf9)_0x3deaf9['classList'][_0x566a56(0x340)](_0x566a56(0x2ab));}),on($(_0x702c64(0x500)),_0x702c64(0x3b9),async()=>{const _0x420038=_0x702c64,_0x3d285d=getCurrentSubtopic();if(!_0x3d285d)return;const _0x2d2ede=pendingNoteSessionId,_0x16a813=_0x3d285d['sessions'][_0x420038(0x292)](_0x164fb0=>_0x164fb0['id']===_0x2d2ede);_0x16a813&&(_0x16a813[_0x420038(0x4d6)]=$('#noteText')['value'][_0x420038(0x3a2)](),await saveData(),renderStatsHistory(),toast('Đã\x20lưu\x20ghi\x20chú')),closeNoteModal();}),on($(_0x702c64(0x3f4)),_0x702c64(0x3b9),()=>closeNoteModal()),on($(_0x702c64(0x35c)),_0x702c64(0x3b9),addGeneralNote),on($('#btnSummarizeNote'),_0x702c64(0x3b9),handleSummarizeNote),on($('#btnSendMessage'),_0x702c64(0x3b9),handleSendMessage),on($(_0x702c64(0x3e3)),'keydown',_0x178743=>{if(_0x178743['key']==='Enter')handleSendMessage();}),$$(_0x702c64(0x437))[_0x702c64(0x4ab)](_0x486cfb=>{on(_0x486cfb,'click',()=>{const _0xe72321=_0x1a06,_0x4e77b5=_0x486cfb['dataset'][_0xe72321(0x217)];$(_0xe72321(0x3e3))[_0xe72321(0x301)]=_0x4e77b5,$(_0xe72321(0x3e3))[_0xe72321(0x255)]();});}),on($(_0x702c64(0x34c)),'click',clearChat),on($(_0x702c64(0x390)),_0x702c64(0x3b9),addSubtopicTask),on($(_0x702c64(0x3db)),'keydown',_0x2560e4=>{const _0x13bdb7=_0x702c64;if(_0x2560e4[_0x13bdb7(0x375)]===_0x13bdb7(0x33d))addSubtopicTask();}),on($('#btnToggleYtSound'),_0x702c64(0x3b9),toggleYtSound),on($('#btnEnableSound'),_0x702c64(0x3b9),()=>{ensureAudio(),unlockAudioChain();}),on($('#ytSoundVolume'),_0x702c64(0x3f5),_0x315cbf=>{const _0x2f1a5f=_0x702c64,_0xea737c=parseInt(_0x315cbf[_0x2f1a5f(0x253)][_0x2f1a5f(0x301)],0xa);ytPlayer&&ytPlayer[_0x2f1a5f(0x2bb)]&&ytPlayer[_0x2f1a5f(0x2bb)](_0xea737c);}),on($('#set_youtubeUrl'),_0x702c64(0x3f5),handleYoutubeUrlInput),$$(_0x702c64(0x2a7))['forEach'](_0x2d73c4=>{const _0x292cf7=_0x702c64;_0x2d73c4[_0x292cf7(0x4f1)](_0x292cf7(0x3b9),()=>{const _0x1c65d8=_0x292cf7,_0x32d1e5=_0x2d73c4[_0x1c65d8(0x497)]['view'],_0x55d9e2=data?.['settings']?.['currentView']||_0x1c65d8(0x490);if(_0x55d9e2===_0x32d1e5&&_0x32d1e5!=='timer')switchView(_0x1c65d8(0x490));else switchView(_0x32d1e5);});}),$$(_0x702c64(0x388))['forEach'](_0x3f548f=>{const _0x35da83=_0x702c64;_0x3f548f['addEventListener'](_0x35da83(0x3b9),()=>{const _0xab5cff=_0x35da83,_0xa526de=_0x3f548f['dataset'][_0xab5cff(0x32a)],_0x3c587e=_0x3f548f[_0xab5cff(0x29c)]('.aux-panel,\x20.modal-card');if(!_0x3c587e)return;_0x3c587e[_0xab5cff(0x42e)](_0xab5cff(0x388))[_0xab5cff(0x4ab)](_0x251dce=>_0x251dce[_0xab5cff(0x39e)][_0xab5cff(0x4f4)](_0xab5cff(0x229))),_0x3f548f[_0xab5cff(0x39e)][_0xab5cff(0x4b0)](_0xab5cff(0x229)),_0x3c587e[_0xab5cff(0x42e)](_0xab5cff(0x50e))[_0xab5cff(0x4ab)](_0x48d57d=>{const _0x5f4fb5=_0xab5cff;_0x48d57d['classList'][_0x5f4fb5(0x4f4)](_0x5f4fb5(0x229)),_0x48d57d[_0x5f4fb5(0x225)][_0x5f4fb5(0x31b)]='none';});const _0x5ec9c4=_0x3c587e[_0xab5cff(0x20b)]('#'+_0xa526de);_0x5ec9c4&&(_0x5ec9c4[_0xab5cff(0x39e)][_0xab5cff(0x4b0)]('active'),_0x5ec9c4['style']['display']=_0xab5cff(0x4af),_0x3c587e[_0xab5cff(0x29c)](_0xab5cff(0x241))&&(_0x5ec9c4['style']['display']=_0xab5cff(0x4db)));});});const _0x5763c3=$('#methodEditorContentInput');function _0x18343a(_0x3c0949,_0x1aaa98=null){const _0x8df078=_0x702c64;try{document[_0x8df078(0x48e)]('styleWithCSS',![],!![]);}catch(_0x5d2a5e){}try{document[_0x8df078(0x48e)](_0x3c0949,![],_0x1aaa98);}catch(_0x6e24c6){}if(_0x5763c3)_0x5763c3[_0x8df078(0x255)]();}on($(_0x702c64(0x335)),_0x702c64(0x3b9),()=>_0x18343a(_0x702c64(0x507))),on($(_0x702c64(0x3d9)),_0x702c64(0x3b9),()=>_0x18343a(_0x702c64(0x317))),on($(_0x702c64(0x352)),'click',()=>_0x18343a(_0x702c64(0x39a),_0x702c64(0x4a6))),on($(_0x702c64(0x471)),_0x702c64(0x3b9),()=>_0x18343a('insertOrderedList')),on($('#toolBullet'),'click',()=>_0x18343a(_0x702c64(0x41f)));const _0x1f04be=$(_0x702c64(0x47d)),_0x4127f0=$(_0x702c64(0x33e));on($('#toolColor'),_0x702c64(0x3b9),_0x5c038a=>{const _0x431d72=_0x702c64;if(!_0x4127f0)return;_0x5c038a[_0x431d72(0x508)](),_0x4127f0[_0x431d72(0x39e)][_0x431d72(0x340)](_0x431d72(0x2ab));}),$$(_0x702c64(0x4a5))['forEach'](_0x59837a=>{const _0x24b707=_0x702c64;on(_0x59837a,_0x24b707(0x3b9),_0x1b4ebc=>{const _0x15eaef=_0x24b707;_0x1b4ebc[_0x15eaef(0x423)]();const _0x44838e=_0x59837a[_0x15eaef(0x497)][_0x15eaef(0x354)]||'';let _0x34be31=_0x44838e;try{const _0x579761=_0x44838e[_0x15eaef(0x397)](/--[a-zA-Z0-9_-]+/);if(_0x579761)_0x34be31=getComputedStyle(document[_0x15eaef(0x3d0)])[_0x15eaef(0x44c)](_0x579761[0x0])[_0x15eaef(0x3a2)]();}catch(_0x51b4d1){}_0x18343a(_0x15eaef(0x3dd),_0x34be31);if(_0x4127f0)_0x4127f0[_0x15eaef(0x39e)]['add'](_0x15eaef(0x2ab));});}),on(document,'click',_0x3e73e9=>{const _0x3a66ce=_0x702c64;if(!_0x1f04be||!_0x4127f0)return;!_0x1f04be[_0x3a66ce(0x3d4)](_0x3e73e9[_0x3a66ce(0x253)])&&!_0x4127f0[_0x3a66ce(0x39e)][_0x3a66ce(0x3d4)](_0x3a66ce(0x2ab))&&_0x4127f0[_0x3a66ce(0x39e)][_0x3a66ce(0x4b0)](_0x3a66ce(0x2ab));});function _0xb6c366(_0x1e1e34){const _0x5bef07=_0x702c64,_0x1f7052=getCurrentSubtopic();if(!_0x1f7052){toast(_0x5bef07(0x243));return;}_0x1f7052['methods']=Array[_0x5bef07(0x2d0)](_0x1f7052[_0x5bef07(0x257)])?_0x1f7052[_0x5bef07(0x257)]:[];const _0xb8b0b8=_0x1f7052['methods'],_0x2b5e11=_0x1e1e34?_0xb8b0b8[_0x5bef07(0x292)](_0x526db1=>_0x526db1['id']===_0x1e1e34):null;$(_0x5bef07(0x33a))['value']=_0x2b5e11&&_0x2b5e11['id']||'',$(_0x5bef07(0x2c4))[_0x5bef07(0x3fc)]=_0x2b5e11?_0x5bef07(0x345):_0x5bef07(0x43f),$(_0x5bef07(0x4e1))[_0x5bef07(0x301)]=_0x2b5e11&&_0x2b5e11[_0x5bef07(0x3d5)]||'';const _0x240171=$('#methodEditorContentInput');if(_0x240171)_0x240171['innerHTML']=_0x2b5e11&&_0x2b5e11['content']||'';$(_0x5bef07(0x2b7))['classList'][_0x5bef07(0x4b0)]('show');try{trapFocus($(_0x5bef07(0x2b7)));}catch(_0x3cc223){}try{const _0x4311f4=$(_0x5bef07(0x38c));if(_0x4311f4){const _0x3597cc=!!(data?.[_0x5bef07(0x35e)]?.[_0x5bef07(0x4d0)]&&data[_0x5bef07(0x35e)]['apiKey']['trim']());_0x4311f4[_0x5bef07(0x3ee)]=!_0x3597cc,_0x4311f4[_0x5bef07(0x3d5)]=_0x3597cc?_0x5bef07(0x28e):'Vui\x20lòng\x20thêm\x20Gemini\x20API\x20Key\x20trong\x20Cài\x20đặt\x20để\x20sử\x20dụng\x20tính\x20năng\x20này.';}}catch(_0x121bbd){}}on($(_0x702c64(0x294)),_0x702c64(0x3b9),()=>{const _0x6b3c65=_0x702c64;$('#modalMethodEditor')[_0x6b3c65(0x39e)][_0x6b3c65(0x4f4)](_0x6b3c65(0x32c));try{releaseFocus();}catch(_0x587871){}}),on($(_0x702c64(0x3a4)),_0x702c64(0x3b9),async()=>{const _0x1147b1=_0x702c64,_0x401ba5=getCurrentSubtopic();if(!_0x401ba5){toast(_0x1147b1(0x243));return;}_0x401ba5['methods']=Array[_0x1147b1(0x2d0)](_0x401ba5[_0x1147b1(0x257)])?_0x401ba5['methods']:[];const _0x40969d=$(_0x1147b1(0x33a))[_0x1147b1(0x301)]||uid('m'),_0x4229a4=($(_0x1147b1(0x4e1))['value']||'')[_0x1147b1(0x3a2)](),_0x529204=$(_0x1147b1(0x2df)),_0x3c3a53=_0x529204?_0x529204[_0x1147b1(0x1ed)]||'':'',_0x506311=_0x401ba5['methods'][_0x1147b1(0x2a8)](_0x367dd6=>_0x367dd6['id']===_0x40969d),_0xc61414={'id':_0x40969d,'title':_0x4229a4,'content':_0x3c3a53};if(_0x506311>=0x0)_0x401ba5[_0x1147b1(0x257)][_0x506311]=_0xc61414;else _0x401ba5[_0x1147b1(0x257)][_0x1147b1(0x3de)](_0xc61414);await storageManager['update']('subtopics',_0x401ba5),renderMethods(),$(_0x1147b1(0x2b7))[_0x1147b1(0x39e)][_0x1147b1(0x4f4)](_0x1147b1(0x32c));try{releaseFocus();}catch(_0x9f5b97){}}),on($(_0x702c64(0x38c)),'click',async()=>{const _0x298fac=_0x702c64,_0x55a944=$('#methodEditorContentInput');if(!_0x55a944)return;const _0x1c9d70=(_0x55a944[_0x298fac(0x3fc)]||'')[_0x298fac(0x3a2)]();if(!_0x1c9d70||_0x1c9d70[_0x298fac(0x3fd)]<0x14){toast(_0x298fac(0x2f9));return;}const _0x513c00=$(_0x298fac(0x38c));_0x513c00&&(_0x513c00['disabled']=!![],_0x513c00[_0x298fac(0x1ed)]=_0x298fac(0x42f));const _0x22fa29=_0x298fac(0x2f0)+_0x1c9d70+'\x22',_0x1b8e36=await callGeminiAPI(_0x22fa29);_0x1b8e36?(_0x55a944[_0x298fac(0x1ed)]=_0x1b8e36,toast(_0x298fac(0x231))):toast(_0x298fac(0x479)),_0x513c00&&(_0x513c00[_0x298fac(0x3ee)]=![],_0x513c00['innerHTML']='✨\x20Tự\x20động\x20định\x20dạng');}),on($(_0x702c64(0x296)),_0x702c64(0x3b9),()=>{const _0x53930a=_0x702c64;if(!getCurrentSubtopic()){toast(_0x53930a(0x243));return;}_0xb6c366();});const _0x1ea886=document[_0x702c64(0x20b)](_0x702c64(0x39c));_0x1ea886&&_0x1ea886[_0x702c64(0x4f1)](_0x702c64(0x3b9),_0x1ee19b=>{const _0x344bfb=_0x702c64,_0x594722=_0x1ee19b[_0x344bfb(0x253)][_0x344bfb(0x29c)]&&_0x1ee19b[_0x344bfb(0x253)]['closest'](_0x344bfb(0x3e6)),_0x598617=!_0x594722&&_0x1ee19b[_0x344bfb(0x253)]['closest']&&_0x1ee19b[_0x344bfb(0x253)][_0x344bfb(0x29c)]('.method-delete');if(_0x594722){_0x1ee19b['preventDefault'](),_0x1ee19b['stopPropagation']();const _0x247af4=_0x594722[_0x344bfb(0x497)]['id'];if(_0x247af4)_0xb6c366(_0x247af4);return;}if(_0x598617){_0x1ee19b[_0x344bfb(0x423)](),_0x1ee19b['stopPropagation']();const _0x327c4e=_0x598617[_0x344bfb(0x497)]['id'];if(!_0x327c4e)return;const _0x25d661=getCurrentSubtopic();if(!_0x25d661)return;_0x25d661[_0x344bfb(0x257)]=Array['isArray'](_0x25d661[_0x344bfb(0x257)])?_0x25d661['methods']:[];const _0x4e15b5=_0x25d661[_0x344bfb(0x257)][_0x344bfb(0x292)](_0x3b1fec=>_0x3b1fec['id']===_0x327c4e);if(!_0x4e15b5)return;showConfirmModal(_0x344bfb(0x2ce),_0x344bfb(0x327)+(_0x4e15b5['title']||'')+'\x22?',async _0x525855=>{const _0x2e9b8a=_0x344bfb;if(!_0x525855)return;_0x25d661[_0x2e9b8a(0x257)]=_0x25d661[_0x2e9b8a(0x257)]['filter'](_0x94683e=>_0x94683e['id']!==_0x327c4e),await storageManager['update'](_0x2e9b8a(0x47c),_0x25d661),renderMethods();});}});$$(_0x702c64(0x1f1))[_0x702c64(0x4ab)](_0x229b07=>{const _0x1f44d9=_0x702c64;_0x229b07[_0x1f44d9(0x4f1)]('click',()=>{const _0x41a8a6=_0x1f44d9;editingPreset=_0x229b07[_0x41a8a6(0x497)][_0x41a8a6(0x4a7)],highlightPresetSelector(),loadEditingPresetFields();});}),$$(_0x702c64(0x462))[_0x702c64(0x4ab)](_0x26d5d0=>{const _0x310c25=_0x702c64;_0x26d5d0[_0x310c25(0x4f1)](_0x310c25(0x3b9),_0x3577a9=>{const _0x36fc1f=_0x310c25,_0xaf04d7=_0x3577a9[_0x36fc1f(0x253)][_0x36fc1f(0x497)][_0x36fc1f(0x4e6)],_0x255f7f=data['settings'][_0x36fc1f(0x4e6)];if(_0xaf04d7===_0x255f7f)return;timer[_0x36fc1f(0x2c7)]!==_0x36fc1f(0x49f)?showConfirmModal('Xác\x20nhận\x20chuyển\x20đổi',_0x36fc1f(0x40b)+_0xaf04d7+_0x36fc1f(0x366),_0x3ca305=>{const _0x527e9f=_0x36fc1f;_0x3ca305&&(timer[_0x527e9f(0x28f)](),timer[_0x527e9f(0x318)](_0xaf04d7),renderAll(),toast('Đã\x20chuyển\x20sang\x20Kiểu\x20'+_0xaf04d7+'.'));}):(timer[_0x36fc1f(0x318)](_0xaf04d7),renderAll(),toast(_0x36fc1f(0x2a2)+_0xaf04d7+'.'));});}),on($(_0x702c64(0x3a5)),_0x702c64(0x3b9),()=>timer[_0x702c64(0x3ac)]()),on($(_0x702c64(0x237)),_0x702c64(0x3b9),()=>timer[_0x702c64(0x33c)]()),on($('#btnPause'),_0x702c64(0x3b9),()=>timer[_0x702c64(0x3c2)]()),on($(_0x702c64(0x207)),_0x702c64(0x3b9),()=>timer[_0x702c64(0x36f)]()),on($(_0x702c64(0x367)),_0x702c64(0x3b9),()=>timer['skip']()),on($(_0x702c64(0x280)),_0x702c64(0x3b9),()=>timer[_0x702c64(0x28f)]()),on($(_0x702c64(0x4de)),_0x702c64(0x3b9),()=>timer[_0x702c64(0x288)]()),on($(_0x702c64(0x357)),_0x702c64(0x34e),_0x4c635d=>{const _0x47f3ff=_0x702c64;handleFileUpload(_0x4c635d[_0x47f3ff(0x253)][_0x47f3ff(0x35d)][0x0],async _0x2b6af7=>{const _0x2f5bb5=_0x47f3ff;data[_0x2f5bb5(0x35e)][_0x2f5bb5(0x2d1)]=_0x2b6af7,await saveData(),applyCustomBg(),toast(_0x2f5bb5(0x240));}),_0x4c635d[_0x47f3ff(0x253)][_0x47f3ff(0x301)]=null;}),on($('#btnClearBg'),_0x702c64(0x3b9),async()=>{const _0x101096=_0x702c64;data[_0x101096(0x35e)][_0x101096(0x2d1)]='',data[_0x101096(0x35e)][_0x101096(0x4b9)]=![],await saveData(),applyCustomBg(),toast('Đã\x20xóa\x20hình\x20nền\x20tùy\x20chỉnh.'),$('#modalSettings')[_0x101096(0x39e)][_0x101096(0x3d4)](_0x101096(0x32c))&&openSettings();}),on($('#uploadSoundWork'),_0x702c64(0x34e),_0x54c098=>{const _0x4b435b=_0x702c64;handleFileUpload(_0x54c098[_0x4b435b(0x253)][_0x4b435b(0x35d)][0x0],async _0x562578=>{const _0x563d0a=_0x4b435b;data['settings'][_0x563d0a(0x37b)][_0x563d0a(0x4f8)]=_0x562578,await saveData(),toast('Đã\x20lưu\x20âm\x20báo\x20hết\x20LÀM\x20VIỆC.');}),_0x54c098[_0x4b435b(0x253)][_0x4b435b(0x301)]=null;}),on($(_0x702c64(0x50b)),'change',_0x5e13e1=>{const _0xc9fbab=_0x702c64;handleFileUpload(_0x5e13e1[_0xc9fbab(0x253)][_0xc9fbab(0x35d)][0x0],async _0x2b45ef=>{const _0xddb5=_0xc9fbab;data[_0xddb5(0x35e)][_0xddb5(0x37b)][_0xddb5(0x29f)]=_0x2b45ef,await saveData(),toast('Đã\x20lưu\x20âm\x20báo\x20hết\x20NGHỈ\x20NGẮN.');}),_0x5e13e1[_0xc9fbab(0x253)][_0xc9fbab(0x301)]=null;}),on($(_0x702c64(0x3ec)),'change',_0x1c3946=>{const _0x291003=_0x702c64;handleFileUpload(_0x1c3946['target']['files'][0x0],async _0x229acf=>{const _0x52c0d1=_0x1a06;data['settings'][_0x52c0d1(0x37b)][_0x52c0d1(0x4c5)]=_0x229acf,await saveData(),toast(_0x52c0d1(0x3f0));}),_0x1c3946['target'][_0x291003(0x301)]=null;}),on($(_0x702c64(0x391)),_0x702c64(0x3b9),toggleFullScreen),document[_0x702c64(0x4f1)](_0x702c64(0x20c),updateFullscreenButton),window[_0x702c64(0x4f1)](_0x702c64(0x4f5),_0x38d213=>{const _0x58ddd7=_0x702c64,_0x1ca64e=_0x38d213[_0x58ddd7(0x253)],_0x21c056=(_0x1ca64e['tagName']||'')[_0x58ddd7(0x281)](),_0x42adbd=[_0x58ddd7(0x3f5),_0x58ddd7(0x2ed),_0x58ddd7(0x28d)][_0x58ddd7(0x2c3)](_0x21c056)||_0x1ca64e[_0x58ddd7(0x4fe)];if(_0x38d213[_0x58ddd7(0x3e1)]===_0x58ddd7(0x2fc)&&!_0x42adbd){_0x38d213[_0x58ddd7(0x423)]();if(timer[_0x58ddd7(0x2c7)]===_0x58ddd7(0x49f)||timer[_0x58ddd7(0x2c7)]==='paused')timer[_0x58ddd7(0x3ac)]();else timer['pause']();}(_0x38d213['key']==='n'||_0x38d213[_0x58ddd7(0x375)]==='N')&&(!_0x42adbd&&(_0x38d213['preventDefault'](),timer[_0x58ddd7(0x305)]()));if(_0x38d213[_0x58ddd7(0x375)]===_0x58ddd7(0x41b)){$$(_0x58ddd7(0x1f0))[_0x58ddd7(0x4ab)](_0x19be4c=>_0x19be4c[_0x58ddd7(0x39e)][_0x58ddd7(0x4f4)]('show'));try{releaseFocus();}catch(_0x28f6df){}}if(_0x38d213[_0x58ddd7(0x262)]&&!_0x42adbd){if(_0x38d213[_0x58ddd7(0x375)]===_0x58ddd7(0x395))_0x38d213[_0x58ddd7(0x423)](),_0x3f56cd(0x0,-0xa);else{if(_0x38d213[_0x58ddd7(0x375)]==='ArrowDown')_0x38d213[_0x58ddd7(0x423)](),_0x3f56cd(0x0,0xa);else{if(_0x38d213[_0x58ddd7(0x375)]==='ArrowLeft')_0x38d213['preventDefault'](),_0x3f56cd(-0xa,0x0);else _0x38d213['key']===_0x58ddd7(0x23d)&&(_0x38d213[_0x58ddd7(0x423)](),_0x3f56cd(0xa,0x0));}}}}),$$(_0x702c64(0x1f0))[_0x702c64(0x4ab)](_0x3788e4=>_0x3788e4[_0x702c64(0x4f1)](_0x702c64(0x3b9),_0x26905d=>{const _0x8b23fe=_0x702c64;if(_0x26905d&&_0x26905d[_0x8b23fe(0x253)]&&_0x26905d[_0x8b23fe(0x253)]['id']===_0x8b23fe(0x396))return;if(_0x26905d[_0x8b23fe(0x253)]===_0x3788e4){_0x3788e4[_0x8b23fe(0x39e)][_0x8b23fe(0x4f4)]('show');try{releaseFocus();}catch(_0x1415a5){}}})),window[_0x702c64(0x4f1)](_0x702c64(0x3b9),_0x1b36d3=>{const _0x53c482=_0x702c64;!_0x1b36d3[_0x53c482(0x253)]['closest'](_0x53c482(0x484))&&!_0x1b36d3[_0x53c482(0x253)][_0x53c482(0x29c)](_0x53c482(0x2a4))&&closeAllMenus();});try{const _0x157394=document[_0x702c64(0x20b)](_0x702c64(0x4df));if(_0x157394)_0x157394[_0x702c64(0x4f1)](_0x702c64(0x282),closeAllMenus);}catch(_0x2e5369){}try{window['addEventListener']('scroll',closeAllMenus,!![]);}catch(_0x47b0e0){}window[_0x702c64(0x4f1)](_0x702c64(0x47a),()=>timer['persistTimerState'](!![]));try{const _0x10fd18=Array[_0x702c64(0x36a)](document[_0x702c64(0x42e)]('#view-methods\x20.method-item'));_0x10fd18['length']&&_0x10fd18[_0x702c64(0x4ab)](_0x291eaa=>{const _0x1b2918=_0x702c64;_0x291eaa[_0x1b2918(0x4f1)](_0x1b2918(0x340),()=>{_0x291eaa['open']&&_0x10fd18['forEach'](_0x561781=>{const _0xe0fb08=_0x1a06;if(_0x561781!==_0x291eaa)_0x561781[_0xe0fb08(0x247)]=![];});});});}catch(_0x17460d){}const _0x3be1bc=$(_0x702c64(0x3f1));let _0x295eba=![],_0x423f12,_0xb651e3;_0x3be1bc&&(_0x3be1bc[_0x702c64(0x4f1)](_0x702c64(0x4d5),_0x5cf7d5=>{const _0x8c8d2c=_0x702c64;_0x295eba=!![];const _0x2bca6b=_0x3be1bc[_0x8c8d2c(0x27f)]();_0x423f12=_0x5cf7d5[_0x8c8d2c(0x3b3)]-_0x2bca6b[_0x8c8d2c(0x43e)],_0xb651e3=_0x5cf7d5['clientY']-_0x2bca6b['top'],_0x3be1bc['style'][_0x8c8d2c(0x373)]=_0x8c8d2c(0x234);}),document['addEventListener'](_0x702c64(0x297),_0x246b73=>{const _0xc02aa0=_0x702c64;if(!_0x295eba)return;let _0x49dcef=_0x246b73[_0xc02aa0(0x3b3)]-_0x423f12,_0x581eee=_0x246b73[_0xc02aa0(0x320)]-_0xb651e3;const _0x4afd3c=window[_0xc02aa0(0x21b)]-_0x3be1bc['offsetWidth'],_0x776dcc=window['innerHeight']-_0x3be1bc['offsetHeight'];_0x49dcef=Math['max'](0x0,Math[_0xc02aa0(0x368)](_0x49dcef,_0x4afd3c)),_0x581eee=Math[_0xc02aa0(0x378)](0x0,Math[_0xc02aa0(0x368)](_0x581eee,_0x776dcc)),_0x3be1bc[_0xc02aa0(0x225)][_0xc02aa0(0x43e)]=_0x49dcef+'px',_0x3be1bc[_0xc02aa0(0x225)][_0xc02aa0(0x4ca)]=_0x581eee+'px',_0x3be1bc[_0xc02aa0(0x225)][_0xc02aa0(0x42b)]=_0xc02aa0(0x39d),_0x3be1bc[_0xc02aa0(0x225)][_0xc02aa0(0x2cb)]='auto';}),document[_0x702c64(0x4f1)](_0x702c64(0x315),()=>{const _0x3ef34f=_0x702c64;if(!_0x295eba)return;_0x295eba=![],_0x3be1bc['style'][_0x3ef34f(0x373)]='';}));function _0x1896e5(_0xff13be){const _0x52d61c=_0x702c64,_0xf33647=$(_0x52d61c(0x3f1));if(!_0xf33647)return;_0xf33647['style']['position']=_0x52d61c(0x2b3),_0xf33647[_0x52d61c(0x225)]['transition']='',_0xf33647['style'][_0x52d61c(0x43e)]=_0x52d61c(0x39d),_0xf33647[_0x52d61c(0x225)][_0x52d61c(0x4ca)]=_0x52d61c(0x39d),_0xf33647[_0x52d61c(0x225)]['right']=_0x52d61c(0x39d),_0xf33647[_0x52d61c(0x225)][_0x52d61c(0x42b)]=_0x52d61c(0x39d);const _0x257453=0x10;_0xff13be==='tl'&&(_0xf33647['style'][_0x52d61c(0x43e)]=_0x257453+'px',_0xf33647[_0x52d61c(0x225)]['top']=_0x257453+'px'),_0xff13be==='tr'&&(_0xf33647[_0x52d61c(0x225)][_0x52d61c(0x2cb)]=_0x257453+'px',_0xf33647[_0x52d61c(0x225)][_0x52d61c(0x4ca)]=_0x257453+'px'),_0xff13be==='bl'&&(_0xf33647[_0x52d61c(0x225)][_0x52d61c(0x43e)]=_0x257453+'px',_0xf33647[_0x52d61c(0x225)][_0x52d61c(0x42b)]=_0x257453+'px'),_0xff13be==='br'&&(_0xf33647[_0x52d61c(0x225)][_0x52d61c(0x2cb)]=_0x257453+'px',_0xf33647['style'][_0x52d61c(0x42b)]=_0x257453+'px');}function _0x3f56cd(_0x212a42,_0x27fd7b){const _0x236bdb=_0x702c64,_0x20e4d=$(_0x236bdb(0x3f1));if(!_0x20e4d)return;const _0x136da9=_0x20e4d['getBoundingClientRect'](),_0x28f600=Math[_0x236bdb(0x378)](0x0,Math[_0x236bdb(0x368)](_0x136da9['left']+_0x212a42,window[_0x236bdb(0x21b)]-_0x20e4d['offsetWidth'])),_0x3dbcc3=Math[_0x236bdb(0x378)](0x0,Math['min'](_0x136da9['top']+_0x27fd7b,window[_0x236bdb(0x3fb)]-_0x20e4d[_0x236bdb(0x37c)]));_0x20e4d[_0x236bdb(0x225)][_0x236bdb(0x43e)]=_0x28f600+'px',_0x20e4d[_0x236bdb(0x225)]['top']=_0x3dbcc3+'px',_0x20e4d['style'][_0x236bdb(0x2cb)]=_0x236bdb(0x39d),_0x20e4d[_0x236bdb(0x225)]['bottom']=_0x236bdb(0x39d);}}function toggleBackgroundView(){const _0x4bfc3d=_0x336a98,_0x4ab559=document['body'];_0x4ab559['classList']['toggle'](_0x4bfc3d(0x475));const _0x363d63=_0x4ab559['classList'][_0x4bfc3d(0x3d4)]('bg-view-mode'),_0x18e237=$(_0x4bfc3d(0x4f9));if(!_0x18e237)return;_0x363d63?(_0x18e237['title']='Hiện\x20giao\x20diện',_0x18e237['innerHTML']=_0x4bfc3d(0x444)):(_0x18e237[_0x4bfc3d(0x3d5)]=_0x4bfc3d(0x49e),_0x18e237[_0x4bfc3d(0x1ed)]=_0x4bfc3d(0x313));}function updateMainViewVisibility(){const _0x5a4c4e=_0x336a98,_0x3b99b5=!!getCurrentSubtopic(),_0x5d846d=$(_0x5a4c4e(0x338)),_0x3c246e=$(_0x5a4c4e(0x2db));_0x3c246e&&_0x3c246e['classList'][_0x5a4c4e(0x340)](_0x5a4c4e(0x2ab),_0x3b99b5),_0x5d846d&&(_0x3b99b5?_0x5d846d[_0x5a4c4e(0x39e)][_0x5a4c4e(0x4f4)](_0x5a4c4e(0x2cd)):_0x5d846d[_0x5a4c4e(0x39e)]['add'](_0x5a4c4e(0x2cd)));}function updatePresetButtonsText(){const _0x2bc293=_0x336a98,_0x548287=data[_0x2bc293(0x35e)],_0x83911c=_0x548287['cyclesA'],_0xb9f4bf=_0x548287[_0x2bc293(0x274)],_0x63be4=_0x548287[_0x2bc293(0x4f2)][_0x2bc293(0x24c)],_0x91382a=_0x548287[_0x2bc293(0x4f2)][_0x2bc293(0x355)],_0x5f1cc9=$('#btnPresetA'),_0x19d798=$('#btnPresetB'),_0x1629b8=$(_0x2bc293(0x4fb));_0x5f1cc9&&(_0x5f1cc9[_0x2bc293(0x3fc)]=_0x83911c+'×'+_0x63be4+_0x2bc293(0x2d6)),_0x19d798&&(_0x19d798['textContent']=_0xb9f4bf+'×'+_0x91382a+_0x2bc293(0x1fe)),_0x1629b8&&(_0x1629b8[_0x2bc293(0x3fc)]='🌊\x20Flow');}function renderAll(){const _0x3a7a0f=_0x336a98;updatePresetButtonsText();const _0x3d0644=data[_0x3a7a0f(0x35e)][_0x3a7a0f(0x4e6)];$$('.presets\x20button')[_0x3a7a0f(0x4ab)](_0x563bc3=>{const _0x49eb95=_0x3a7a0f,_0x1def5b=_0x563bc3['dataset'][_0x49eb95(0x4e6)]===_0x3d0644;_0x563bc3[_0x49eb95(0x39e)]['toggle'](_0x49eb95(0x445),_0x1def5b),_0x563bc3[_0x49eb95(0x39e)][_0x49eb95(0x340)](_0x49eb95(0x28b),!_0x1def5b),_0x563bc3['setAttribute']('aria-pressed',_0x1def5b);}),updateMainViewVisibility(),timer[_0x3a7a0f(0x318)](data['settings'][_0x3a7a0f(0x4e6)],{'silent':!![]}),renderTopics(),renderContextBadge(),renderStatsHistory(),renderGeneralNotes(),renderMethods(),renderChat(),applyCustomBg(),applyPanelOpacity(),renderSubtopicTasks(),updateFullscreenButton(),switchView(data[_0x3a7a0f(0x35e)][_0x3a7a0f(0x4ee)]);}function toggleFullScreen(){const _0x281d76=_0x336a98;!document['fullscreenElement']?document[_0x281d76(0x3d6)][_0x281d76(0x232)]()['catch'](_0x514fb9=>{const _0x37cf3e=_0x281d76;toast(_0x37cf3e(0x246)+_0x514fb9[_0x37cf3e(0x414)]);}):document[_0x281d76(0x4be)]&&document[_0x281d76(0x4be)]();}function updateFullscreenButton(){const _0x5c26e8=_0x336a98,_0x374188=$(_0x5c26e8(0x391));document['fullscreenElement']?(_0x374188[_0x5c26e8(0x1ed)]='↙️',_0x374188[_0x5c26e8(0x3d5)]='Thoát\x20toàn\x20màn\x20hình'):(_0x374188[_0x5c26e8(0x1ed)]='↗️',_0x374188[_0x5c26e8(0x3d5)]=_0x5c26e8(0x323));}async function initializeApp(){const _0x10272c=_0x336a98;try{await storageManager[_0x10272c(0x31c)]();const [_0x13ad93,_0x36e594,_0x271ca3]=await Promise[_0x10272c(0x4e7)]([storageManager[_0x10272c(0x45c)](),storageManager[_0x10272c(0x495)](_0x10272c(0x38e)),storageManager[_0x10272c(0x495)](_0x10272c(0x47c))]);let _0x429fb5;if(!_0x13ad93){const _0x2c278b=JSON[_0x10272c(0x235)](JSON[_0x10272c(0x22c)](defaults));await storageManager[_0x10272c(0x4c3)](_0x2c278b[_0x10272c(0x35e)]);for(const _0x243df2 of _0x2c278b[_0x10272c(0x38e)]){const {subtopics:_0x3d33dd,..._0x298f73}=_0x243df2;await storageManager[_0x10272c(0x4b0)](_0x10272c(0x38e),_0x298f73);for(const _0x46cf93 of _0x3d33dd){await storageManager['add']('subtopics',{..._0x46cf93,'topicId':_0x243df2['id']});}}_0x429fb5=_0x2c278b;}else{const _0x242f10={};for(const _0x58df42 of _0x36e594)_0x242f10[_0x58df42['id']]={..._0x58df42,'subtopics':[]};for(const _0x54f1f2 of _0x271ca3)_0x242f10[_0x54f1f2[_0x10272c(0x4cb)]]?.[_0x10272c(0x47c)][_0x10272c(0x1fd)](_0x54f1f2);_0x429fb5={'version':defaults['version'],'settings':_0x13ad93,'topics':Object[_0x10272c(0x25d)](_0x242f10)};}data=window[_0x10272c(0x407)]=_0x429fb5,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),renderAll();try{storageManager[_0x10272c(0x4c9)](data);}catch(_0xd3b970){console[_0x10272c(0x277)](_0x10272c(0x251),_0xd3b970);}bindEvents(),applyTheme();}catch(_0x202ef3){console[_0x10272c(0x258)](_0x10272c(0x308),_0x202ef3),toast(_0x10272c(0x2ad)+_0x202ef3[_0x10272c(0x414)]);}}callGeminiAPI=async function(_0x4a5910,_0x2c30ff=0x3,_0x20923d=0x3e8){const _0xcde63=_0x336a98,_0x350263=data?.[_0xcde63(0x35e)]?.[_0xcde63(0x4d0)]||'';if(!_0x350263)return toast(_0xcde63(0x418)),null;const _0x55e7c8='https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key='+_0x350263,_0x5c0cb1={'contents':[{'role':_0xcde63(0x472),'parts':[{'text':_0x4a5910}]}]};try{const _0x3bbf6c=await fetch(_0x55e7c8,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON[_0xcde63(0x22c)](_0x5c0cb1)});if(!_0x3bbf6c['ok']){if(_0x3bbf6c['status']===0x1ad&&_0x2c30ff>0x0)return await new Promise(_0x48d62f=>setTimeout(_0x48d62f,_0x20923d)),callGeminiAPI(_0x4a5910,_0x2c30ff-0x1,_0x20923d*0x2);let _0x3b35a6=null;try{_0x3b35a6=await _0x3bbf6c[_0xcde63(0x3dc)]();}catch(_0x47a194){}let _0x57d98a=_0xcde63(0x21a)+_0x3bbf6c['status'];if(_0x3bbf6c[_0xcde63(0x2d4)]===0x190)_0x57d98a=_0xcde63(0x2b9);else{if(_0x3bbf6c[_0xcde63(0x2d4)]===0x1ad)_0x57d98a=_0xcde63(0x41a);else _0x3b35a6?.[_0xcde63(0x258)]?.[_0xcde63(0x414)]&&(_0x57d98a=_0xcde63(0x27a)+_0x3b35a6['error'][_0xcde63(0x414)]);}return toast(_0x57d98a,0xfa0),console['error']('Gemini\x20API\x20Error:',_0x3b35a6||_0x3bbf6c['statusText']),null;}const _0x1c71f9=await _0x3bbf6c[_0xcde63(0x3dc)]();if(_0x1c71f9['candidates']&&_0x1c71f9['candidates'][0x0]?.[_0xcde63(0x4ea)]?.[_0xcde63(0x226)]?.[0x0]?.[_0xcde63(0x4fa)])return formatGeminiResponse(_0x1c71f9[_0xcde63(0x206)][0x0]['content'][_0xcde63(0x226)][0x0][_0xcde63(0x4fa)]);else{console[_0xcde63(0x258)](_0xcde63(0x50f),_0x1c71f9);if(_0x1c71f9[_0xcde63(0x326)]?.[_0xcde63(0x3c4)])return _0xcde63(0x307)+_0x1c71f9['promptFeedback'][_0xcde63(0x3c4)]+'.\x20Vui\x20lòng\x20thử\x20lại\x20với\x20nội\x20dung\x20khác.';return _0xcde63(0x49b);}}catch(_0x5b29ee){return console['error']('Lỗi\x20khi\x20gọi\x20Gemini\x20API:',_0x5b29ee),toast(_0xcde63(0x27d),0xfa0),null;}},loadLanguage(localStorage[_0x336a98(0x2c0)](_0x336a98(0x24f))||'vi')[_0x336a98(0x493)](initializeApp);
    </script>
</body>
</html>

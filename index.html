<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="·ª®ng d·ª•ng Pomodoro h·ªó tr·ª£ h·ªçc t·∫≠p v·ªõi t√≠ch h·ª£p Gemini AI v√† giao di·ªán hi·ªán ƒë·∫°i." />
    <title>Pomodoro Study App ‚Äî T√≠ch h·ª£p Gemini AI (Giao di·ªán m·ªõi)</title>
    <style>
    /*
    =============================================
    POMODORO STUDY APP ‚Äî PHI√äN B·∫¢N GIAO DI·ªÜN T·∫¨P TRUNG (v1.0)
    =============================================
    */

    :root {
      /* Theme Dark (M·∫∑c ƒë·ªãnh) - C·∫≠p nh·∫≠t t·ª´ file 2 */
      --bg: #0f1222;
      --panel: #171a2e;
      --panel-rgb: 23, 26, 46; /* Th√™m bi·∫øn RGB cho panel */
      --muted: #212646;
      --text: #f4f6ff;
      --sub: #b7c1ff;
      --acc: #6c8cff;
      --acc-rgb: 108, 140, 255;
      --acc-2: #27d3a2;
      --purple: #a78bfa;
      --warn: #ffb020;
      --danger: #ff5c7a;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.054), 0px 4.3px 5.3px rgba(0, 0, 0, 0.077), 0px 8.1px 10px rgba(0, 0, 0, 0.095), 0px 14.5px 17.9px rgba(0, 0, 0, 0.113), 0px 27.2px 33.4px rgba(0, 0, 0, 0.136), 0px 65px 80px rgba(0, 0, 0, 0.19);
      --radius: 16px;
      --panel-opacity: 0.85;
      --gradient-border: linear-gradient(135deg, var(--acc), var(--acc-2));
    }
    
    /* === START: TH√äM C√ÅC THEME M·ªöI === */
    [data-theme='light'] {
      --bg: #f5f0e8; --panel: #ffffff; --panel-rgb: 255, 255, 255; --muted: #eaddcf; --text: #4a4a4a; --sub: #8a817c; --acc: #d4a373; --acc-rgb: 212, 163, 115; --acc-2: #a3b18a; --warn: #e76f51; --danger: #d00000;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.024), 0px 4.3px 5.3px rgba(0, 0, 0, 0.037), 0px 8.1px 10px rgba(0, 0, 0, 0.045), 0px 14.5px 17.9px rgba(0, 0, 0, 0.053), 0px 27.2px 33.4px rgba(0, 0, 0, 0.066), 0px 65px 80px rgba(0, 0, 0, 0.09);
      --panel-opacity: 0.9;
      /* NgƒÉn n·ªÅn t·ªëi m·∫∑c ƒë·ªãnh khi kh√¥ng c√≥ ·∫£nh */
      --bg-image: none;
    }

    [data-theme='pastel'] {
      --bg: #fde2e4; --panel: #fff1f2; --panel-rgb: 255, 241, 242; --muted: #fad2e1; --text: #595260; --sub: #8c7a8a; --acc: #c78283; --acc-rgb: 199, 130, 131; --acc-2: #7ec4cf; --warn: #f9bf45; --danger: #d7263d;
      --shadow: 0 5px 20px rgba(200,150,150,0.2);
      --panel-opacity: 0.9;
      /* NgƒÉn n·ªÅn t·ªëi m·∫∑c ƒë·ªãnh khi kh√¥ng c√≥ ·∫£nh */
      --bg-image: none;
    }
    
    [data-theme='lofi'] {
      --bg: #2a2a3e; --panel: #3c3c52; --panel-rgb: 60, 60, 82; --muted: #4d4d66; --text: #e0e0ff; --sub: #a0a0c0; --acc: #ff8c69; --acc-rgb: 255, 140, 105; --acc-2: #69c6ff; --warn: #ffd700; --danger: #ff6961;
      /* === Replaced external GIF with inline data URI (offline-safe) === */
      --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9J2cnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAlJyBzdG9wLWNvbG9yPScjMmEyYTNlJy8+PHN0b3Agb2Zmc2V0PScxMDAlJyBzdG9wLWNvbG9yPScjM2MzYzUyJy8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9JzEwMCUnIGhlaWdodD0nMTAwJScgZmlsbD0ndXJsKCNnKScvPjwvc3ZnPg==');
      --panel-opacity: 0.8;
    }
    
    [data-theme='space'] {
        --bg: #000000; --panel: #1a1a2e; --panel-rgb: 26, 26, 46; --muted: #2a2a4e; --text: #e0e0ff; --sub: #b0b0e0; --acc: #00aaff; --acc-rgb: 0, 170, 255; --acc-2: #aaff00; --warn: #ffaa00; --danger: #ff0055;
        /* === Replaced external GIF with inline data URI (offline-safe) === */
        --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9J2cnIGN4PSc1MCUnIGN5PSc0MCUnIHI9JzcwJSc+PHN0b3Agb2Zmc2V0PScwJScgc3RvcC1jb2xvcj0nIzBiMGIxYScvPjxzdG9wIG9mZnNldD0nMTAwJScgc3RvcC1jb2xvcj0nIzAwMDAwMCcvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZpbGw9J3VybCgjZyknLz48L3N2Zz4=');
        --panel-opacity: 0.75;
    }
    /* === END: TH√äM C√ÅC THEME M·ªöI === */

    *:focus-visible {
      outline: 2px solid var(--acc); outline-offset: 2px; border-radius: 4px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin:0; 
      font-family: system-ui, -apple-system, 'Segoe UI Variable', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Inter', sans-serif; 
      
      background-color: var(--bg);
      background-image: var(--bg-image, radial-gradient(1200px 800px at 10% -10%, #20285b 0%, #0f1222 50%, #0b0e1a 100%));
      
      background-size: cover; 
      background-position: center; 
      color:var(--text); 
      transition: background 0.5s ease, color 0.5s ease, filter 0.5s ease;
      text-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    a{color:var(--acc)}

    .app{display:flex; min-height:100vh}
    
    .app-nav {
        width: 60px;
        padding: 16px 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
        z-index: 100;
    }
    .nav-btn {
        background: transparent;
        border: none;
        color: var(--sub);
        width: 44px;
        height: 44px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all .2s ease;
        position: relative;
    }
    .nav-btn:hover { background: var(--muted); color: var(--text); }
    .nav-btn.active { background: var(--acc); color: white; }
    .nav-btn svg { width: 24px; height: 24px; }
    .nav-btn .tooltip {
        position: absolute;
        left: 110%;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        box-shadow: var(--shadow);
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        pointer-events: none;
        z-index: 200;
    }
    .nav-btn:hover .tooltip { opacity: 1; visibility: visible; }

    .app-content {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        max-height: 100vh;
    }

    .view { display: none; }
    .view.active { display: grid; gap: 24px; animation: fadeIn .3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .main.reloading { opacity: 0; transition: opacity 0.2s ease-out; }

    .panel-bg{
        background: rgba(23, 26, 46, var(--panel-opacity));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border:1px solid rgba(255,255,255,.08);
    }
    /* Th√™m c√°c quy t·∫Øc border cho theme light/pastel */
    [data-theme='light'] .panel-bg, [data-theme='pastel'] .panel-bg { border:1px solid rgba(0,0,0,0.05); }
    [data-theme='lofi'] .panel-bg { border:1px solid rgba(255,255,255,0.1); }
    [data-theme='space'] .panel-bg { border:1px solid rgba(255,255,255,0.12); }


header.app-header{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-radius:var(--radius); box-shadow:var(--shadow); margin-bottom: 24px; position: relative; z-index: 2000;}
    header .actions{display:flex; gap:8px; align-items:center}
    
    .btn {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text);
      border: none; /* S·ª≠a ƒë·ªïi: b·ªè border m·∫∑c ƒë·ªãnh */
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,0.08);
      font-weight: 600;
      transition: all .15s ease;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        border: 2px solid transparent; border-radius: 12px; background: var(--gradient-border) border-box;
        -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: destination-out; mask-composite: exclude; opacity: 0; transition: opacity 0.3s ease;
    }
    .btn:hover::before { opacity: 1; }
    .btn:hover { background: rgba(255, 255, 255, 0.12); }
    .btn:active { transform: translateY(1px) scale(0.98); filter: brightness(1); }
    .btn:disabled { cursor: not-allowed; filter: brightness(0.8) saturate(0.5); }
    .btn.ghost { background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); }
    .btn.ghost:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); }
    .btn.acc { background: var(--acc); color: white; }
    .btn.warn { background: var(--warn); color: white; }
    .btn.danger { background: var(--danger); color: white; }
    .btn.small { padding: 6px 10px; font-size: 14px; border-radius: 9px; }
    .btn.small::before { border-radius: 9px; }
    .btn > svg { width: 16px; height: 16px; stroke-width: 2.5px; }

    /* === START: C·∫¨P NH·∫¨T GIAO DI·ªÜN QU·∫¢N L√ù CH·ª¶ ƒê·ªÄ === */
    #view-topics { grid-template-columns: 1fr; }
    .topic-item { background:rgba(255,255,255,.04); border:1px solid var(--muted); border-radius:12px; padding:8px; margin-bottom:8px; } /* S·ª≠a ƒë·ªïi */
    .topic-header, .sub-row { display:flex; align-items:center; gap:8px; position: relative; }
    .topic-header { cursor: pointer; }
    .topic-header .topic-actions { cursor: default; }
    .topic-header .topic-actions * { cursor: pointer; }
    .topic-item { cursor: pointer; }
    .topic-item .topic-actions { cursor: default; }
    .topic-item .topic-actions * { cursor: pointer; }
    .topic-title { flex:1; font-weight:600; cursor: pointer; }
    .chev { width:28px; height:28px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; flex-shrink: 0; cursor: pointer; }
    .chev .ico { display:inline-block; transition: transform .18s ease; }
    .chev[aria-expanded="false"] .ico { transform: rotate(-90deg); }
    .subtopics { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .subtopics.hidden { display:none; }
    
    .topic-actions, .sub-row .actions {
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        display: flex;
        gap: 6px;
        align-items: center;
    }
    .topic-item:hover .topic-actions, .topic-item:focus-within .topic-actions,
    .sub-row:hover .actions, .sub-row:focus-within .actions {
      opacity: 1;
      visibility: visible;
    }
    .actions-menu-btn {
        padding: 0;
        width: 28px;
        height: 28px;
        font-size: 1.2em;
        line-height: 1;
    }
    .actions-menu {
        position: absolute;
        top: 100%;
        right: 0;
        border-radius: 8px;
        padding: 6px;
        box-shadow: var(--shadow);
        z-index: 10;
        min-width: 150px;
        display: none;
        flex-direction: column;
        gap: 4px;
    }
    /* N√¢ng kh·ªëi ƒëang m·ªü menu l√™n tr√™n c√°c kh·ªëi kh√°c */
    .topic-item.menu-active { position: relative; z-index: 20; }
    
    .actions-menu.show { display: flex; }
    .menu-item {
        background: transparent; border: none; color: var(--text);
        padding: 8px 10px; border-radius: 6px; text-align: left;
        width: 100%; cursor: pointer; transition: background .2s ease;
        display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500;
    }
    .menu-item:hover { background: var(--acc); color: white; }
    .menu-item.danger:hover { background: var(--danger); }
    /* === END: C·∫¨P NH·∫¨T GIAO DI·ªÜN QU·∫¢N L√ù CH·ª¶ ƒê·ªÄ === */

    .subtopic-btn{
        flex:1; 
        text-align:left;
        background-color: rgba(0,0,0,0.02); /* S·ª≠a ƒë·ªïi */
    }
    .subtopic-btn:hover {
        background-color: transparent; /* Hover transparent to avoid blue background */
    }
    .subtopic-btn.active{
        outline:2px solid var(--acc); 
    }
    .subtopic-btn.active:hover {
        background: transparent; /* Gi·ªØ n·ªÅn trong su·ªët khi di chu·ªôt qua */
    }
    
    .panel{border-radius:var(--radius); padding:24px; box-shadow:var(--shadow)}

    .timer-header { display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; }
    .timer{display:grid; gap:16px; grid-template-columns: 1fr; align-items:center; text-align:center}
    .big-time{font-size: clamp(60px, 12vw, 96px); letter-spacing:1px; font-weight:700; color: var(--text)}
    .state{font-weight:700; letter-spacing:.6px}
    .state.work{color:var(--acc-2)} /* S·ª≠a ƒë·ªïi m√†u */
    .state.break{color:var(--warn)}
    .state.long{color:var(--danger)} /* S·ª≠a ƒë·ªïi m√†u */
    .controls{display:flex; flex-wrap:wrap; gap:12px; justify-content:center}    
    #btnStart { padding: 14px 28px; font-size: 1.2em; }
    #btnPause, #btnResume { padding: 12px 24px; font-size: 1.1em; }

    /* === START: T√ôY CH·ªàNH D·∫¢I PH√ÇN C√ÅCH M·ªÄM M·∫†I H∆†N === */
    #view-timer .panel-bg hr {
        border: none; /* B·ªè ƒë∆∞·ªùng vi·ªÅn m·∫∑c ƒë·ªãnh */
        height: 1px;  /* ƒê·∫∑t chi·ªÅu cao cho ƒë∆∞·ªùng k·∫ª */
        background-color: var(--muted); /* S·ª≠ d·ª•ng m√†u ph·ª• c·ªßa theme */
        opacity: 0.3; /* L√†m cho n√≥ m·ªù ƒëi, h√≤a v√†o n·ªÅn */
        margin-top: 0; /* ƒêi·ªÅu ch·ªânh l·∫°i kho·∫£ng c√°ch */
    }
    /* === END: T√ôY CH·ªàNH D·∫¢I PH√ÇN C√ÅCH M·ªÄM M·∫†I H∆†N === */

    .stats-grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px}
    .stat-card{background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:14px; padding:12px; text-align:center} /* S·ª≠a ƒë·ªïi */
    .stat-card h4{margin:4px 0 8px; color:var(--sub); font-weight:600; font-size: 14px;}
    .stat-value{font-size: 20px; font-weight: 600;}
    .tiny{font-size:12px; color:var(--sub)}
    .history{display:grid; gap:8px; max-height:300px; overflow:auto; padding-right:6px}
    .hist-item{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:start; background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:10px; padding:10px} /* S·ª≠a ƒë·ªïi */

    .row{display:flex; gap:8px; align-items:center}
    .row > * {flex:1}
    input[type="text"], input[type="password"], input[type="number"], select, textarea{width:100%; background:rgba(255,255,255,0.04); color:var(--text); border:1px solid var(--muted); border-radius:10px; padding:10px; outline:none}
    textarea{min-height:80px; resize: vertical;}

    .toasts{position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:9999}
    .toast{
        background: var(--panel); /* S·ª≠a ƒë·ªïi */
        border:1px solid var(--muted);
        color:var(--text);
        padding:10px 12px; border-radius:12px; box-shadow:var(--shadow);
        animation: toast-in .3s ease; transform-origin: bottom right;
    }
    @keyframes toast-in { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,var(--panel-opacity)); z-index:10000; backdrop-filter: blur(5px);} /* N√¢ng z-index ƒë·ªÉ n·∫±m tr√™n header */
    .modal.show{display:flex}
    .modal-card{
        position: relative;
        z-index: 10001;
        width:min(720px, 94vw);
        border-radius:16px;
        padding:16px;
        box-shadow:var(--shadow);
        animation: modal-in .25s ease-out;
        max-height: 90vh;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }
    body.modal-open { overflow: hidden; }
    @keyframes modal-in { from { opacity: 0; transform: scale(0.92) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .modal-card h3{margin-top:0}
    .dashboard-table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    .dashboard-table th, .dashboard-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--muted); }
    .dashboard-table th { color: var(--sub); }

    .footer-note{font-size:12px; color:var(--sub)}
    .hidden{display:none !important}

    .notes-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; padding-right: 6px; }
    .note-item { background: rgba(255,255,255,0.04); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; cursor: pointer; } /* S·ª≠a ƒë·ªïi */
    .note-content-wrapper { flex: 1; min-width: 0; }
    .note-content { white-space: pre-wrap; word-break: break-word; max-height: 60px; overflow: hidden; position: relative; transition: max-height 0.35s ease-in-out; }
    .note-content:not(.expanded)::after {
        content: ''; position: absolute; bottom: 0; right: 0; width: 100%; height: 20px; background: linear-gradient(to top, var(--panel) 20%, transparent);
    }
    .note-content.expanded { max-height: 500px; }
    .note-meta { font-size: 11px; color: var(--sub); margin-top: 4px; }
    
    .spinner { border: 2px solid var(--muted); border-top-color: var(--text); border-radius: 50%; width: 16px; height: 16px; animation: spin 1s linear infinite; } /* S·ª≠a ƒë·ªïi */
    @keyframes spin { to { transform: rotate(360deg); } }

    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .panel-header h3 { margin: 0; }
    .panel-header .actions { display: flex; gap: 8px; }
    
    .aux-panel { margin-top: 24px; }
    .tab-nav { display: flex; gap: 4px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 16px; }
    .tab-btn { background: transparent; border: none; color: var(--sub); padding: 8px 16px; cursor: pointer; border-bottom: 2px solid transparent; transition: all .2s ease; font-weight: 600; }
    .tab-btn:hover { color: var(--text); }
    .tab-btn.active { color: var(--acc); border-bottom-color: var(--acc); }
    .tab-content {
      display: none;
      padding-top: 8px;
    }
    .tab-content.active {
      animation: fadeIn 0.25s ease-out;
    }
    #tasks.tab-content.active,
    #notes.tab-content.active,
    #ai.tab-content.active {
        display: block;
    }

    #settings-timer.tab-content.active,
    #settings-ui.tab-content.active,
    #settings-integrations.tab-content.active {
        display: flex;
    }

    .settings-row-toggle {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
    }
    .settings-row-toggle span {
      flex: 1;
      cursor: pointer;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle-switch .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--muted);
      transition: .3s;
      border-radius: 24px;
    }
    .toggle-switch .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    .toggle-switch input:checked + .slider {
      background-color: var(--acc-2);
    }
    .toggle-switch input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    .chat-messages { max-height: 250px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; padding: 4px; }
    .chat-msg { padding: 8px 12px; border-radius: 12px; max-width: 85%; word-break: break-word; }
    .chat-msg.user { background: var(--acc); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
    .chat-msg.model { background: var(--muted); align-self: flex-start; border-bottom-left-radius: 4px; }
    .chat-input-area { display: flex; gap: 8px; }

    .methods-list { list-style: none; padding: 0; }
    .method-item { align-items: flex-start; padding: 12px; display: flex; gap: 10px; border-radius: 8px; }
    .method-item:hover { background: rgba(0,0,0,0.03); } /* S·ª≠a ƒë·ªïi */
    .method-item input[type="checkbox"] { width: 18px; height: 18px; margin-top: 2px; flex-shrink: 0;}
    .method-item label { flex: 1; }
    .method-item label.completed { text-decoration: line-through; color: var(--sub); }
    .method-item .content-wrapper { flex: 1; cursor: pointer; }
    .method-item .concept { font-size: 14px; color: var(--sub); margin-top: 8px; border-left: 2px solid var(--muted); padding-left: 12px; white-space: pre-wrap; word-break: break-word; }
    /* Highlight section titles and bold text inside method content */
    .method-content h4 {
        color: var(--acc-2);
        font-size: 1.1em;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    .method-content strong {
        color: var(--acc);
        font-weight: 600;
    }
    /* Apply the same highlight to the Guide view */
    #view-guide h4 { color: var(--acc-2); }
    #view-guide strong { color: var(--acc-2); }
    /* Show hand cursor to indicate clickability */
    .method-item, .method-item summary { cursor: pointer; }
    .subtopic-todo-list { list-style: none; padding: 0; margin: 0; max-height: 100px; overflow-y: auto; text-align: left; }
    .subtopic-todo-list li { display: flex; align-items: center; gap: 8px; padding: 4px; transition: all 0.2s ease-out; }
    .subtopic-todo-list li.removing { transform: translateX(100%); opacity: 0; }
    .subtopic-todo-list label { flex: 1; }

    #youtube-player-container { position: absolute; top: -9999px; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 10px; } /* S·ª≠a ƒë·ªïi */
    ::-webkit-scrollbar-thumb { background: var(--muted); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
    ::-webkit-scrollbar-thumb:hover { background: var(--sub); background-clip: content-box; }
    
    .timer-circle-container {
        position: relative; width: clamp(250px, 40vw, 320px); height: clamp(250px, 40vw, 320px); margin: 24px auto; display: flex; align-items: center; justify-content: center;
    }
    .timer-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform: rotate(-90deg); }
    .timer-circle-bg, .timer-circle-progress { fill: none; stroke-width: 8; }
    .timer-circle-bg { stroke: var(--muted); } /* S·ª≠a ƒë·ªïi */
    .timer-circle-progress { stroke: var(--acc); stroke-linecap: round; transition: stroke-dashoffset 0.3s linear, stroke 0.5s ease; }
    @keyframes flash { 0%, 100% { box-shadow: 0 0 10px 2px transparent; } 50% { box-shadow: 0 0 20px 8px currentColor; } }
    .timer-circle-container.finished { color: var(--acc-2); animation: flash 1s ease-out; }
    @keyframes breathing-effect { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    .timer-circle-container.breathing { animation: breathing-effect 3s ease-in-out infinite; }
    
    
    
    @media (max-width: 1024px) {
      .app-content { padding: 20px; }
      .panel { padding: 20px; }
      .timer-circle-container { width: clamp(220px, 50vw, 300px); height: clamp(220px, 50vw, 300px); }
    }

    @media (max-width: 768px) {
      .app { flex-direction: column; }
      .app-nav { width: 100%; height: 60px; flex-direction: row; justify-content: center; border-right: none; border-top: 1px solid rgba(255,255,255,.08); order: 2; padding: 0 16px; }
      .app-content { padding: 16px; order: 1; }
      .panel { padding: 16px; }
      .modal-card .tab-nav { overflow-x: auto; }
    }

    @media (max-width: 480px) {
      .app-nav { height: 50px; }
      .nav-btn { flex: 1; }
      header.app-header { flex-direction: column; align-items: stretch; gap: 8px; }
      .btn { padding: 8px 12px; }
      .timer-circle-container { width: clamp(180px, 80vw, 220px); height: clamp(180px, 80vw, 220px); margin: 16px auto; }
      .panel { padding: 12px; }
      .app-content { padding: 12px; }
    }

    #view-timer.no-subtopic-selected > .panel-bg:not(:first-child) { display: none; }
    #view-timer.no-subtopic-selected .timer-header > .presets { display: none; }
    #view-timer.no-subtopic-selected .timer { display: none; }

    header.app-header .actions #btnFullscreen { background: transparent; border: none; box-shadow: none; }
    header.app-header .actions #btnFullscreen:hover { background: var(--muted); filter: none; }
    header.app-header .actions #btnFullscreen:hover::before { opacity: 0; }

    input[type="text"], input[type="password"], input[type="number"], select, textarea {
        background: rgba(255,255,255,0.04) !important; /* S·ª≠a ƒë·ªïi: chuy·ªÉn sang n·ªÅn tr·∫Øng trong su·ªët */
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.1); /* Vi·ªÅn tr·∫Øng m·ªù */
        transition: background .2s ease, border-color .2s ease;
    }
    input[type="text"]:focus, input[type="password"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
        background: rgba(255,255,255,0.06) !important; /* Tinh ch·ªânh: s√°t m·∫´u h∆°n */
        border-color: var(--acc);
    }
    /* === START: S·ª¨A L·ªñI N·ªÄN INPUT/SELECT TR√äN THEME S√ÅNG === */
    [data-theme='light'] input, [data-theme='light'] select, [data-theme='light'] textarea,
    [data-theme='pastel'] input, [data-theme='pastel'] select, [data-theme='pastel'] textarea {
        background: rgba(0, 0, 0, 0.05) !important; /* D√πng n·ªÅn ƒëen m·ªù thay v√¨ tr·∫Øng m·ªù */
        border-color: rgba(0, 0, 0, 0.1); /* Vi·ªÅn ƒëen m·ªù tr√™n theme s√°ng */
    }

    [data-theme='light'] input:focus, [data-theme='light'] select:focus, [data-theme='light'] textarea:focus,
    [data-theme='pastel'] input:focus, [data-theme='pastel'] select:focus, [data-theme='pastel'] textarea:focus {
        background: rgba(0, 0, 0, 0.07) !important; /* TƒÉng ƒë·ªô ƒë·∫≠m khi focus */
    }
    /* === END: S·ª¨A L·ªñI N·ªÄN INPUT/SELECT TR√äN THEME S√ÅNG === */

    /* C·∫£i thi·ªán n·ªÅn v√† m√†u ch·ªØ cho option trong select theo theme hi·ªán t·∫°i */
    select option {
        background: var(--panel);
        color: var(--text);
    }
    
    ::placeholder { color: var(--sub); opacity: 0.7; } /* S·ª≠a ƒë·ªïi */
    ::-ms-input-placeholder { color: var(--sub); }
    :-ms-input-placeholder { color: var(--sub); }

    
    
    .draggable-timer {
        position: fixed;
        bottom: 20px;
        right: 20px;
        color: var(--text);
        padding: 8px 16px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        font-size: 2em;
        font-weight: 600;
        cursor: move;
        user-select: none;
        z-index: 9998;
        opacity: 0;
        transform: scale(0.9);
        pointer-events: none;
        transition: opacity 0.35s ease, transform 0.35s ease;
    }
    body.bg-view-mode .draggable-timer {
        opacity: 1;
        transform: scale(1);
        pointer-events: auto;
    }
    .app-nav, .panel-bg, .app-header .actions > *, .app-header > .row {
        transition: opacity 0.35s ease, transform 0.35s ease, background 0.35s ease, border-color 0.35s ease, box-shadow 0.35s ease;
    }
    body.bg-view-mode .app-nav,
    body.bg-view-mode .view.active > .panel-bg {
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
    }
    body.bg-view-mode .app-header {
        background: transparent !important;
        border-color: transparent !important;
        box-shadow: none !important;
    }
    body.bg-view-mode .app-header .actions > *:not(#btnToggleBg),
    body.bg-view-mode .app-header > .row {
        opacity: 0;
        pointer-events: none;
    }
    body.bg-view-mode #btnToggleBg {
        opacity: 1;
        pointer-events: auto;
    }
    .sound-permission-bar {
      position: fixed; left: 50%; transform: translateX(-50%);
      bottom: 48px; z-index: 9999;
      border-radius: 12px; padding: 10px 14px;
      display: none; align-items: center; gap: 10px;
      box-shadow: var(--shadow);
    }
    .sound-permission-bar.show { display: flex; }
    .sound-permission-bar .msg { font-size: 14px; color: var(--text); }
    .draggable-timer { text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.9); }

    /* Gi·∫£m/lo·∫°i b·ªè b√≥ng ch·ªØ cho theme s√°ng ƒë·ªÉ tr√°nh nh√≤e/l√≥a */
    body[data-theme='light'],
    body[data-theme='pastel'] { text-shadow: none; }
    body[data-theme='light'] .draggable-timer,
    body[data-theme='pastel'] .draggable-timer { text-shadow: none; }

    /* ============================================= */
/* ========================================================= */
/* START: THI?T L?P PANEL KI?U M?  ?C (FROSTED GLASS)        */
/* ========================================================= */

/* --- 1.  p d?ng hi?u ?ng n?n m? chung cho t?t c? c c panel --- */
.app-nav,
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    background: rgba(var(--panel-rgb), var(--panel-opacity));
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* --- 2.  ?nh nghia vi?n cho t?ng lo?i panel --- */
.app-nav {
    border-right: 1px solid rgba(255, 255, 255, 0.1);
}
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* --- 3. Tinh ch?nh vi?n cho c c theme S NG (Light/Pastel) --- */
[data-theme='light'] .app-nav,
[data-theme='light'] .panel-bg,
[data-theme='light'] .modal-card,
[data-theme='light'] .actions-menu,
[data-theme='light'] .nav-btn .tooltip,
[data-theme='light'] .draggable-timer,
[data-theme='light'] .sound-permission-bar,
[data-theme='light'] .toast,
[data-theme='light'] .topic-item,
[data-theme='light'] .stat-card,
[data-theme='light'] .hist-item,
[data-theme='light'] .method-item,
[data-theme='pastel'] .app-nav,
[data-theme='pastel'] .panel-bg,
[data-theme='pastel'] .modal-card,
[data-theme='pastel'] .actions-menu,
[data-theme='pastel'] .nav-btn .tooltip,
[data-theme='pastel'] .draggable-timer,
[data-theme='pastel'] .sound-permission-bar,
[data-theme='pastel'] .toast,
[data-theme='pastel'] .topic-item,
[data-theme='pastel'] .stat-card,
[data-theme='pastel'] .hist-item,
[data-theme='pastel'] .method-item {
    border-color: rgba(0, 0, 0, 0.1);
}

/* --- 4. S?a l?i hi?u ?ng fade-out c?a ghi ch  cho ph  h?p --- */
.note-content:not(.expanded)::after {
    background: linear-gradient(to top, rgba(var(--panel-rgb), 1) 20%, transparent);
}

/* --- C c quy t?c c n l?i gi? nguy n t? file g?c --- */
[data-theme='light'] .tab-nav,
[data-theme='pastel'] .tab-nav {
    border-bottom-color: rgba(0, 0, 0, 0.1);
}
.subtopic-btn {
    background-color: transparent;
}
.subtopic-btn:hover {
    background-color: transparent; /* Hover transparent to avoid blue background */
}
.method-item[open] summary {
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
    [data-theme='light'] .method-item[open] summary,
    [data-theme='pastel'] .method-item[open] summary {
        border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    /* Editor container (single pane, Rich Text) */
    .editor-container { height: 350px; }
    .editable-content { height: 100%; border: 1px solid var(--muted); border-radius: 10px; padding: 10px; overflow-y: auto; background: var(--bg); }
    .editable-content:focus-within { border-color: var(--acc); outline: none; }
    .editable-content h4 { color: var(--acc-2); font-size: 1.1em; margin-top: 1.5em; margin-bottom: 0.5em; }
    .editable-content strong, .editable-content b { color: var(--acc); font-weight: 600; }
    .editable-content ol, .editable-content ul { padding-left: 20px; }

    /* Editor toolbar for Methods modal */
    .editor-toolbar { display: flex; gap: 6px; margin-bottom: 6px; padding: 4px; background: var(--muted); border-radius: 8px; }
    .editor-toolbar button { font-weight: bold; width: 32px; height: 32px; padding: 0; }
    .editor-toolbar .btn.ghost:hover { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.15); }
    .editor-toolbar .btn.ghost.active { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.25); }
    .color-picker-wrapper { position: relative; }
    .color-palette { position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; padding: 6px; border-radius: 8px; border: 1px solid var(--muted); background: var(--panel); box-shadow: var(--shadow); z-index: 10; }
    .color-swatch { width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255, 255, 255, 0.5); cursor: pointer; transition: transform 0.15s ease; }
    .color-swatch:hover { transform: scale(1.15); }

    /* Method actions inline with summary and show on hover */
    .method-item summary { display: flex; align-items: center; justify-content: space-between; }
    .method-item summary > span { flex: 1; }
    .method-item summary .topic-actions { margin-left: 8px; }
    .method-title { cursor: pointer; }
    .method-item:hover .topic-actions, .method-item:focus-within .topic-actions { opacity: 1; visibility: visible; }

    </style>
</head>
<body data-theme="default"> <div class="app" id="app">
    <nav class="app-nav">
        <button class="nav-btn active" id="navBtnTimer" data-view="timer" aria-label="ƒê·ªìng h·ªì">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span class="tooltip">ƒê·ªìng h·ªì</span>
        </button>
        <button class="nav-btn" id="navBtnTopics" data-view="topics" aria-label="Ch·ªß ƒë·ªÅ">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
            <span class="tooltip">Ch·ªß ƒë·ªÅ</span>
        </button>
        <button class="nav-btn" id="navBtnStats" data-view="stats" aria-label="Th·ªëng k√™">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
            <span class="tooltip">Th·ªëng k√™</span>
        </button>
        <button class="nav-btn" id="navBtnMethods" data-view="methods" aria-label="Kho Tri Th·ª©c">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.042 21.672L13.684 16.6s.408-1.947 1.25-3.25c.842-1.303 2.002-2.5 3.5-3.5s3.25-1.25 3.25-1.25l5.072 1.358c.27.072.358.42.128.628l-3.35 3.35a.499.499 0 0 1-.594.052l-2.07-1.486c-.44-.314-.82-.53-1.11-.665-.29-.135-.55-.22-.78-.245s-.45.045-.63.155c-.18.11-.3.29-.36.5-.06.21.02.48.18.78.16.3.385.68.665 1.11l1.486 2.07a.499.499 0 0 1-.052.594l-3.35 3.35c-.208.23-.556.142-.628-.128z"/><path d="M12 15l-3-3 3-3 3 3-3 3z"/><path d="M9.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/><path d="M5.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/></svg>
            <span class="tooltip">Kho Tri Th·ª©c</span>
        </button>
        <button class="nav-btn" id="btnSettings" style="margin-top: auto;" aria-label="C√†i ƒë·∫∑t">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            <span class="tooltip">C√†i ƒë·∫∑t</span>
        </button>
        <button class="nav-btn" id="navBtnGuide" data-view="guide" aria-label="H∆∞·ªõng d·∫´n">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            <span class="tooltip">H∆∞·ªõng d·∫´n</span>
        </button>
    </nav>

    <main class="app-content">
      <header class="app-header panel-bg">
        <div class="row" style="gap:12px; align-items:center; flex:0 1 auto">
          <strong>üìö Pomodoro Study App</strong>
          <span class="badge" id="selectedContext">Ch∆∞a ch·ªçn Ch·ªß ƒë·ªÅ con</span>
        </div>
        <div class="actions">
          <button class="btn ghost small" id="btnDashboard" title="Dashboard T·ªïng quan">üìä T·ªïng Quan </button>
          <a href="https://forms.gle/EfFqBJFTbFtDo5H4A" target="_blank" rel="noopener noreferrer" class="btn ghost small" title="G·ª≠i ph·∫£n h·ªìi c·ªßa b·∫°n">üí¨ Ph·∫£n H·ªìi</a>
          <button class="btn ghost small" id="btnExport" title="Xu·∫•t JSON">‚¨áÔ∏è Xu·∫•t File</button>
          <label class="btn ghost small" for="importFile" title="Nh·∫≠p JSON">‚¨ÜÔ∏è Nh·∫≠p File</label>
          <input type="file" id="importFile" accept="application/json" style="display:none" />
          <button class="btn small" id="btnToggleBg" title="·∫®n/Hi·ªán giao di·ªán">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
          <button class="btn small" id="btnFullscreen" title="To√†n m√†n h√¨nh">‚ÜóÔ∏è</button>
        </div>
      </header>
      

      <div id="view-timer" class="view active">
        <section class="panel panel-bg">
          <div class="timer-header">
            <div id="welcomePanel" class="hidden panel-bg" style="text-align:center; padding: 20px; border-radius: var(--radius); width: 100%;">
                <h3>Ch√†o m·ª´ng ƒë·∫øn v·ªõi Pomodoro Study App!</h3>
                <p>H√£y b·∫Øt ƒë·∫ßu b·∫±ng c√°ch ch·ªçn m·ªôt <strong>Ch·ªß ƒë·ªÅ con</strong> ho·∫∑c t·∫°o Ch·ªß ƒë·ªÅ/Ch·ªß ƒë·ªÅ con m·ªõi.</p>
                <button class="btn acc" id="btnHelpCreateTopic">Ôºã T·∫°o Ch·ªß ƒë·ªÅ M·ªõi</button>
            </div>
            <div class="presets" role="group" aria-label="Ch·ªçn ch·∫ø ƒë·ªô preset">
                <button id="btnPresetA" class="btn small ghost" data-preset="A"></button>
                <button id="btnPresetB" class="btn small ghost" data-preset="B"></button>
                <button id="btnPresetC" class="btn small ghost" data-preset="C">üåä Flow</button>
            </div>
          </div>
          <hr />
          <div class="timer" aria-live="polite">
            <div class="badge" id="stateBadge">TR·∫†NG TH√ÅI</div>
            
            <div class="timer-circle-container">
              <svg class="timer-svg" viewBox="0 0 100 100">
                  <circle class="timer-circle-bg" cx="50" cy="50" r="45"></circle>
                  <circle class="timer-circle-progress" cx="50" cy="50" r="45"></circle>
              </svg>
              <div id="timeDisplay" class="big-time">00:00</div>
            </div>

            <div class="tiny" id="cycleInfo"></div>

            <div class="tiny" id="breakSuggestionDisplay" style="min-height: 1.5em; font-style: italic; opacity: 0.8; transition: opacity 0.3s ease;"></div>

            <div id="windDownChecklist" class="hidden" style="text-align: left; max-width: 300px; margin: 0 auto; padding: 0 10px;">
              <h4 style="margin: 8px 0 4px; color: var(--acc); text-align: center;">Checklist H·∫° nhi·ªát</h4>
              <ul style="list-style: '‚úì '; margin: 0; padding-left: 20px; color: var(--sub);">
                <li>L∆∞u c√¥ng vi·ªác ƒëang l√†m (Save/Commit).</li>
                <li>Ghi ch√∫ nhanh "Next step".</li>
                <li>D·ªçn d·∫πp kh√¥ng gian l√†m vi·ªác.</li>
              </ul>
            </div>
            
            <div class="controls">
              <button class="btn acc" id="btnStart" aria-label="B·∫Øt ƒë·∫ßu (Space)">‚ñ∂Ô∏è B·∫Øt ƒë·∫ßu</button>
              <button class="btn warn hidden" id="btnFinishFlow" aria-label="K·∫øt th√∫c phi√™n l√†m vi·ªác">üßò B·∫Øt ƒë·∫ßu ngh·ªâ</button>
              <button class="btn" id="btnPause" aria-label="T·∫°m d·ª´ng (Space)">‚è∏Ô∏è T·∫°m d·ª´ng</button>
              <button class="btn" id="btnResume" aria-label="Ti·∫øp t·ª•c (Space)">‚èµ Ti·∫øp t·ª•c</button>
              <button class="btn warn" id="btnSkip" aria-label="B·ªè qua (N)">‚è≠Ô∏è B·ªè qua</button>
              <button class="btn danger" id="btnReset">‚Ü∫ ƒê·∫∑t l·∫°i</button>
              <button class="btn acc small hidden" id="btnBreakEarly">üßò Ngh·ªâ s·ªõm</button>
            </div>
            <div class="tiny">Ph√≠m t·∫Øt: <strong>Space</strong> = B·∫Øt ƒë·∫ßu/T·∫°m d·ª´ng/Ti·∫øp t·ª•c, <strong>N</strong> = Ti·∫øp theo/B·ªè qua</div>
          </div>
        </section>

        <section class="panel panel-bg aux-panel">
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="tasks">Nhi·ªám v·ª•</button>
                <button class="tab-btn" data-tab="notes">Ghi ch√∫</button>
                <button class="tab-btn" data-tab="ai">Gemini AI</button>
            </nav>
            <div id="tasks" class="tab-content active">
                <h4 style="margin: 0 0 8px; color: var(--sub);">To-do cho ch·ªß ƒë·ªÅ con n√†y:</h4>
                <ul id="subtopicTasksList" class="subtopic-todo-list"></ul>
                <div class="row" style="gap:8px; margin-top: 8px;">
                    <input type="text" id="newSubtopicTaskInput" placeholder="Th√™m m·ªôt task m·ªõi..." />
                    <button id="btnAddSubtopicTask" class="btn small" style="flex: 0 1 auto;">Th√™m</button>
                </div>
            </div>
            <div id="notes" class="tab-content">
                <div id="generalNotesList" class="notes-list"></div>
                <div class="add-note-area" style="margin-top: 12px;">
                    <textarea id="newGeneralNoteText" placeholder="Th√™m ghi ch√∫ m·ªõi..."></textarea>
                    <div style="text-align: right; margin-top: 8px;">
                        <button class="btn acc small" id="btnAddGeneralNote">Ôºã Th√™m ghi ch√∫</button>
                    </div>
                </div>
            </div>
            <div id="ai" class="tab-content">
                <div class="panel-header" style="margin-bottom: 8px; padding: 0;">
                    <h4 style="margin:0;">Gemini cho: <span id="currentSubtopicNameChat">(ch∆∞a ch·ªçn)</span></h4>
                    <div class="actions">
                        <button id="btnClearChat" class="btn small danger" title="X√≥a l·ªãch s·ª≠">üóëÔ∏è</button>
                    </div>
                </div>
                <div id="chatMessages" class="chat-messages"></div>
                <div id="aiPromptSuggestions" style="display: flex; gap: 6px; margin: 8px 0; flex-wrap: wrap;">
                  <button class="btn small ghost" data-prompt="Gi·∫£i th√≠ch kh√°i ni·ªám ch√≠nh c·ªßa ch·ªß ƒë·ªÅ n√†y">Gi·∫£i th√≠ch kh√°i ni·ªám</button>
                  <button class="btn small ghost" data-prompt="T·∫°o m·ªôt d√†n √Ω chi ti·∫øt cho ch·ªß ƒë·ªÅ n√†y">T·∫°o d√†n √Ω</button>
                  <button class="btn small ghost" data-prompt="Li·ªát k√™ 5 c√¢u h·ªèi √¥n t·∫≠p quan tr·ªçng v·ªÅ ch·ªß ƒë·ªÅ n√†y">T·∫°o c√¢u h·ªèi √¥n t·∫≠p</button>
                </div>
                <div class="chat-input-area">
                  <input type="text" id="chatInput" placeholder="H·ªèi Gemini ƒëi·ªÅu g√¨ ƒë√≥..." />
                  <button id="btnSendMessage" class="btn acc">G·ª≠i</button>
                </div>
            </div>
        </section>
      </div>

      <div id="view-topics" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin: 0;">Qu·∫£n l√Ω Ch·ªß ƒë·ªÅ</h3>
                <button class="btn small acc" id="btnAddTopic" style="margin-left: auto;">Ôºã Th√™m Ch·ªß ƒë·ªÅ</button>
            </div>
            <div id="topicsList"></div>
            <div class="footer-note">Nh·∫•p m≈©i t√™n ƒë·ªÉ m·ªü/ƒë√≥ng danh s√°ch ch·ªß ƒë·ªÅ con.</div>
        </div>
      </div>
      
      <div id="view-stats" class="view">
        <section class="panel panel-bg">
            <h3 style="margin:0 0 12px 0;">Th·ªëng k√™ & L·ªãch s·ª≠ ‚Äî <span id="currentSubtopicName">(ch∆∞a ch·ªçn)</span></h3>
            <div class="stats-grid">
              <div class="stat-card"><h4>T·ªïng th·ªùi gian</h4><div class="stat-value" id="statTotal">0 ph√∫t</div></div>
              <div class="stat-card"><h4>Phi√™n</h4><div class="stat-value" id="statSessions">0</div></div>
              <div class="stat-card"><h4>Nhi·ªám v·ª• Ho√†n th√†nh</h4><div class="stat-value" id="statTasks">0</div></div>
            </div>
            <div style="margin-top:12px">
              <h4 style="margin:4px 0 8px; color:var(--sub)">L·ªãch s·ª≠ (L√ÄM VI·ªÜC)</h4>
              <div class="history" id="historyList"></div>
            </div>
        </section>
      </div>
      
      <div id="view-methods" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin:0;">üí° Kho Tri Th·ª©c C√° Nh√¢n H√≥a</h3>
                <button class="btn small acc" id="btnAddMethod" style="margin-left: auto;">Ôºã Th√™m tri th·ª©c</button>
            </div>
            <p class="tiny" style="margin-top: -8px; margin-bottom: 20px;">Nh·∫•p v√†o t·ª´ng m·ª•c ƒë·ªÉ xem chi ti·∫øt.</p>
            <div class="methods-container"></div>
        </div>
      </div>

      <div id="view-guide" class="view">
          <div class="panel panel-bg">
              <h3 style="margin-top: 0;">üìñ Kh√°m Ph√° Pomodoro Study App</h3>
              <p>
                  Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi kh√¥ng gian h·ªçc t·∫≠p ƒë∆∞·ª£c thi·∫øt k·∫ø d√†nh ri√™ng cho s·ª± t·∫≠p trung v√† hi·ªáu qu·∫£. H√£y c√πng kh√°m ph√° nh·ªØng t√≠nh nƒÉng s·∫Ω ƒë·ªìng h√†nh c√πng b·∫°n tr√™n h√†nh tr√¨nh chinh ph·ª•c tri th·ª©c.
              </p>

              <h4>üöÄ Kh·ªüi ƒê·∫ßu Nhanh Ch·ªâ Trong 4 B∆∞·ªõc</h4>
              <p>ƒê·ªÉ h√†nh tr√¨nh c·ªßa b·∫°n lu√¥n m·∫°ch l·∫°c, m·ªçi th·ª© trong ·ª©ng d·ª•ng ƒë∆∞·ª£c s·∫Øp x·∫øp theo c·∫•u tr√∫c <strong>Ch·ªß ƒë·ªÅ L·ªõn ‚Üí Ch·ªß ƒë·ªÅ con</strong>.</p>
              <ol>
                  <li>M·ªü m·ª•c <strong>üìö Ch·ªß ƒë·ªÅ</strong> t·ª´ thanh ƒëi·ªÅu h∆∞·ªõng b√™n c·∫°nh.</li>
                  <li>Nh·∫•n <strong>Ôºã Th√™m Ch·ªß ƒë·ªÅ</strong> ƒë·ªÉ t·∫°o m·ªôt lƒ©nh v·ª±c l·ªõn (v√≠ d·ª•: "Ti·∫øng Anh Giao Ti·∫øp").</li>
                  <li>B√™n c·∫°nh ch·ªß ƒë·ªÅ v·ª´a t·∫°o, nh·∫•n <strong>Ôºã Th√™m</strong> ƒë·ªÉ t·∫°o m·ªôt ch·ªß ƒë·ªÅ con, chi ti·∫øt h∆°n (v√≠ d·ª•: "B√†i 1: Luy·ªán ph√°t √¢m IPA").</li>
                  <li>Ch·ªçn ch·ªß ƒë·ªÅ con ƒë√≥. Gi·ªù ƒë√¢y, b·∫°n ƒë√£ s·∫µn s√†ng ƒë·ªÉ b·∫Øt ƒë·∫ßu phi√™n h·ªçc ƒë·∫ßu ti√™n c·ªßa m√¨nh!</li>
              </ol>

              <hr />
              <h4>‚ú® Nh·ªØng T√≠nh NƒÉng ƒê√°ng Ch√∫ √ù</h4>

              <h4>C√°c Ch·∫ø ƒê·ªô ƒê·ªìng H·ªì Linh Ho·∫°t ‚è±Ô∏è</h4>
              <p>·ª®ng d·ª•ng kh√¥ng ch·ªâ c√≥ Pomodoro. H√£y ch·ªçn ph∆∞∆°ng ph√°p ph√π h·ª£p v·ªõi c√¥ng vi·ªác c·ªßa b·∫°n:</p>
              <ul>
                  <li><strong>Pomodoro C·ªï ƒêi·ªÉn (Ki·ªÉu A/B):</strong> L√†m vi·ªác t·∫≠p trung trong c√°c phi√™n ƒë·ªãnh s·∫µn (v√≠ d·ª•: 25 ph√∫t l√†m, 5 ph√∫t ngh·ªâ) ƒë·ªÉ x√¢y d·ª±ng k·ª∑ lu·∫≠t v√† nh·ªãp ƒë·ªô.</li>
                  <li><strong>Ch·∫ø ƒë·ªô Flowtime (Ki·ªÉu üåä Flow):</strong> D√†nh cho c√¥ng vi·ªác c·∫ßn d√≤ng ch·∫£y s√¢u. ƒê·ªìng h·ªì s·∫Ω ƒë·∫øm l√™n, cho ph√©p b·∫°n l√†m vi·ªác ƒë·∫øn khi t·ª± c·∫£m th·∫•y c·∫ßn ngh·ªâ. Th·ªùi gian ngh·ªâ s·∫Ω ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t d·ª±a tr√™n th·ªùi gian b·∫°n ƒë√£ l√†m vi·ªác.</li>
                  <li><strong>ƒê·ªám "H·∫° nhi·ªát" (Wind-down):</strong> M·ªôt kho·∫£ng ƒë·ªám t√πy ch·ªânh gi·ªØa l√∫c l√†m v√† l√∫c ngh·ªâ, gi√∫p b·∫°n k·∫øt th√∫c c√¥ng vi·ªác ƒëang d·ªü, ghi ch√∫ l·∫°i "b∆∞·ªõc ti·∫øp theo" v√† chuy·ªÉn tr·∫°ng th√°i m·ªôt c√°ch m∆∞·ª£t m√†, kh√¥ng b·ªã c·∫Øt ngang ƒë·ªôt ng·ªôt.</li>
              </ul> 
              <h4>Kho Tri Th·ª©c Theo T·ª´ng Ch·ªß ƒê·ªÅ Con üí°</h4>
<p>
    M·ªói m·ªôt <strong>Ch·ªß ƒë·ªÅ con</strong> gi·ªù ƒë√¢y s·∫Ω c√≥ m·ªôt "Kho Tri Th·ª©c" ho√†n to√†n ri√™ng bi·ªát. T√≠nh nƒÉng n√†y cho ph√©p b·∫°n x√¢y d·ª±ng m·ªôt th∆∞ vi·ªán ki·∫øn th·ª©c chuy√™n s√¢u, ch·ªâ li√™n quan ƒë·∫øn lƒ©nh v·ª±c b·∫°n ƒëang h·ªçc.
</p>
<p>
    V√≠ d·ª•, c√°c ghi ch√∫ v√† ph∆∞∆°ng ph√°p h·ªçc "Ti·∫øng Anh Giao Ti·∫øp" s·∫Ω ch·ªâ xu·∫•t hi·ªán khi b·∫°n ch·ªçn ch·ªß ƒë·ªÅ con ƒë√≥, v√† s·∫Ω kh√¥ng b·ªã l·∫´n v·ªõi c√°c c√¥ng th·ª©c trong ch·ªß ƒë·ªÅ con "Gi·∫£i t√≠ch To√°n h·ªçc".
</p>
<p>
    V·ªõi tr√¨nh so·∫°n th·∫£o m·∫°nh m·∫Ω, b·∫°n v·∫´n c√≥ th·ªÉ d·ªÖ d√†ng ƒë·ªãnh d·∫°ng ti√™u ƒë·ªÅ, in ƒë·∫≠m, t·∫°o danh s√°ch v√† l√†m n·ªïi b·∫≠t nh·ªØng th√¥ng tin quan tr·ªçng nh·∫•t cho t·ª´ng m√¥n h·ªçc c·ªßa m√¨nh.
</p>

              <h4>Qu·∫£n L√Ω Ch·ªß ƒê·ªÅ Tr·ª±c Quan</h4>
              <p>D·ªÖ d√†ng s·∫Øp x·∫øp c√°c m·ª•c ti√™u h·ªçc t·∫≠p c·ªßa b·∫°n. S·ª≠ d·ª•ng thao t√°c <strong>k√©o v√† th·∫£</strong> ƒë·ªÉ s·∫Øp x·∫øp l·∫°i th·ª© t·ª± c√°c Ch·ªß ƒë·ªÅ ho·∫∑c di chuy·ªÉn m·ªôt Ch·ªß ƒë·ªÅ con sang m·ªôt lƒ©nh v·ª±c kh√°c m·ªôt c√°ch tr·ª±c quan.</p>

              <h4>Nhi·ªám V·ª• & Ghi Ch√∫ T√≠ch H·ª£p üìù</h4>
              <p>Ngay trong m√†n h√¨nh ƒë·ªìng h·ªì, b·∫°n c√≥ th·ªÉ t·∫°o danh s√°ch vi·ªác c·∫ßn l√†m (to-do) cho t·ª´ng ch·ªß ƒë·ªÅ con ho·∫∑c ghi l·∫°i nh·ªØng √Ω t∆∞·ªüng ch·ª£t n·∫£y ra m√† kh√¥ng l√†m gi√°n ƒëo·∫°n d√≤ng ch·∫£y c√¥ng vi·ªác.</p>

              <h4>Ch·∫ø ƒê·ªô Zen üßò</h4>
              <p>Khi c·∫ßn t·∫≠p trung tuy·ªát ƒë·ªëi, h√£y nh·∫•n v√†o bi·ªÉu t∆∞·ª£ng con m·∫Øt (üëÅÔ∏è). Giao di·ªán s·∫Ω ·∫©n ƒëi, ch·ªâ ƒë·ªÉ l·∫°i h√¨nh n·ªÅn v√† chi·∫øc ƒë·ªìng h·ªì. Trong ch·∫ø ƒë·ªô n√†y, b·∫°n c√≥ th·ªÉ <strong>k√©o th·∫£ ƒë·ªìng h·ªì</strong> ƒë·∫øn b·∫•t k·ª≥ v·ªã tr√≠ n√†o tr√™n m√†n h√¨nh ƒë·ªÉ c√≥ m·ªôt kh√¥ng gian l√†m vi·ªác g·ªçn g√†ng nh·∫•t.</p>

              <h4>Th·ªëng K√™ & C·ªôt M·ªëc üèÜ</h4>
              <p>Theo d√µi h√†nh tr√¨nh c·ªßa b·∫°n qua nh·ªØng con s·ªë bi·∫øt n√≥i. ·ª®ng d·ª•ng s·∫Ω t·ª± ƒë·ªông ghi nh·∫≠n v√† ch√∫c m·ª´ng khi b·∫°n ƒë·∫°t ƒë∆∞·ª£c nh·ªØng c·ªôt m·ªëc quan tr·ªçng v·ªÅ th·ªùi gian t·∫≠p trung, bi·∫øn m·ªói n·ªó l·ª±c th√†nh m·ªôt th√†nh t·ª±u ƒë√°ng t·ª± h√†o.</p>

              <hr />
              <h4>‚å®Ô∏è Ph√≠m T·∫Øt Th√¥ng Minh</h4>
              <ul>
                  <li><kbd>Space</kbd>: B·∫Øt ƒë·∫ßu / T·∫°m d·ª´ng / Ti·∫øp t·ª•c phi√™n h·ªçc.</li>
                  <li><kbd>N</kbd>: B·ªè qua phi√™n l√†m vi·ªác ho·∫∑c ngh·ªâ hi·ªán t·∫°i.</li>
                  <li><kbd>Esc</kbd>: ƒê√≥ng c√°c c·ª≠a s·ªï ƒëang m·ªü (nh∆∞ C√†i ƒë·∫∑t).</li>
              </ul>

              <hr />
              <h4>üõ†Ô∏è C√†i ƒê·∫∑t N√¢ng Cao & T√≠ch H·ª£p</h4>

              <h4>Tr·ª£ L√Ω Gemini AI üß†</h4>
              <p>Bi·∫øn ·ª©ng d·ª•ng th√†nh m·ªôt ng∆∞·ªùi b·∫°n ƒë·ªìng h√†nh th√¥ng minh. Ngo√†i vi·ªác h·ªèi ƒë√°p, b·∫°n c√≤n c√≥ th·ªÉ:</p>
              <ul>
                  <li><strong>T·ª± ƒë·ªông ƒê·ªãnh d·∫°ng Th√¥ng minh:</strong> Khi so·∫°n th·∫£o trong m·ª•c "Ph∆∞∆°ng ph√°p", h√£y ƒë·ªÉ AI t·ª± ƒë·ªông ph√¢n t√≠ch v√† ƒë·ªãnh d·∫°ng vƒÉn b·∫£n th√¥ c·ªßa b·∫°n‚Äît·ª± nh·∫≠n di·ªán ti√™u ƒë·ªÅ, c√°c √Ω ch√≠nh c·∫ßn in ƒë·∫≠m v√† danh s√°ch.</li>
                  <li><strong>Thi·∫øt l·∫≠p:</strong> Truy c·∫≠p Google AI Studio ƒë·ªÉ t·∫°o API Key mi·ªÖn ph√≠ v√† d√°n v√†o √¥ "Gemini API Key" trong C√†i ƒë·∫∑t c·ªßa ·ª©ng d·ª•ng.</li>
              </ul>

              <h4>T√πy Bi·∫øn Giao Di·ªán & √Çm Thanh üé®</h4>
              <p>Bi·∫øn kh√¥ng gian h·ªçc t·∫≠p th√†nh c·ªßa ri√™ng b·∫°n:</p>
              <ul>
                  <li><strong>Nhi·ªÅu Theme & H√¨nh n·ªÅn:</strong> L·ª±a ch·ªçn gi·ªØa c√°c theme c√≥ s·∫µn (S√°ng, T·ªëi, Pastel...) ho·∫∑c <strong>t·∫£i l√™n h√¨nh n·ªÅn c·ªßa ri√™ng b·∫°n</strong> ƒë·ªÉ t·∫°o c·∫£m h·ª©ng.</li>
                  <li><strong>√Çm b√°o T√πy ch·ªânh:</strong> B·∫°n c√≥ th·ªÉ <strong>t·∫£i l√™n c√°c file √¢m thanh (.mp3, .wav...) c·ªßa ri√™ng m√¨nh</strong> ƒë·ªÉ s·ª≠ d·ª•ng l√†m chu√¥ng b√°o cho c√°c phi√™n l√†m vi·ªác v√† ngh·ªâ ng∆°i.</li>
              </ul>

              <h4>Nh·∫°c N·ªÅn YouTube üé∂</h4>
              <p>T·∫°o kh√¥ng gian h·ªçc t·∫≠p ho√†n h·∫£o b·∫±ng c√°ch ph√°t m·ªôt video ho·∫∑c danh s√°ch ph√°t YouTube l√†m nh·∫°c n·ªÅn. D√°n ƒë∆∞·ªùng d·∫´n (URL) v√†o √¥ "Nh·∫°c n·ªÅn YouTube" trong C√†i ƒë·∫∑t.</p>

              <h4>An To√†n D·ªØ Li·ªáu: Sao L∆∞u & Ph·ª•c H·ªìi üõ°Ô∏è</h4>
              <p>·ª®ng d·ª•ng t·ª± ƒë·ªông sao l∆∞u ti·∫øn tr√¨nh c·ªßa b·∫°n m·ªói ng√†y. B·∫°n c√≥ th·ªÉ t√πy ch·ªânh s·ªë ng√†y l∆∞u gi·ªØ b·∫£n sao l∆∞u v√† ph·ª•c h·ªìi d·ªØ li·ªáu t·ª´ m·ªôt ng√†y trong qu√° kh·ª© n·∫øu c·∫ßn. ‚ö†Ô∏è <strong>C·∫£nh b√°o:</strong> Ph·ª•c h·ªìi s·∫Ω ghi ƒë√® to√†n b·ªô d·ªØ li·ªáu hi·ªán t·∫°i.</p>
          </div>
      </div>
    </main>
  </div>

  <div class="modal" id="modalMilestone" role="dialog" aria-modal="true" aria-labelledby="milestoneTitle">
    <div class="modal-card" style="width: min(600px, 94vw);">
        <h3 id="milestoneTitle">üéâ Ch√∫c m·ª´ng B·∫°n!</h3>
        <p id="milestoneMessage" style="white-space: pre-wrap; line-height: 1.6;"></p>
        <div class="row" style="justify-content:flex-end; margin-top:12px">
            <button class="btn acc" id="btnMilestoneClose">Ti·∫øp t·ª•c h√†nh tr√¨nh!</button>
        </div>
    </div>
  </div>
  <div class="modal" id="modalSettings" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="modal-card">
          <h3 id="settingsTitle">‚öôÔ∏è C√†i ƒë·∫∑t</h3>
          <nav class="tab-nav">
              <button class="tab-btn active" data-tab="settings-timer">ƒê·ªìng h·ªì</button>
              <button class="tab-btn" data-tab="settings-ui">Giao di·ªán & √Çm thanh</button>
              <button class="tab-btn" data-tab="settings-integrations">T√≠ch h·ª£p</button>
          </nav>
          <div class="settings-content">
              <div id="settings-timer" class="tab-content active" style="flex-direction:column; gap:20px;">
                  <div class="row" id="timerPresetSelector" style="margin-bottom:16px;">
                      <button class="btn acc" data-preset-target="A"> Ki·ªÉu A </button>
                      <button class="btn ghost" data-preset-target="B"> Ki·ªÉu B </button>
                      <button class="btn ghost" data-preset-target="C"> Ki·ªÉu C (Flow) </button>
                  </div>
                  <div id="settings-pomodoro">
                      <h4>Th·ªùi l∆∞·ª£ng Pomodoro</h4>
                      <div class="row">
                          <label>L√ÄM VI·ªÜC (ph√∫t)<input type="number" id="set_work" min="1" /></label>
                          <label>H·∫† NHI·ªÜT (ph√∫t)<input type="number" id="set_winddown" min="0" /></label>
                          <label>NGH·ªà NG·∫ÆN (ph√∫t)<input type="number" id="set_short" min="1" /></label>
                          <label>NGH·ªà D√ÄI (ph√∫t)<input type="number" id="set_long" min="1" /></label>
                      </div>
                      <div class="row">
                          <label>Chu k·ª≥ Pomodoro<input type="number" id="set_cycles" min="1" /></label>
                          <label>Chu k·ª≥ ngh·ªâ d√†i<input type="number" id="set_interval" min="2" /></label>
                      </div>
                  </div>
                  <div id="settings-flowtime" class="hidden">
                      <h4>Flowtime</h4>
                      <div class="row">
                          <label>T·ª∑ l·ªá ngh·ªâ (L√†m vi·ªác / X)
                              <input type="number" id="set_flowRatio" min="1" max="20" />
                          </label>
                      </div>
                      <p class="tiny" style="margin-top: 4px;">G·ª£i √Ω: Th·ªùi gian ngh·ªâ = t·ªïng th·ªùi gian l√†m vi·ªác / X. M·∫∑c ƒë·ªãnh l√† 5.</p>
                  </div>
                  <div class="settings-row-toggle">
                          <label for="set_autoStartNext">T·ª± ƒë·ªông b·∫Øt ƒë·∫ßu phi√™n ti·∫øp theo</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_autoStartNext">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableWinddown">B·∫≠t H·∫° nhi·ªát sau phi√™n l√†m</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableWinddown">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableSessionNotes">Nh·∫Øc ghi ch√∫ sau m·ªói phi√™n</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableSessionNotes">
                              <span class="slider"></span>
                          </label>
                      </div>
              </div>
              <div id="settings-ui" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Giao di·ªán</h4>
                      <div class="row">
                          <label>Theme Giao Di·ªán
                                <select id="set_theme_color">
                                    <option value="default">M·∫∑c ƒë·ªãnh (Dark Blue)</option>
                                    <option value="light">Light - Tr√† S·ªØa</option>
                                    <option value="pastel">Pastel - D·ªÖ th∆∞∆°ng</option>
                                    <option value="lofi">Lofi Study Room</option>
                                    <option value="space">Space Station</option>
                                </select>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 12px;">
                          <label>Ch·∫ø ƒë·ªô hi·ªÉn th·ªã n·ªÅn
                              <select id="set_backgroundMode">
                                  <option value="cover">L·∫•p ƒë·∫ßy (M·∫∑c ƒë·ªãnh)</option>
                                  <option value="contain">V·ª´a v·∫∑n (S·∫Øc n√©t)</option>
                                  <option value="auto">K√≠ch th∆∞·ªõc g·ªëc (L·∫∑p l·∫°i)</option>
                              </select>
                          </label>
                      </div>
                      <div class="row">
                          <label>H√¨nh n·ªÅn
                              <label class="btn small ghost" for="uploadBg">T·∫£i ·∫£nh m·ªõi</label>
                              <input type="file" id="uploadBg" accept="image/*" class="hidden" />
                          </label>
                          <button class="btn small danger" id="btnClearBg">X√≥a n·ªÅn</button>
                      </div>
                      <div class="row">
                          <label style="flex: 1;">ƒê·ªô trong su·ªët c·ªßa n·ªÅn</label>
                          <input type="range" id="set_panelOpacity" min="0.1" max="1" step="0.05" style="flex: 2;">
                      </div>
                      
                      
                   </div>
                  
                   <div>
                      <h4>√Çm thanh</h4>
                      <div class="row">
                          <label>√Çm l∆∞·ª£ng (0‚Äì1)<input type="number" id="set_volume" step="0.05" min="0" max="1"/></label>
                          <label>Ki·ªÉu √¢m b√°o
                              <select id="set_theme">
                                  <option value="beep">Beep</option>
                                  <option value="chime">Chime</option>
                              </select>
                          </label>
                           <button class="btn" id="btnTestSound" style="flex: 0 1 auto; align-self: center;">Test</button>
                      </div>
                      <div style="text-align: right; margin-top: 12px;">
                          <button class="btn ghost small" id="btnToggleCustomSounds">T√πy ch·ªânh √¢m b√°o</button>
                      </div>

                      <div id="customSoundsContainer" class="hidden" style="margin-top: 8px;">
                      <div class="row" style="display: flex; gap: 8px; justify-content: flex-end;">
                          <div>
                              <small>√Çm b√°o h·∫øt L√ÄM VI·ªÜC</small>
                              <label title="√Çm b√°o h·∫øt L√ÄM VI·ªÜC" class="btn small ghost" for="uploadSoundWork">L√ÄM VI·ªÜC</label>
                              <input type="file" id="uploadSoundWork" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>√Çm b√°o h·∫øt NGH·ªà NG·∫ÆN</small>
                              <label title="√Çm b√°o h·∫øt NGH·ªà NG·∫ÆN" class="btn small ghost" for="uploadSoundBreak">NGH·ªà NG·∫ÆN</label>
                              <input type="file" id="uploadSoundBreak" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>√Çm b√°o h·∫øt NGH·ªà D√ÄI</small>
                              <label title="√Çm b√°o h·∫øt NGH·ªà D√ÄI" class="btn small ghost" for="uploadSoundLong">NGH·ªà D√ÄI</label>
                              <input type="file" id="uploadSoundLong" accept="audio/*" class="hidden" />
                          </div>
                      </div>
                      </div>
                      
                  </div>
              </div>
              <div id="settings-integrations" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>T√≠ch h·ª£p AI</h4>
                      <label>Gemini API Key
                          <input type="password" id="set_apiKey" placeholder="D√°n API Key c·ªßa b·∫°n v√†o ƒë√¢y..." />
                      </label>
                      <div class="tiny">C·∫ßn c√≥ ƒë·ªÉ s·ª≠ d·ª•ng c√°c t√≠nh nƒÉng AI. L·∫•y key mi·ªÖn ph√≠ t·∫°i <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a>.</div>
                  </div>
                  <div>
                      <h4>üéµ Nh·∫°c n·ªÅn YouTube</h4>
                      <div class="row" style="gap:8px; align-items:center;">
                          <input type="text" id="set_youtubeUrl" placeholder="D√°n link YouTube v√†o ƒë√¢y..." style="flex:1;">
                          </div>
                      <div id="ytUrlFeedback" class="tiny" style="min-height: 1.2em; padding: 4px 0;"></div>
                      <div class="row" style="margin-top: 4px;">
                          <label style="flex: 0 1 auto; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                              <input type="checkbox" id="set_ytThumbAsBg">
                              <span>D√πng ·∫£nh b√¨a video l√†m n·ªÅn</span>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 8px;">
                          <button id="btnToggleYtSound" class="btn small" style="flex:0 1 auto;" title="D·ª´ng s·∫Ω kh√¥ng t·ª± ph√°t l·∫°i cho ƒë·∫øn khi b·∫°n b·∫•m ‚ñ∂Ô∏è">‚ñ∂Ô∏è</button>
                          <input type="range" id="ytSoundVolume" min="0" max="100" step="1" value="80" style="flex:1;">
                      </div>
                      <div class="tiny" style="text-align:center; margin-top:4px;">√Çm l∆∞·ª£ng</div>
                  </div>
                  <div>
                      <h4>üõ°Ô∏è C√†i ƒë·∫∑t sao l∆∞u</h4>
                      <div class="row">
                          <label>S·ªë ng√†y sao l∆∞u c·∫ßn gi·ªØ l·∫°i
                               <input type="number" id="set_backupDays" min="1" max="30" />
                          </label>
                      </div>
                  </div>
                  <div>
                      <h4>üõ°Ô∏è Ph·ª•c h·ªìi d·ªØ li·ªáu</h4>
                      <p class="tiny">Ph·ª•c h·ªìi d·ªØ li·ªáu t·ª´ m·ªôt b·∫£n sao l∆∞u t·ª± ƒë·ªông h√†ng ng√†y. H√†nh ƒë·ªông n√†y s·∫Ω ghi ƒë√® l√™n d·ªØ li·ªáu hi·ªán t·∫°i c·ªßa b·∫°n.</p>
                      <div class="row">
                          <select id="backupList" style="flex: 3;"></select>
                          <button id="btnRestoreBackup" class="btn warn small" style="flex: 1;">Ph·ª•c h·ªìi</button>
                      </div>
                  </div>
              </div>
          </div>
          <div class="row" style="margin-top:16px; justify-content:flex-end">
              <button class="btn ghost" id="btnDefaults">M·∫∑c ƒë·ªãnh</button>
              <button class="btn acc" id="btnSaveSettings">L∆∞u</button>
              <button class="btn" id="btnCloseSettings">ƒê√≥ng</button>
          </div>
      </div>
  </div>

  <div class="modal" id="modalNote" role="dialog" aria-modal="true" aria-labelledby="noteTitle">
    <div class="modal-card">
      <h3 id="noteTitle">üìù Ghi ch√∫ cho phi√™n v·ª´a ho√†n th√†nh</h3>
      <div class="row"><textarea id="noteText" placeholder="B·∫°n h·ªçc ƒë∆∞·ª£c g√¨? Kh√≥ khƒÉn? Next steps?"></textarea></div>
      <div class="row" style="justify-content:flex-end; margin-top:8px; gap: 12px;">
        <button class="btn" id="btnSummarizeNote">‚ú® T√≥m t·∫Øt & G·ª£i √Ω</button>
        <button class="btn" id="btnSkipNote">B·ªè qua</button>
        <button class="btn acc" id="btnSaveNote">L∆∞u ghi ch√∫</button>
      </div>
    </div>
  </div>

  <div class="modal" id="modalGeneric" role="dialog" aria-modal="true" aria-labelledby="genericTitle">
      <div class="modal-card" style="width: min(450px, 94vw);">
          <h3 id="genericTitle">Ti√™u ƒë·ªÅ</h3>
          <p id="genericMessage" class="hidden"></p>
          <input type="text" id="genericInput" class="hidden" />
          <div class="row" style="justify-content:flex-end; margin-top:12px">
              <button class="btn" id="btnGenericCancel">H·ªßy</button>
              <button class="btn acc" id="btnGenericOk">OK</button>
          </div>
      </div>
  </div>
  
  <div class="modal" id="modalDashboard" role="dialog" aria-modal="true" aria-labelledby="dashboardTitle">
    <div class="modal-card" style="width: min(800px, 95vw);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h3 id="dashboardTitle">üìä T·ªïng quan</h3>
            <button class="btn ghost small" id="btnCloseDashboard">ƒê√≥ng</button>
        </div>
        <p class="tiny">T·ªïng h·ª£p th·ªùi gian v√† s·ªë phi√™n ƒë√£ ho√†n th√†nh tr√™n t·∫•t c·∫£ c√°c ch·ªß ƒë·ªÅ.</p>
        <div id="dashboardContent" style="max-height: 60vh; overflow-y: auto;"></div>
    </div>
  </div>

  <div class="modal" id="modalMethodEditor" role="dialog" aria-modal="true">
    <div class="modal-card" style="width: min(800px, 95vw);">
      <h3 id="methodEditorTitle">Ch·ªânh-s·ª≠a Ph∆∞∆°ng-ph√°p</h3>
      
      <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
        <input type="hidden" id="methodEditorId">
        <label>Ti√™u-ƒë·ªÅ<input type="text" id="methodEditorTitleInput"></label>
        
        <label>N·ªôi-dung</label>
        <div class="editor-toolbar">
          <button id="toolH4" class="btn small ghost" title="Ti√™u-ƒë·ªÅ nh·ªè">H</button>
          <button id="toolBold" class="btn small ghost" title="In ƒë·∫≠m">B</button>
          <button id="toolItalic" class="btn small ghost" title="In nghi√™ng">I</button>
          <button id="toolList" class="btn small ghost" title="Danh-s√°ch">1.</button>
          <button id="toolBullet" class="btn small ghost" title="Danh s√°ch ch·∫•m tr√≤n">‚Ä¢</button>

          <div class="color-picker-wrapper">
            <button id="toolColor" class="btn small ghost" title="M√†u ch·ªØ">A</button>
            <div class="color-palette hidden">
              <button class="color-swatch" style="background-color: var(--text);" data-color="var(--text)" title="M√†u ch·ªØ m·∫∑c ƒë·ªãnh"></button>
              <button class="color-swatch" style="background-color: var(--acc);" data-color="var(--acc)" title="M√†u nh·∫•n m·∫°nh"></button>
              <button class="color-swatch" style="background-color: var(--acc-2);" data-color="var(--acc-2)" title="M√†u t√≠ch c·ª±c"></button>
              <button class="color-swatch" style="background-color: var(--warn);" data-color="var(--warn)" title="M√†u c·∫£nh b√°o"></button>
              <button class="color-swatch" style="background-color: var(--danger);" data-color="var(--danger)" title="M√†u nguy hi·ªÉm"></button>
              <button class="color-swatch" style="background-color: var(--purple);" data-color="var(--purple)" title="M√†u t√≠m"></button>
            </div>
          </div>
        </div>

        <div class="editor-container">
            <div id="methodEditorContentInput" class="editable-content" contenteditable="true"></div>
        </div>

      </div>

      <div class="row" style="justify-content:space-between; margin-top:16px">
        <button id="btnAutoFormat" class="btn small" disabled title="T√≠nh nƒÉng n√†y y√™u c·∫ßu Gemini API Key">‚ú® T·ª± ƒë·ªông ƒë·ªãnh d·∫°ng</button>
        <div>
          <button class="btn" id="btnCancelMethodEditor">H·ªßy</button>
          <button class="btn acc" id="btnSaveMethod">L∆∞u</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toasts" id="toasts"></div>
  <audio id="audioWorkEnd"></audio>
  <audio id="audioBreakEnd"></audio>
  <audio id="audioLongEnd"></audio>
  <div id="youtube-player-container"></div>

  <div id="draggableTimer" class="draggable-timer">00:00</div>

  <div id="soundPermissionBar" class="sound-permission-bar" role="alert" aria-live="polite">
    <span class="msg">Nh·∫•n "B·∫≠t √¢m thanh" ƒë·ªÉ cho ph√©p ph√°t nh·∫°c n·ªÅn.</span>
    <button id="btnEnableSound" class="btn small acc">B·∫≠t √¢m thanh</button>
  </div>
<!-- YouTube Iframe API is loaded dynamically when needed -->
<!-- === START: Inline Minimal Sortable (Offline-Safe) === -->
<script>
// Minimal Sortable shim for offline single-file usage.
// Supports: draggable selector, cross-list via same group, onEnd callback.
(function(){
  if (window.Sortable) return; // Respect existing if loaded
  const DND = { src: null, from: null, selector: null, group: null };
  function makeDraggable(container, selector){
    Array.from(container.querySelectorAll(selector)).forEach(el => {
      try { el.setAttribute('draggable','true'); } catch(_) {}
    });
  }
  function closestItem(e, selector){
    const t = e.target && e.target.closest ? e.target.closest(selector) : null;
    return t || null;
  }
  function Sortable(container, opts){
    this.el = container;
    this.options = opts || {};
    const selector = this.options.draggable || '*';
    const group = this.options.group || null;
    makeDraggable(container, selector);
    const handleDragStart = (e) => {
      const item = closestItem(e, selector);
      if (!item) return;
      DND.src = item; DND.from = container; DND.selector = selector; DND.group = group;
      e.dataTransfer.effectAllowed = 'move';
      try { e.dataTransfer.setData('text/plain', ''); } catch(_) {}
    };
    const handleDragOver = (e) => {
      if (!DND.src) return;
      // Only allow drop if same selector and group matches (or no group)
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
    };
    const handleDrop = (e) => {
      if (!DND.src) return;
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
      const from = DND.from;
      const to = container;
      const children = Array.from(from.querySelectorAll(DND.selector));
      const oldIndex = children.indexOf(DND.src);
      if (target && DND.src && target !== DND.src) {
        to.insertBefore(DND.src, target);
      }
      const newChildren = Array.from(to.querySelectorAll(DND.selector));
      const newIndex = newChildren.indexOf(DND.src);
      if (typeof this.options.onEnd === 'function') {
        try { this.options.onEnd({ oldIndex, newIndex, from, to, item: DND.src }); } catch(_) {}
      }
      DND.src = null; DND.from = null; DND.selector = null; DND.group = null;
    };
    this._listeners = { handleDragStart, handleDragOver, handleDrop };
    container.addEventListener('dragstart', handleDragStart);
    container.addEventListener('dragover', handleDragOver);
    container.addEventListener('drop', handleDrop);
    this.destroy = () => {
      container.removeEventListener('dragstart', handleDragStart);
      container.removeEventListener('dragover', handleDragOver);
      container.removeEventListener('drop', handleDrop);
    };
  }
  window.Sortable = Sortable;
})();
</script>
<!-- === END: Inline Minimal Sortable === -->
  <script>
   const _0x1f8e33=_0x44fa;(function(_0x50225e,_0x361c3){const _0x61604d=_0x44fa,_0x43aed8=_0x50225e();while(!![]){try{const _0x26643f=parseInt(_0x61604d(0x126))/0x1+parseInt(_0x61604d(0x2c3))/0x2+parseInt(_0x61604d(0x8b))/0x3*(-parseInt(_0x61604d(0x2c6))/0x4)+parseInt(_0x61604d(0x87))/0x5*(-parseInt(_0x61604d(0x34d))/0x6)+parseInt(_0x61604d(0x192))/0x7+-parseInt(_0x61604d(0x191))/0x8+parseInt(_0x61604d(0x319))/0x9*(parseInt(_0x61604d(0x22b))/0xa);if(_0x26643f===_0x361c3)break;else _0x43aed8['push'](_0x43aed8['shift']());}catch(_0x3b6794){_0x43aed8['push'](_0x43aed8['shift']());}}}(_0x32f5,0x93d81),window[_0x1f8e33(0x30e)](_0x1f8e33(0x99),()=>{try{updateFullscreenButton();}catch(_0x416b5e){}}));const IS_FILE_PROTOCOL=window[_0x1f8e33(0x2d8)][_0x1f8e33(0xd9)]===_0x1f8e33(0x1cb);function startYtApiWatchdog(){const _0x104bf2=_0x1f8e33,_0x423cdd=document[_0x104bf2(0x176)](_0x104bf2(0xe1));if(!_0x423cdd)return;const _0x31478c=setTimeout(()=>{const _0x463075=_0x104bf2;try{(!window['YT']||!window['YT'][_0x463075(0x235)])&&(_0x423cdd[_0x463075(0x1a6)]='Loading\x20YouTube\x20API...',_0x423cdd[_0x463075(0x10e)][_0x463075(0x282)]=_0x463075(0xce));}catch(_0x13ce1e){}},0x5dc),_0x33497c=setTimeout(()=>{const _0x401b93=_0x104bf2;try{(!window['YT']||!window['YT']['Player'])&&(_0x423cdd[_0x401b93(0x1a6)]='Failed\x20to\x20load\x20the\x20YouTube\x20API.\x20Check\x20your\x20network\x20or\x20reload\x20the\x20page.',_0x423cdd[_0x401b93(0x10e)][_0x401b93(0x282)]=_0x401b93(0x1b0));}catch(_0x41b086){}},0x1b58);window[_0x104bf2(0x2db)]={'cancel'(){clearTimeout(_0x31478c),clearTimeout(_0x33497c);}};}(function(){const _0x11f04c=_0x1f8e33,_0xdf7627={'timer.cycleInfo':({current:current=0x0,target:target=0x0}={})=>_0x11f04c(0x10f)+current+'/'+target,'timer.selectSubtopicPrompt':_0x11f04c(0x28a)};window['t']=function _0x561cef(_0x32f138,_0x3f4cf7){const _0x546d1f=_0x11f04c;try{const _0x8eaa=_0xdf7627[_0x32f138];if(typeof _0x8eaa===_0x546d1f(0x2ca))return _0x8eaa(_0x3f4cf7||{});if(typeof _0x8eaa===_0x546d1f(0x1b8))return _0x8eaa;}catch(_0x50e58d){}return _0x32f138;},window['loadLanguage']=function _0xeb0b2b(_0x487bcc){const _0x4fa927=_0x11f04c;try{localStorage[_0x4fa927(0x38b)](_0x4fa927(0x1ea),_0x487bcc||'en');}catch(_0x9be7ee){}return Promise[_0x4fa927(0x233)]();};}());function ensureYouTubeAPI(){const _0x1907d5=_0x1f8e33;if(IS_FILE_PROTOCOL)return Promise[_0x1907d5(0x233)](![]);try{if(window['YT']&&window['YT']['Player'])return Promise[_0x1907d5(0x233)](!![]);}catch(_0x2dfcae){}if(window[_0x1907d5(0x292)])return window['__ytApiPromise'];return startYtApiWatchdog(),window[_0x1907d5(0x292)]=new Promise((_0x1db265,_0x4d8543)=>{const _0x1820d8=_0x1907d5;try{const _0x26f85b=document[_0x1820d8(0x307)](_0x1820d8(0x17e));_0x26f85b[_0x1820d8(0x244)]='https://www.youtube.com/iframe_api',_0x26f85b[_0x1820d8(0x160)]=!![],_0x26f85b[_0x1820d8(0x214)]=!![],_0x26f85b[_0x1820d8(0x1c7)]=()=>_0x1db265(!![]),_0x26f85b[_0x1820d8(0x133)]=()=>_0x4d8543(new Error(_0x1820d8(0x12f))),document[_0x1820d8(0x122)][_0x1820d8(0x2cc)](_0x26f85b);}catch(_0x3c2c28){_0x4d8543(_0x3c2c28);}}),window[_0x1907d5(0x292)];}function _0x44fa(_0x24cb25,_0xd0f1ef){const _0x32f51c=_0x32f5();return _0x44fa=function(_0x44fadf,_0x2e5fac){_0x44fadf=_0x44fadf-0x7c;let _0x547067=_0x32f51c[_0x44fadf];return _0x547067;},_0x44fa(_0x24cb25,_0xd0f1ef);}const storageManager={'DB_NAME':_0x1f8e33(0x2f0),'DB_VERSION':0x1,'db':null,async 'initDB'(){return new Promise((_0x55c072,_0x34c86a)=>{const _0x3f30a8=_0x44fa;if(this['db'])return _0x55c072(this['db']);const _0x29ce58=indexedDB[_0x3f30a8(0x109)](this[_0x3f30a8(0x115)],this[_0x3f30a8(0xac)]);_0x29ce58[_0x3f30a8(0x90)]=_0x3daed7=>{const _0x563d3e=_0x3f30a8,_0x49bd54=_0x3daed7[_0x563d3e(0xa4)][_0x563d3e(0x7c)];!_0x49bd54[_0x563d3e(0x88)][_0x563d3e(0x136)](_0x563d3e(0x1f9))&&_0x49bd54[_0x563d3e(0x2f7)](_0x563d3e(0x1f9));!_0x49bd54['objectStoreNames']['contains'](_0x563d3e(0x372))&&_0x49bd54[_0x563d3e(0x2f7)]('topics',{'keyPath':'id'});if(!_0x49bd54[_0x563d3e(0x88)][_0x563d3e(0x136)](_0x563d3e(0x1c5))){const _0x9907dd=_0x49bd54['createObjectStore'](_0x563d3e(0x1c5),{'keyPath':'id'});_0x9907dd[_0x563d3e(0x200)](_0x563d3e(0x148),_0x563d3e(0x2c7));}!_0x49bd54[_0x563d3e(0x88)]['contains'](_0x563d3e(0x2a2))&&_0x49bd54['createObjectStore'](_0x563d3e(0x2a2),{'keyPath':'date'});},_0x29ce58['onsuccess']=_0x8e8b50=>{const _0x4c9a81=_0x3f30a8;this['db']=_0x8e8b50['target'][_0x4c9a81(0x7c)],console[_0x4c9a81(0xeb)](_0x4c9a81(0x19a)),_0x55c072(this['db']);},_0x29ce58[_0x3f30a8(0x133)]=_0x4c0487=>{const _0x9167b7=_0x3f30a8;console[_0x9167b7(0x132)](_0x9167b7(0x1e3),_0x4c0487['target'][_0x9167b7(0x1f1)]),_0x34c86a(_0x4c0487[_0x9167b7(0xa4)][_0x9167b7(0x132)]);};});},async '_getStore'(_0x4f11d9,_0x455b7c=_0x1f8e33(0xf6)){const _0x31f852=_0x1f8e33;await this[_0x31f852(0x2d1)]();const _0x19874f=this['db']['transaction']([_0x4f11d9],_0x455b7c);return _0x19874f[_0x31f852(0x189)](_0x4f11d9);},async 'getSettings'(){const _0x5d613a=_0x1f8e33,_0x17c0c0=await this[_0x5d613a(0x104)]('settings');return new Promise((_0x3a9383,_0x4a8f09)=>{const _0xe5ab4b=_0x5d613a,_0x1d34a3=_0x17c0c0[_0xe5ab4b(0x301)](_0xe5ab4b(0x342));_0x1d34a3[_0xe5ab4b(0x334)]=()=>_0x3a9383(_0x1d34a3[_0xe5ab4b(0x7c)]),_0x1d34a3[_0xe5ab4b(0x133)]=()=>_0x4a8f09(_0x1d34a3['error']);});},async 'updateSettings'(_0x6c724d){const _0x290ac9=_0x1f8e33,_0x117325=await this['_getStore'](_0x290ac9(0x1f9),_0x290ac9(0xda));return new Promise((_0xd9e84c,_0x1967c9)=>{const _0xef7eea=_0x290ac9,_0x1d45ef=_0x117325[_0xef7eea(0x1fb)](_0x6c724d,_0xef7eea(0x342));_0x1d45ef[_0xef7eea(0x334)]=()=>_0xd9e84c(_0x1d45ef['result']),_0x1d45ef[_0xef7eea(0x133)]=()=>_0x1967c9(_0x1d45ef[_0xef7eea(0x132)]);});},async 'getAll'(_0x11ea8b){const _0x33c3bb=_0x1f8e33,_0x502871=await this[_0x33c3bb(0x104)](_0x11ea8b);return new Promise((_0x3c8690,_0x104531)=>{const _0x4495db=_0x33c3bb,_0x3b3eb8=_0x502871[_0x4495db(0x23d)]();_0x3b3eb8[_0x4495db(0x334)]=()=>_0x3c8690(_0x3b3eb8['result']),_0x3b3eb8[_0x4495db(0x133)]=()=>_0x104531(_0x3b3eb8['error']);});},async 'update'(_0x1a1893,_0x4e353e){const _0x463bc1=_0x1f8e33,_0x1481ac=await this[_0x463bc1(0x104)](_0x1a1893,_0x463bc1(0xda));return new Promise((_0x4aefb3,_0x41b1ef)=>{const _0x550e4b=_0x463bc1,_0x396d99=_0x1481ac['put'](_0x4e353e);_0x396d99[_0x550e4b(0x334)]=()=>_0x4aefb3(_0x396d99['result']),_0x396d99['onerror']=()=>_0x41b1ef(_0x396d99[_0x550e4b(0x132)]);});},async 'add'(_0x42ac36,_0x19193b){const _0x5a5be5=_0x1f8e33,_0x271685=await this['_getStore'](_0x42ac36,_0x5a5be5(0xda));return new Promise((_0x216c58,_0x5f19f7)=>{const _0x4f2710=_0x5a5be5,_0x3084c1=_0x271685[_0x4f2710(0x2d4)](_0x19193b);_0x3084c1[_0x4f2710(0x334)]=()=>_0x216c58(_0x3084c1['result']),_0x3084c1[_0x4f2710(0x133)]=()=>_0x5f19f7(_0x3084c1[_0x4f2710(0x132)]);});},async 'delete'(_0xda4cdc,_0x92a1bd){const _0x3e431f=_0x1f8e33,_0x3dbc3c=await this[_0x3e431f(0x104)](_0xda4cdc,_0x3e431f(0xda));return new Promise((_0x247a8a,_0x42b2ef)=>{const _0x2c70bb=_0x3e431f,_0x13b608=_0x3dbc3c[_0x2c70bb(0xb9)](_0x92a1bd);_0x13b608[_0x2c70bb(0x334)]=()=>_0x247a8a(_0x13b608[_0x2c70bb(0x7c)]),_0x13b608['onerror']=()=>_0x42b2ef(_0x13b608['error']);});},async 'save'(_0x214533){const _0x5e1809=_0x1f8e33;return await this[_0x5e1809(0x2d1)](),new Promise((_0x5127db,_0x5833d0)=>{const _0x4a8de7=_0x5e1809,_0x5729d2=this['db'][_0x4a8de7(0x1cf)]([_0x4a8de7(0x1f9),_0x4a8de7(0x372),_0x4a8de7(0x1c5)],'readwrite'),_0x5125ee=_0x5729d2['objectStore']('settings'),_0xd6c707=_0x5729d2[_0x4a8de7(0x189)](_0x4a8de7(0x372)),_0x412345=_0x5729d2[_0x4a8de7(0x189)](_0x4a8de7(0x1c5));_0x5125ee[_0x4a8de7(0x1fb)](_0x214533[_0x4a8de7(0x1f9)],'main_settings'),_0xd6c707[_0x4a8de7(0x306)](),_0x412345[_0x4a8de7(0x306)](),_0x214533[_0x4a8de7(0x372)][_0x4a8de7(0x2dd)](_0x1b5f53=>{const _0x1dbd3d=_0x4a8de7,{subtopics:_0x46f994,..._0x26c2cc}=_0x1b5f53;_0xd6c707[_0x1dbd3d(0x1fb)](_0x26c2cc),(_0x46f994||[])[_0x1dbd3d(0x2dd)](_0x2e43e2=>_0x412345[_0x1dbd3d(0x1fb)](_0x2e43e2));}),_0x5729d2['oncomplete']=()=>_0x5127db(),_0x5729d2[_0x4a8de7(0x133)]=_0x3cfb7d=>_0x5833d0(_0x3cfb7d[_0x4a8de7(0xa4)][_0x4a8de7(0x132)]);});},async 'autoBackup'(_0x21adcb){const _0x355dd3=_0x1f8e33;await this[_0x355dd3(0x2d1)]();const _0x19ba38=new Date()[_0x355dd3(0x333)]()[_0x355dd3(0x123)](0x0,0xa),_0x580591=localStorage[_0x355dd3(0x86)](_0x355dd3(0x2fd));if(_0x19ba38!==_0x580591){console['log']('Creating\x20backup\x20for\x20'+_0x19ba38+'...');const _0x2cedf4={'date':_0x19ba38,'data':JSON[_0x355dd3(0x150)](JSON['stringify'](_0x21adcb))},_0x2a816e=this['db']['transaction']([_0x355dd3(0x2a2)],'readwrite'),_0xafe6cc=_0x2a816e[_0x355dd3(0x189)](_0x355dd3(0x2a2)),_0x1375cb=_0xafe6cc[_0x355dd3(0x1fb)](_0x2cedf4);_0x1375cb['onsuccess']=()=>{const _0x539116=_0x355dd3;localStorage['setItem'](_0x539116(0x2fd),_0x19ba38),console[_0x539116(0xeb)](_0x539116(0x275)),this['cleanupOldBackups'](_0x21adcb?.[_0x539116(0x1f9)]?.[_0x539116(0x147)]||0x7);},_0x1375cb[_0x355dd3(0x133)]=_0x457e0e=>{const _0x595a63=_0x355dd3;console['error'](_0x595a63(0x2ba),_0x457e0e['target'][_0x595a63(0x132)]);};}},async 'cleanupOldBackups'(_0x4ceef2){const _0xaea9a9=_0x1f8e33;await this[_0xaea9a9(0x2d1)]();const _0x468933=this['db'][_0xaea9a9(0x1cf)]([_0xaea9a9(0x2a2)],'readwrite'),_0x389dd2=_0x468933[_0xaea9a9(0x189)](_0xaea9a9(0x2a2)),_0x16eea3=_0x389dd2[_0xaea9a9(0x316)]();_0x16eea3['onsuccess']=()=>{const _0x30957d=_0xaea9a9,_0x22f4f7=_0x16eea3['result'][_0x30957d(0x119)]()['reverse']();if(_0x22f4f7[_0x30957d(0x370)]>_0x4ceef2){const _0x150672=_0x22f4f7[_0x30957d(0x123)](_0x4ceef2);_0x150672[_0x30957d(0x2dd)](_0x58598b=>{const _0x46dcd9=_0x30957d;_0x389dd2[_0x46dcd9(0xb9)](_0x58598b),console[_0x46dcd9(0xeb)](_0x46dcd9(0x2ef)+_0x58598b);});}};},async 'getBackupList'(){const _0x431289=_0x1f8e33;return await this[_0x431289(0x2d1)](),new Promise((_0x3d23c1,_0xe97ea6)=>{const _0x59133b=_0x431289,_0x1690c8=this['db']['transaction'](['backups'],'readonly'),_0x119347=_0x1690c8['objectStore'](_0x59133b(0x2a2)),_0x41b350=_0x119347[_0x59133b(0x23d)]();_0x41b350[_0x59133b(0x334)]=()=>_0x3d23c1(_0x41b350[_0x59133b(0x7c)][_0x59133b(0x119)]((_0x2a40a5,_0x2c3994)=>_0x2c3994[_0x59133b(0x2bd)][_0x59133b(0x13a)](_0x2a40a5[_0x59133b(0x2bd)]))),_0x41b350[_0x59133b(0x133)]=_0x1f762e=>_0xe97ea6(_0x1f762e[_0x59133b(0xa4)][_0x59133b(0x132)]);});},async 'restoreBackup'(_0x3a1037){const _0x18383c=_0x1f8e33;return await this[_0x18383c(0x2d1)](),new Promise((_0x14432b,_0xc633bc)=>{const _0x959142=_0x18383c,_0x5a7e68=this['db']['transaction']([_0x959142(0x2a2)],_0x959142(0xf6)),_0x446578=_0x5a7e68[_0x959142(0x189)](_0x959142(0x2a2)),_0x3d3687=_0x446578[_0x959142(0x301)](_0x3a1037);_0x3d3687['onsuccess']=()=>{const _0x3d9f2b=_0x959142;_0x3d3687[_0x3d9f2b(0x7c)]&&_0x3d3687['result'][_0x3d9f2b(0x34b)]?(localStorage[_0x3d9f2b(0x38b)]('pomodoroData_v11',JSON[_0x3d9f2b(0x367)](_0x3d3687[_0x3d9f2b(0x7c)]['data'])),_0x14432b(_0x3d3687['result']['data'])):_0xc633bc(new Error('Backup\x20not\x20found.'));},_0x3d3687[_0x959142(0x133)]=_0xf9e90f=>_0xc633bc(_0xf9e90f[_0x959142(0xa4)][_0x959142(0x132)]);});},'exportData'(_0x4da558){const _0x6ff3e4=_0x1f8e33;let _0x261025={};try{_0x261025=JSON[_0x6ff3e4(0x150)](JSON['stringify'](_0x4da558||{}));}catch(_0x138536){_0x261025=_0x4da558;}try{if(_0x261025&&_0x261025[_0x6ff3e4(0x1f9)])_0x261025[_0x6ff3e4(0x1f9)]['apiKey']='';}catch(_0x577c35){}const _0x7f4a1e=new Blob([JSON[_0x6ff3e4(0x367)](_0x261025,null,0x2)],{'type':_0x6ff3e4(0x9c)}),_0x4030f0=document[_0x6ff3e4(0x307)]('a'),_0x19e2bf=new Date(),_0x2fe622=_0x54d2a7=>(''+_0x54d2a7)['padStart'](0x2,'0');_0x4030f0[_0x6ff3e4(0x2fc)]=URL[_0x6ff3e4(0x11a)](_0x7f4a1e),_0x4030f0[_0x6ff3e4(0x1a5)]=_0x6ff3e4(0x2e4)+_0x19e2bf['getFullYear']()+_0x2fe622(_0x19e2bf[_0x6ff3e4(0x84)]()+0x1)+_0x2fe622(_0x19e2bf[_0x6ff3e4(0x2a1)]())+'.json',_0x4030f0[_0x6ff3e4(0x2ad)](),URL[_0x6ff3e4(0x1c0)](_0x4030f0[_0x6ff3e4(0x2fc)]);},async 'importData'(_0x4847ef){const _0xf2a2b4=_0x1f8e33,_0x3239d0=await _0x4847ef[_0xf2a2b4(0x38a)](),_0x4900b1=JSON[_0xf2a2b4(0x150)](_0x3239d0);if(!_0x4900b1['version']||!_0x4900b1[_0xf2a2b4(0x1f9)]||!Array[_0xf2a2b4(0x2dc)](_0x4900b1['topics']))throw new Error(_0xf2a2b4(0x392));try{const _0x5a535d=window['data']&&window[_0xf2a2b4(0x34b)][_0xf2a2b4(0x1f9)]&&window[_0xf2a2b4(0x34b)]['settings'][_0xf2a2b4(0x298)]||'';(!(_0xf2a2b4(0x298)in _0x4900b1[_0xf2a2b4(0x1f9)])||_0x4900b1[_0xf2a2b4(0x1f9)][_0xf2a2b4(0x298)]==='')&&(_0x4900b1['settings'][_0xf2a2b4(0x298)]=_0x5a535d);}catch(_0x25fe3d){}return localStorage['setItem'](_0xf2a2b4(0x22d),JSON[_0xf2a2b4(0x367)](_0x4900b1)),_0x4900b1;}},$=(_0x326304,_0xe1bbae=document)=>_0xe1bbae[_0x1f8e33(0x1e4)](_0x326304),breakSuggestions=[_0x1f8e33(0x38c),'Drink\x20a\x20glass\x20of\x20water\x20to\x20stay\x20hydrated.',_0x1f8e33(0x26e),_0x1f8e33(0x2fa),_0x1f8e33(0x21e),'Tidy\x20or\x20rearrange\x20your\x20workspace.',_0x1f8e33(0x34c),_0x1f8e33(0xfe),_0x1f8e33(0x7d),'Relax\x20your\x20body\x20and\x20notice\x20your\x20breath.','Place\x20a\x20hand\x20on\x20your\x20chest\x20and\x20feel\x20your\x20heartbeat.',_0x1f8e33(0x228),'Gently\x20massage\x20your\x20temples.',_0x1f8e33(0x21d),_0x1f8e33(0x2a6),_0x1f8e33(0xcb),_0x1f8e33(0x393),_0x1f8e33(0x80),'Relax\x20your\x20legs\x20and\x20rotate\x20your\x20ankles\x20under\x20the\x20desk.',_0x1f8e33(0xb1),_0x1f8e33(0x22e),'Take\x20one\x20deep\x20sigh\x20and\x20relax\x20your\x20shoulders.',_0x1f8e33(0x2ac),_0x1f8e33(0x267),_0x1f8e33(0x1eb),_0x1f8e33(0x168),_0x1f8e33(0x19c),_0x1f8e33(0x209),_0x1f8e33(0x286),_0x1f8e33(0x12e),'Check\x20your\x20breathing‚Äîif\x20rushed,\x20slow\x20it\x20down.',_0x1f8e33(0xd7)],$$=(_0x26cb69,_0xa64238=document)=>Array['from'](_0xa64238[_0x1f8e33(0x1b7)](_0x26cb69));function on(_0x3ebdfe,_0x187d1e,_0x3ce6c0){const _0x1af304=_0x1f8e33;if(!_0x3ebdfe){console[_0x1af304(0x1d0)](_0x1af304(0x181),_0x187d1e);return;}_0x3ebdfe[_0x1af304(0x30e)](_0x187d1e,_0x3ce6c0);}const formatMMSS=_0x4ecb60=>{const _0x15f911=_0x1f8e33,_0x2d949d=Math[_0x15f911(0x381)](_0x4ecb60/0x3c)[_0x15f911(0x183)]()['padStart'](0x2,'0'),_0x48a05a=Math[_0x15f911(0x381)](_0x4ecb60%0x3c)[_0x15f911(0x183)]()['padStart'](0x2,'0');return _0x2d949d+':'+_0x48a05a;},uid=(_0x3199dd='id')=>_0x3199dd+'_'+Date[_0x1f8e33(0x255)]()+'_'+Math[_0x1f8e33(0x2c4)]()[_0x1f8e33(0x183)](0x24)['slice'](0x2,0x9);let __releaseFocusTrap=null;function trapFocus(_0x36b9fd){const _0x41afd9=_0x1f8e33;try{const _0x2919ab=_0x36b9fd[_0x41afd9(0x1b7)](_0x41afd9(0x25f));if(!_0x2919ab[_0x41afd9(0x370)])return;const _0x15ffe4=_0x2919ab[0x0],_0x3dcf3c=_0x2919ab[_0x2919ab[_0x41afd9(0x370)]-0x1],_0x4248dc=_0x3262ac=>{const _0x2851a6=_0x41afd9;if(_0x3262ac[_0x2851a6(0xf8)]==='Tab'){if(_0x3262ac[_0x2851a6(0xb0)]&&document[_0x2851a6(0xcc)]===_0x15ffe4)_0x3262ac[_0x2851a6(0x288)](),_0x3dcf3c['focus']();else!_0x3262ac['shiftKey']&&document[_0x2851a6(0xcc)]===_0x3dcf3c&&(_0x3262ac[_0x2851a6(0x288)](),_0x15ffe4[_0x2851a6(0xae)]());}};_0x36b9fd[_0x41afd9(0x30e)](_0x41afd9(0x261),_0x4248dc),_0x15ffe4[_0x41afd9(0xae)](),__releaseFocusTrap=()=>{const _0x3a4764=_0x41afd9;try{_0x36b9fd[_0x3a4764(0x8a)]('keydown',_0x4248dc);}catch(_0x1f426f){}};}catch(_0x30d7b0){}}function releaseFocus(){if(__releaseFocusTrap){try{__releaseFocusTrap();}catch(_0xbe84a2){}__releaseFocusTrap=null;}}const todayISO=()=>new Date()['toISOString']();function toast(_0x396542,_0xa1ba7=0xa28){const _0x570143=_0x1f8e33,_0x2a60fb=$(_0x570143(0x1e5)),_0x108f14=document[_0x570143(0x307)](_0x570143(0x179));_0x108f14[_0x570143(0x8c)]=_0x570143(0x11c),_0x108f14[_0x570143(0x1a6)]=_0x396542,_0x2a60fb[_0x570143(0x2cc)](_0x108f14),setTimeout(()=>{const _0x122f38=_0x570143;_0x108f14[_0x122f38(0x10e)][_0x122f38(0xa9)]='0';},_0xa1ba7-0x12c),setTimeout(()=>_0x2a60fb[_0x570143(0x277)](_0x108f14),_0xa1ba7);}function escapeHTML(_0x4c51ff){const _0x5dfb8e=_0x1f8e33;return _0x4c51ff['replace'](/[&<>"']/g,_0x4a9a67=>({'&':_0x5dfb8e(0x385),'<':_0x5dfb8e(0x345),'>':_0x5dfb8e(0x2c9),'\x22':'&quot;','\x27':_0x5dfb8e(0x2ff)}[_0x4a9a67]));}function formatDaysHoursMinutes(_0x1fad52){const _0x903f2d=_0x1f8e33;if(!_0x1fad52||_0x1fad52<0x1)return _0x903f2d(0x27e);const _0x1bfb61=Math['floor'](_0x1fad52/0x3c),_0x42b540=_0x1fad52%0x3c,_0x577d74=_0x42b540['toString']()[_0x903f2d(0x85)](0x2,'0');return _0x1bfb61+'\x20hours\x20'+_0x577d74+_0x903f2d(0x199);}function formatGeminiResponse(_0x2917af){return _0x2917af['replace'](/(\*\*|__|\*|_|#+\s*)/g,'');}function parseSimpleMarkdown(_0x283827){const _0xcf15cf=_0x1f8e33,_0xd2f549=(_0x283827||'')[_0xcf15cf(0xd2)]('\x0a');let _0x594ed1='',_0x589421=null;const _0x2f29dd=()=>{const _0xf52ebb=_0xcf15cf;_0x589421&&(_0x594ed1+=_0x589421==='ol'?'</ol>':_0xf52ebb(0x134),_0x589421=null);};for(let _0xee4e95 of _0xd2f549){let _0x299d62=(_0xee4e95||'')[_0xcf15cf(0x26a)]();if(!_0x299d62){_0x2f29dd();continue;}if(_0x299d62[_0xcf15cf(0x35b)](_0xcf15cf(0x9e)))_0x2f29dd(),_0x594ed1+='<h4>'+escapeHTML(_0x299d62[_0xcf15cf(0x34a)](0x5))+_0xcf15cf(0x390);else{if(/^\d+\.\s/['test'](_0x299d62)){_0x589421!=='ol'&&(_0x2f29dd(),_0x594ed1+=_0xcf15cf(0x18a),_0x589421='ol');const _0x528b7c=_0x299d62[_0xcf15cf(0x34a)](_0x299d62[_0xcf15cf(0x241)]('\x20')+0x1);_0x594ed1+='<li>'+escapeHTML(_0x528b7c)+_0xcf15cf(0x2f4);}else _0x299d62[_0xcf15cf(0x35b)]('-\x20')?(_0x589421!=='ul'&&(_0x2f29dd(),_0x594ed1+=_0xcf15cf(0x81),_0x589421='ul'),_0x594ed1+=_0xcf15cf(0x1d6)+escapeHTML(_0x299d62[_0xcf15cf(0x34a)](0x2))+'</li>'):(_0x2f29dd(),_0x299d62=escapeHTML(_0x299d62)[_0xcf15cf(0x318)](/\*\*(.*?)\*\*/g,'<strong>$1</strong>')[_0xcf15cf(0x318)](/_(.*?)_/g,_0xcf15cf(0x139)),_0x594ed1+=_0xcf15cf(0x138)+_0x299d62+_0xcf15cf(0x245));}}return _0x2f29dd(),_0x594ed1;}function wrapTextInMarkdown(_0x5a3632,_0x565a83,_0x4456ae=''){const _0x486d2e=_0x1f8e33;if(!_0x5a3632)return;const _0x515982=_0x5a3632[_0x486d2e(0x9b)]||0x0,_0x5c67c8=_0x5a3632['selectionEnd']||0x0,_0x8a5e5b=_0x5a3632[_0x486d2e(0x278)][_0x486d2e(0x34a)](_0x515982,_0x5c67c8),_0x419594=_0x565a83+_0x8a5e5b+(_0x4456ae||_0x565a83);_0x5a3632[_0x486d2e(0x314)](_0x419594,_0x515982,_0x5c67c8,'end'),_0x5a3632[_0x486d2e(0xae)]();}function updateEditorPreview(){const _0x1a4c01=_0x1f8e33,_0x605c9f=$(_0x1a4c01(0x388)),_0x42920d=$(_0x1a4c01(0x396));if(!_0x605c9f||!_0x42920d)return;const _0x8798ac=_0x605c9f[_0x1a4c01(0x278)]||'';_0x42920d[_0x1a4c01(0xa6)]=parseSimpleMarkdown(_0x8798ac);}function normalizeDataStructure(_0x2a9d51){const _0x575e83=_0x1f8e33;if(!_0x2a9d51||typeof _0x2a9d51!=='object')return;const _0x28aafe=_0x2a9d51[_0x575e83(0x1f9)]||{},_0x4375a8={...defaults[_0x575e83(0x1f9)],..._0x28aafe,'durations':{...defaults[_0x575e83(0x1f9)][_0x575e83(0x1c9)],..._0x28aafe[_0x575e83(0x1c9)]||{}}};if(!Array[_0x575e83(0x2dc)](_0x4375a8[_0x575e83(0x194)]))_0x4375a8[_0x575e83(0x194)]=[];_0x2a9d51[_0x575e83(0x1f9)]=_0x4375a8,_0x2a9d51[_0x575e83(0x372)]=Array['isArray'](_0x2a9d51[_0x575e83(0x372)])?_0x2a9d51[_0x575e83(0x372)]:[],_0x2a9d51[_0x575e83(0x372)][_0x575e83(0x2dd)](_0x489da6=>{const _0x4014ff=_0x575e83;_0x489da6[_0x4014ff(0x1c5)]=Array[_0x4014ff(0x2dc)](_0x489da6[_0x4014ff(0x1c5)])?_0x489da6['subtopics']:[],_0x489da6['subtopics'][_0x4014ff(0x2dd)](_0x1dec30=>{const _0x489210=_0x4014ff;_0x1dec30[_0x489210(0x308)]=_0x1dec30[_0x489210(0x308)]||[],_0x1dec30[_0x489210(0x35e)]=_0x1dec30[_0x489210(0x35e)]||[],_0x1dec30[_0x489210(0x18f)]=_0x1dec30[_0x489210(0x18f)]||[],_0x1dec30['chatHistory']=_0x1dec30['chatHistory']||[],_0x1dec30[_0x489210(0x1f7)]=Array[_0x489210(0x2dc)](_0x1dec30[_0x489210(0x1f7)])?_0x1dec30[_0x489210(0x1f7)]:[],_0x1dec30[_0x489210(0x1fe)]=_0x1dec30['stats']||{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},_0x1dec30[_0x489210(0xf9)]=_0x1dec30[_0x489210(0xf9)]||[],_0x1dec30[_0x489210(0xaa)]=_0x1dec30[_0x489210(0xaa)]||{'state':_0x489210(0x315),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0};});});}function extractYouTubeID(_0x31d826){const _0x44ff57=_0x1f8e33;if(!_0x31d826)return null;const _0x3d72d4=/^.*(?:youtu.be\/|shorts\/|live\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([A-Za-z0-9_-]{11}).*/,_0x348a1d=_0x31d826[_0x44ff57(0x95)](_0x3d72d4);return _0x348a1d?_0x348a1d[0x1]:null;}let sessionYoutubeUrl='';function getActiveYoutubeUrl(){const _0x294b2a=_0x1f8e33;try{if(sessionYoutubeUrl)return sessionYoutubeUrl;const _0x9e5f94=document['getElementById'](_0x294b2a(0x177)),_0x14b96c=(_0x9e5f94&&_0x9e5f94[_0x294b2a(0x278)]?_0x9e5f94[_0x294b2a(0x278)]:'')['trim']();return _0x14b96c;}catch(_0x30990b){return'';}}function getActiveVideoId(){return extractYouTubeID(getActiveYoutubeUrl());}async function migrateSharedMethodsToCurrentSubtopic(){const _0x447330=_0x1f8e33;try{const _0x4030eb=data?.[_0x447330(0x1f9)]?.[_0x447330(0x1f7)]||[];if(!Array[_0x447330(0x2dc)](_0x4030eb)||_0x4030eb[_0x447330(0x370)]===0x0)return;const _0x2e7034=getCurrentSubtopic();if(!_0x2e7034)return;(!Array[_0x447330(0x2dc)](_0x2e7034[_0x447330(0x1f7)])||_0x2e7034['methods']['length']===0x0)&&(_0x2e7034[_0x447330(0x1f7)]=_0x4030eb,data[_0x447330(0x1f9)]['methods']=[],await saveData());}catch(_0x396e6f){}}function handleYoutubeUrlInput(){const _0x55c66f=_0x1f8e33,_0x172eca=$(_0x55c66f(0x2b8)),_0x366dc7=$('#ytUrlFeedback'),_0x3c382d=$(_0x55c66f(0x37b)),_0xb42909=_0x172eca[_0x55c66f(0x278)][_0x55c66f(0x26a)](),_0x9c275d=extractYouTubeID(_0xb42909);if(_0x9c275d){_0x366dc7[_0x55c66f(0x1a6)]='OK.\x20Valid\x20link.\x20Preparing\x20to\x20play...',_0x366dc7[_0x55c66f(0x10e)][_0x55c66f(0x282)]=_0x55c66f(0x14b),_0x3c382d['disabled']=![],sessionYoutubeUrl=_0xb42909;try{ytUserPaused=![];}catch(_0x7dff64){}try{const _0x4767f1=_0x55c66f(0x1a4)+_0x9c275d+_0x55c66f(0x259),_0x1740f2=new Image();_0x1740f2[_0x55c66f(0x1c7)]=async()=>{const _0x82f519=_0x55c66f;data[_0x82f519(0x1f9)][_0x82f519(0x18d)]=_0x4767f1;try{await saveData();}catch(_0x49f804){}applyCustomBg();},_0x1740f2[_0x55c66f(0x133)]=async()=>{const _0x3afa2b=_0x55c66f,_0x108fd7='https://img.youtube.com/vi/'+_0x9c275d+'/hqdefault.jpg';data[_0x3afa2b(0x1f9)][_0x3afa2b(0x18d)]=_0x108fd7;try{await saveData();}catch(_0x184744){}applyCustomBg();},_0x1740f2[_0x55c66f(0x244)]=_0x4767f1;}catch(_0x55c079){}try{if(IS_FILE_PROTOCOL){const _0x3d4a65=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x9c275d,{'autoplay':0x1,'mute':_0x3d4a65});try{setTimeout(()=>{const _0x55734=_0x55c66f;try{fallbackPostMessage(_0x55734(0x1c1));}catch(_0x5228da){}},0xfa);}catch(_0x10b7e7){}!_ytUnlocked&&showSoundPermission();try{setTimeout(()=>{const _0x440eab=_0x55c66f,_0xe56fed=document[_0x440eab(0x176)](_0x440eab(0xe1));if(_0xe56fed)_0xe56fed[_0x440eab(0x1a6)]='Playing';},0x1f4);}catch(_0x26e72c){}}else ensureYouTubeAPI()[_0x55c66f(0x17f)](()=>{const _0x1645d1=_0x55c66f;updateYouTubePlayer();try{if(_ytUnlocked)ytFadeInPlay();else ytPlayer&&ytPlayer[_0x1645d1(0xe0)]&&ytPlayer[_0x1645d1(0x1c1)]&&(ytPlayer[_0x1645d1(0xe0)](),ytPlayer[_0x1645d1(0x1c1)](),_ytPrimed=!![],showSoundPermission());}catch(_0x2f767f){}})[_0x55c66f(0x1aa)](()=>{});}catch(_0x5b168a){}}else{if(_0xb42909===''){_0x366dc7[_0x55c66f(0x1a6)]='',_0x3c382d[_0x55c66f(0x201)]=!![];if(IS_FILE_PROTOCOL)try{fallbackStop();}catch(_0x40b024){}else ytPlayer&&ytPlayer[_0x55c66f(0x258)]&&ytPlayer[_0x55c66f(0x258)]();}else _0x366dc7[_0x55c66f(0x1a6)]=_0x55c66f(0x2e1),_0x366dc7['style'][_0x55c66f(0x282)]=_0x55c66f(0x1b0),_0x3c382d[_0x55c66f(0x201)]=!![];}}function applyTheme(_0x3e8354){const _0x361015=_0x1f8e33,_0x4366b2=_0x3e8354||data['settings'][_0x361015(0x2aa)]||_0x361015(0x368);document[_0x361015(0x22c)][_0x361015(0xe5)][_0x361015(0x2aa)]=_0x4366b2;const _0x3dfca5=[_0x361015(0xa5),_0x361015(0x213)][_0x361015(0x359)](_0x4366b2),_0xcedbb0=_0x4366b2===_0x361015(0x197)||_0x4366b2===_0x361015(0xdf),_0x4f29c9=data[_0x361015(0x1f9)][_0x361015(0x18d)],_0xa2d687=()=>{const _0x165b8f=_0x361015;try{document[_0x165b8f(0x22c)][_0x165b8f(0x10e)][_0x165b8f(0x32c)]='';}catch(_0x485338){}};if(_0x4f29c9&&!data[_0x361015(0x1f9)]['useYtThumbnailAsBg'])document['body'][_0x361015(0x10e)][_0x361015(0x82)](_0x361015(0x169),_0x361015(0xf7)+_0x4f29c9+')'),_0xa2d687();else{if(_0x4f29c9&&data['settings']['useYtThumbnailAsBg'])document[_0x361015(0x22c)][_0x361015(0x10e)][_0x361015(0x82)](_0x361015(0x169),_0x361015(0xf7)+_0x4f29c9+')'),_0xa2d687();else{if(_0x3dfca5)document[_0x361015(0x22c)][_0x361015(0x10e)][_0x361015(0x1ec)](_0x361015(0x169)),_0xa2d687();else _0xcedbb0?(document[_0x361015(0x22c)][_0x361015(0x10e)][_0x361015(0x82)](_0x361015(0x169),_0x361015(0x219)),_0xa2d687()):(document[_0x361015(0x22c)][_0x361015(0x10e)][_0x361015(0x82)](_0x361015(0x169),''),document['body']['style']['backgroundImage']=_0x361015(0x366));}}}const defaults={'version':0x1,'settings':{'apiKey':'','currentView':_0x1f8e33(0x1a8),'preset':'A','autoStartNext':!![],'soundOn':!![],'volume':0.8,'soundTheme':'beep','theme':_0x1f8e33(0x368),'cyclesA':0x4,'longBreakIntervalA':0x4,'cyclesB':0x4,'longBreakIntervalB':0x4,'flowtimeBreakRatio':0x5,'enableSessionNotes':!![],'enableWinddown':!![],'durations':{'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},'selectedTopicId':'','selectedSubtopicId':'','collapsedTopics':{},'customBg':'','customSounds':{'work_end':'','break_end':'','long_end':''},'youtubeUrl':'','youtubeVolume':0x50,'useYtThumbnailAsBg':!![],'panelOpacity':0.85,'panelBlur':0xa,'backgroundMode':'cover','backupDaysToKeep':0x7,'achievedMilestones':[],'methods':[{'id':uid('m'),'title':_0x1f8e33(0x225),'content':'<p>The\x20core\x20idea:\x20\x22If\x20you\x20can‚Äôt\x20explain\x20a\x20topic\x20simply,\x20you\x20don‚Äôt\x20truly\x20understand\x20it.\x22\x20The\x20goal\x20is\x20to\x20turn\x20complex\x20knowledge\x20into\x20explanations\x20simple\x20enough\x20that\x20a\x20child\x20could\x20understand.</p><h4>Streamlined\x204-Step\x20Process</h4><ol><li><strong>Learn:</strong>\x20Pick\x20a\x20topic\x20and\x20write\x20down\x20everything\x20you\x20know\x20about\x20it.</li><li><strong>Teach:</strong>\x20Pretend\x20to\x20teach\x20it\x20using\x20the\x20simplest\x20language\x20possible.\x20Write\x20or\x20speak\x20it\x20out\x20loud.</li><li><strong>Find\x20&\x20Fix\x20Gaps:</strong>\x20Whenever\x20you\x20get\x20\x22stuck\x22,\x20rely\x20on\x20jargon,\x20or\x20can‚Äôt\x20explain\x20smoothly,\x20you‚Äôve\x20found\x20a\x20knowledge\x20gap.\x20Go\x20back\x20to\x20the\x20source\x20and\x20learn\x20until\x20the\x20gap\x20is\x20filled.</li><li><strong>Simplify:</strong>\x20Reorganize\x20your\x20final\x20explanation,\x20using\x20simple\x20examples\x20or\x20analogies\x20so\x20it‚Äôs\x20clear\x20and\x20easy\x20to\x20grasp.</li></ol><h4>Essence</h4><p>The\x20Feynman\x20Technique\x20forces\x20you\x20to\x20move\x20from\x20passive\x20intake\x20(reading,\x20listening)\x20to\x20actively\x20processing\x20information.\x20The\x20moment\x20you\x20\x22get\x20stuck\x22\x20is\x20a\x20powerful\x20diagnostic\x20tool‚Äîpinpointing\x20exactly\x20where\x20you‚Äôre\x20weak.</p><p><i>The\x20quickest\x20way\x20to\x20check\x20and\x20strengthen\x20understanding\x20is\x20to\x20try\x20teaching\x20it\x20simply\x20to\x20someone\x20else.</i></p>'},{'id':uid('m'),'title':_0x1f8e33(0x113),'content':_0x1f8e33(0x309)},{'id':uid('m'),'title':'The\x2080/20\x20Principle\x20for\x20Mastering\x20a\x20New\x20Field','content':_0x1f8e33(0x379)},{'id':uid('m'),'title':_0x1f8e33(0x12d),'content':_0x1f8e33(0x1f8)},{'id':uid('m'),'title':_0x1f8e33(0x207),'content':_0x1f8e33(0x163)}]},'topics':[]};let data,editingPreset='A',AUDIO_CTX=null;function ensureAudio(){const _0x38baa7=_0x1f8e33;if(!AUDIO_CTX)AUDIO_CTX=new(window['AudioContext']||window[(_0x38baa7(0x25a))])();}function tone(_0x4f266e=0x370,_0x47d4a8=0xc8,_0x287f3b=0.2,_0x20a77d=_0x1f8e33(0xe7),_0x3f6966=0x0){const _0x46e672=_0x1f8e33;ensureAudio();const _0x526f1b=AUDIO_CTX,_0x4319f6=_0x526f1b['createOscillator'](),_0x3bd012=_0x526f1b['createGain']();_0x4319f6[_0x46e672(0x13e)]=_0x20a77d,_0x4319f6['frequency']['value']=_0x4f266e,_0x4319f6['connect'](_0x3bd012),_0x3bd012[_0x46e672(0x1bc)](_0x526f1b[_0x46e672(0x2b9)]);const _0x156bb9=_0x526f1b['currentTime']+_0x3f6966;_0x3bd012['gain'][_0x46e672(0x83)](0x0,_0x156bb9),_0x3bd012[_0x46e672(0x32e)][_0x46e672(0x32b)](_0x287f3b,_0x156bb9+0.01),_0x3bd012[_0x46e672(0x32e)][_0x46e672(0x327)](0.0001,_0x156bb9+_0x47d4a8/0x3e8),_0x4319f6[_0x46e672(0x36d)](_0x156bb9),_0x4319f6[_0x46e672(0x33c)](_0x156bb9+_0x47d4a8/0x3e8+0.05);}function playSound(_0x1813b3){const _0x40f1e9=_0x1f8e33;if(!data[_0x40f1e9(0x1f9)][_0x40f1e9(0x399)])return;const _0x165835=Math[_0x40f1e9(0xe4)](0x0,Math['min'](0x1,data['settings'][_0x40f1e9(0x246)]??0.8)),_0x38e124=data[_0x40f1e9(0x1f9)]['customSounds']?.[_0x1813b3];let _0x5c4305;if(_0x1813b3==='work_end')_0x5c4305=$(_0x40f1e9(0x37d));else{if(_0x1813b3===_0x40f1e9(0x394))_0x5c4305=$(_0x40f1e9(0x1e7));else{if(_0x1813b3===_0x40f1e9(0x170))_0x5c4305=$(_0x40f1e9(0x2d7));}}if(_0x38e124&&_0x5c4305){_0x38e124[_0x40f1e9(0x35b)](_0x40f1e9(0x24c))||_0x38e124[_0x40f1e9(0x35b)](_0x40f1e9(0x2e6))||_0x38e124['startsWith'](_0x40f1e9(0x26c))?(_0x5c4305['src']=_0x38e124,_0x5c4305['volume']=_0x165835,_0x5c4305[_0x40f1e9(0x304)]()[_0x40f1e9(0x1aa)](_0x37c07f=>console[_0x40f1e9(0x132)](_0x40f1e9(0x29d),_0x37c07f))):getStoredFileUrl(_0x38e124)[_0x40f1e9(0x17f)](_0x4d957e=>{const _0x38e37f=_0x40f1e9;_0x4d957e&&(_0x5c4305[_0x38e37f(0x244)]=_0x4d957e,_0x5c4305[_0x38e37f(0x246)]=_0x165835,_0x5c4305[_0x38e37f(0x304)]()[_0x38e37f(0x1aa)](_0x222f28=>console['error']('Audio\x20playback\x20error:',_0x222f28)));});return;}const _0x5ea164=data[_0x40f1e9(0x1f9)][_0x40f1e9(0x175)]||'beep';if(_0x5ea164===_0x40f1e9(0x25e)){if(_0x1813b3==='work_end')tone(0x370,0xfa,_0x165835),tone(0x294,0xb4,_0x165835*0.8,_0x40f1e9(0xe7),0.22);else{if(_0x1813b3===_0x40f1e9(0x394))tone(0x294,0xdc,_0x165835*0.9);else _0x1813b3===_0x40f1e9(0x170)&&(tone(0x208,0xc8,_0x165835),tone(0x30c,0xc8,_0x165835,_0x40f1e9(0xe7),0.22),tone(0x410,0xdc,_0x165835,_0x40f1e9(0xe7),0.44));}}else{if(_0x1813b3===_0x40f1e9(0x30d))tone(0x4b0,0xa0,_0x165835*0.9,_0x40f1e9(0x9d)),tone(0x384,0xdc,_0x165835*0.8,_0x40f1e9(0x9d),0.18);else{if(_0x1813b3===_0x40f1e9(0x394))tone(0x370,0xf0,_0x165835*0.8,_0x40f1e9(0x9d));else _0x1813b3===_0x40f1e9(0x170)&&(tone(0x258,0xdc,_0x165835*0.9,_0x40f1e9(0x9d)),tone(0x3b6,0xf0,_0x165835*0.9,_0x40f1e9(0x9d),0.22),tone(0x4b0,0xf0,_0x165835,_0x40f1e9(0x9d),0.44));}}}async function saveData(){const _0x3751d3=_0x1f8e33;try{await storageManager[_0x3751d3(0x1fd)](data);}catch(_0x2296c2){console[_0x3751d3(0x132)](_0x3751d3(0xc1),_0x2296c2),toast(_0x3751d3(0xa1)+_0x2296c2[_0x3751d3(0x36e)]);}}async function ensureValidSelection(){const _0x1cf5e9=_0x1f8e33,_0x332bc3=data[_0x1cf5e9(0x1f9)];if(!data[_0x1cf5e9(0x372)]||data[_0x1cf5e9(0x372)][_0x1cf5e9(0x370)]===0x0){_0x332bc3['selectedTopicId']='',_0x332bc3['selectedSubtopicId']='',await saveData();return;}const _0x16b5f6=data[_0x1cf5e9(0x372)][_0x1cf5e9(0x352)](_0x36f707=>_0x36f707['id']===_0x332bc3[_0x1cf5e9(0x29b)]),_0x4cf896=_0x16b5f6?.[_0x1cf5e9(0x1c5)]['find'](_0x556b09=>_0x556b09['id']===_0x332bc3[_0x1cf5e9(0x208)]);if(!_0x16b5f6||!_0x4cf896){const _0x4517df=data['topics'][0x0],_0x431b43=_0x4517df?.[_0x1cf5e9(0x1c5)]?.[0x0];_0x332bc3[_0x1cf5e9(0x29b)]=_0x4517df?.['id']||'',_0x332bc3[_0x1cf5e9(0x208)]=_0x431b43?.['id']||'',await saveData();}}function showInputModal(_0x5e66ee,_0x65d622,_0x229e72=''){const _0x3c9a28=_0x1f8e33;$(_0x3c9a28(0x1c3))[_0x3c9a28(0x1a6)]=_0x5e66ee,$(_0x3c9a28(0x154))[_0x3c9a28(0x164)][_0x3c9a28(0x2d4)](_0x3c9a28(0xcf));const _0x4ba8db=$(_0x3c9a28(0x157));_0x4ba8db['value']=_0x229e72,_0x4ba8db[_0x3c9a28(0x164)][_0x3c9a28(0xf3)](_0x3c9a28(0xcf)),$(_0x3c9a28(0x273))['classList'][_0x3c9a28(0x2d4)](_0x3c9a28(0x2e8));try{trapFocus($(_0x3c9a28(0x273)));}catch(_0x5b6375){}_0x4ba8db[_0x3c9a28(0xae)](),_0x4ba8db[_0x3c9a28(0x17d)]();const _0x282e70=()=>{const _0x21c1be=_0x3c9a28;_0x65d622(_0x4ba8db[_0x21c1be(0x278)]),_0x30d21b();},_0x4f6a32=()=>_0x30d21b(),_0x333fb0=_0x2aa1a0=>{const _0x3b6e35=_0x3c9a28;if(_0x2aa1a0[_0x3b6e35(0xf8)]==='Enter')_0x282e70();if(_0x2aa1a0[_0x3b6e35(0xf8)]===_0x3b6e35(0x172))_0x4f6a32();};$('#btnGenericOk')[_0x3c9a28(0x211)]=_0x282e70,$('#btnGenericCancel')[_0x3c9a28(0x211)]=_0x4f6a32,_0x4ba8db[_0x3c9a28(0x389)]=_0x333fb0;function _0x30d21b(){const _0x28c5d6=_0x3c9a28;$(_0x28c5d6(0x273))[_0x28c5d6(0x164)]['remove'](_0x28c5d6(0x2e8)),$('#btnGenericOk')[_0x28c5d6(0x211)]=null,$(_0x28c5d6(0x1db))['onclick']=null,_0x4ba8db['onkeydown']=null;try{releaseFocus();}catch(_0x19b112){}}}function showConfirmModal(_0x3c386d,_0x2f9116,_0x8ed02d){const _0x2951f5=_0x1f8e33;$(_0x2951f5(0x1c3))[_0x2951f5(0x1a6)]=_0x3c386d;const _0x5c4f22=$(_0x2951f5(0x154));_0x5c4f22['textContent']=_0x2f9116,_0x5c4f22[_0x2951f5(0x164)]['remove'](_0x2951f5(0xcf)),$('#genericInput')[_0x2951f5(0x164)][_0x2951f5(0x2d4)](_0x2951f5(0xcf)),$(_0x2951f5(0x273))[_0x2951f5(0x164)][_0x2951f5(0x2d4)](_0x2951f5(0x2e8));try{trapFocus($(_0x2951f5(0x273)));}catch(_0x22ed03){}const _0x2c0481=()=>{_0x8ed02d(!![]),_0x2bbebb();},_0x1d3425=()=>{_0x8ed02d(![]),_0x2bbebb();};$(_0x2951f5(0x108))['onclick']=_0x2c0481,$('#btnGenericCancel')[_0x2951f5(0x211)]=_0x1d3425;function _0x2bbebb(){const _0x2685e7=_0x2951f5;$(_0x2685e7(0x273))[_0x2685e7(0x164)][_0x2685e7(0xf3)]('show'),$(_0x2685e7(0x108))['onclick']=null,$(_0x2685e7(0x1db))['onclick']=null;try{releaseFocus();}catch(_0x30c327){}}}let pendingNoteSessionId=null;function openNoteModal(_0x5f8dcc){const _0x2e5ccd=_0x1f8e33;pendingNoteSessionId=_0x5f8dcc||null;const _0x337d6f=$(_0x2e5ccd(0x1e0));if(!_0x337d6f)return;const _0x3ea7ff=$(_0x2e5ccd(0x1ff));if(_0x3ea7ff)try{_0x3ea7ff[_0x2e5ccd(0x278)]='';}catch(_0x134f40){}_0x337d6f['classList'][_0x2e5ccd(0x2d4)](_0x2e5ccd(0x2e8));try{trapFocus(_0x337d6f);}catch(_0x9f88ff){}}function closeNoteModal(){const _0x14399b=_0x1f8e33,_0x190906=$(_0x14399b(0x1e0));if(!_0x190906)return;_0x190906['classList'][_0x14399b(0xf3)](_0x14399b(0x2e8)),pendingNoteSessionId=null;try{releaseFocus();}catch(_0x37dc71){}}async function switchView(_0x170397){const _0x425717=_0x1f8e33;$$(_0x425717(0x186))[_0x425717(0x2dd)](_0xcc2e52=>_0xcc2e52[_0x425717(0x164)][_0x425717(0xf3)](_0x425717(0x1ca))),$(_0x425717(0x31e)+_0x170397)[_0x425717(0x164)]['add'](_0x425717(0x1ca)),$$('.nav-btn')[_0x425717(0x2dd)](_0x2a9657=>_0x2a9657[_0x425717(0x164)][_0x425717(0xf3)]('active'));const _0x4f0392=$(_0x425717(0x198)+_0x170397+'\x22]');if(_0x4f0392)_0x4f0392[_0x425717(0x164)][_0x425717(0x2d4)](_0x425717(0x1ca));data[_0x425717(0x1f9)][_0x425717(0x37e)]=_0x170397,await saveData(),_0x170397==='stats'&&renderDashboard();}function closeAllMenus(){const _0xca98ae=_0x1f8e33;$$('.actions-menu.show')[_0xca98ae(0x2dd)](_0x51ea1b=>_0x51ea1b[_0xca98ae(0x164)][_0xca98ae(0xf3)](_0xca98ae(0x2e8))),$$('.topic-item.menu-active')['forEach'](_0x8824b=>_0x8824b['classList'][_0xca98ae(0xf3)](_0xca98ae(0x310)));}function renderTopics(){const _0x5e1f7b=_0x1f8e33,_0x2120b9=$(_0x5e1f7b(0x250));if(!_0x2120b9)return;_0x2120b9['innerHTML']='';const _0x3c8b50=data[_0x5e1f7b(0x1f9)][_0x5e1f7b(0x12a)]||{};data[_0x5e1f7b(0x372)][_0x5e1f7b(0x2dd)](_0x471bd3=>{const _0x143948=_0x5e1f7b,_0x3c42b0=document[_0x143948(0x307)](_0x143948(0x179));_0x3c42b0[_0x143948(0x8c)]=_0x143948(0x14c),_0x3c42b0['dataset'][_0x143948(0x30a)]=_0x471bd3['id'];const _0x436fc0=document['createElement']('div');_0x436fc0['className']=_0x143948(0x1e6);const _0x481ec2=!!_0x3c8b50[_0x471bd3['id']],_0x4b2514=document[_0x143948(0x307)](_0x143948(0x13f));_0x4b2514[_0x143948(0x8c)]=_0x143948(0x1f4),_0x4b2514['setAttribute'](_0x143948(0x101),String(!_0x481ec2)),_0x4b2514[_0x143948(0xa6)]=_0x143948(0x1b2);const _0x5ce5a0=document[_0x143948(0x307)](_0x143948(0x179));_0x5ce5a0[_0x143948(0x8c)]=_0x143948(0x158),_0x5ce5a0[_0x143948(0x1a6)]=_0x471bd3[_0x143948(0x149)];const _0x229963=document['createElement'](_0x143948(0x179));_0x229963[_0x143948(0x8c)]='topic-actions';const _0x35c5c5=document[_0x143948(0x307)](_0x143948(0x13f));_0x35c5c5['className']=_0x143948(0x178),_0x35c5c5[_0x143948(0xa6)]=_0x143948(0x1bb),_0x35c5c5[_0x143948(0x2b7)]=_0x143948(0x2df);const _0x130912=document[_0x143948(0x307)](_0x143948(0x179));_0x130912[_0x143948(0x10e)]['position']=_0x143948(0x20c);const _0x56bed4=document['createElement'](_0x143948(0x13f));_0x56bed4[_0x143948(0x8c)]=_0x143948(0x135),_0x56bed4[_0x143948(0xa6)]='...',_0x56bed4['title']=_0x143948(0x2a9);const _0x38deba=document[_0x143948(0x307)](_0x143948(0x179));_0x38deba[_0x143948(0x8c)]=_0x143948(0x358);const _0x4997f9=document[_0x143948(0x307)](_0x143948(0x13f));_0x4997f9['className']=_0x143948(0x11d),_0x4997f9[_0x143948(0xa6)]='Rename\x20Topic';const _0x35758a=document[_0x143948(0x307)]('button');_0x35758a[_0x143948(0x8c)]=_0x143948(0x2f9),_0x35758a[_0x143948(0xa6)]=_0x143948(0x1d5),_0x38deba['append'](_0x4997f9,_0x35758a),_0x130912[_0x143948(0x32a)](_0x56bed4,_0x38deba),_0x229963['append'](_0x35c5c5,_0x130912),_0x436fc0['append'](_0x4b2514,_0x5ce5a0,_0x229963),_0x4b2514[_0x143948(0x30e)](_0x143948(0x2ad),async _0x1c0d6f=>{const _0x18bf8e=_0x143948;_0x1c0d6f['stopPropagation']();const _0x31852d=!!_0x3c8b50[_0x471bd3['id']];_0x31852d?delete _0x3c8b50[_0x471bd3['id']]:_0x3c8b50[_0x471bd3['id']]=!![],data[_0x18bf8e(0x1f9)][_0x18bf8e(0x12a)]=_0x3c8b50,await storageManager[_0x18bf8e(0x142)](data['settings']),renderTopics();});const _0x31fd15=async()=>{const _0x45a91d=_0x143948,_0xf33480=!!_0x3c8b50[_0x471bd3['id']];_0xf33480?delete _0x3c8b50[_0x471bd3['id']]:_0x3c8b50[_0x471bd3['id']]=!![],data[_0x45a91d(0x1f9)][_0x45a91d(0x12a)]=_0x3c8b50,await storageManager['updateSettings'](data[_0x45a91d(0x1f9)]),renderTopics();};_0x436fc0[_0x143948(0x30e)](_0x143948(0x2ad),async _0xe1fc23=>{const _0x3e4af8=_0x143948,_0x1a3f14=_0xe1fc23[_0x3e4af8(0xa4)];if(_0x1a3f14&&_0x1a3f14[_0x3e4af8(0x336)]){if(_0x1a3f14['closest'](_0x3e4af8(0x289))||_0x1a3f14[_0x3e4af8(0x336)](_0x3e4af8(0x1bd))||_0x1a3f14[_0x3e4af8(0x336)]('button')||_0x1a3f14[_0x3e4af8(0x336)]('input,select,textarea'))return;}_0xe1fc23[_0x3e4af8(0x2d9)](),await _0x31fd15();}),_0x5ce5a0[_0x143948(0x30e)]('click',async _0x338623=>{const _0x36ae20=_0x143948;_0x338623[_0x36ae20(0x2d9)](),await _0x31fd15();}),_0x3c42b0[_0x143948(0x30e)](_0x143948(0x2ad),async _0x1f9974=>{const _0x47850c=_0x143948,_0x35416f=_0x1f9974[_0x47850c(0xa4)];if(_0x35416f&&_0x35416f[_0x47850c(0x336)]){if(_0x35416f[_0x47850c(0x336)](_0x47850c(0x96)))return;if(_0x35416f[_0x47850c(0x336)]('.actions-menu')||_0x35416f[_0x47850c(0x336)](_0x47850c(0x1bd))||_0x35416f['closest'](_0x47850c(0x13f))||_0x35416f[_0x47850c(0x336)](_0x47850c(0xbb)))return;}await _0x31fd15();});const _0x4bf690=document[_0x143948(0x307)](_0x143948(0x179));_0x4bf690[_0x143948(0x8c)]='subtopics'+(_0x481ec2?_0x143948(0x2e3):''),_0x4bf690[_0x143948(0xe5)][_0x143948(0x30a)]=_0x471bd3['id'],_0x471bd3[_0x143948(0x1c5)][_0x143948(0x2dd)](_0x48018a=>{const _0x486a89=_0x143948,_0x4441f6=document[_0x486a89(0x307)](_0x486a89(0x179));_0x4441f6[_0x486a89(0x8c)]=_0x486a89(0xab),_0x4441f6[_0x486a89(0xe5)][_0x486a89(0x1ac)]=_0x48018a['id'];const _0x2df541=document[_0x486a89(0x307)](_0x486a89(0x13f));_0x2df541[_0x486a89(0x8c)]=_0x486a89(0x242),_0x2df541[_0x486a89(0x1a6)]='‚Ä¢\x20'+_0x48018a['name'],_0x2df541[_0x486a89(0xe5)][_0x486a89(0x1ac)]=_0x48018a['id'],_0x2df541[_0x486a89(0xe5)][_0x486a89(0x30a)]=_0x471bd3['id'];if(data[_0x486a89(0x1f9)][_0x486a89(0x208)]===_0x48018a['id'])_0x2df541[_0x486a89(0x164)][_0x486a89(0x2d4)](_0x486a89(0x1ca));const _0x51cf49=document['createElement'](_0x486a89(0x179));_0x51cf49[_0x486a89(0x8c)]=_0x486a89(0x34e);const _0x3752c2=document['createElement'](_0x486a89(0x179));_0x3752c2[_0x486a89(0x10e)][_0x486a89(0x1ab)]=_0x486a89(0x20c);const _0x4a9d45=document[_0x486a89(0x307)](_0x486a89(0x13f));_0x4a9d45['className']=_0x486a89(0x135),_0x4a9d45[_0x486a89(0xa6)]=_0x486a89(0x302),_0x4a9d45[_0x486a89(0x2b7)]=_0x486a89(0x2a9);const _0x28270d=document[_0x486a89(0x307)](_0x486a89(0x179));_0x28270d[_0x486a89(0x8c)]='actions-menu';const _0x3958ac=document[_0x486a89(0x307)](_0x486a89(0x13f));_0x3958ac['className']=_0x486a89(0x11d),_0x3958ac[_0x486a89(0xa6)]=_0x486a89(0x305);const _0x124020=document[_0x486a89(0x307)](_0x486a89(0x13f));_0x124020[_0x486a89(0x8c)]=_0x486a89(0x2f9),_0x124020[_0x486a89(0xa6)]=_0x486a89(0x1a7),_0x28270d[_0x486a89(0x32a)](_0x3958ac,_0x124020),_0x3752c2['append'](_0x4a9d45,_0x28270d),_0x51cf49[_0x486a89(0x32a)](_0x3752c2),_0x4441f6[_0x486a89(0x32a)](_0x2df541,_0x51cf49),_0x4bf690[_0x486a89(0x2cc)](_0x4441f6),_0x2df541['addEventListener'](_0x486a89(0x2ad),()=>selectSubtopic(_0x471bd3['id'],_0x48018a['id'])),_0x4a9d45['addEventListener'](_0x486a89(0x2ad),_0x23b320=>{const _0x5b571b=_0x486a89;_0x23b320[_0x5b571b(0x2d9)]();const _0x38010a=_0x28270d[_0x5b571b(0x164)][_0x5b571b(0x136)]('show');closeAllMenus(),_0x38010a?_0x3c42b0['classList']['remove']('menu-active'):(_0x28270d['classList'][_0x5b571b(0x2d4)](_0x5b571b(0x2e8)),_0x3c42b0[_0x5b571b(0x164)][_0x5b571b(0x2d4)](_0x5b571b(0x310)));}),_0x3958ac[_0x486a89(0x30e)](_0x486a89(0x2ad),()=>showInputModal(_0x486a89(0x305),async _0x17accd=>{const _0x5aba3b=_0x486a89;if(!_0x17accd)return;_0x48018a['name']=_0x17accd,await storageManager[_0x5aba3b(0x28f)]('subtopics',_0x48018a),renderAll();},_0x48018a['name'])),_0x124020['addEventListener'](_0x486a89(0x2ad),()=>showConfirmModal(_0x486a89(0x111),_0x486a89(0x2af)+_0x48018a[_0x486a89(0x149)]+_0x486a89(0x269),async _0x1faf18=>{const _0x3c25f9=_0x486a89;if(!_0x1faf18)return;_0x471bd3[_0x3c25f9(0x1c5)]=_0x471bd3[_0x3c25f9(0x1c5)][_0x3c25f9(0x2f6)](_0x908e8d=>_0x908e8d['id']!==_0x48018a['id']);const _0x116851=data[_0x3c25f9(0x1f9)];_0x116851[_0x3c25f9(0x208)]===_0x48018a['id']&&(_0x116851['selectedSubtopicId']='',_0x116851[_0x3c25f9(0x29b)]='',ensureValidSelection()),await storageManager[_0x3c25f9(0xb9)]('subtopics',_0x48018a['id']),renderAll();}));}),_0x56bed4[_0x143948(0x30e)]('click',_0x33a273=>{const _0x3edbd9=_0x143948;_0x33a273['stopPropagation']();const _0xef20c=_0x38deba[_0x3edbd9(0x164)][_0x3edbd9(0x136)](_0x3edbd9(0x2e8));closeAllMenus(),_0xef20c?_0x3c42b0['classList']['remove'](_0x3edbd9(0x310)):(_0x38deba[_0x3edbd9(0x164)][_0x3edbd9(0x2d4)](_0x3edbd9(0x2e8)),_0x3c42b0[_0x3edbd9(0x164)][_0x3edbd9(0x2d4)](_0x3edbd9(0x310)));}),_0x35c5c5[_0x143948(0x30e)]('click',()=>showInputModal(_0x143948(0x2b5),async _0x1b1371=>{const _0x270d19=_0x143948;if(!_0x1b1371)return;const _0x4b1961={'id':uid('s'),'topicId':_0x471bd3['id'],'name':_0x1b1371,'tasks':[],'generalNotes':[],'summaries':[],'chatHistory':[],'methods':[],'stats':{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},'sessions':[],'timerState':{'state':_0x270d19(0x315),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0}};try{const _0x2b8d32=data?.[_0x270d19(0x1f9)]?.['methods']||[];Array['isArray'](_0x2b8d32)&&_0x2b8d32['length']>0x0&&(_0x4b1961['methods']=_0x2b8d32,data['settings'][_0x270d19(0x1f7)]=[],await storageManager[_0x270d19(0x142)](data['settings']));}catch(_0x4e48ad){}_0x471bd3[_0x270d19(0x1c5)][_0x270d19(0x19f)](_0x4b1961),await storageManager[_0x270d19(0x2d4)](_0x270d19(0x1c5),_0x4b1961),renderTopics();})),_0x4997f9[_0x143948(0x30e)](_0x143948(0x2ad),()=>showInputModal(_0x143948(0x28d),async _0x58a96a=>{const _0x22a681=_0x143948;if(!_0x58a96a)return;_0x471bd3['name']=_0x58a96a,await storageManager[_0x22a681(0x28f)]('topics',_0x471bd3),renderTopics();},_0x471bd3['name'])),_0x35758a[_0x143948(0x30e)]('click',()=>showConfirmModal('Confirm\x20Deletion',_0x143948(0x384)+_0x471bd3[_0x143948(0x149)]+_0x143948(0x1cd),async _0x431230=>{const _0x2e47c4=_0x143948;if(!_0x431230)return;data[_0x2e47c4(0x372)]=data['topics'][_0x2e47c4(0x2f6)](_0x4599e0=>_0x4599e0['id']!==_0x471bd3['id']),delete _0x3c8b50[_0x471bd3['id']];data[_0x2e47c4(0x1f9)][_0x2e47c4(0x29b)]===_0x471bd3['id']&&(data[_0x2e47c4(0x1f9)]['selectedTopicId']='',data[_0x2e47c4(0x1f9)][_0x2e47c4(0x208)]='',ensureValidSelection());await storageManager[_0x2e47c4(0xb9)](_0x2e47c4(0x372),_0x471bd3['id']);for(const _0x555e33 of _0x471bd3['subtopics']){await storageManager['delete'](_0x2e47c4(0x1c5),_0x555e33['id']);}renderAll();})),_0x35c5c5['addEventListener'](_0x143948(0x2ad),_0x1f34e0=>_0x1f34e0[_0x143948(0x2d9)]()),_0x4997f9[_0x143948(0x30e)](_0x143948(0x2ad),_0x4df91a=>_0x4df91a['stopPropagation']()),_0x35758a['addEventListener'](_0x143948(0x2ad),_0x533b12=>_0x533b12[_0x143948(0x2d9)]()),_0x3c42b0[_0x143948(0x32a)](_0x436fc0,_0x4bf690),_0x2120b9['appendChild'](_0x3c42b0);});if(window[_0x5e1f7b(0x116)]){const _0x2bb69c=document[_0x5e1f7b(0x176)](_0x5e1f7b(0xb7));if(_0x2bb69c){if(_0x2bb69c['_sortable'])try{_0x2bb69c[_0x5e1f7b(0x2c0)][_0x5e1f7b(0x36a)]();}catch(_0x2149ad){}_0x2bb69c[_0x5e1f7b(0x2c0)]=new Sortable(_0x2bb69c,{'animation':0x96,'draggable':_0x5e1f7b(0x328),'onEnd':async function(_0x17f727){const _0x459d69=_0x5e1f7b;if(_0x17f727[_0x459d69(0x377)]===_0x17f727[_0x459d69(0x10d)])return;const _0x5290a3=data['topics'][_0x459d69(0x13c)](_0x17f727[_0x459d69(0x377)],0x1)[0x0];data[_0x459d69(0x372)][_0x459d69(0x13c)](_0x17f727[_0x459d69(0x10d)],0x0,_0x5290a3),await saveData(),renderTopics();}}),_0x2bb69c['querySelectorAll'](_0x5e1f7b(0x96))[_0x5e1f7b(0x2dd)](_0x183803=>{const _0x580115=_0x5e1f7b;new Sortable(_0x183803,{'group':_0x580115(0x373),'animation':0x96,'draggable':_0x580115(0x204),'onEnd':async function(_0xb0a2c5){const _0x287ecf=_0x580115,_0xcc5fbf=_0xb0a2c5[_0x287ecf(0x35a)]?.[_0x287ecf(0xe5)]?.[_0x287ecf(0x30a)]||_0xb0a2c5['from']?.[_0x287ecf(0x336)]('.topic-item')?.['dataset']?.['tid'],_0x2bf948=_0xb0a2c5['to']?.[_0x287ecf(0xe5)]?.[_0x287ecf(0x30a)]||_0xb0a2c5['to']?.[_0x287ecf(0x336)](_0x287ecf(0x328))?.[_0x287ecf(0xe5)]?.[_0x287ecf(0x30a)],_0x14877d=data[_0x287ecf(0x372)][_0x287ecf(0x352)](_0x457b39=>_0x457b39['id']===_0xcc5fbf),_0x87db2b=data[_0x287ecf(0x372)][_0x287ecf(0x352)](_0x5c1b5e=>_0x5c1b5e['id']===_0x2bf948);if(!_0x14877d||!_0x87db2b)return;let _0x5c7ea2=null;const _0x343126=_0xb0a2c5[_0x287ecf(0x182)]?.['dataset']?.['sid']||_0xb0a2c5[_0x287ecf(0x182)]?.[_0x287ecf(0x1e4)](_0x287ecf(0x173))?.[_0x287ecf(0xe5)]?.['sid'];if(_0x343126){const _0x5f287d=_0x14877d['subtopics'][_0x287ecf(0x114)](_0x2aba83=>_0x2aba83['id']===_0x343126);if(_0x5f287d>=0x0)_0x5c7ea2=_0x14877d[_0x287ecf(0x1c5)][_0x287ecf(0x13c)](_0x5f287d,0x1)[0x0];}!_0x5c7ea2&&(_0x5c7ea2=_0x14877d[_0x287ecf(0x1c5)]['splice'](_0xb0a2c5['oldIndex'],0x1)[0x0]);if(!_0x5c7ea2)return;_0x5c7ea2['topicId']=_0x87db2b['id'],_0x87db2b[_0x287ecf(0x1c5)]['splice'](_0xb0a2c5[_0x287ecf(0x10d)],0x0,_0x5c7ea2),data[_0x287ecf(0x1f9)][_0x287ecf(0x208)]===_0x5c7ea2['id']&&(data[_0x287ecf(0x1f9)][_0x287ecf(0x29b)]=_0x87db2b['id']),await saveData(),renderTopics();}});});}}}function selectSubtopic(_0x13aebc,_0x23b981){const _0x86a267=_0x1f8e33,_0x17e58a=$(_0x86a267(0x38f)),_0x1ecdee=getCurrentSubtopic();_0x1ecdee&&timer[_0x86a267(0x23b)]!=='idle'&&(_0x1ecdee[_0x86a267(0xaa)]={'state':timer[_0x86a267(0x23b)],'prevState':timer[_0x86a267(0xa3)],'remaining':timer['remaining'],'segmentTotal':timer[_0x86a267(0x1a2)],'cycleIndex':timer[_0x86a267(0x23c)]}),_0x17e58a[_0x86a267(0x164)][_0x86a267(0x2d4)](_0x86a267(0x23f)),setTimeout(async()=>{const _0x2d4dad=_0x86a267;data[_0x2d4dad(0x1f9)][_0x2d4dad(0x29b)]=_0x13aebc,data[_0x2d4dad(0x1f9)][_0x2d4dad(0x208)]=_0x23b981;const _0x3b3440=getCurrentSubtopic();_0x3b3440[_0x2d4dad(0xaa)]?(timer[_0x2d4dad(0x23b)]=_0x3b3440[_0x2d4dad(0xaa)][_0x2d4dad(0x23b)],timer[_0x2d4dad(0xa3)]=_0x3b3440['timerState'][_0x2d4dad(0xa3)]||null,timer[_0x2d4dad(0x347)]=_0x3b3440[_0x2d4dad(0xaa)]['remaining'],timer[_0x2d4dad(0x1a2)]=_0x3b3440[_0x2d4dad(0xaa)][_0x2d4dad(0x1a2)],timer[_0x2d4dad(0x23c)]=_0x3b3440[_0x2d4dad(0xaa)][_0x2d4dad(0x23c)]):timer[_0x2d4dad(0x31f)](),await saveData(),timer[_0x2d4dad(0x2a0)](),renderAll(),switchView(_0x2d4dad(0x1a8)),_0x17e58a['classList'][_0x2d4dad(0xf3)](_0x2d4dad(0x23f));},0xc8);}function getCurrentSubtopic(){const _0x3d146d=_0x1f8e33,_0x3476ee=data[_0x3d146d(0x1f9)][_0x3d146d(0x29b)],_0x43cadb=data[_0x3d146d(0x1f9)][_0x3d146d(0x208)];if(!_0x3476ee||!_0x43cadb)return null;const _0x46d282=data[_0x3d146d(0x372)][_0x3d146d(0x352)](_0x2933ad=>_0x2933ad['id']===_0x3476ee);if(!_0x46d282)return null;return _0x46d282[_0x3d146d(0x1c5)][_0x3d146d(0x352)](_0x156cec=>_0x156cec['id']===_0x43cadb)||null;}function renderContextBadge(){const _0x311642=_0x1f8e33,_0x49293d=getCurrentSubtopic(),_0x13b05e=_0x49293d?_0x49293d['name']:_0x311642(0xe9),_0xc90fe5=$('#selectedContext'),_0x57a215=$(_0x311642(0x26b)),_0x165325=$('#currentSubtopicNameChat');if(_0xc90fe5)_0xc90fe5[_0x311642(0x1a6)]=_0x49293d?_0x311642(0x1f5)+_0x49293d[_0x311642(0x149)]:_0x311642(0x156);if(_0x57a215)_0x57a215[_0x311642(0x1a6)]=_0x13b05e;if(_0x165325)_0x165325[_0x311642(0x1a6)]=_0x13b05e;}function renderSubtopicTasks(){const _0x1b8983=_0x1f8e33,_0x49bd45=getCurrentSubtopic(),_0x1ec0b5=$(_0x1b8983(0x1d2)),_0x1920c4=$('#newSubtopicTaskInput');if(!_0x1ec0b5||!_0x1920c4)return;const _0x48dd77=_0x1920c4[_0x1b8983(0x249)];if(!_0x49bd45){_0x1ec0b5[_0x1b8983(0xa6)]=_0x1b8983(0x2e7),_0x48dd77['classList'][_0x1b8983(0x2d4)](_0x1b8983(0xcf));return;}_0x48dd77[_0x1b8983(0x164)][_0x1b8983(0xf3)](_0x1b8983(0xcf)),_0x1ec0b5[_0x1b8983(0xa6)]='';const _0x12e18c=_0x49bd45[_0x1b8983(0x308)]?_0x49bd45[_0x1b8983(0x308)][_0x1b8983(0x2f6)](_0x122539=>!_0x122539[_0x1b8983(0x290)]):[];_0x12e18c[_0x1b8983(0x370)]===0x0&&(_0x1ec0b5[_0x1b8983(0xa6)]='<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Great!\x20No\x20tasks\x20left.</li>'),_0x12e18c[_0x1b8983(0x2dd)](_0x1c4b97=>{const _0x1091a1=_0x1b8983,_0x187253=document[_0x1091a1(0x307)]('li');_0x187253[_0x1091a1(0xa6)]=_0x1091a1(0xd6)+_0x1c4b97['id']+_0x1091a1(0x256)+_0x1c4b97['id']+'\x22>'+escapeHTML(_0x1c4b97['text'])+_0x1091a1(0xc9),_0x187253[_0x1091a1(0x1e4)](_0x1091a1(0x2fe))[_0x1091a1(0x30e)]('change',_0x2ecb0c=>toggleSubtopicTask(_0x2ecb0c['target']['id'],_0x187253)),_0x1ec0b5[_0x1091a1(0x2cc)](_0x187253);});}async function addSubtopicTask(){const _0x3da61f=_0x1f8e33,_0x528cd3=getCurrentSubtopic();if(!_0x528cd3){toast(t(_0x3da61f(0x2cf)));return;}const _0x33b799=$('#newSubtopicTaskInput'),_0x134309=_0x33b799[_0x3da61f(0x278)]['trim']();if(_0x134309){if(!_0x528cd3[_0x3da61f(0x308)])_0x528cd3[_0x3da61f(0x308)]=[];_0x528cd3[_0x3da61f(0x308)][_0x3da61f(0x19f)]({'id':uid(_0x3da61f(0x1b5)),'text':_0x134309,'isCompleted':![],'createdAt':todayISO()}),await saveData(),renderSubtopicTasks(),_0x33b799['value']='';}_0x33b799[_0x3da61f(0xae)]();}async function toggleSubtopicTask(_0x757973,_0x3f27af){const _0xbe06a2=_0x1f8e33,_0x24b96d=getCurrentSubtopic();if(!_0x24b96d||!_0x24b96d[_0xbe06a2(0x308)])return;const _0x337e48=_0x24b96d[_0xbe06a2(0x308)][_0xbe06a2(0x352)](_0x350d41=>_0x350d41['id']===_0x757973);_0x337e48&&(_0x337e48['isCompleted']=!![],_0x24b96d['stats'][_0xbe06a2(0x1c6)]=(_0x24b96d[_0xbe06a2(0x1fe)][_0xbe06a2(0x1c6)]||0x0)+0x1,await saveData(),_0x3f27af[_0xbe06a2(0x164)][_0xbe06a2(0x2d4)](_0xbe06a2(0x1e2)),setTimeout(()=>{renderSubtopicTasks(),renderStatsHistory();},0xc8));}const timer={'state':_0x1f8e33(0x315),'prevState':null,'tickHandle':null,'endAt':null,'remaining':0x0,'segmentTotal':0x0,'cyclesTarget':0x4,'cycleIndex':0x0,'mode':'A','persistInterval':0x3c*0x3e8,'lastPersist':0x0,async 'setPreset'(_0x5a0e24,{silent:silent=![]}={}){const _0x23767f=_0x1f8e33,_0x203404=data['settings'];this[_0x23767f(0x31c)]=_0x5a0e24,this[_0x23767f(0xc8)]=_0x5a0e24==='A'?_0x203404[_0x23767f(0x15c)]:_0x5a0e24==='B'?_0x203404[_0x23767f(0x184)]:0x0,_0x203404[_0x23767f(0x206)]=_0x5a0e24,await saveData(),this[_0x23767f(0x23b)]===_0x23767f(0x315)&&this[_0x23767f(0x31f)]();},'currentDurations'(){const _0x246cf3=_0x1f8e33,_0x3ba7c0=data[_0x246cf3(0x1f9)][_0x246cf3(0x1c9)];if(this['mode']==='A')return{'work':_0x3ba7c0[_0x246cf3(0x257)],'short':_0x3ba7c0['A_short'],'long':_0x3ba7c0[_0x246cf3(0x1ad)],'winddown':_0x3ba7c0[_0x246cf3(0xb6)]??0x0};if(this[_0x246cf3(0x31c)]==='B')return{'work':_0x3ba7c0[_0x246cf3(0x247)],'short':_0x3ba7c0[_0x246cf3(0xd5)],'long':_0x3ba7c0[_0x246cf3(0x2bf)],'winddown':_0x3ba7c0[_0x246cf3(0x15d)]??0x0};return{'work':0x0,'short':0x0,'long':0x0,'winddown':0x0};},'currentConfig'(){const _0x527267=_0x1f8e33,_0x2dcf5e=data[_0x527267(0x1f9)];if(this['mode']==='A')return{'cycles':_0x2dcf5e['cyclesA'],'interval':_0x2dcf5e[_0x527267(0x8f)]};if(this[_0x527267(0x31c)]==='B')return{'cycles':_0x2dcf5e[_0x527267(0x184)],'interval':_0x2dcf5e[_0x527267(0x1e9)]};return{'cycles':0x0,'interval':0x0};},'updateUI'(){const _0x46317c=_0x1f8e33,_0x34be65=$(_0x46317c(0x270)),_0x33dd57=$(_0x46317c(0xa0)),_0x9c17b8=$(_0x46317c(0xc3));if(!_0x34be65||!_0x33dd57||!_0x9c17b8)return;const _0xe35065=this[_0x46317c(0x31c)]==='C';$(_0x46317c(0x2d5))['classList'][_0x46317c(0x27d)](_0x46317c(0xcf),this[_0x46317c(0x23b)]!==_0x46317c(0x315)||_0xe35065&&this[_0x46317c(0x23b)]==='work'),$(_0x46317c(0x1be))[_0x46317c(0x164)]['toggle'](_0x46317c(0xcf),!(_0xe35065&&this['state']===_0x46317c(0x272))),$(_0x46317c(0x1d9))[_0x46317c(0x164)][_0x46317c(0x27d)](_0x46317c(0xcf),!['work','break',_0x46317c(0x237)]['includes'](this[_0x46317c(0x23b)])),$(_0x46317c(0x276))[_0x46317c(0x164)][_0x46317c(0x27d)]('hidden',this['state']!=='paused');let _0x51edbf=_0x46317c(0xb8);if(this[_0x46317c(0x23b)]===_0x46317c(0x272))_0x34be65['textContent']=_0xe35065?_0x46317c(0xf2):_0x46317c(0x215),_0x34be65[_0x46317c(0x8c)]=_0x46317c(0x2b3),_0x51edbf=_0x46317c(0xdd);else{if(this['state']===_0x46317c(0x2b4))_0x34be65[_0x46317c(0x1a6)]=_0x46317c(0x18e),_0x34be65['className']=_0x46317c(0x227),_0x51edbf=_0x46317c(0x39c);else{if(this[_0x46317c(0x23b)]===_0x46317c(0x237))_0x34be65[_0x46317c(0x1a6)]='LONG\x20BREAK',_0x34be65['className']=_0x46317c(0x145),_0x51edbf='var(--danger)';else{if(this[_0x46317c(0x23b)]===_0x46317c(0x1cc)){_0x34be65[_0x46317c(0x1a6)]='WIND-DOWN',_0x34be65[_0x46317c(0x8c)]=_0x46317c(0x2b3),_0x51edbf=_0x46317c(0x14b);try{$(_0x46317c(0x29c))[_0x46317c(0x164)]['remove'](_0x46317c(0xcf)),$(_0x46317c(0x11e))[_0x46317c(0x164)][_0x46317c(0xf3)](_0x46317c(0xcf));}catch(_0x21c5d8){}}else this[_0x46317c(0x23b)]===_0x46317c(0x240)?(_0x34be65['textContent']=_0x46317c(0x230),_0x34be65[_0x46317c(0x8c)]='badge'):(_0x34be65[_0x46317c(0x1a6)]=_0x46317c(0x144),_0x34be65[_0x46317c(0x8c)]='badge');}}}[_0x46317c(0x272),_0x46317c(0x2b4),_0x46317c(0x237),_0x46317c(0x1cc)][_0x46317c(0x359)](this[_0x46317c(0x23b)])?_0x9c17b8['classList'][_0x46317c(0x2d4)](_0x46317c(0x18b)):_0x9c17b8[_0x46317c(0x164)][_0x46317c(0xf3)]('breathing');_0x33dd57['style']['stroke']=_0x51edbf,_0x9c17b8['classList'][_0x46317c(0xf3)](_0x46317c(0x299));const _0x2a9796=$(_0x46317c(0x2a5));if(_0x2a9796)_0x2a9796[_0x46317c(0x1a6)]=formatMMSS(this[_0x46317c(0x347)]);const _0x46ac24=_0x33dd57['r'][_0x46317c(0x137)]['value'],_0x41b991=0x2*Math['PI']*_0x46ac24,_0x4d3b7d=this[_0x46317c(0x1a2)]>0x0?_0x41b991-this['remaining']/this[_0x46317c(0x1a2)]*_0x41b991:_0x41b991;_0x33dd57[_0x46317c(0x10e)]['strokeDasharray']=_0x41b991,_0x33dd57[_0x46317c(0x10e)][_0x46317c(0x15a)]=isNaN(_0x4d3b7d)?_0x41b991:_0x4d3b7d;const _0x5421ef=$(_0x46317c(0x380));if(_0x5421ef){const _0x27ab94=this[_0x46317c(0x348)]();_0x5421ef[_0x46317c(0x1a6)]=t('timer.cycleInfo',{'current':this[_0x46317c(0x23c)],'target':_0x27ab94[_0x46317c(0x2d0)]}),_0x5421ef[_0x46317c(0x164)][_0x46317c(0x27d)](_0x46317c(0xcf),_0xe35065);}const _0x4bf8b8=$('#breakSuggestionDisplay');_0x4bf8b8&&_0x4bf8b8[_0x46317c(0x164)][_0x46317c(0x27d)](_0x46317c(0xcf),_0xe35065&&this[_0x46317c(0x23b)]==='work');const _0x3db324=$(_0x46317c(0x271));if(_0x3db324)_0x3db324[_0x46317c(0x1a6)]=formatMMSS(this[_0x46317c(0x347)]);if(this[_0x46317c(0x23b)]!==_0x46317c(0x1cc))try{$(_0x46317c(0x29c))[_0x46317c(0x164)]['add'](_0x46317c(0xcf)),$(_0x46317c(0x11e))[_0x46317c(0x164)][_0x46317c(0x2d4)](_0x46317c(0xcf));}catch(_0x26b5ab){}},'persistTimerState'(_0x405237=![]){const _0x39af1f=_0x1f8e33;try{const _0x4d55ca=getCurrentSubtopic();if(!_0x4d55ca)return;const _0xf2df27={'state':this[_0x39af1f(0x23b)],'prevState':this[_0x39af1f(0xa3)],'remaining':this[_0x39af1f(0x347)],'segmentTotal':this[_0x39af1f(0x1a2)],'cycleIndex':this[_0x39af1f(0x23c)]};_0x4d55ca[_0x39af1f(0xaa)]=_0xf2df27;try{localStorage['setItem']('timerState_'+_0x4d55ca['id'],JSON['stringify'](_0xf2df27));}catch(_0x26598b){}this['lastPersist']=Date['now']();}catch(_0x8bd085){}},'_startTick'(){const _0xc451e0=_0x1f8e33;if(this['tickHandle'])clearInterval(this[_0xc451e0(0xa2)]);if(this[_0xc451e0(0x31c)]==='C'&&this[_0xc451e0(0x23b)]==='work'){this['tickHandle']=setInterval(()=>{const _0x35286e=_0xc451e0;this[_0x35286e(0x347)]+=0x1,this[_0x35286e(0x2a0)](),this['persistTimerState']();},0x3e8);return;}this[_0xc451e0(0xa2)]=setInterval(()=>{const _0x50280b=_0xc451e0;this[_0x50280b(0x347)]>0x0&&(this[_0x50280b(0x347)]-=0x1,this[_0x50280b(0x2a0)](),this[_0x50280b(0x1e1)]()),this[_0x50280b(0x347)]<=0x0&&(clearInterval(this[_0x50280b(0xa2)]),this[_0x50280b(0xa2)]=null,this[_0x50280b(0x1c2)]());},0x3e8);},'_onFinishSegment'(){const _0x5ab5ed=_0x1f8e33;if(this[_0x5ab5ed(0x23b)]==='work'){const _0x1488ef=getCurrentSubtopic();if(_0x1488ef){const _0x2c89ba=this[_0x5ab5ed(0x20d)]()['work'];_0x1488ef[_0x5ab5ed(0x1fe)]['totalMinutes']=(_0x1488ef[_0x5ab5ed(0x1fe)][_0x5ab5ed(0x236)]||0x0)+_0x2c89ba,_0x1488ef[_0x5ab5ed(0x1fe)][_0x5ab5ed(0x171)]=(_0x1488ef[_0x5ab5ed(0x1fe)]['sessionsCompleted']||0x0)+0x1;const _0x49b2b3={'id':uid('sess'),'dateISO':todayISO(),'durationMinutes':_0x2c89ba,'mode':this['mode'],'note':''};if(!_0x1488ef[_0x5ab5ed(0xf9)])_0x1488ef[_0x5ab5ed(0xf9)]=[];_0x1488ef[_0x5ab5ed(0xf9)][_0x5ab5ed(0x2ee)](_0x49b2b3);if(data?.['settings']?.[_0x5ab5ed(0x260)])try{openNoteModal(_0x49b2b3['id']);}catch(_0x7da1e2){}saveData(),renderStatsHistory(),checkAndShowMilestones();}this[_0x5ab5ed(0x23c)]++;}if(typeof data!==_0x5ab5ed(0x253)&&data&&data[_0x5ab5ed(0x1f9)]&&data[_0x5ab5ed(0x1f9)]['enableWinddown']===![]&&this[_0x5ab5ed(0x23b)]===_0x5ab5ed(0x272))playSound('work_end');else(this[_0x5ab5ed(0x23b)]===_0x5ab5ed(0x1cc)||this[_0x5ab5ed(0x23b)]===_0x5ab5ed(0x2b4)||this['state']==='long_break')&&playSound('break_end');const _0x4cfd11=$(_0x5ab5ed(0xc3));if(_0x4cfd11)_0x4cfd11['classList'][_0x5ab5ed(0x2d4)](_0x5ab5ed(0x299));if(data[_0x5ab5ed(0x1f9)][_0x5ab5ed(0x193)]){if(this[_0x5ab5ed(0x23b)]==='work')data[_0x5ab5ed(0x1f9)]['enableWinddown']===![]?this[_0x5ab5ed(0x38d)]():this[_0x5ab5ed(0x15b)]();else this[_0x5ab5ed(0x23b)]===_0x5ab5ed(0x1cc)?this[_0x5ab5ed(0x38d)]():this[_0x5ab5ed(0xbd)]();}else this[_0x5ab5ed(0xa2)]&&(clearInterval(this[_0x5ab5ed(0xa2)]),this[_0x5ab5ed(0xa2)]=null),this[_0x5ab5ed(0x23b)]=_0x5ab5ed(0x315),this['prevState']=null,this[_0x5ab5ed(0x2a0)](),toast(_0x5ab5ed(0x1e8));},'beginWindDown'(){const _0x10d32e=_0x1f8e33;if(data?.[_0x10d32e(0x1f9)]?.[_0x10d32e(0x266)]===![]){this[_0x10d32e(0x38d)]();return;}this[_0x10d32e(0xa3)]=this[_0x10d32e(0x23b)],this['state']='wind_down';const _0x1e3003=(this[_0x10d32e(0x20d)]()[_0x10d32e(0x28b)]||0x0)*0x3c;if(_0x1e3003<=0x0){this['beginBreak']();return;}this[_0x10d32e(0x1a2)]=_0x1e3003,this['remaining']=_0x1e3003;try{playSound(_0x10d32e(0x394));}catch(_0x9d7747){}try{toast(_0x10d32e(0x31b));}catch(_0x4f7ff5){}this[_0x10d32e(0x2cd)](),this[_0x10d32e(0x2a0)]();},'beginWork'(){const _0x2fdcf7=_0x1f8e33;this[_0x2fdcf7(0xa3)]=this['state'],this[_0x2fdcf7(0x23b)]=_0x2fdcf7(0x272);if(this['mode']==='C'){this[_0x2fdcf7(0x1a2)]=0x0;if(this[_0x2fdcf7(0xa3)]!==_0x2fdcf7(0x240))this['remaining']=0x0;}else{const _0x31470e=this[_0x2fdcf7(0x20d)]()[_0x2fdcf7(0x272)]*0x3c;this[_0x2fdcf7(0x1a2)]=_0x31470e;if(this[_0x2fdcf7(0xa3)]!==_0x2fdcf7(0x240))this[_0x2fdcf7(0x347)]=_0x31470e;}const _0x28a0e8=$(_0x2fdcf7(0x294));_0x28a0e8&&(_0x28a0e8['textContent']=''),this[_0x2fdcf7(0x2cd)](),this[_0x2fdcf7(0x2a0)]();},'finishFlowSession'(){const _0x5f4eb6=_0x1f8e33;if(this[_0x5f4eb6(0x31c)]!=='C'||this[_0x5f4eb6(0x23b)]!==_0x5f4eb6(0x272))return;this[_0x5f4eb6(0xa2)]&&(clearInterval(this['tickHandle']),this[_0x5f4eb6(0xa2)]=null);const _0x295378=Math[_0x5f4eb6(0xe4)](0x1,parseInt(data['settings'][_0x5f4eb6(0x33f)]??0x5,0xa)),_0x45597=Math[_0x5f4eb6(0xe4)](0x0,this[_0x5f4eb6(0x347)]|0x0),_0x4a90ea=Math[_0x5f4eb6(0xe4)](0x3c,Math['floor'](_0x45597/_0x295378));try{const _0x4b03c4=getCurrentSubtopic();if(_0x4b03c4){const _0x341c26=Math[_0x5f4eb6(0xe4)](0x1,Math[_0x5f4eb6(0x166)](_0x45597/0x3c));_0x4b03c4[_0x5f4eb6(0x1fe)]['totalMinutes']=(_0x4b03c4['stats'][_0x5f4eb6(0x236)]||0x0)+_0x341c26,_0x4b03c4['stats'][_0x5f4eb6(0x171)]=(_0x4b03c4['stats']['sessionsCompleted']||0x0)+0x1;const _0x1aadad={'id':uid('sess'),'dateISO':todayISO(),'durationMinutes':_0x341c26,'mode':this[_0x5f4eb6(0x31c)],'note':''};if(!_0x4b03c4[_0x5f4eb6(0xf9)])_0x4b03c4[_0x5f4eb6(0xf9)]=[];_0x4b03c4[_0x5f4eb6(0xf9)][_0x5f4eb6(0x2ee)](_0x1aadad),saveData(),renderStatsHistory(),data?.[_0x5f4eb6(0x1f9)]?.[_0x5f4eb6(0x260)]&&openNoteModal(_0x1aadad['id']);}}catch(_0x3f6d99){}this[_0x5f4eb6(0x23b)]='break',this[_0x5f4eb6(0x1a2)]=_0x4a90ea,this[_0x5f4eb6(0x347)]=_0x4a90ea,this[_0x5f4eb6(0x2cd)](),this[_0x5f4eb6(0x2a0)](),this[_0x5f4eb6(0x1e1)](!![]);try{toast(_0x5f4eb6(0x311)+Math[_0x5f4eb6(0x166)](_0x4a90ea/0x3c)+'\x20min\x20via\x20Flowtime\x20('+_0x295378+').');}catch(_0x55b808){}},'beginBreak'(){const _0x39f2de=_0x1f8e33;this[_0x39f2de(0xa3)]=this[_0x39f2de(0x23b)];const _0x1e691d=this[_0x39f2de(0x348)](),_0x10cf3c=this['currentDurations']();if(this['cycleIndex']>0x0&&this[_0x39f2de(0x23c)]%_0x1e691d[_0x39f2de(0xf5)]===0x0){this[_0x39f2de(0x23b)]=_0x39f2de(0x237);const _0x263ec3=_0x10cf3c[_0x39f2de(0xbe)]*0x3c;this['segmentTotal']=_0x263ec3;if(this['prevState']!==_0x39f2de(0x240))this['remaining']=_0x263ec3;toast('Great!\x20Time\x20for\x20a\x20long\x20break.');}else{this[_0x39f2de(0x23b)]=_0x39f2de(0x2b4);const _0xdecff7=_0x10cf3c[_0x39f2de(0x102)]*0x3c;this[_0x39f2de(0x1a2)]=_0xdecff7;if(this[_0x39f2de(0xa3)]!==_0x39f2de(0x240))this[_0x39f2de(0x347)]=_0xdecff7;}const _0x5b198e=$(_0x39f2de(0x294));if(_0x5b198e){const _0x3eea2d=Math[_0x39f2de(0x381)](Math[_0x39f2de(0x2c4)]()*breakSuggestions[_0x39f2de(0x370)]);_0x5b198e[_0x39f2de(0x1a6)]=_0x39f2de(0x2ab)+breakSuggestions[_0x3eea2d];}this['_startTick'](),this[_0x39f2de(0x2a0)]();},async 'start'(){const _0x14ce50=_0x1f8e33;if(!getCurrentSubtopic()){toast(_0x14ce50(0x2f8));return;}ensureAudio();if(this['mode']==='C'&&this[_0x14ce50(0x23b)]===_0x14ce50(0x315))this[_0x14ce50(0x23b)]=_0x14ce50(0x272),this[_0x14ce50(0x347)]=0x0,this[_0x14ce50(0x1a2)]=0x0,this['cycleIndex']=0x0,this['_startTick'](),this[_0x14ce50(0x2a0)]();else{if(this[_0x14ce50(0x23b)]===_0x14ce50(0x315))this[_0x14ce50(0x23c)]=this['cycleIndex']||0x0,this[_0x14ce50(0xbd)]();else this[_0x14ce50(0x23b)]==='paused'&&this[_0x14ce50(0x1ef)]();}await this[_0x14ce50(0x1e1)](!![]);},async 'pause'(){const _0x33b593=_0x1f8e33;this[_0x33b593(0xa2)]&&(clearInterval(this[_0x33b593(0xa2)]),this[_0x33b593(0xa2)]=null),this[_0x33b593(0xa3)]=this[_0x33b593(0x23b)],this[_0x33b593(0x23b)]='paused',this[_0x33b593(0x2a0)](),await this[_0x33b593(0x1e1)](!![]);},async 'resume'(){const _0x2d47ab=_0x1f8e33;if(this['state']!=='paused')return;this['state']=this[_0x2d47ab(0xa3)]||_0x2d47ab(0x272),this[_0x2d47ab(0x2cd)](),this['updateUI'](),await this['persistTimerState'](!![]);},async 'skip'(){const _0x26c218=_0x1f8e33;if(this[_0x26c218(0x31c)]==='C'&&this[_0x26c218(0x23b)]===_0x26c218(0x272)){this[_0x26c218(0x12c)](),await this[_0x26c218(0x1e1)](!![]);return;}this[_0x26c218(0x23b)]===_0x26c218(0x272)?(this[_0x26c218(0xa2)]&&(clearInterval(this['tickHandle']),this[_0x26c218(0xa2)]=null),this[_0x26c218(0x347)]=0x0,this[_0x26c218(0x1c2)]()):(this[_0x26c218(0x347)]=0x0,this[_0x26c218(0xa2)]&&(clearInterval(this[_0x26c218(0xa2)]),this[_0x26c218(0xa2)]=null),this['_onFinishSegment']()),await this[_0x26c218(0x1e1)](!![]);},async 'reset'(){const _0xcedb7a=_0x1f8e33;this[_0xcedb7a(0xa2)]&&(clearInterval(this['tickHandle']),this[_0xcedb7a(0xa2)]=null);this[_0xcedb7a(0x23b)]=_0xcedb7a(0x315),this[_0xcedb7a(0xa3)]=null,this[_0xcedb7a(0x347)]=0x0,this[_0xcedb7a(0x1a2)]=0x0,this[_0xcedb7a(0x23c)]=0x0;const _0x2076d2=$(_0xcedb7a(0x294));_0x2076d2&&(_0x2076d2[_0xcedb7a(0x1a6)]=''),this[_0xcedb7a(0x2a0)](),await this['persistTimerState'](!![]);}};async function deleteSummary(_0x5e5b78){const _0x3e8599=_0x1f8e33;showConfirmModal(_0x3e8599(0x111),_0x3e8599(0x1fc),async _0x4b858d=>{const _0x5be11e=_0x3e8599;if(!_0x4b858d)return;const _0x293d9d=getCurrentSubtopic();if(!_0x293d9d||!_0x293d9d[_0x5be11e(0x18f)])return;const _0x314e40=[..._0x293d9d[_0x5be11e(0x18f)]];_0x293d9d['summaries']=_0x293d9d[_0x5be11e(0x18f)][_0x5be11e(0x2f6)](_0x654bd8=>_0x654bd8['id']!==_0x5e5b78);try{await storageManager[_0x5be11e(0x28f)]('subtopics',_0x293d9d),renderSummaries(),toast(_0x5be11e(0x284));}catch(_0x311892){console[_0x5be11e(0x132)](_0x5be11e(0x29f),_0x311892),_0x293d9d[_0x5be11e(0x18f)]=_0x314e40,toast(_0x5be11e(0x365));}});}function exportSummary(_0x31ae76){const _0x18428e=_0x1f8e33,_0x230343=new Blob([_0x31ae76[_0x18428e(0x152)]],{'type':_0x18428e(0x262)}),_0x2ed432=document[_0x18428e(0x307)]('a'),_0x31c0e3=new Date(_0x31ae76[_0x18428e(0xd3)]),_0x243dae=_0x489f53=>(''+_0x489f53)[_0x18428e(0x85)](0x2,'0');_0x2ed432[_0x18428e(0x2fc)]=URL[_0x18428e(0x11a)](_0x230343),_0x2ed432[_0x18428e(0x1a5)]='summary_'+_0x31c0e3['getFullYear']()+_0x243dae(_0x31c0e3[_0x18428e(0x84)]()+0x1)+_0x243dae(_0x31c0e3['getDate']())+_0x18428e(0xb2),_0x2ed432[_0x18428e(0x2ad)](),URL[_0x18428e(0x1c0)](_0x2ed432[_0x18428e(0x2fc)]);}function renderStatsHistory(){const _0x299d90=_0x1f8e33,_0x484b28=getCurrentSubtopic(),_0x177181=$('#statTotal'),_0x2da825=$(_0x299d90(0x317)),_0x39167a=$('#statTasks'),_0x23d56b=$(_0x299d90(0x216));if(!_0x177181||!_0x2da825||!_0x39167a||!_0x23d56b)return;if(!_0x484b28){_0x177181[_0x299d90(0x1a6)]='0\x20min',_0x2da825['textContent']='0',_0x39167a[_0x299d90(0x1a6)]='0',_0x23d56b[_0x299d90(0xa6)]='<div\x20class=\x22tiny\x22>No\x20data\x20yet</div>';return;}const _0x486f87=_0x484b28[_0x299d90(0x1fe)]&&_0x484b28[_0x299d90(0x1fe)][_0x299d90(0x236)]?_0x484b28['stats'][_0x299d90(0x236)]:0x0,_0x2bb4e2=_0x484b28[_0x299d90(0x1fe)]&&_0x484b28[_0x299d90(0x1fe)][_0x299d90(0x171)]?_0x484b28[_0x299d90(0x1fe)]['sessionsCompleted']:0x0,_0x31064c=_0x484b28['tasks']?_0x484b28['tasks'][_0x299d90(0x2f6)](_0x5331d5=>_0x5331d5[_0x299d90(0x290)])['length']:0x0;_0x177181[_0x299d90(0x1a6)]=formatDaysHoursMinutes(_0x486f87),_0x2da825[_0x299d90(0x1a6)]=String(_0x2bb4e2),_0x39167a[_0x299d90(0x1a6)]=String(_0x31064c),_0x23d56b[_0x299d90(0xa6)]='';const _0x1e3b9b=Array[_0x299d90(0x2dc)](_0x484b28[_0x299d90(0xf9)])?_0x484b28['sessions']:[];if(_0x1e3b9b['length']===0x0){_0x23d56b[_0x299d90(0xa6)]='<div\x20class=\x22tiny\x22>No\x20sessions\x20yet</div>';return;}_0x1e3b9b[_0x299d90(0x2dd)](_0x126083=>{const _0x541948=_0x299d90,_0x2eb20c=document[_0x541948(0x307)]('div');_0x2eb20c['className']=_0x541948(0x2de);const _0x4e1aef=document[_0x541948(0x307)]('div'),_0x5a3d9e=_0x126083[_0x541948(0x33d)]?new Date(_0x126083[_0x541948(0x33d)]):new Date(),_0x22ef1b=_0x126083[_0x541948(0x383)]!=null?_0x126083[_0x541948(0x383)]:_0x126083[_0x541948(0xed)]||0x0,_0x235e96=_0x541948(0x34f)+_0x5a3d9e[_0x541948(0xa7)]()+'\x20¬∑\x20'+_0x22ef1b+_0x541948(0x341)+(_0x126083[_0x541948(0x31c)]||'')+_0x541948(0x9f);let _0x119d75='';if(_0x126083[_0x541948(0x2c1)])_0x119d75=_0x541948(0x16a)+escapeHTML(_0x126083[_0x541948(0x2c1)])+'</div>';else data?.['settings']?.['enableSessionNotes']&&(_0x119d75=_0x541948(0x232));_0x4e1aef['innerHTML']=_0x235e96+_0x119d75,_0x2eb20c['appendChild'](_0x4e1aef),_0x23d56b[_0x541948(0x2cc)](_0x2eb20c);});}function renderGeneralNotes(){const _0x29a929=_0x1f8e33,_0x20eca7=$('#generalNotesList');if(!_0x20eca7)return;const _0x15d629=getCurrentSubtopic();if(!_0x15d629){_0x20eca7['innerHTML']=_0x29a929(0xba);return;}_0x15d629[_0x29a929(0x35e)]=_0x15d629[_0x29a929(0x35e)]||[];if(_0x15d629[_0x29a929(0x35e)][_0x29a929(0x370)]===0x0){_0x20eca7[_0x29a929(0xa6)]=_0x29a929(0x29e);return;}_0x20eca7[_0x29a929(0xa6)]='',_0x15d629[_0x29a929(0x35e)]['forEach'](_0x56b352=>{const _0x2e6e20=_0x29a929,_0x923b26=document[_0x2e6e20(0x307)](_0x2e6e20(0x179));_0x923b26[_0x2e6e20(0x8c)]=_0x2e6e20(0x187);const _0x1dd1c2=document[_0x2e6e20(0x307)](_0x2e6e20(0x179));_0x1dd1c2['className']=_0x2e6e20(0x37c),_0x1dd1c2[_0x2e6e20(0x1a6)]=typeof _0x56b352===_0x2e6e20(0x1b8)?_0x56b352:_0x56b352[_0x2e6e20(0x38a)]||'';const _0x3f5758=document['createElement']('div');_0x3f5758[_0x2e6e20(0x8c)]=_0x2e6e20(0x25c),_0x3f5758[_0x2e6e20(0x1a6)]=_0x56b352[_0x2e6e20(0xd3)]?new Date(_0x56b352[_0x2e6e20(0xd3)])[_0x2e6e20(0xa7)]():'';const _0x5e6296=document[_0x2e6e20(0x307)](_0x2e6e20(0x179)),_0x345303=document[_0x2e6e20(0x307)](_0x2e6e20(0x13f));_0x345303[_0x2e6e20(0x8c)]='btn\x20small\x20danger',_0x345303[_0x2e6e20(0x1a6)]=_0x2e6e20(0x1a0),_0x345303[_0x2e6e20(0x211)]=async _0x4c5e2a=>{const _0x1b8caf=_0x2e6e20;_0x4c5e2a[_0x1b8caf(0x2d9)]();const _0x7682a3=getCurrentSubtopic();if(!_0x7682a3)return;_0x7682a3[_0x1b8caf(0x35e)]=(_0x7682a3[_0x1b8caf(0x35e)]||[])[_0x1b8caf(0x2f6)](_0x564bab=>(_0x564bab['id']||_0x564bab)!==(_0x56b352['id']||_0x56b352)),await saveData(),renderGeneralNotes();},_0x5e6296[_0x2e6e20(0x2cc)](_0x345303);const _0x29a215=document[_0x2e6e20(0x307)](_0x2e6e20(0x179));_0x29a215[_0x2e6e20(0x8c)]=_0x2e6e20(0x17c),_0x29a215[_0x2e6e20(0x32a)](_0x1dd1c2,_0x3f5758),_0x923b26[_0x2e6e20(0x32a)](_0x29a215,_0x5e6296),_0x20eca7[_0x2e6e20(0x2cc)](_0x923b26);});}function renderMethods(){const _0x5c67a4=_0x1f8e33,_0x418a14=document['querySelector'](_0x5c67a4(0x224));if(!_0x418a14)return;_0x418a14[_0x5c67a4(0xa6)]='';const _0xe1c366=getCurrentSubtopic();if(!_0xe1c366){_0x418a14[_0x5c67a4(0xa6)]=_0x5c67a4(0x7e);return;}const _0x228003=Array[_0x5c67a4(0x2dc)](_0xe1c366['methods'])?_0xe1c366[_0x5c67a4(0x1f7)]:[];if(_0x228003[_0x5c67a4(0x370)]===0x0){_0x418a14[_0x5c67a4(0xa6)]=_0x5c67a4(0x376);return;}_0x228003[_0x5c67a4(0x2dd)](_0x4f29e5=>{const _0x2393f6=_0x5c67a4,_0x5860fb=document[_0x2393f6(0x307)](_0x2393f6(0x371));_0x5860fb[_0x2393f6(0x8c)]=_0x2393f6(0xdb),_0x5860fb[_0x2393f6(0xe5)]['methodId']=_0x4f29e5['id'];const _0x7ce80b=document['createElement']('summary'),_0x3da837=document['createElement'](_0x2393f6(0x98));_0x3da837[_0x2393f6(0x8c)]=_0x2393f6(0x143),_0x3da837[_0x2393f6(0x1a6)]=_0x4f29e5[_0x2393f6(0x2b7)]||_0x2393f6(0x2b2),_0x3da837[_0x2393f6(0x30e)](_0x2393f6(0x2ad),_0xb478db=>{const _0x423c91=_0x2393f6;_0xb478db[_0x423c91(0x288)](),_0xb478db[_0x423c91(0x2d9)](),_0x5860fb[_0x423c91(0x109)]=!_0x5860fb['open'];});const _0x5d8506=document[_0x2393f6(0x307)]('div');_0x5d8506[_0x2393f6(0x8c)]=_0x2393f6(0x2b6);const _0x4814c6=document['createElement']('button');_0x4814c6[_0x2393f6(0x8c)]=_0x2393f6(0x13d),_0x4814c6['textContent']=_0x2393f6(0x18c),_0x4814c6[_0x2393f6(0xe5)]['id']=_0x4f29e5['id'];const _0x3895dc=document[_0x2393f6(0x307)]('button');_0x3895dc[_0x2393f6(0x8c)]='btn\x20small\x20danger\x20method-delete',_0x3895dc['textContent']=_0x2393f6(0x1a0),_0x3895dc[_0x2393f6(0xe5)]['id']=_0x4f29e5['id'],_0x5d8506['append'](_0x4814c6,_0x3895dc),_0x7ce80b[_0x2393f6(0x32a)](_0x3da837,_0x5d8506);const _0x169e15=document[_0x2393f6(0x307)](_0x2393f6(0x179));_0x169e15[_0x2393f6(0x8c)]=_0x2393f6(0x39a),_0x169e15[_0x2393f6(0xa6)]=_0x4f29e5[_0x2393f6(0x152)]||'',_0x5860fb['append'](_0x7ce80b,_0x169e15),_0x418a14[_0x2393f6(0x2cc)](_0x5860fb),_0x5860fb[_0x2393f6(0x30e)]('click',_0x4ccc0f=>{const _0x30c39b=_0x2393f6,_0x29aa50=_0x4ccc0f[_0x30c39b(0xa4)];if(!_0x29aa50)return;if(_0x29aa50[_0x30c39b(0x336)](_0x30c39b(0x13f))||_0x29aa50['closest']('a')||_0x29aa50[_0x30c39b(0x336)]('.color-picker-wrapper')||_0x29aa50[_0x30c39b(0x336)](_0x30c39b(0x295)))return;if(!_0x5860fb[_0x30c39b(0x109)])_0x5860fb[_0x30c39b(0x109)]=!![];});});const _0x32bc5f=_0x418a14['querySelectorAll'](_0x5c67a4(0x38e));_0x32bc5f[_0x5c67a4(0x2dd)](_0x4e69ec=>{const _0x31978a=_0x5c67a4;_0x4e69ec['addEventListener'](_0x31978a(0x27d),()=>{_0x4e69ec['open']&&_0x32bc5f['forEach'](_0x3bd900=>{const _0x82d10d=_0x44fa;if(_0x3bd900!==_0x4e69ec)_0x3bd900[_0x82d10d(0x109)]=![];});});}),window[_0x5c67a4(0x116)]&&new Sortable(_0x418a14,{'animation':0x96,'draggable':_0x5c67a4(0x38e),'onEnd':async function(_0x140e96){const _0xd9194b=_0x5c67a4;if(_0x140e96[_0xd9194b(0x377)]===_0x140e96[_0xd9194b(0x10d)])return;const _0x12b47a=getCurrentSubtopic();if(!_0x12b47a||!Array[_0xd9194b(0x2dc)](_0x12b47a[_0xd9194b(0x1f7)]))return;const _0x3c412d=_0x12b47a[_0xd9194b(0x1f7)][_0xd9194b(0x13c)](_0x140e96['oldIndex'],0x1)[0x0];_0x12b47a[_0xd9194b(0x1f7)][_0xd9194b(0x13c)](_0x140e96[_0xd9194b(0x10d)],0x0,_0x3c412d),await saveData();}});}function addGeneralNote(){const _0x3ed7cc=_0x1f8e33;showInputModal(_0x3ed7cc(0x127),async _0x5ea8db=>{const _0x32215f=_0x3ed7cc;if(!_0x5ea8db)return;const _0xdb4613=getCurrentSubtopic();if(!_0xdb4613){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}_0xdb4613['generalNotes']=_0xdb4613['generalNotes']||[],_0xdb4613[_0x32215f(0x35e)][_0x32215f(0x2ee)]({'id':uid('gn'),'text':_0x5ea8db,'createdAt':todayISO()}),await saveData(),renderGeneralNotes();},'');}async function summarizeNotes(){const _0x984c96=_0x1f8e33,_0x5e4ef6=getCurrentSubtopic();if(!_0x5e4ef6){toast(_0x984c96(0x106));return;}const _0x2d5d5e=(_0x5e4ef6['generalNotes']||[])[_0x984c96(0x24e)](_0xc956ec=>typeof _0xc956ec===_0x984c96(0x1b8)?_0xc956ec:_0xc956ec[_0x984c96(0x38a)]||'')[_0x984c96(0x2f6)](Boolean);if(_0x2d5d5e[_0x984c96(0x370)]===0x0){toast(_0x984c96(0x165));return;}const _0x3706ff=$(_0x984c96(0x20f));_0x3706ff&&(_0x3706ff['disabled']=!![],_0x3706ff[_0x984c96(0xa6)]=_0x984c96(0x344));try{const _0x42ade9=_0x984c96(0x374)+_0x2d5d5e['join'](_0x984c96(0x268)),_0x43ef4a=await callGeminiAPI(_0x42ade9);if(!_0x5e4ef6[_0x984c96(0x18f)])_0x5e4ef6[_0x984c96(0x18f)]=[];_0x5e4ef6[_0x984c96(0x18f)][_0x984c96(0x2ee)]({'id':uid(_0x984c96(0x293)),'content':_0x43ef4a||'(Could\x20not\x20generate\x20summary)','createdAt':todayISO()}),await saveData(),renderSummaries();}catch(_0x481f62){console['error'](_0x481f62),toast(_0x984c96(0xd8));}finally{_0x3706ff&&(_0x3706ff[_0x984c96(0x201)]=![],_0x3706ff['textContent']=_0x984c96(0x2a8));}}function renderSummaries(){const _0xf2504c=_0x1f8e33,_0x24118a=$('#summariesList');if(!_0x24118a)return;const _0x553c76=getCurrentSubtopic();if(!_0x553c76){_0x24118a[_0xf2504c(0xa6)]=_0xf2504c(0x355);return;}_0x24118a[_0xf2504c(0xa6)]='';if(!_0x553c76['summaries']||_0x553c76[_0xf2504c(0x18f)][_0xf2504c(0x370)]===0x0){_0x24118a[_0xf2504c(0xa6)]=_0xf2504c(0x254);return;}_0x553c76[_0xf2504c(0x18f)][_0xf2504c(0x2dd)](_0x1b4d05=>{const _0x441cc8=_0xf2504c,_0x34e62a=document[_0x441cc8(0x307)](_0x441cc8(0x179));_0x34e62a[_0x441cc8(0x8c)]=_0x441cc8(0x187);const _0x20d19f=document[_0x441cc8(0x307)]('div');_0x20d19f['className']=_0x441cc8(0x17c);const _0x217e3c=document[_0x441cc8(0x307)]('div');_0x217e3c[_0x441cc8(0x8c)]=_0x441cc8(0x37c),_0x217e3c[_0x441cc8(0x1a6)]=_0x1b4d05[_0x441cc8(0x152)];const _0x54f2d9=document[_0x441cc8(0x307)](_0x441cc8(0x179));_0x54f2d9[_0x441cc8(0x8c)]=_0x441cc8(0x25c),_0x54f2d9['textContent']=new Date(_0x1b4d05[_0x441cc8(0xd3)])['toLocaleString'](),_0x20d19f[_0x441cc8(0x32a)](_0x217e3c,_0x54f2d9);const _0x23ac0b=document[_0x441cc8(0x307)](_0x441cc8(0x179)),_0x1cb349=document[_0x441cc8(0x307)](_0x441cc8(0x13f));_0x1cb349[_0x441cc8(0x8c)]='btn\x20small',_0x1cb349['textContent']=_0x441cc8(0x1c4),_0x1cb349[_0x441cc8(0x211)]=_0x51f407=>{const _0x20531b=_0x441cc8;_0x51f407[_0x20531b(0x2d9)](),exportSummary(_0x1b4d05);};const _0x596472=document[_0x441cc8(0x307)]('button');_0x596472[_0x441cc8(0x8c)]=_0x441cc8(0x100),_0x596472[_0x441cc8(0x1a6)]=_0x441cc8(0x1a0),_0x596472['onclick']=_0x410776=>{const _0x2333d4=_0x441cc8;_0x410776[_0x2333d4(0x2d9)](),deleteSummary(_0x1b4d05['id']);},_0x23ac0b[_0x441cc8(0x32a)](_0x1cb349,_0x596472),_0x34e62a[_0x441cc8(0x32a)](_0x20d19f,_0x23ac0b),_0x34e62a['addEventListener'](_0x441cc8(0x2ad),()=>_0x217e3c[_0x441cc8(0x164)][_0x441cc8(0x27d)](_0x441cc8(0x32f))),_0x24118a[_0x441cc8(0x2cc)](_0x34e62a);});}function loadEditingPresetFields(){const _0x2f10b7=_0x1f8e33,_0x567337=data['settings'],_0x3136ed=_0x567337[_0x2f10b7(0x1c9)],_0x13d6ff=$(_0x2f10b7(0xb4)),_0x4ba766=$(_0x2f10b7(0x1a9));if(_0x13d6ff&&_0x4ba766){const _0x2202ab=editingPreset==='C';_0x13d6ff[_0x2f10b7(0x164)]['toggle']('hidden',_0x2202ab),_0x4ba766['classList'][_0x2f10b7(0x27d)](_0x2f10b7(0xcf),!_0x2202ab);}if(editingPreset==='A'){$(_0x2f10b7(0x252))[_0x2f10b7(0x278)]=_0x3136ed['A_work'];if($(_0x2f10b7(0x185)))$(_0x2f10b7(0x185))[_0x2f10b7(0x278)]=_0x3136ed[_0x2f10b7(0xb6)]??0x0;$(_0x2f10b7(0x364))[_0x2f10b7(0x278)]=_0x3136ed[_0x2f10b7(0x12b)],$(_0x2f10b7(0x1fa))[_0x2f10b7(0x278)]=_0x3136ed[_0x2f10b7(0x1ad)],$(_0x2f10b7(0x2d3))[_0x2f10b7(0x278)]=_0x567337[_0x2f10b7(0x15c)],$('#set_interval')['value']=_0x567337['longBreakIntervalA'];}else{if(editingPreset==='B'){$(_0x2f10b7(0x252))[_0x2f10b7(0x278)]=_0x3136ed[_0x2f10b7(0x247)];if($(_0x2f10b7(0x185)))$('#set_winddown')['value']=_0x3136ed[_0x2f10b7(0x15d)]??0x0;$(_0x2f10b7(0x364))[_0x2f10b7(0x278)]=_0x3136ed[_0x2f10b7(0xd5)],$(_0x2f10b7(0x1fa))[_0x2f10b7(0x278)]=_0x3136ed['B_long'],$(_0x2f10b7(0x2d3))['value']=_0x567337[_0x2f10b7(0x184)],$(_0x2f10b7(0xfa))[_0x2f10b7(0x278)]=_0x567337[_0x2f10b7(0x1e9)];}else{if(editingPreset==='C'){const _0x40cd14=$(_0x2f10b7(0x23a));if(_0x40cd14)_0x40cd14[_0x2f10b7(0x278)]=_0x567337[_0x2f10b7(0x33f)]??0x5;}}}}function highlightPresetSelector(){const _0x2368f7=_0x1f8e33;$$('#timerPresetSelector\x20button')[_0x2368f7(0x2dd)](_0x4a5aa0=>{const _0x4f9942=_0x2368f7,_0x55a7f3=_0x4a5aa0[_0x4f9942(0xe5)]['presetTarget']===editingPreset;_0x4a5aa0[_0x4f9942(0x164)][_0x4f9942(0x27d)](_0x4f9942(0x10a),_0x55a7f3),_0x4a5aa0[_0x4f9942(0x164)][_0x4f9942(0x27d)]('ghost',!_0x55a7f3);});}function openSettings(){const _0x3f5a58=_0x1f8e33,_0x4490ce=data[_0x3f5a58(0x1f9)];editingPreset=_0x4490ce[_0x3f5a58(0x206)],$('#set_apiKey')['value']=_0x4490ce[_0x3f5a58(0x298)]||'',loadEditingPresetFields(),highlightPresetSelector(),$('#set_volume')[_0x3f5a58(0x278)]=_0x4490ce['volume']??0.8,$(_0x3f5a58(0x378))[_0x3f5a58(0x278)]=_0x4490ce['soundTheme']||'beep',$(_0x3f5a58(0x263))[_0x3f5a58(0x278)]=_0x4490ce[_0x3f5a58(0x2aa)]||_0x3f5a58(0x368);const _0x4c18ae=getActiveYoutubeUrl();$('#set_youtubeUrl')[_0x3f5a58(0x278)]=_0x4c18ae||'';const _0x21de23=extractYouTubeID(_0x4c18ae);$(_0x3f5a58(0x37b))[_0x3f5a58(0x201)]=!_0x21de23;$(_0x3f5a58(0x180))&&($(_0x3f5a58(0x180))[_0x3f5a58(0x1a6)]='');$(_0x3f5a58(0x220))['value']=_0x4490ce[_0x3f5a58(0x14e)]||0x50,$(_0x3f5a58(0x279))['checked']=!!_0x4490ce[_0x3f5a58(0x153)],$(_0x3f5a58(0x248))['value']=_0x4490ce[_0x3f5a58(0x1b6)]||0.85;$('#set_backgroundMode')&&($('#set_backgroundMode')['value']=_0x4490ce[_0x3f5a58(0xd4)]||_0x3f5a58(0x369));$('#set_autoStartNext')&&($(_0x3f5a58(0x226))[_0x3f5a58(0x167)]=!!_0x4490ce[_0x3f5a58(0x193)]);$('#set_enableWinddown')&&($(_0x3f5a58(0x89))[_0x3f5a58(0x167)]=_0x4490ce[_0x3f5a58(0x266)]!==![]);$(_0x3f5a58(0x2ed))&&($(_0x3f5a58(0x2ed))[_0x3f5a58(0x167)]=!!_0x4490ce['enableSessionNotes']);$(_0x3f5a58(0x30c))&&($(_0x3f5a58(0x30c))[_0x3f5a58(0x278)]=_0x4490ce['backupDaysToKeep']||0x7);const _0xc0da01=$('#backupList');_0xc0da01&&storageManager[_0x3f5a58(0x356)]()[_0x3f5a58(0x17f)](_0x257776=>{const _0x589ba5=_0x3f5a58;_0xc0da01['innerHTML']='<option\x20value=\x22\x22>--\x20Select\x20a\x20date\x20to\x20restore\x20--</option>',_0x257776&&_0x257776[_0x589ba5(0x370)]>0x0?_0x257776['forEach'](_0x445e30=>{const _0x358e10=_0x589ba5,_0x5e4626=document[_0x358e10(0x307)]('option');_0x5e4626[_0x358e10(0x278)]=_0x445e30[_0x358e10(0x2bd)],_0x5e4626['textContent']=_0x358e10(0x2bb)+new Date(_0x445e30[_0x358e10(0x2bd)])['toLocaleDateString'](_0x358e10(0x1d7)),_0xc0da01[_0x358e10(0x2cc)](_0x5e4626);}):_0xc0da01[_0x589ba5(0xa6)]=_0x589ba5(0x155);});$('#modalSettings')[_0x3f5a58(0x164)][_0x3f5a58(0x2d4)](_0x3f5a58(0x2e8));try{trapFocus($(_0x3f5a58(0x146)));}catch(_0x41e569){}}function closeSettings(){const _0x2c8b60=_0x1f8e33;$('#modalSettings')[_0x2c8b60(0x164)][_0x2c8b60(0xf3)](_0x2c8b60(0x2e8));try{releaseFocus();}catch(_0x1eb48a){}}async function setDefaults(){const _0x544742=_0x1f8e33;data[_0x544742(0x1f9)]['durations']={'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},data[_0x544742(0x1f9)]['cyclesA']=0x4,data['settings'][_0x544742(0x8f)]=0x4,data[_0x544742(0x1f9)][_0x544742(0x184)]=0x4,data['settings'][_0x544742(0x1e9)]=0x4,data[_0x544742(0x1f9)][_0x544742(0x33f)]=0x5,data['settings'][_0x544742(0x206)]='A',data['settings']['volume']=0.8,data[_0x544742(0x1f9)]['soundTheme']='beep',await saveData(),openSettings(),toast(_0x544742(0x1a3));}async function saveSettings(){const _0x45ffe6=_0x1f8e33,_0x5ce8b5=data[_0x45ffe6(0x1f9)];_0x5ce8b5[_0x45ffe6(0x298)]=$(_0x45ffe6(0x2a3))['value'][_0x45ffe6(0x26a)]();const _0x313e50=_0x5ce8b5[_0x45ffe6(0x1c9)];if(editingPreset==='A')_0x313e50[_0x45ffe6(0x257)]=clampInt($(_0x45ffe6(0x252))['value'],0x1,0x3e7),_0x313e50[_0x45ffe6(0xb6)]=clampInt($(_0x45ffe6(0x185))[_0x45ffe6(0x278)],0x0,0x3e7),_0x313e50[_0x45ffe6(0x12b)]=clampInt($(_0x45ffe6(0x364))[_0x45ffe6(0x278)],0x1,0x3e7),_0x313e50[_0x45ffe6(0x1ad)]=clampInt($('#set_long')['value'],0x1,0x3e7),_0x5ce8b5['cyclesA']=clampInt($('#set_cycles')['value'],0x1,0xc),_0x5ce8b5[_0x45ffe6(0x8f)]=clampInt($('#set_interval')['value'],0x2,0xc);else{if(editingPreset==='B')_0x313e50[_0x45ffe6(0x247)]=clampInt($(_0x45ffe6(0x252))['value'],0x1,0x3e7),_0x313e50[_0x45ffe6(0x15d)]=clampInt($(_0x45ffe6(0x185))[_0x45ffe6(0x278)],0x0,0x3e7),_0x313e50['B_short']=clampInt($('#set_short')[_0x45ffe6(0x278)],0x1,0x3e7),_0x313e50['B_long']=clampInt($('#set_long')['value'],0x1,0x3e7),_0x5ce8b5[_0x45ffe6(0x184)]=clampInt($('#set_cycles')['value'],0x1,0xc),_0x5ce8b5['longBreakIntervalB']=clampInt($(_0x45ffe6(0xfa))[_0x45ffe6(0x278)],0x2,0xc);else{if(editingPreset==='C'){const _0x2b3b7f=$(_0x45ffe6(0x23a));if(_0x2b3b7f)_0x5ce8b5[_0x45ffe6(0x33f)]=clampInt(_0x2b3b7f['value'],0x1,0x14);}}}_0x5ce8b5[_0x45ffe6(0x246)]=clampFloat($(_0x45ffe6(0x10c))[_0x45ffe6(0x278)],0x0,0x1,0.8),_0x5ce8b5[_0x45ffe6(0x175)]=$(_0x45ffe6(0x378))[_0x45ffe6(0x278)]===_0x45ffe6(0xec)?'chime':_0x45ffe6(0x25e),_0x5ce8b5['theme']=$(_0x45ffe6(0x263))[_0x45ffe6(0x278)],_0x5ce8b5[_0x45ffe6(0x1b6)]=parseFloat($('#set_panelOpacity')[_0x45ffe6(0x278)])||0.85;$(_0x45ffe6(0x229))&&(_0x5ce8b5[_0x45ffe6(0xd4)]=$(_0x45ffe6(0x229))[_0x45ffe6(0x278)]);_0x5ce8b5[_0x45ffe6(0x193)]=!!($(_0x45ffe6(0x226))&&$('#set_autoStartNext')[_0x45ffe6(0x167)]),_0x5ce8b5[_0x45ffe6(0x266)]=!!($('#set_enableWinddown')&&$(_0x45ffe6(0x89))[_0x45ffe6(0x167)]),_0x5ce8b5['enableSessionNotes']=!!($(_0x45ffe6(0x2ed))&&$('#set_enableSessionNotes')['checked']);$(_0x45ffe6(0x30c))&&(_0x5ce8b5[_0x45ffe6(0x147)]=clampInt($(_0x45ffe6(0x30c))[_0x45ffe6(0x278)],0x1,0x1e));_0x5ce8b5['theme']===_0x45ffe6(0x197)||_0x5ce8b5[_0x45ffe6(0x2aa)]===_0x45ffe6(0xdf)?(_0x5ce8b5[_0x45ffe6(0x153)]=![],typeof _0x5ce8b5[_0x45ffe6(0x18d)]===_0x45ffe6(0x1b8)&&_0x5ce8b5[_0x45ffe6(0x18d)]['includes']('img.youtube.com/vi/')&&(_0x5ce8b5[_0x45ffe6(0x18d)]='')):_0x5ce8b5['useYtThumbnailAsBg']=!![];const _0x3f5145=$(_0x45ffe6(0x2b8))[_0x45ffe6(0x278)][_0x45ffe6(0x26a)]();_0x5ce8b5[_0x45ffe6(0x153)]=$(_0x45ffe6(0x279))['checked'],_0x5ce8b5[_0x45ffe6(0x14e)]=parseInt($('#ytSoundVolume')[_0x45ffe6(0x278)],0xa),sessionYoutubeUrl=_0x3f5145;try{if(!IS_FILE_PROTOCOL){if(ytPlayer&&ytPlayer[_0x45ffe6(0x24f)])ytPlayer['setVolume'](_0x5ce8b5[_0x45ffe6(0x14e)]);}else try{fallbackPostMessage(_0x45ffe6(0x24f),[_0x5ce8b5[_0x45ffe6(0x14e)]]);}catch(_0x3b6e9e){}}catch(_0x1471ce){}await saveData(),applyTheme(),applyCustomBg(),applyPanelOpacity(),updatePresetButtonsText(),timer[_0x45ffe6(0x285)](_0x5ce8b5[_0x45ffe6(0x206)],{'silent':!![]}),closeSettings(),toast(_0x45ffe6(0xd0));}function clampInt(_0x4608b8,_0x5ab918,_0x38150e){const _0x59a0e0=_0x1f8e33;_0x4608b8=parseInt(_0x4608b8||0x0,0xa);if(isNaN(_0x4608b8))_0x4608b8=_0x5ab918;return Math['max'](_0x5ab918,Math[_0x59a0e0(0x159)](_0x38150e,_0x4608b8));}function clampFloat(_0x42823d,_0xdde18f,_0x2b9316,_0x5e6398){const _0x4913b7=_0x1f8e33;_0x42823d=parseFloat(_0x42823d);if(Number['isNaN'](_0x42823d))_0x42823d=_0x5e6398;return Math[_0x4913b7(0xe4)](_0xdde18f,Math[_0x4913b7(0x159)](_0x2b9316,_0x42823d));}const dbPromise=new Promise((_0x193a91,_0x8af4ba)=>{const _0x47236d=_0x1f8e33,_0x230ebe=indexedDB[_0x47236d(0x109)](_0x47236d(0x382),0x1);_0x230ebe[_0x47236d(0x90)]=_0xb9225d=>_0xb9225d[_0x47236d(0xa4)][_0x47236d(0x7c)][_0x47236d(0x2f7)]('files'),_0x230ebe[_0x47236d(0x334)]=_0x2bff63=>_0x193a91(_0x2bff63[_0x47236d(0xa4)][_0x47236d(0x7c)]),_0x230ebe[_0x47236d(0x133)]=_0x54490f=>_0x8af4ba(_0x54490f);}),fileCache={};function handleFileUpload(_0x15fee0,_0x5cd73c){const _0x3511d1=_0x1f8e33;if(!_0x15fee0)return;dbPromise[_0x3511d1(0x17f)](_0x2f86a6=>{const _0x3ca87c=_0x3511d1,_0x2364e8=uid('file'),_0x3ea66e=_0x2f86a6[_0x3ca87c(0x1cf)](_0x3ca87c(0x21b),_0x3ca87c(0xda));_0x3ea66e[_0x3ca87c(0x189)](_0x3ca87c(0x21b))[_0x3ca87c(0x1fb)](_0x15fee0,_0x2364e8),_0x3ea66e[_0x3ca87c(0x1d3)]=()=>_0x5cd73c(_0x2364e8),_0x3ea66e['onerror']=()=>toast(_0x3ca87c(0x349));});}function getStoredFileUrl(_0x53e4b4){const _0x42df1e=_0x1f8e33;if(!_0x53e4b4)return Promise[_0x42df1e(0x233)]('');if(fileCache[_0x53e4b4])return Promise[_0x42df1e(0x233)](fileCache[_0x53e4b4]);return dbPromise['then'](_0x1d75dc=>new Promise(_0xf7c36=>{const _0x19c875=_0x42df1e,_0x535fc7=_0x1d75dc[_0x19c875(0x1cf)](_0x19c875(0x21b),_0x19c875(0xf6)),_0xa2a0b3=_0x535fc7[_0x19c875(0x189)](_0x19c875(0x21b))[_0x19c875(0x301)](_0x53e4b4);_0xa2a0b3['onsuccess']=_0x3707a8=>{const _0x5b67b7=_0x19c875,_0x4f05ba=_0x3707a8[_0x5b67b7(0xa4)]['result'];if(_0x4f05ba){const _0x283c47=URL[_0x5b67b7(0x11a)](_0x4f05ba);fileCache[_0x53e4b4]=_0x283c47,_0xf7c36(_0x283c47);}else _0xf7c36('');},_0xa2a0b3[_0x19c875(0x133)]=()=>_0xf7c36('');}));}function applyCustomBg(){const _0x12f43c=_0x1f8e33,_0x4ff150=data[_0x12f43c(0x1f9)],_0x5c03c2=_0x4ff150[_0x12f43c(0x18d)],_0x5949e5=_0x4ff150[_0x12f43c(0x2aa)],_0x5bb91f=[_0x12f43c(0xa5),_0x12f43c(0x213)][_0x12f43c(0x359)](_0x5949e5),_0x339949=_0x5949e5===_0x12f43c(0x197)||_0x5949e5===_0x12f43c(0xdf),_0x1f1b75=_0x4ff150['backgroundMode']||'cover';document['body'][_0x12f43c(0x10e)][_0x12f43c(0x397)]=_0x1f1b75,document[_0x12f43c(0x22c)][_0x12f43c(0x10e)][_0x12f43c(0x391)]=_0x1f1b75==='auto'?_0x12f43c(0x1a1):_0x12f43c(0x28e);const _0x5e5d26=()=>{const _0x430652=_0x12f43c;try{document[_0x430652(0x22c)][_0x430652(0x10e)][_0x430652(0x32c)]='';}catch(_0x50f4ee){}};if(_0x5c03c2){const _0x106d3b=_0x5c03c2[_0x12f43c(0x35b)]('data:')||_0x5c03c2[_0x12f43c(0x35b)](_0x12f43c(0x2e6))||_0x5c03c2[_0x12f43c(0x35b)]('blob:')?Promise[_0x12f43c(0x233)](_0x5c03c2):getStoredFileUrl(_0x5c03c2);_0x106d3b[_0x12f43c(0x17f)](_0x2474b4=>{const _0x146852=_0x12f43c;_0x2474b4?document['body']['style'][_0x146852(0x82)](_0x146852(0x169),_0x146852(0xf7)+_0x2474b4+')'):document[_0x146852(0x22c)][_0x146852(0x10e)][_0x146852(0x82)](_0x146852(0x169),_0x339949?_0x146852(0x219):''),_0x5e5d26();});}else!_0x5bb91f?_0x339949?(document[_0x12f43c(0x22c)][_0x12f43c(0x10e)][_0x12f43c(0x82)](_0x12f43c(0x169),'none'),_0x5e5d26()):document[_0x12f43c(0x22c)][_0x12f43c(0x10e)]['setProperty'](_0x12f43c(0x169),_0x12f43c(0x366)):(document[_0x12f43c(0x22c)][_0x12f43c(0x10e)]['removeProperty']('--bg-image'),_0x5e5d26());}function applyPanelOpacity(){const _0x414914=_0x1f8e33;document[_0x414914(0x16c)][_0x414914(0x10e)][_0x414914(0x82)](_0x414914(0x361),data[_0x414914(0x1f9)][_0x414914(0x1b6)]);}function renderDashboard(){const _0x584d15=_0x1f8e33,_0x380ebb=data[_0x584d15(0x372)][_0x584d15(0x35f)](_0x49bdc4=>_0x49bdc4[_0x584d15(0x1c5)][_0x584d15(0x24e)](_0x1c12b1=>({'topic':_0x49bdc4['name'],'subtopic':_0x1c12b1[_0x584d15(0x149)],'m':_0x1c12b1[_0x584d15(0x1fe)][_0x584d15(0x236)]||0x0,'c':_0x1c12b1[_0x584d15(0x1fe)]['sessionsCompleted']||0x0,'t':_0x1c12b1[_0x584d15(0x1fe)][_0x584d15(0x1c6)]||0x0}))),_0x3a6e99=_0x380ebb['reduce']((_0x2134e2,_0x14e342)=>_0x2134e2+_0x14e342['m'],0x0),_0xa7ce06=_0x380ebb[_0x584d15(0x35c)]((_0x1dd49e,_0x142c6a)=>_0x1dd49e+_0x142c6a['c'],0x0),_0x1a4a03=_0x380ebb[_0x584d15(0x35c)]((_0x3fe1ff,_0x490896)=>_0x3fe1ff+_0x490896['t'],0x0);let _0x1a4a50='<p\x20class=\x22tiny\x22><strong>Total\x20time:</strong>\x20'+formatDaysHoursMinutes(_0x3a6e99)+_0x584d15(0xf1)+_0xa7ce06+_0x584d15(0x357)+_0x1a4a03+_0x584d15(0xb3);_0x380ebb[_0x584d15(0x2dd)](_0x439447=>{const _0x802714=_0x584d15;_0x1a4a50+=_0x802714(0x131)+escapeHTML(_0x439447[_0x802714(0x324)])+'</td><td>'+escapeHTML(_0x439447[_0x802714(0x33b)])+_0x802714(0x205)+formatDaysHoursMinutes(_0x439447['m'])+_0x802714(0x205)+_0x439447['c']+_0x802714(0x205)+_0x439447['t']+'</td></tr>';}),_0x1a4a50+=_0x584d15(0x362);const _0x56e070=$(_0x584d15(0xaf));if(_0x56e070)_0x56e070[_0x584d15(0xa6)]=_0x1a4a50;}function getMilestones(){const _0x181c3a=_0x1f8e33;return[{'hours':0x5,'title':_0x181c3a(0xe8),'message':_0x181c3a(0x223)},{'hours':0x14,'title':_0x181c3a(0x297),'message':_0x181c3a(0x26f)},{'hours':0x32,'title':'To\x20You,\x2050\x20Hours\x20(Momentum)','message':_0x181c3a(0x360)},{'hours':0x64,'title':'To\x20You,\x20100\x20Hours\x20of\x20Dedication\x20(Commitment)','message':_0x181c3a(0xea)},{'hours':0xfa,'title':'To\x20You,\x20250\x20Hours\x20(Perseverance)','message':_0x181c3a(0xc2)},{'hours':0x1f4,'title':'To\x20You,\x20500\x20Hours\x20(Focus\x20Mastery)','message':_0x181c3a(0x326)},{'hours':0x3e8,'title':_0x181c3a(0x97),'message':'Welcome\x20to\x20the\x201,000-Hour\x20Club.\x0a\x0aThis\x20number\x20is\x20not\x20just\x20time‚Äîit\x20represents\x20transformation.\x20Focus\x20has\x20become\x20part\x20of\x20you,\x20a\x20‚Äòsuperpower‚Äô\x20you\x20can\x20summon.\x20Your\x20journey\x20is\x20inspiring.'},{'hours':0x1388,'title':_0x181c3a(0x337),'message':_0x181c3a(0x20e)}][_0x181c3a(0x119)]((_0x4f6281,_0x502fee)=>_0x502fee[_0x181c3a(0x8d)]-_0x4f6281['hours']);}async function checkAndShowMilestones(){const _0x4f04f9=_0x1f8e33;if(!data||!data[_0x4f04f9(0x1f9)])return;if(!Array['isArray'](data[_0x4f04f9(0x1f9)][_0x4f04f9(0x194)]))data[_0x4f04f9(0x1f9)][_0x4f04f9(0x194)]=[];const _0x4569ce=data['topics'][_0x4f04f9(0x35c)]((_0x3c74e4,_0x52f33f)=>{const _0x3cf68a=_0x4f04f9;return _0x3c74e4+_0x52f33f['subtopics'][_0x3cf68a(0x35c)]((_0x1776d1,_0x156dd5)=>{const _0x507245=_0x3cf68a;return _0x1776d1+(_0x156dd5[_0x507245(0x1fe)][_0x507245(0x236)]||0x0);},0x0);},0x0),_0x5b374b=_0x4569ce/0x3c,_0x5c03d6=getMilestones(),_0x2200e7=Array[_0x4f04f9(0x2dc)](data[_0x4f04f9(0x1f9)][_0x4f04f9(0x194)])?data['settings'][_0x4f04f9(0x194)]:[],_0x3107c3=_0x5c03d6[_0x4f04f9(0x2f6)](_0x464b6d=>_0x5b374b>=_0x464b6d['hours']&&!_0x2200e7[_0x4f04f9(0x359)](_0x464b6d[_0x4f04f9(0x8d)]));if(_0x3107c3[_0x4f04f9(0x370)]===0x0)return![];const _0x296f62=_0x3107c3['reduce']((_0x488bf0,_0x5a1f3d)=>_0x488bf0&&_0x488bf0[_0x4f04f9(0x8d)]>_0x5a1f3d['hours']?_0x488bf0:_0x5a1f3d,null);if(!_0x296f62)return![];$('#milestoneTitle')[_0x4f04f9(0x1a6)]=_0x296f62[_0x4f04f9(0x2b7)],$(_0x4f04f9(0x351))['textContent']=_0x296f62['message'],$(_0x4f04f9(0x94))[_0x4f04f9(0x164)][_0x4f04f9(0x2d4)]('show');try{trapFocus($(_0x4f04f9(0x94)));}catch(_0x4e62c1){}return data[_0x4f04f9(0x1f9)][_0x4f04f9(0x194)]['push'](_0x296f62[_0x4f04f9(0x8d)]),await saveData(),!![];}async function seedAchievedMilestones(){const _0x1a4729=_0x1f8e33;if(!data||!data[_0x1a4729(0x1f9)])return;!Array[_0x1a4729(0x2dc)](data['settings']['achievedMilestones'])&&(data[_0x1a4729(0x1f9)][_0x1a4729(0x194)]=[],await saveData());}async function handleSendMessage(){const _0x45e3ce=_0x1f8e33,_0xe8ec8b=$(_0x45e3ce(0x151)),_0x4e0888=$(_0x45e3ce(0x2a4)),_0x1e01a6=_0x4e0888[_0x45e3ce(0x278)][_0x45e3ce(0x26a)](),_0x2d6be7=getCurrentSubtopic();if(!_0x1e01a6)return;if(!_0x2d6be7){toast(t(_0x45e3ce(0x2cf)));return;}_0x4e0888[_0x45e3ce(0x278)]='',_0xe8ec8b['disabled']=!![],_0xe8ec8b[_0x45e3ce(0xa6)]=_0x45e3ce(0x344),_0x2d6be7['chatHistory'][_0x45e3ce(0x19f)]({'role':_0x45e3ce(0x35d),'text':_0x1e01a6}),renderChat();const _0x34aef7=await callGeminiAPI(_0x1e01a6);_0x34aef7&&(_0x2d6be7[_0x45e3ce(0x140)]['push']({'role':_0x45e3ce(0x16e),'text':_0x34aef7}),await saveData(),renderChat()),_0xe8ec8b[_0x45e3ce(0x201)]=![],_0xe8ec8b[_0x45e3ce(0xa6)]=_0x45e3ce(0x21c);}function renderChat(){const _0x183ee5=_0x1f8e33,_0x38580b=getCurrentSubtopic(),_0x54a7bd=$('#chatMessages'),_0x55e0c5=$('#chatInput'),_0x3d5b11=$(_0x183ee5(0x151));if(!_0x54a7bd||!_0x55e0c5||!_0x3d5b11)return;if(!_0x38580b){_0x54a7bd['innerHTML']=_0x183ee5(0x251),_0x55e0c5['disabled']=!![],_0x3d5b11['disabled']=!![];return;}_0x55e0c5[_0x183ee5(0x201)]=![],_0x3d5b11[_0x183ee5(0x201)]=![],_0x54a7bd[_0x183ee5(0xa6)]='';if(!_0x38580b['chatHistory']||_0x38580b['chatHistory'][_0x183ee5(0x370)]===0x0){_0x54a7bd[_0x183ee5(0xa6)]=_0x183ee5(0xe2);return;}_0x38580b[_0x183ee5(0x140)][_0x183ee5(0x2dd)](_0x32aae5=>{const _0x37103c=_0x183ee5,_0x42dab0=document['createElement'](_0x37103c(0x179));_0x42dab0[_0x37103c(0x8c)]=_0x37103c(0x107)+_0x32aae5[_0x37103c(0x16b)],_0x42dab0[_0x37103c(0x1a6)]=_0x32aae5[_0x37103c(0x38a)],_0x54a7bd['appendChild'](_0x42dab0);}),_0x54a7bd[_0x183ee5(0x212)]=_0x54a7bd[_0x183ee5(0xcd)];}async function handleSummarizeNote(){const _0x247ab1=_0x1f8e33,_0x1d878e=$('#btnSummarizeNote'),_0x3ea076=$(_0x247ab1(0x1ff)),_0x1c76c2=_0x3ea076[_0x247ab1(0x278)]['trim'](),_0x1809f6=getCurrentSubtopic();if(!_0x1c76c2){toast(_0x247ab1(0xa8));return;}const _0x2a476c=_0x1d878e[_0x247ab1(0xa6)];_0x1d878e[_0x247ab1(0xa6)]=_0x247ab1(0x344),_0x1d878e[_0x247ab1(0x201)]=!![];const _0x3cb7ca='Based\x20on\x20the\x20following:\x0a-\x20Topic/Subtopic:\x20\x22'+(_0x1809f6?.['name']||'unknown')+_0x247ab1(0x11f)+_0x1c76c2+_0x247ab1(0x243),_0x31d19f=await callGeminiAPI(_0x3cb7ca);_0x31d19f&&(_0x3ea076[_0x247ab1(0x278)]+='\x0a\x0a'+_0x31d19f),_0x1d878e[_0x247ab1(0xa6)]=_0x2a476c,_0x1d878e['disabled']=![];}function _0x32f5(){const _0x4a57ff=['Switch\x20to\x20Style\x20','#btnPause','Add\x20New\x20Knowledge','#btnGenericCancel','Disabled\x20YouTube\x20background\x20to\x20suit\x20the\x20light\x20theme.','reload','isConnected','code','#modalNote','persistTimerState','removing','IndexedDB\x20error:','querySelector','#toasts','topic-header','#audioBreakEnd','Session\x20completed!\x20Press\x20Start\x20to\x20begin\x20the\x20next\x20session.','longBreakIntervalB','lang','Stand\x20up\x20and\x20take\x20a\x20few\x20steps.','removeProperty','autoplay;\x20encrypted-media;\x20picture-in-picture','#timerPresetSelector\x20button','resume','#btnMilestoneClose','errorCode','No\x20valid\x20link.\x20Paste\x20a\x20link\x20then\x20press\x20‚ñ∂Ô∏è.','getSettings','chev\x20btn\x20small\x20ghost','Subtopic:\x20','API\x20response\x20structure\x20is\x20unexpected:','methods','<p>Active\x20Recall\x20is\x20the\x20effortful\x20retrieval\x20of\x20information\x20from\x20memory\x20without\x20looking\x20at\x20materials.\x20It\x20outperforms\x20passive\x20methods\x20like\x20rereading,\x20highlighting,\x20or\x20summarizing.</p><h4>The\x2020/80\x20Principle</h4><p><strong>The\x20vital\x2020%:</strong>\x20Forcing\x20yourself\x20to\x20recall\x20strengthens\x20neural\x20connections\x20and\x20consolidates\x20long-term\x20memory.\x20The\x20difficulty\x20you\x20feel\x20while\x20recalling\x20is\x20the\x20sign\x20of\x20effective\x20learning.</p><p><strong>The\x2080%\x20result:</strong>\x20You\x20retain\x20knowledge\x20longer\x20and\x20know\x20exactly\x20where\x20you‚Äôre\x20weak.</p><h4>Most\x20Effective\x20Techniques</h4><ul><li><strong>Self-testing:</strong>\x20Hide\x20your\x20notes\x20and\x20quiz\x20yourself.\x20For\x20example,\x20use\x20flashcards\x20and\x20always\x20answer\x20before\x20flipping\x20them\x20over.</li><li><strong>Blurting:</strong>\x20After\x20studying\x20a\x20topic,\x20close\x20the\x20book\x20and\x20write\x20everything\x20you\x20can\x20remember.\x20Then\x20compare\x20with\x20the\x20source\x20to\x20fill\x20gaps.</li><li><strong>Teach\x20someone\x20else:</strong>\x20Explaining\x20a\x20concept\x20forces\x20retrieval,\x20simplification,\x20and\x20coherent\x20structuring.</li></ul><p><i>Bottom\x20line:\x20Don‚Äôt\x20just\x20reread.\x20Pause,\x20cover\x20your\x20materials,\x20and\x20ask:\x20\x22What\x20do\x20I\x20actually\x20remember?\x22</i></p>','settings','#set_long','put','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20summary?','save','stats','#noteText','createIndex','disabled','styleWithCSS','about:blank','.sub-row','</td><td>','preset','Spaced\x20Repetition:\x20Learning\x20at\x20the\x20Right\x20Time','selectedSubtopicId','Loosen\x20your\x20finger\x20joints\x20after\x20typing.','height','üåä\x20Flow','relative','currentDurations','5,000\x20hours\x20of\x20deliberate\x20focus.\x20Few\x20ever\x20reach\x20this.\x0a\x0aAt\x20this\x20milestone,\x20the\x20question\x20shifts\x20from\x20‚ÄòHow\x20do\x20I\x20focus?‚Äô\x20to\x20‚ÄòWhat\x20value\x20will\x20this\x20focus\x20create?‚Äô.\x20You‚Äôre\x20not\x20just\x20working‚Äîyou‚Äôre\x20building\x20a\x20legacy.','#btnSummarize','insertOrderedList','onclick','scrollTop','space','defer','FOCUS','#historyList','.method-delete','Initialization\x20error:\x20','none','#customSoundsContainer','files','Send','Look\x20at\x20something\x20cute\x20or\x20uplifting.','Do\x20a\x20few\x20deep-breathing\x20cycles.','command','#ytSoundVolume','.color-picker-wrapper','innerHeight','Five\x20focused\x20hours!\x20You‚Äôve\x20overcome\x20the\x20biggest\x20barrier:\x20procrastination.\x20Every\x20minute\x20invested\x20is\x20a\x20statement\x20of\x20your\x20intent.\x20Keep\x20the\x20fire\x20burning!','#view-methods\x20.methods-container','The\x20Feynman\x20Technique:\x20Understand\x20Deeply\x20by\x20Explaining\x20Simply','#set_autoStartNext','badge\x20state\x20break','Open\x20a\x20window\x20for\x20some\x20fresh\x20air.','#set_backgroundMode','transition','620310fHNsPd','body','pomodoroData_v11','Count\x20your\x20breaths\x20slowly\x20up\x20to\x20ten.','BUFFERING','PAUSED','#btnAddGeneralNote','<div><span\x20class=\x22tiny\x22>(no\x20note\x20yet)</span></div>','resolve','Error:\x20Unable\x20to\x20enter\x20fullscreen:\x20','Player','totalMinutes','long_break','cueVideoById','textarea','#set_flowRatio','state','cycleIndex','getAll','#methodEditorTitle','reloading','paused','indexOf','btn\x20subtopic-btn','\x22\x0a\x0aProduce\x20a\x20concise\x20summary\x20of\x20what\x20was\x20done\x20and\x20propose\x20a\x20reasonable\x20next\x20step.\x20Format\x20the\x20answer\x20like\x20this:\x0a\x0a---\x0a**‚ú®\x20AI\x20Summary:**\x0a[Summary\x20here]\x0a\x0a**üöÄ\x20Next\x20Suggestion:**\x0a[Suggestion\x20here]','src','</p>','volume','B_work','#set_panelOpacity','parentElement','getBoundingClientRect','Data\x20imported\x20successfully!','data:','#toolBold','map','setVolume','#topicsList','<div\x20class=\x22tiny\x22>Select\x20a\x20subtopic\x20to\x20start\x20chatting.</div>','#set_work','undefined','<div\x20class=\x22tiny\x22>No\x20summaries\x20yet.</div>','now','\x22\x20title=\x22Complete\x20task\x22>\x20<label\x20for=\x22','A_work','stopVideo','/maxresdefault.jpg','webkitAudioContext','formatBlock','note-meta','-9999px','beep','button,\x20[href],\x20input,\x20select,\x20textarea,\x20[tabindex]:not([tabindex=\x22-1\x22])','enableSessionNotes','keydown','text/plain','#set_theme_color','#view-methods\x20.method-item','no-subtopic-selected','enableWinddown','Have\x20a\x20sip\x20of\x20water.','\x0a-\x20','\x22?\x20All\x20related\x20data\x20will\x20be\x20lost.','trim','#currentSubtopicName','blob:','#btnPresetA','Gaze\x20out\x20the\x20window\x20for\x2020\x20seconds.','Congrats\x20on\x20doing\x20the\x20hardest\x20part:\x20starting\x20and\x20staying\x20consistent.\x0a\x0aThese\x2020\x20hours\x20aren‚Äôt\x20just\x20time‚Äîthey‚Äôre\x2020\x20hours\x20of\x20winning\x20against\x20distraction.\x20You‚Äôre\x20building\x20a\x20strong\x20foundation\x20of\x20discipline.\x20Be\x20proud\x20of\x20this\x20start.','#stateBadge','#draggableTimer','work','#modalGeneric','.modal','Daily\x20backup\x20successful.','#btnResume','removeChild','value','#set_ytThumbAsBg','onYouTubeIframeAPIReady','#uploadBg','#newSubtopicTaskInput','toggle','0\x20min','Gemini\x20error:\x20','#modalDashboard','youtube-player-container','color','left','Summary\x20deleted.','setPreset','Refuel\x20with\x20a\x20healthy\x20snack.','#view-methods','preventDefault','.actions-menu','Please\x20select\x20a\x20Subtopic\x20before\x20proceeding.','winddown','Sound\x20has\x20been\x20enabled!','Rename\x20Topic','no-repeat','update','isCompleted','customSounds','__ytApiPromise','sum','#breakSuggestionDisplay','.color-palette','#methodEditorTitleInput','To\x20You,\x2020\x20Hours\x20(Foundation)','apiKey','finished','Switched\x20to\x20Style\x20','selectedTopicId','#windDownChecklist','Audio\x20playback\x20error:','<div\x20class=\x22tiny\x22>No\x20notes\x20yet.</div>','Failed\x20to\x20delete\x20summary:','updateUI','getDate','backups','#set_apiKey','#chatInput','#timeDisplay','Count\x20down\x20slowly\x20from\x2020\x20to\x200.','https://www.youtube.com','Summarize','More\x20options','theme','üí°\x20Suggestion:\x20','Listen\x20closely\x20to\x20your\x20in-breath\x20and\x20out-breath.','click','all','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20subtopic\x20\x22','getPropertyValue','ArrowUp','Untitled','badge\x20state\x20work','break','New\x20Subtopic\x20name?','topic-actions','title','#set_youtubeUrl','destination','Backup\x20failed:','Backup\x20from:\x20','#btnSaveMethod','date','Use\x20AI\x20to\x20auto-format\x20text','B_long','_sortable','note','origin','660246WTmTkj','random','#aiPromptSuggestions\x20button','88LMCtWY','topicId','offsetWidth','&gt;','function','Analyze\x20and\x20reformat\x20the\x20following\x20plain\x20text\x20into\x20clean\x20HTML.\x20Use\x20these\x20tags:\x0a-\x20Use\x20<h4>\x20for\x20main\x20section\x20headings.\x0a-\x20Use\x20<strong>\x20to\x20emphasize\x20important\x20terms\x20or\x20ideas.\x0a-\x20Use\x20<i>\x20for\x20notes\x20or\x20quotes.\x0a-\x20Use\x20<ol>\x20and\x20<li>\x20for\x20ordered\x20lists.\x0a-\x20Use\x20<ul>\x20and\x20<li>\x20for\x20unordered\x20lists.\x0a-\x20Wrap\x20normal\x20paragraphs\x20with\x20<p>.\x0aText\x20to\x20format:\x0a\x0a\x22','appendChild','_startTick','Chat\x20history\x20cleared.','timer.selectSubtopicPrompt','cycles','initDB','width','#set_cycles','add','#btnStart','sound_unlocked','#audioLongEnd','location','stopPropagation','toLowerCase','__ytApiWatchdog','isArray','forEach','hist-item','Add\x20subtopic','#backupList','‚ùå\x20Invalid\x20or\x20unsupported\x20link.','https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=','\x20hidden','pomodoro_backup_','Custom\x20background\x20removed.','http','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Select\x20a\x20subtopic\x20to\x20view\x20the\x20to-do\x20list.</li>','show','clientY','#btnPresetB','#modalMethodEditor','.color-swatch','#set_enableSessionNotes','unshift','Deleted\x20old\x20backup:\x20','PomodoroAppDB','iframe','#btnDashboard','#btnAutoFormat','</li>','#methodEditorId','filter','createObjectStore','Please\x20select\x20a\x20Subtopic\x20first','menu-item\x20danger','Take\x20a\x20short\x20walk\x20around\x20the\x20room.','#btnFullscreen','href','lastBackupDate','input','&#39;','getVolume','get','...','bold','play','Rename\x20Subtopic','clear','createElement','tasks','<p>Benjamin\x20Franklin\x20trained\x20himself\x20from\x20a\x20poor\x20writer\x20into\x20a\x20master\x20by\x20practicing\x20actively‚Äîrather\x20than\x20reading\x20passively.\x20The\x20core\x20is\x20to\x20deconstruct,\x20recreate,\x20and\x20compare\x20with\x20a\x20high-quality\x20piece.</p><p>This\x20is\x20a\x20classic\x20example\x20of\x20<i>Deliberate\x20Practice</i>:\x20target\x20weaknesses,\x20set\x20clear\x20goals,\x20and\x20get\x20immediate\x20feedback.</p><h4>Core\x203-Step\x20Process</h4><ol><li><strong>Deconstruct:</strong>\x20Read\x20an\x20excellent\x20sample.\x20Then\x20jot\x20down\x20only\x20the\x20key\x20points\x20of\x20each\x20paragraph\x20or\x20sentence\x20on\x20a\x20separate\x20sheet.</li><li><strong>Recreate:</strong>\x20A\x20few\x20days\x20later‚Äîonce\x20you‚Äôve\x20forgotten\x20the\x20original\x20style‚Äîuse\x20those\x20key-point\x20notes\x20to\x20rewrite\x20the\x20piece\x20entirely\x20in\x20your\x20own\x20words.</li><li><strong>Compare\x20&\x20Correct:</strong>\x20Compare\x20your\x20version\x20with\x20the\x20original.\x20This\x20crucial\x20step\x20reveals\x20errors\x20in\x20vocabulary,\x20sentence\x20structure,\x20and\x20idea\x20organization\x20so\x20you\x20can\x20fix\x20them.</li></ol><p>Franklin\x20also\x20practiced\x20advanced\x20variations:\x20shuffling\x20the\x20order\x20of\x20ideas\x20to\x20train\x20logic,\x20or\x20turning\x20prose\x20into\x20poetry\x20to\x20enrich\x20vocabulary.</p><h4>The\x20Golden\x20Rule</h4><p>Success\x20here\x20doesn‚Äôt\x20come\x20from\x20mindless\x20repetition,\x20but\x20from\x20direct\x20feedback\x20loops.\x20Comparing\x20to\x20the\x20original\x20forces\x20you\x20to\x20confront\x20and\x20correct\x20specific\x20weaknesses‚Äîturning\x20vague\x20learning\x20into\x20measurable\x20practice.</p><p><i>To\x20write\x20better,\x20don‚Äôt\x20just\x20read.\x20Choose\x20a\x20great\x20piece,\x20analyze\x20it,\x20try\x20to\x20recreate\x20it,\x20then\x20compare\x20and\x20correct.</i></p>','tid','Error:\x20Invalid\x20or\x20changed\x20Gemini\x20API\x20Key.\x20Please\x20verify\x20in\x20Settings.','#set_backupDays','work_end','addEventListener','pause','menu-active','Break\x20','.presets\x20button','Content\x20blocked\x20for:\x20','setRangeText','idle','getAllKeys','#statSessions','replace','9jPLCrh','#btnExport','Time\x20to\x20wind\x20down.\x20Please\x20wrap\x20up\x20and\x20prepare\x20to\x20rest.','mode','altKey','#view-','reset','#btnRestoreBackup','#uploadSoundBreak','skip','auto','topic','#btnSaveNote','Half\x20a\x20thousand\x20hours\x20of\x20focus.\x20You‚Äôve\x20devoted\x20meaningful\x20time\x20to\x20what\x20matters.\x20This\x20level\x20of\x20dedication\x20creates\x20deep,\x20distinctive\x20results.\x20Admirable.','exponentialRampToValueAtTime','.topic-item','allow','append','linearRampToValueAtTime','backgroundImage','top','gain','expanded','change','abs','Saved\x20alert\x20for\x20FOCUS.','toISOString','onsuccess','#btnClearChat','closest','To\x20You,\x205,000+\x20Hours\x20(Legacy)','https:','#btnEnableSound','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M9.88\x209.88a3\x203\x200\x201\x200\x204.24\x204.24\x22/><path\x20d=\x22M10.73\x205.08A10.43\x2010.43\x200\x200\x201\x2012\x205c7\x200\x2010\x207\x2010\x207a13.16\x2013.16\x200\x200\x201-1.67\x202.68\x22/><path\x20d=\x22M6.61\x206.61A13.526\x2013.526\x200\x200\x200\x202\x2012s3\x207\x2010\x207a9.74\x209.74\x200\x200\x200\x205.39-1.61\x22/><line\x20x1=\x222\x22\x20y1=\x222\x22\x20x2=\x2222\x22\x20y2=\x2222\x22/></svg>','subtopic','stop','dateISO','Network\x20error\x20connecting\x20to\x20Gemini.\x20Please\x20check\x20your\x20internet\x20connection.','flowtimeBreakRatio','Data\x20restored\x20successfully!\x20Reloading...','\x27\x20¬∑\x20Mode\x20','main_settings','prompt','<div\x20class=\x22spinner\x22></div>','&lt;','candidates','remaining','currentConfig','File\x20save\x20error.','substring','data','Play\x20a\x20favorite\x20song\x20briefly.','434118oHOquY','actions','<div\x20class=\x22hist-meta\x22>','#btnSkipNote','#milestoneMessage','find','mousedown','tagName','<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20summaries.</div>','getBackupList','\x20|\x20<strong>Total\x20tasks:</strong>\x20','actions-menu','includes','from','startsWith','reduce','user','generalNotes','flatMap','50\x20focused\x20hours!\x20Your\x20habits\x20are\x20creating\x20momentum.\x20Small\x20daily\x20consistencies\x20compound\x20into\x20big\x20steps\x20forward.\x20You‚Äôre\x20on\x20the\x20right\x20path‚Äîkeep\x20going.','--panel-opacity','</tbody></table>','statusText','#set_short','Unable\x20to\x20save\x20changes.','radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)','stringify','default','cover','destroy','isContentEditable','pauseVideo','start','message','#btnAddSubtopicTask','length','details','topics','subtopics-group','Summarize\x20the\x20following\x20notes\x20as\x20concise,\x20clear\x20bullet\x20points:\x0a\x0a','AI\x20finished\x20formatting!','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>No\x20knowledge\x20items\x20added\x20yet.</p>','oldIndex','#set_theme','<p>To\x20avoid\x20overwhelm\x20in\x20a\x20new\x20domain,\x20focus\x20on\x20the\x20vital\x2020%\x20that\x20delivers\x2080%\x20of\x20the\x20results\x20(Minimum\x20Effective\x20Dose).</p><h4>The\x20Core\x2020%:\x20Use\x20this\x205-Step\x20Analysis\x20Framework\x20to\x20identify\x20the\x20critical\x2020%:</h4><ol><li><strong>Define\x20Outcomes:</strong>\x20What\x20is\x20your\x20end\x20goal?\x20(e.g.,\x20ship\x20a\x20basic\x20website).</li><li><strong>Analyze\x20Fundamentals:</strong>\x20Identify\x203‚Äì5\x20invariant\x20principles\x20of\x20the\x20field.</li><li><strong>Spot\x20Common\x20Pitfalls:</strong>\x20Learn\x20the\x20mistakes\x20beginners\x20make\x20and\x20avoid\x20them.</li><li><strong>Find\x20the\x20‚ÄúForce\x20Multiplier‚Äù:</strong>\x20Which\x20meta-skill\x20makes\x20learning\x20everything\x20else\x20easier?\x20(e.g.,\x20music\x20theory\x20in\x20music).</li><li><strong>Map\x20Practical\x20Application:</strong>\x20Focus\x20on\x20the\x2020%\x20of\x20tasks\x20that\x20consume\x2080%\x20of\x20real-world\x20time.</li></ol>','fullscreenElement','#btnToggleYtSound','note-content','#audioWorkEnd','currentView','scroll','#cycleInfo','floor','pomodoro_files','durationMinutes','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20topic\x20\x22','&amp;','#welcomePanel\x20p','soundPermissionBar','#methodEditorContentInput','onkeydown','text','setItem','Stand\x20up\x20and\x20stretch.','beginBreak','.method-item','.app-content','</h4>','backgroundRepeat','Invalid\x20file\x20format','Check\x20and\x20correct\x20your\x20sitting\x20posture.','break_end','ArrowRight','#editorPreview','backgroundSize','version','soundOn','method-content','#view-timer','var(--warn)','result','Loosen\x20wrists\x20and\x20shoulders\x20for\x2030\x20seconds.','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20its\x20Knowledge\x20Base.</p>','offsetHeight','Gently\x20close\x20your\x20eyes\x20and\x20smile\x20to\x20yourself.','<ul>','setProperty','setValueAtTime','getMonth','padStart','getItem','25GKNspE','objectStoreNames','#set_enableWinddown','removeEventListener','19170YhcYqx','className','hours','POST','longBreakIntervalA','onupgradeneeded','#btnDefaults','Did\x20not\x20receive\x20valid\x20content\x20from\x20AI.','right','#modalMilestone','match','.subtopics','To\x20You,\x201,000\x20Hours\x20(Transformation)','span','load','json','selectionStart','application/json','triangle','####\x20','</div>','.timer-circle-progress','Error\x20saving\x20data:\x20','tickHandle','prevState','target','lofi','innerHTML','toLocaleString','Please\x20enter\x20a\x20note\x20before\x20summarizing.','opacity','timerState','sub-row','DB_VERSION','Enter','focus','#dashboardContent','shiftKey','Notice\x20the\x20room‚Äôs\x20temperature\x20and\x20lighting.','.txt','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22dashboard-table\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead><tr><th>Topic</th><th>Subtopic</th><th>Time</th><th>Sessions</th><th>Tasks</th></tr></thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','#settings-pomodoro','Please\x20enter\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings.','A_winddown','topicsList','var(--muted)','delete','<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic.</div>','input,select,textarea','#btnAddTopic','beginWork','long','Error:\x20Rate\x20limit\x20exceeded\x20for\x20Gemini.\x20Please\x20try\x20again\x20in\x20a\x20few\x20minutes.','yt-fallback','Failed\x20to\x20save\x20data:','250\x20hours\x20is\x20proof\x20of\x20incredible\x20perseverance.\x20You‚Äôve\x20met\x20hard\x20days\x20and\x20distractions‚Äîand\x20you\x20kept\x20returning.\x20Real\x20strength\x20lies\x20in\x20this\x20consistency.','.timer-circle-container','display','setAttribute','.nav-btn[data-view]','PlayerState','cyclesTarget','</label>','postMessage','Ask\x20yourself:\x20‚ÄòHow\x20do\x20I\x20feel\x20right\x20now?‚Äô','activeElement','scrollHeight','var(--sub)','hidden','Settings\x20saved','Playing\x20background\x20music...','split','createdAt','backgroundMode','B_short','<input\x20type=\x22checkbox\x22\x20id=\x22','Remind\x20yourself:\x20Resting\x20well\x20helps\x20you\x20work\x20better!','Summary\x20failed.','protocol','readwrite','method-item','modalMethodEditor','var(--acc)','contentWindow','pastel','mute','ytUrlFeedback','<div\x20class=\x22tiny\x22>No\x20messages\x20yet.</div>','‚ú®\x20Auto-format','max','dataset','/hqdefault.jpg','sine','To\x20You,\x20The\x20First\x205\x20Hours\x20(Warm-up)','(none\x20selected)','100\x20hours!\x20This\x20is\x20no\x20longer\x20an\x20experiment‚Äîit‚Äôs\x20a\x20serious\x20investment\x20in\x20your\x20goals.\x0a\x0aTake\x20a\x20moment\x20to\x20reflect:\x20how\x20far\x20have\x20these\x20100\x20focused\x20hours\x20taken\x20you?\x20Your\x20energy\x20is\x20shaping\x20real\x20outcomes.','log','chime','workMinutes','#toolH4','Show\x20interface','AI\x20cannot\x20format\x20at\x20the\x20moment.','\x20|\x20<strong>Total\x20sessions:</strong>\x20','FOCUS\x20(FLOW)','remove','Background\x20music\x20stopped.','interval','readonly','url(','key','sessions','#set_interval','ArrowLeft','flex','Confirm\x20Restore','Close\x20your\x20eyes\x20and\x20relax\x20for\x20one\x20minute.','https://www.youtube.com/embed/','btn\x20small\x20danger','aria-expanded','short','cancel','_getStore','#toolBullet','Please\x20select\x20a\x20subtopic\x20first.','chat-msg\x20','#btnGenericOk','open','acc','#btnTestSound','#set_volume','newIndex','style','Cycle\x20','?\x20This\x20will\x20stop\x20and\x20reset\x20the\x20current\x20session.','Confirm\x20Deletion','#toolColor','Benjamin\x20Franklin‚Äôs\x20Writing\x20Method:\x20Learn\x20by\x20Recreating','findIndex','DB_NAME','Sortable','.tab-content','unMute','sort','createObjectURL','Hide\x20interface','toast','menu-item','#btnBreakEarly','\x22\x0a-\x20User\x27s\x20note\x20after\x20a\x20focus\x20session:\x20\x22','#welcomePanel','values','head','slice','Space','btnToggleYtSound','1050007Rcorjw','Add\x20note','HTTP\x20error:\x20','importData','collapsedTopics','A_short','finishFlowSession','Active\x20Recall:\x20The\x20Core\x20Principle\x20for\x20Deep\x20Learning','Step\x20onto\x20a\x20balcony\x20and\x20enjoy\x20natural\x20light.','Failed\x20to\x20load\x20YouTube\x20API','pointerdown','<tr><td>','error','onerror','</ul>','btn\x20small\x20ghost\x20actions-menu-btn','contains','baseVal','<p>','<i>$1</i>','localeCompare','#btnSkip','splice','btn\x20small\x20ghost\x20method-edit','type','button','chatHistory','Are\x20you\x20sure\x20you\x20want\x20to\x20restore\x20data\x20from\x20','updateSettings','method-title','READY','badge\x20state\x20long','#modalSettings','backupDaysToKeep','by_topic','name','beforeunload','var(--acc-2)','topic-item','promptFeedback','youtubeVolume','#btnCloseDashboard','parse','#btnSendMessage','content','useYtThumbnailAsBg','#genericMessage','<option\x20value=\x22\x22>No\x20backups\x20available</option>','No\x20Subtopic\x20Selected','#genericInput','topic-title','min','strokeDashoffset','beginWindDown','cyclesA','B_winddown','absolute','presetTarget','async','.tab-btn','bottom','<p>If\x20Active\x20Recall\x20is\x20about\x20<i>how</i>\x20you\x20learn,\x20Spaced\x20Repetition\x20is\x20about\x20<i>when</i>.\x20It\x20schedules\x20reviews\x20to\x20move\x20knowledge\x20into\x20long-term\x20memory\x20most\x20efficiently.</p><h4>Core\x20Principle:\x20Resist\x20Forgetting\x20üß†</h4><p>Based\x20on\x20the\x20‚ÄúForgetting\x20Curve,‚Äù\x20we\x20forget\x20fastest\x20right\x20after\x20learning.\x20Spaced\x20Repetition\x20prompts\x20review\x20right\x20before\x20you‚Äôre\x20about\x20to\x20forget.</p><p>Each\x20successful\x20review\x20lengthens\x20retention\x20intervals.\x20You\x20might\x20forget\x20after\x201\x20day\x20initially,\x20but\x20after\x20review,\x20you‚Äôll\x20remember\x20for\x203\x20days,\x20then\x20a\x20week,\x20a\x20month,\x20and\x20so\x20on.</p><h4>Most\x20Effective\x20Tool:\x20SRS\x20Apps\x20üì±</h4><p>Instead\x20of\x20manual\x20schedules,\x20use\x20Spaced\x20Repetition\x20Software\x20(SRS).\x20Anki\x20is\x20the\x20gold\x20standard:\x20it\x20automates\x20scheduling\x20for\x20thousands\x20of\x20cards\x20based\x20on\x20your\x20self-rated\x20difficulty,\x20ensuring\x20optimal\x20review\x20timing.</p><h4>Biggest\x20Pitfall\x20to\x20Avoid\x20‚ùå</h4><p>The\x20#1\x20cause\x20of\x20failure\x20is\x20<i>Review\x20Overload</i>‚Äîcreating\x20too\x20many\x20new\x20cards\x20daily\x20or\x20skipping\x20days,\x20leading\x20to\x20a\x20discouraging\x20backlog.</p><p><strong>Solution\x20(20%\x20effort,\x2080%\x20results):</strong>\x20Be\x20consistent.\x20Set\x20realistic\x20new-card\x20limits\x20(e.g.,\x2010‚Äì20/day)\x20and\x20review\x20daily.\x20Better\x20to\x20study\x20a\x20little\x20every\x20day\x20than\x20to\x20cram.</p><h4>Essential\x20Combo:\x20AR\x20+\x20SR</h4><p>Spaced\x20Repetition\x20(SR)\x20and\x20Active\x20Recall\x20(AR)\x20are\x20two\x20sides\x20of\x20the\x20same\x20coin.\x20SR\x20tells\x20you\x20<i>when</i>\x20to\x20review;\x20AR\x20is\x20what\x20you\x20do\x20<i>during</i>\x20the\x20review.\x20Together\x20they\x20ensure\x20your\x20recall\x20efforts\x20hit\x20memory‚Äôs\x20‚Äúsweet\x20spot.‚Äù\x20Anki\x20is\x20the\x20most\x20effective\x20way\x20to\x20implement\x20this\x20combo.</p>','classList','No\x20notes\x20to\x20summarize.','round','checked','Blink\x20ten\x20times\x20to\x20prevent\x20dry\x20eyes.','--bg-image','<div>','role','documentElement','Fullscreen','model','#btnSettings','long_end','sessionsCompleted','Escape','.subtopic-btn','exportData','soundTheme','getElementById','set_youtubeUrl','btn\x20small','div','#uploadSoundWork','Note\x20saved','note-content-wrapper','select','script','then','#ytUrlFeedback','Missing\x20element','item','toString','cyclesB','#set_winddown','.view','note-item','Error\x20calling\x20Gemini\x20API:','objectStore','<ol>','breathing','Edit','customBg','SHORT\x20BREAK','summaries','toLocaleDateString','3331088xFUdHc','574973EAPOsU','autoStartNext','achievedMilestones','Import\x20failed:\x20','fullscreenchange','light','.nav-btn[data-view=\x22','\x20min','IndexedDB\x20initialized\x20successfully.','blockReason','Splash\x20water\x20on\x20your\x20face\x20or\x20pat\x20it\x20gently.','status','mousemove','push','Delete','repeat','segmentTotal','Defaults\x20restored','https://img.youtube.com/vi/','download','textContent','Delete\x20Subtopic','timer','#settings-flowtime','catch','position','sid','A_long','#btnHelpCreateTopic','getPlayerState','var(--danger)','requestFullscreen','<span\x20class=\x22ico\x22>‚ñæ</span>','clientX','tab','task','panelOpacity','querySelectorAll','string','.method-edit','Please\x20add\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings\x20to\x20use\x20this\x20feature.','Ôºã\x20Add','connect','.actions-menu-btn','#btnFinishFlow','\x20(B)','revokeObjectURL','playVideo','_onFinishSegment','#genericTitle','Export','subtopics','tasksCompleted','onload','.\x20Please\x20try\x20again\x20with\x20different\x20content.','durations','active','file:','wind_down','\x22?\x20All\x20subtopics\x20and\x20related\x20data\x20will\x20be\x20lost.','insertUnorderedList','transaction','warn','innerWidth','#subtopicTasksList','oncomplete','restoreBackup','Delete\x20Topic','<li>','en-US'];_0x32f5=function(){return _0x4a57ff;};return _0x32f5();}function clearChat(){const _0x4eb95d=_0x1f8e33,_0x350065=getCurrentSubtopic();if(!_0x350065){toast(t('timer.selectSubtopicPrompt'));return;}showConfirmModal(_0x4eb95d(0x111),'Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20all\x20chat\x20history\x20for\x20this\x20subtopic?',async _0x5247aa=>{const _0x2b016b=_0x4eb95d;_0x5247aa&&(_0x350065[_0x2b016b(0x140)]=[],await saveData(),renderChat(),toast(_0x2b016b(0x2ce)));});}let ytPlayer,ytUserPaused=![],ytFallbackFrame=null,ytFallbackIsPlaying=![];function buildFallbackSrc(_0x3ddc31,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x4fb972=_0x1f8e33,_0x2f74a3=new URLSearchParams({'autoplay':String(autoplay),'mute':String(mute),'controls':'0','playsinline':'1','loop':'1','playlist':_0x3ddc31,'enablejsapi':'1','origin':_0x4fb972(0x2a7)})['toString']();return _0x4fb972(0xff)+_0x3ddc31+'?'+_0x2f74a3;}function ensureFallbackFrame(){const _0x35c214=_0x1f8e33,_0x2b199c=document[_0x35c214(0x176)](_0x35c214(0x281));if(!_0x2b199c)return null;if(ytFallbackFrame&&ytFallbackFrame['isConnected'])return ytFallbackFrame;const _0x4d0537=document['createElement'](_0x35c214(0x2f1));return _0x4d0537['id']=_0x35c214(0xc0),_0x4d0537[_0x35c214(0x2d2)]='1',_0x4d0537[_0x35c214(0x20a)]='1',_0x4d0537[_0x35c214(0x10e)][_0x35c214(0x1ab)]=_0x35c214(0x15e),_0x4d0537[_0x35c214(0x10e)]['top']=_0x35c214(0x25d),_0x4d0537[_0x35c214(0x10e)][_0x35c214(0x283)]=_0x35c214(0x25d),_0x4d0537[_0x35c214(0x329)]=_0x35c214(0x1ed),_0x2b199c[_0x35c214(0xa6)]='',_0x2b199c[_0x35c214(0x2cc)](_0x4d0537),ytFallbackFrame=_0x4d0537,_0x4d0537;}function fallbackLoadVideo(_0x42209b,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x517af6=_0x1f8e33,_0xed3621=document[_0x517af6(0x176)](_0x517af6(0x281));if(!_0xed3621)return;_0xed3621[_0x517af6(0xa6)]='';const _0x57517e=document[_0x517af6(0x307)](_0x517af6(0x2f1));_0x57517e['id']=_0x517af6(0xc0),_0x57517e[_0x517af6(0x2d2)]='1',_0x57517e[_0x517af6(0x20a)]='1',_0x57517e[_0x517af6(0x10e)][_0x517af6(0x1ab)]=_0x517af6(0x15e),_0x57517e['style'][_0x517af6(0x32d)]=_0x517af6(0x25d),_0x57517e[_0x517af6(0x10e)][_0x517af6(0x283)]=_0x517af6(0x25d),_0x57517e[_0x517af6(0x329)]=_0x517af6(0x1ed),_0x57517e[_0x517af6(0x244)]=buildFallbackSrc(_0x42209b,{'autoplay':autoplay,'mute':mute}),_0xed3621['appendChild'](_0x57517e),ytFallbackFrame=_0x57517e,ytFallbackIsPlaying=!!autoplay;try{const _0x1db3f6=document[_0x517af6(0x176)](_0x517af6(0x125));if(_0x1db3f6)_0x1db3f6[_0x517af6(0x1a6)]=ytFallbackIsPlaying?'‚è∏Ô∏è':'‚ñ∂Ô∏è';}catch(_0xea807c){}}function fallbackPostMessage(_0x4b9c7b,_0x26e450=[]){const _0xd83275=_0x1f8e33;try{if(!ytFallbackFrame||!ytFallbackFrame[_0xd83275(0xde)])return;ytFallbackFrame['contentWindow'][_0xd83275(0xca)](JSON[_0xd83275(0x367)]({'event':_0xd83275(0x21f),'func':_0x4b9c7b,'args':_0x26e450}),'https://www.youtube.com');}catch(_0x5ab43b){}}function fallbackPlay(){const _0x4a2b7d=_0x1f8e33;fallbackPostMessage(_0x4a2b7d(0x1c1));}function fallbackStop(){const _0x2e9be6=_0x1f8e33;try{ytFallbackFrame&&(ytFallbackFrame['src']=_0x2e9be6(0x203),ytFallbackIsPlaying=![]);}catch(_0x4d36f9){}}function fallbackPause(){fallbackStop();}function fallbackUnMute(){const _0x3f103a=_0x1f8e33;fallbackPostMessage(_0x3f103a(0x118));}function fallbackMute(){const _0x587d0e=_0x1f8e33;fallbackPostMessage(_0x587d0e(0xe0));}window[_0x1f8e33(0x27a)]=function(){const _0x52cef4=_0x1f8e33;if(IS_FILE_PROTOCOL){try{window[_0x52cef4(0x2db)]&&window['__ytApiWatchdog'][_0x52cef4(0x103)]();}catch(_0x2f8d5f){}return;}const _0x36d736={'height':'1','width':'1','playerVars':{'autoplay':0x0,'controls':0x0,'playsinline':0x1},'events':{'onReady':onPlayerReady,'onStateChange':onPlayerStateChange},'host':_0x52cef4(0x2a7)};(window[_0x52cef4(0x2d8)][_0x52cef4(0xd9)]==='http:'||window[_0x52cef4(0x2d8)][_0x52cef4(0xd9)]===_0x52cef4(0x338))&&(_0x36d736['origin']=window[_0x52cef4(0x2d8)][_0x52cef4(0x2c2)]);ytPlayer=new YT['Player'](_0x52cef4(0x281),_0x36d736);try{window['__ytApiWatchdog']&&window[_0x52cef4(0x2db)][_0x52cef4(0x103)]();const _0x5b680a=document[_0x52cef4(0x176)](_0x52cef4(0xe1));_0x5b680a&&(_0x5b680a[_0x52cef4(0x1a6)]='');}catch(_0x57b350){}};let _ytPrimed=![],_ytUnlocked=![];try{_ytUnlocked=localStorage[_0x1f8e33(0x86)](_0x1f8e33(0x2d6))==='1';}catch(_0xe1aa7c){}function showSoundPermission(){const _0x72a9e3=_0x1f8e33,_0x4a3fd6=document[_0x72a9e3(0x176)]('soundPermissionBar');if(!_0x4a3fd6)return;if(_ytUnlocked){_0x4a3fd6[_0x72a9e3(0x164)][_0x72a9e3(0xf3)]('show');return;}_0x4a3fd6[_0x72a9e3(0x164)][_0x72a9e3(0x2d4)](_0x72a9e3(0x2e8));}function hideSoundPermission(){const _0x528e00=_0x1f8e33,_0xac724d=document[_0x528e00(0x176)](_0x528e00(0x387));if(!_0xac724d)return;_0xac724d[_0x528e00(0x164)][_0x528e00(0xf3)]('show');}function unlockAudioChain(){const _0x304325=_0x1f8e33;try{if(AUDIO_CTX&&typeof AUDIO_CTX[_0x304325(0x1ef)]==='function')AUDIO_CTX[_0x304325(0x1ef)]();}catch(_0x4fef9b){}try{if(IS_FILE_PROTOCOL)fallbackUnMute(),fallbackPlay();else ytPlayer&&ytPlayer[_0x304325(0x118)]&&(ytPlayer[_0x304325(0x118)](),ytPlayer[_0x304325(0x1c1)]());}catch(_0x2c0225){}_ytUnlocked=!![];try{localStorage['setItem'](_0x304325(0x2d6),'1');}catch(_0x2db6da){}hideSoundPermission(),toast(_0x304325(0x28c));}function onPlayerReady(_0x1dd637){const _0x37ac5e=_0x1f8e33;try{const _0x56dd7f=ytPlayer&&ytPlayer['getIframe']?ytPlayer['getIframe']():null;_0x56dd7f&&_0x56dd7f[_0x37ac5e(0xc5)](_0x37ac5e(0x329),_0x37ac5e(0x1ed));}catch(_0x56b9cb){}try{if(ytPlayer&&ytPlayer[_0x37ac5e(0x24f)])ytPlayer[_0x37ac5e(0x24f)](data&&data['settings']&&data['settings'][_0x37ac5e(0x14e)]||0x50);}catch(_0x15a9b4){}try{const _0x81d9e7=getActiveVideoId&&getActiveVideoId();if(_0x81d9e7&&ytPlayer&&ytPlayer[_0x37ac5e(0xe0)]&&ytPlayer['playVideo']){ytPlayer[_0x37ac5e(0xe0)](),ytPlayer[_0x37ac5e(0x1c1)](),_ytPrimed=!![];const _0xf0b29=()=>{const _0x532d39=_0x37ac5e;if(_ytUnlocked)return;try{unlockAudioChain();}catch(_0x484164){}window[_0x532d39(0x8a)](_0x532d39(0x130),_0xf0b29,!![]),window['removeEventListener'](_0x532d39(0x261),_0xf0b29,!![]);};window['addEventListener'](_0x37ac5e(0x130),_0xf0b29,!![]),window['addEventListener']('keydown',_0xf0b29,!![]),showSoundPermission();}}catch(_0x2a9012){}updateYouTubePlayer();}function onPlayerStateChange(_0x3d7bb0){const _0x209522=_0x1f8e33,_0x47b023=$(_0x209522(0x37b));_0x3d7bb0['data']==YT[_0x209522(0xc7)]['PLAYING']?(_0x47b023['textContent']='‚è∏Ô∏è',hideSoundPermission()):_0x47b023[_0x209522(0x1a6)]='‚ñ∂Ô∏è';if(_0x3d7bb0['data']===YT['PlayerState']['ENDED']){if(!ytUserPaused)ytPlayer[_0x209522(0x1c1)]();}}async function ytFadeTo(_0x2e9a64,_0x244cb3=0xfa){const _0x29053b=_0x1f8e33;try{if(!ytPlayer||!ytPlayer[_0x29053b(0x300)]||!ytPlayer[_0x29053b(0x24f)])return;ytPlayer[_0x29053b(0x118)]();const _0x5bec2c=ytPlayer['getVolume'](),_0x28afcd=_0x2e9a64-_0x5bec2c;if(Math[_0x29053b(0x331)](_0x28afcd)<0x1||_0x244cb3<=0x0){ytPlayer['setVolume'](_0x2e9a64);return;}const _0x485fa7=performance['now']();await new Promise(_0x568888=>{const _0x32541e=_0x59178d=>{const _0x4df9ae=_0x44fa,_0x26533b=Math[_0x4df9ae(0x159)](0x1,(_0x59178d-_0x485fa7)/_0x244cb3),_0xc428e3=Math[_0x4df9ae(0x166)](_0x5bec2c+_0x28afcd*_0x26533b);ytPlayer[_0x4df9ae(0x24f)](_0xc428e3);if(_0x26533b<0x1)requestAnimationFrame(_0x32541e);else _0x568888();};requestAnimationFrame(_0x32541e);});}catch(_0x485fed){}}async function ytFadeInPlay(_0x4509d7=0xdc){const _0x5f5021=_0x1f8e33;try{const _0x3747ca=Math[_0x5f5021(0xe4)](0x0,Math[_0x5f5021(0x159)](0x64,data&&data[_0x5f5021(0x1f9)]&&data['settings'][_0x5f5021(0x14e)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;ytPlayer[_0x5f5021(0x118)](),ytPlayer[_0x5f5021(0x1c1)]();try{ytPlayer[_0x5f5021(0x24f)](0x0);}catch(_0x3fa389){}await ytFadeTo(_0x3747ca,_0x4509d7);}else{const _0x1a5e37=getActiveVideoId();_0x1a5e37&&fallbackLoadVideo(_0x1a5e37,{'autoplay':0x1,'mute':0x0});}}catch(_0x28a51e){}}async function ytFadeOutPause(_0x14b988=0xb4){const _0x477c9d=_0x1f8e33;try{const _0x2c7cda=Math[_0x477c9d(0xe4)](0x0,Math[_0x477c9d(0x159)](0x64,data&&data[_0x477c9d(0x1f9)]&&data[_0x477c9d(0x1f9)]['youtubeVolume']||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;await ytFadeTo(0x0,_0x14b988);try{ytPlayer[_0x477c9d(0x36c)](),ytPlayer[_0x477c9d(0x24f)](_0x2c7cda);}catch(_0x28c815){}}else try{fallbackPause();}catch(_0xfd157){}}catch(_0x24695b){}}async function updateYouTubePlayer(){const _0x4a2eed=_0x1f8e33,_0x4cda8d=getActiveVideoId();if(data['settings'][_0x4a2eed(0x153)]&&_0x4cda8d){const _0x5aabf3=_0x4a2eed(0x1a4)+_0x4cda8d+_0x4a2eed(0x259),_0x34a072=new Image();_0x34a072[_0x4a2eed(0x1c7)]=async()=>{const _0x96352d=_0x4a2eed;data[_0x96352d(0x1f9)]['customBg']=_0x5aabf3,await saveData(),applyCustomBg();},_0x34a072[_0x4a2eed(0x133)]=async()=>{const _0x26c842=_0x4a2eed,_0x3ad65b=_0x26c842(0x1a4)+_0x4cda8d+_0x26c842(0xe6);data['settings'][_0x26c842(0x18d)]=_0x3ad65b,await saveData(),applyCustomBg();},_0x34a072[_0x4a2eed(0x244)]=_0x5aabf3;}else!_0x4cda8d&&(data['settings'][_0x4a2eed(0x18d)]='',await saveData(),applyCustomBg());if(IS_FILE_PROTOCOL){if(!_0x4cda8d){fallbackStop(),hideSoundPermission();return;}const _0x52edb9=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x4cda8d,{'autoplay':0x1,'mute':_0x52edb9});!_ytUnlocked&&showSoundPermission();return;}if(!ytPlayer||!ytPlayer[_0x4a2eed(0x238)]){try{ensureYouTubeAPI();}catch(_0x68f120){}return;}if(!_0x4cda8d){if(ytPlayer[_0x4a2eed(0x258)])ytPlayer[_0x4a2eed(0x258)]();hideSoundPermission();return;}ytPlayer['cueVideoById'](_0x4cda8d),ytPlayer['setVolume'](data['settings']['youtubeVolume']);}function toggleYtSound(){const _0x842cef=_0x1f8e33;if(!_ytUnlocked){try{ensureAudio();}catch(_0x3577e3){}try{unlockAudioChain();}catch(_0x234263){}return;}if(IS_FILE_PROTOCOL){const _0xaf2747=getActiveVideoId();if(!ytFallbackFrame||!ytFallbackFrame[_0x842cef(0x1de)]){if(!_0xaf2747){toast(_0x842cef(0x1f2));return;}fallbackLoadVideo(_0xaf2747,{'autoplay':0x1,'mute':0x0}),ytFallbackIsPlaying=!![];try{const _0x24fd93=document[_0x842cef(0x176)](_0x842cef(0x125));if(_0x24fd93)_0x24fd93[_0x842cef(0x1a6)]='‚è∏Ô∏è';}catch(_0x485f8a){}toast(_0x842cef(0xd1));return;}if(ytFallbackIsPlaying)fallbackPostMessage(_0x842cef(0x36c)),ytFallbackIsPlaying=![],toast(_0x842cef(0xf4));else{if(!_0xaf2747){toast(_0x842cef(0x1f2));return;}fallbackPostMessage('playVideo'),ytFallbackIsPlaying=!![],toast(_0x842cef(0xd1));}try{const _0x2a8ca3=document[_0x842cef(0x176)]('btnToggleYtSound');if(_0x2a8ca3)_0x2a8ca3['textContent']=ytFallbackIsPlaying?'‚è∏Ô∏è':'‚ñ∂Ô∏è';}catch(_0x16b6da){}return;}if(!ytPlayer||typeof ytPlayer[_0x842cef(0x1af)]!==_0x842cef(0x2ca)){try{ensureYouTubeAPI();}catch(_0x20b832){}return;}const _0x4bd92e=ytPlayer[_0x842cef(0x1af)]();_0x4bd92e===YT['PlayerState']['PLAYING']||_0x4bd92e===YT['PlayerState'][_0x842cef(0x22f)]?(ytFadeOutPause(),ytUserPaused=!![],toast('Background\x20music\x20stopped.')):(ytFadeInPlay(),ytUserPaused=![],toast(_0x842cef(0xd1)));}function bindEvents(){const _0x20ccc7=_0x1f8e33;try{const _0x973ec0=document[_0x20ccc7(0x1e4)](_0x20ccc7(0x386));_0x973ec0&&(_0x973ec0['innerHTML']='Get\x20started\x20by\x20selecting\x20a\x20<strong>Subtopic</strong>\x20or\x20creating\x20a\x20Topic.');}catch(_0x11001c){}on($('#btnToggleBg'),_0x20ccc7(0x2ad),toggleBackgroundView),on($(_0x20ccc7(0x1f0)),_0x20ccc7(0x2ad),()=>{const _0x5c6b12=_0x20ccc7;$(_0x5c6b12(0x94))[_0x5c6b12(0x164)][_0x5c6b12(0xf3)](_0x5c6b12(0x2e8));try{releaseFocus();}catch(_0x4fdbf8){}}),on($(_0x20ccc7(0xbc)),_0x20ccc7(0x2ad),()=>showInputModal('New\x20Topic\x20name?',async _0x23f760=>{const _0x356d31=_0x20ccc7;if(!_0x23f760)return;data[_0x356d31(0x372)][_0x356d31(0x19f)]({'id':uid('t'),'name':_0x23f760,'subtopics':[]}),await saveData(),renderTopics();})),on($(_0x20ccc7(0x31a)),_0x20ccc7(0x2ad),()=>storageManager[_0x20ccc7(0x174)](data)),on($('#importFile'),'change',_0x3fe77e=>{const _0x104e87=_0x20ccc7,_0x4490c5=_0x3fe77e['target']['files'][0x0];if(!_0x4490c5)return;storageManager[_0x104e87(0x129)](_0x4490c5)[_0x104e87(0x17f)](async _0x5cedf5=>{const _0x5bb572=_0x104e87;data=_0x5cedf5,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),toast(_0x5bb572(0x24b)),renderAll();})[_0x104e87(0x1aa)](_0x12545e=>toast(_0x104e87(0x195)+_0x12545e['message'])),_0x3fe77e[_0x104e87(0xa4)][_0x104e87(0x278)]=null;}),on($(_0x20ccc7(0x320)),_0x20ccc7(0x2ad),()=>{const _0x24285c=_0x20ccc7,_0x5055d2=$(_0x24285c(0x2e0)),_0x2d0ad1=_0x5055d2?_0x5055d2[_0x24285c(0x278)]:'';if(!_0x2d0ad1){toast('Please\x20select\x20a\x20backup.');return;}showConfirmModal(_0x24285c(0xfd),_0x24285c(0x141)+new Date(_0x2d0ad1)[_0x24285c(0x190)]()+'?\x20Current\x20data\x20will\x20be\x20overwritten.',_0x2d568e=>{const _0xc9217a=_0x24285c;_0x2d568e&&storageManager[_0xc9217a(0x1d4)](_0x2d0ad1)[_0xc9217a(0x17f)](_0x26e3a0=>{const _0x1a6735=_0xc9217a;data=_0x26e3a0,toast(_0x1a6735(0x340)),setTimeout(()=>window[_0x1a6735(0x2d8)][_0x1a6735(0x1dd)](),0x5dc);})[_0xc9217a(0x1aa)](_0x4fbe13=>{toast('Error:\x20'+_0x4fbe13['message']);});});}),on($('#set_theme_color'),_0x20ccc7(0x2fe),_0x3e3cfb=>{const _0x3a6d92=_0x20ccc7,_0x4a4a6a=_0x3e3cfb[_0x3a6d92(0xa4)][_0x3a6d92(0x278)];applyTheme(_0x4a4a6a);if(_0x4a4a6a===_0x3a6d92(0x197)||_0x4a4a6a===_0x3a6d92(0xdf)){const _0x32b487=$(_0x3a6d92(0x279));_0x32b487&&(_0x32b487['checked']=![],toast(_0x3a6d92(0x1dc),0x7d0));try{document[_0x3a6d92(0x22c)][_0x3a6d92(0x10e)][_0x3a6d92(0x82)](_0x3a6d92(0x169),'none');}catch(_0x648321){}}else{const _0x1eebf6=$(_0x3a6d92(0x279));_0x1eebf6&&(_0x1eebf6[_0x3a6d92(0x167)]=!![]);try{updateYouTubePlayer();}catch(_0x386291){}}}),on($(_0x20ccc7(0x16f)),_0x20ccc7(0x2ad),openSettings),on($(_0x20ccc7(0x1ae)),_0x20ccc7(0x2ad),()=>{const _0xcc1948=_0x20ccc7;switchView('topics'),$('#btnAddTopic')[_0xcc1948(0x2ad)]();}),on($(_0x20ccc7(0x2f2)),_0x20ccc7(0x2ad),()=>{const _0x5d674a=_0x20ccc7;renderDashboard(),$(_0x5d674a(0x280))[_0x5d674a(0x164)][_0x5d674a(0x2d4)](_0x5d674a(0x2e8));}),on($(_0x20ccc7(0x14f)),_0x20ccc7(0x2ad),()=>{const _0x579e81=_0x20ccc7;$(_0x579e81(0x280))[_0x579e81(0x164)][_0x579e81(0xf3)](_0x579e81(0x2e8));}),on($('#btnCloseSettings'),'click',closeSettings),on($('#btnSaveSettings'),_0x20ccc7(0x2ad),saveSettings),on($(_0x20ccc7(0x91)),_0x20ccc7(0x2ad),setDefaults),on($(_0x20ccc7(0x10b)),_0x20ccc7(0x2ad),()=>{const _0x412c71=_0x20ccc7;ensureAudio(),playSound(_0x412c71(0x30d));}),on($('#btnToggleCustomSounds'),_0x20ccc7(0x2ad),_0x15f79d=>{const _0xcadc96=_0x20ccc7;_0x15f79d['preventDefault']();const _0x5c5cbe=$(_0xcadc96(0x21a));if(_0x5c5cbe)_0x5c5cbe[_0xcadc96(0x164)][_0xcadc96(0x27d)](_0xcadc96(0xcf));}),on($(_0x20ccc7(0x325)),_0x20ccc7(0x2ad),async()=>{const _0x5357b5=_0x20ccc7,_0x5d6b1d=getCurrentSubtopic();if(!_0x5d6b1d)return;const _0x3fcaf1=pendingNoteSessionId,_0x1cd600=_0x5d6b1d['sessions'][_0x5357b5(0x352)](_0xe2ff01=>_0xe2ff01['id']===_0x3fcaf1);_0x1cd600&&(_0x1cd600[_0x5357b5(0x2c1)]=$(_0x5357b5(0x1ff))[_0x5357b5(0x278)][_0x5357b5(0x26a)](),await saveData(),renderStatsHistory(),toast(_0x5357b5(0x17b))),closeNoteModal();}),on($(_0x20ccc7(0x350)),_0x20ccc7(0x2ad),()=>closeNoteModal()),on($(_0x20ccc7(0x231)),'click',addGeneralNote),on($('#btnSummarizeNote'),_0x20ccc7(0x2ad),handleSummarizeNote),on($('#btnSendMessage'),_0x20ccc7(0x2ad),handleSendMessage),on($(_0x20ccc7(0x2a4)),_0x20ccc7(0x261),_0x36ee36=>{const _0x5c9b05=_0x20ccc7;if(_0x36ee36[_0x5c9b05(0xf8)]===_0x5c9b05(0xad))handleSendMessage();}),$$(_0x20ccc7(0x2c5))[_0x20ccc7(0x2dd)](_0x89f5b7=>{on(_0x89f5b7,'click',()=>{const _0x120bcd=_0x44fa,_0x3406f6=_0x89f5b7['dataset'][_0x120bcd(0x343)];$(_0x120bcd(0x2a4))[_0x120bcd(0x278)]=_0x3406f6,$(_0x120bcd(0x2a4))['focus']();});}),on($(_0x20ccc7(0x335)),_0x20ccc7(0x2ad),clearChat),on($(_0x20ccc7(0x36f)),_0x20ccc7(0x2ad),addSubtopicTask),on($(_0x20ccc7(0x27c)),_0x20ccc7(0x261),_0xfa156=>{const _0x372734=_0x20ccc7;if(_0xfa156[_0x372734(0xf8)]===_0x372734(0xad))addSubtopicTask();}),on($(_0x20ccc7(0x37b)),_0x20ccc7(0x2ad),toggleYtSound),on($(_0x20ccc7(0x339)),_0x20ccc7(0x2ad),()=>{ensureAudio(),unlockAudioChain();}),on($(_0x20ccc7(0x220)),'input',_0x1eddf0=>{const _0x5dbf7a=_0x20ccc7,_0x5c00e4=parseInt(_0x1eddf0[_0x5dbf7a(0xa4)][_0x5dbf7a(0x278)],0xa);ytPlayer&&ytPlayer[_0x5dbf7a(0x24f)]&&ytPlayer[_0x5dbf7a(0x24f)](_0x5c00e4);}),on($(_0x20ccc7(0x2b8)),_0x20ccc7(0x2fe),handleYoutubeUrlInput),$$(_0x20ccc7(0xc6))[_0x20ccc7(0x2dd)](_0x48938f=>{const _0x24a44c=_0x20ccc7;_0x48938f[_0x24a44c(0x30e)](_0x24a44c(0x2ad),()=>{const _0xbe567c=_0x24a44c,_0x143410=_0x48938f['dataset']['view'],_0x7d2d29=data?.['settings']?.[_0xbe567c(0x37e)]||_0xbe567c(0x1a8);if(_0x7d2d29===_0x143410&&_0x143410!=='timer')switchView(_0xbe567c(0x1a8));else switchView(_0x143410);});}),$$(_0x20ccc7(0x161))['forEach'](_0x5bb33e=>{const _0x18e157=_0x20ccc7;_0x5bb33e['addEventListener'](_0x18e157(0x2ad),()=>{const _0x3197a1=_0x18e157,_0x30109f=_0x5bb33e[_0x3197a1(0xe5)][_0x3197a1(0x1b4)],_0x18730a=_0x5bb33e['closest']('.aux-panel,\x20.modal-card');if(!_0x18730a)return;_0x18730a[_0x3197a1(0x1b7)](_0x3197a1(0x161))[_0x3197a1(0x2dd)](_0x562574=>_0x562574['classList'][_0x3197a1(0xf3)](_0x3197a1(0x1ca))),_0x5bb33e[_0x3197a1(0x164)][_0x3197a1(0x2d4)](_0x3197a1(0x1ca)),_0x18730a['querySelectorAll'](_0x3197a1(0x117))[_0x3197a1(0x2dd)](_0x456eba=>{const _0x192cb3=_0x3197a1;_0x456eba['classList'][_0x192cb3(0xf3)](_0x192cb3(0x1ca)),_0x456eba[_0x192cb3(0x10e)][_0x192cb3(0xc4)]='none';});const _0x211708=_0x18730a[_0x3197a1(0x1e4)]('#'+_0x30109f);_0x211708&&(_0x211708[_0x3197a1(0x164)][_0x3197a1(0x2d4)](_0x3197a1(0x1ca)),_0x211708[_0x3197a1(0x10e)][_0x3197a1(0xc4)]='block',_0x18730a[_0x3197a1(0x336)](_0x3197a1(0x146))&&(_0x211708[_0x3197a1(0x10e)]['display']=_0x3197a1(0xfc)));});});const _0x2742c0=$('#methodEditorContentInput');function _0x344f50(_0x310e13,_0xb52641=null){const _0x408171=_0x20ccc7;try{document['execCommand'](_0x408171(0x202),![],!![]);}catch(_0x52cf7a){}try{document['execCommand'](_0x310e13,![],_0xb52641);}catch(_0x430fb4){}if(_0x2742c0)_0x2742c0['focus']();}on($(_0x20ccc7(0x24d)),_0x20ccc7(0x2ad),()=>_0x344f50(_0x20ccc7(0x303))),on($('#toolItalic'),_0x20ccc7(0x2ad),()=>_0x344f50('italic')),on($(_0x20ccc7(0xee)),'click',()=>_0x344f50(_0x20ccc7(0x25b),'<h4>')),on($('#toolList'),'click',()=>_0x344f50(_0x20ccc7(0x210))),on($(_0x20ccc7(0x105)),_0x20ccc7(0x2ad),()=>_0x344f50(_0x20ccc7(0x1ce)));const _0x13a1dc=$(_0x20ccc7(0x221)),_0x2936b1=$(_0x20ccc7(0x295));on($(_0x20ccc7(0x112)),'click',_0x43c03e=>{const _0x56107d=_0x20ccc7;if(!_0x2936b1)return;_0x43c03e['stopPropagation'](),_0x2936b1[_0x56107d(0x164)][_0x56107d(0x27d)]('hidden');}),$$(_0x20ccc7(0x2ec))[_0x20ccc7(0x2dd)](_0x3de0f8=>{on(_0x3de0f8,'click',_0x10b8fd=>{const _0x2426a9=_0x44fa;_0x10b8fd[_0x2426a9(0x288)]();const _0x129bb3=_0x3de0f8['dataset'][_0x2426a9(0x282)]||'';let _0x40ef6a=_0x129bb3;try{const _0x20433d=_0x129bb3[_0x2426a9(0x95)](/--[a-zA-Z0-9_-]+/);if(_0x20433d)_0x40ef6a=getComputedStyle(document[_0x2426a9(0x22c)])[_0x2426a9(0x2b0)](_0x20433d[0x0])[_0x2426a9(0x26a)]();}catch(_0x28c631){}_0x344f50('foreColor',_0x40ef6a);if(_0x2936b1)_0x2936b1['classList'][_0x2426a9(0x2d4)](_0x2426a9(0xcf));});}),on(document,'click',_0x55f048=>{const _0x1daf17=_0x20ccc7;if(!_0x13a1dc||!_0x2936b1)return;!_0x13a1dc['contains'](_0x55f048[_0x1daf17(0xa4)])&&!_0x2936b1[_0x1daf17(0x164)][_0x1daf17(0x136)](_0x1daf17(0xcf))&&_0x2936b1[_0x1daf17(0x164)]['add'](_0x1daf17(0xcf));});function _0x5732da(_0x3c22a9){const _0x4c4cbc=_0x20ccc7,_0x38f502=getCurrentSubtopic();if(!_0x38f502){toast(_0x4c4cbc(0x106));return;}const _0x175005=Array[_0x4c4cbc(0x2dc)](_0x38f502[_0x4c4cbc(0x1f7)])?_0x38f502[_0x4c4cbc(0x1f7)]:[],_0x1a909c=_0x3c22a9?_0x175005[_0x4c4cbc(0x352)](_0x2d5187=>_0x2d5187['id']===_0x3c22a9):null;$('#methodEditorId')[_0x4c4cbc(0x278)]=_0x1a909c&&_0x1a909c['id']||'',$(_0x4c4cbc(0x23e))[_0x4c4cbc(0x1a6)]=_0x1a909c?'Edit\x20Knowledge':_0x4c4cbc(0x1da),$(_0x4c4cbc(0x296))['value']=_0x1a909c&&_0x1a909c[_0x4c4cbc(0x2b7)]||'';const _0x526612=$(_0x4c4cbc(0x388));if(_0x526612)_0x526612['innerHTML']=_0x1a909c&&_0x1a909c[_0x4c4cbc(0x152)]||'';$('#modalMethodEditor')[_0x4c4cbc(0x164)]['add'](_0x4c4cbc(0x2e8));try{trapFocus($(_0x4c4cbc(0x2eb)));}catch(_0x2cfb0b){}try{const _0x24e062=$(_0x4c4cbc(0x2f3));if(_0x24e062){const _0x58792e=!!(data?.[_0x4c4cbc(0x1f9)]?.['apiKey']&&data[_0x4c4cbc(0x1f9)]['apiKey'][_0x4c4cbc(0x26a)]());_0x24e062[_0x4c4cbc(0x201)]=!_0x58792e,_0x24e062[_0x4c4cbc(0x2b7)]=_0x58792e?_0x4c4cbc(0x2be):_0x4c4cbc(0x1ba);}}catch(_0x3baa8a){}}on($('#btnCancelMethodEditor'),_0x20ccc7(0x2ad),()=>{const _0x3f55b7=_0x20ccc7;$(_0x3f55b7(0x2eb))[_0x3f55b7(0x164)][_0x3f55b7(0xf3)]('show');try{releaseFocus();}catch(_0x3b21f3){}}),on($(_0x20ccc7(0x2bc)),_0x20ccc7(0x2ad),async()=>{const _0x442785=_0x20ccc7,_0x2f58dc=$(_0x442785(0x2f5))[_0x442785(0x278)]||uid('m'),_0x2c1bb4=($(_0x442785(0x296))[_0x442785(0x278)]||'')[_0x442785(0x26a)](),_0x3c30fc=$('#methodEditorContentInput'),_0xdcb2ea=_0x3c30fc?_0x3c30fc['innerHTML']||'':'',_0x49caa0=getCurrentSubtopic();if(!_0x49caa0){toast(_0x442785(0x106));return;}if(!Array[_0x442785(0x2dc)](_0x49caa0[_0x442785(0x1f7)]))_0x49caa0[_0x442785(0x1f7)]=[];const _0x1db7f8=_0x49caa0[_0x442785(0x1f7)]['findIndex'](_0x37998f=>_0x37998f['id']===_0x2f58dc),_0x354e81={'id':_0x2f58dc,'title':_0x2c1bb4,'content':_0xdcb2ea};if(_0x1db7f8>=0x0)_0x49caa0[_0x442785(0x1f7)][_0x1db7f8]=_0x354e81;else _0x49caa0[_0x442785(0x1f7)][_0x442785(0x2ee)](_0x354e81);await saveData(),renderMethods(),$(_0x442785(0x2eb))['classList'][_0x442785(0xf3)](_0x442785(0x2e8));try{releaseFocus();}catch(_0x629300){}}),on($('#btnAutoFormat'),_0x20ccc7(0x2ad),async()=>{const _0x10094c=_0x20ccc7,_0x26aac1=$('#methodEditorContentInput');if(!_0x26aac1)return;const _0x2f5642=(_0x26aac1[_0x10094c(0x1a6)]||'')[_0x10094c(0x26a)]();if(!_0x2f5642||_0x2f5642[_0x10094c(0x370)]<0x14){toast('Content\x20required\x20for\x20AI\x20formatting.');return;}const _0xbe55e0=$(_0x10094c(0x2f3));_0xbe55e0&&(_0xbe55e0[_0x10094c(0x201)]=!![],_0xbe55e0['innerHTML']=_0x10094c(0x344));const _0x36fd89=_0x10094c(0x2cb)+_0x2f5642+'\x22',_0x34dd32=await callGeminiAPI(_0x36fd89);_0x34dd32?(_0x26aac1[_0x10094c(0xa6)]=_0x34dd32,toast(_0x10094c(0x375))):toast(_0x10094c(0xf0)),_0xbe55e0&&(_0xbe55e0['disabled']=![],_0xbe55e0[_0x10094c(0xa6)]=_0x10094c(0xe3));}),on($('#btnAddMethod'),'click',()=>_0x5732da());const _0x2ef842=document[_0x20ccc7(0x1e4)](_0x20ccc7(0x287));_0x2ef842&&_0x2ef842[_0x20ccc7(0x30e)]('click',_0x40d02b=>{const _0x4f9342=_0x20ccc7,_0x55f573=_0x40d02b[_0x4f9342(0xa4)][_0x4f9342(0x336)]&&_0x40d02b[_0x4f9342(0xa4)][_0x4f9342(0x336)](_0x4f9342(0x1b9)),_0x5f410a=!_0x55f573&&_0x40d02b[_0x4f9342(0xa4)]['closest']&&_0x40d02b[_0x4f9342(0xa4)][_0x4f9342(0x336)](_0x4f9342(0x217));if(_0x55f573){_0x40d02b[_0x4f9342(0x288)](),_0x40d02b[_0x4f9342(0x2d9)]();const _0x4a2a47=_0x55f573[_0x4f9342(0xe5)]['id'];if(_0x4a2a47)_0x5732da(_0x4a2a47);return;}if(_0x5f410a){_0x40d02b[_0x4f9342(0x288)](),_0x40d02b['stopPropagation']();const _0x3da24e=_0x5f410a[_0x4f9342(0xe5)]['id'];if(!_0x3da24e)return;const _0xf5515d=getCurrentSubtopic();if(!_0xf5515d){toast(_0x4f9342(0x106));return;}const _0x56fc16=Array[_0x4f9342(0x2dc)](_0xf5515d[_0x4f9342(0x1f7)])?_0xf5515d[_0x4f9342(0x1f7)]:[],_0x1ac6c0=_0x56fc16[_0x4f9342(0x352)](_0x4dfae8=>_0x4dfae8['id']===_0x3da24e);if(!_0x1ac6c0)return;showConfirmModal(_0x4f9342(0x111),'Delete\x20knowledge\x20\x22'+(_0x1ac6c0[_0x4f9342(0x2b7)]||'')+'\x22?',async _0x20e437=>{const _0xf728ba=_0x4f9342;if(!_0x20e437)return;_0xf5515d[_0xf728ba(0x1f7)]=_0x56fc16[_0xf728ba(0x2f6)](_0x11c279=>_0x11c279['id']!==_0x3da24e),await saveData(),renderMethods();});}});$$(_0x20ccc7(0x1ee))[_0x20ccc7(0x2dd)](_0x998c3f=>{const _0x3618bc=_0x20ccc7;_0x998c3f[_0x3618bc(0x30e)](_0x3618bc(0x2ad),()=>{const _0x4d7a3f=_0x3618bc;editingPreset=_0x998c3f[_0x4d7a3f(0xe5)][_0x4d7a3f(0x15f)],highlightPresetSelector(),loadEditingPresetFields();});}),$$('.presets\x20button')[_0x20ccc7(0x2dd)](_0x2b5219=>{const _0x8b9d45=_0x20ccc7;_0x2b5219['addEventListener'](_0x8b9d45(0x2ad),_0x56fba9=>{const _0x284380=_0x8b9d45,_0x48db1d=_0x56fba9[_0x284380(0xa4)][_0x284380(0xe5)]['preset'],_0xbcfa4f=data[_0x284380(0x1f9)][_0x284380(0x206)];if(_0x48db1d===_0xbcfa4f)return;timer[_0x284380(0x23b)]!==_0x284380(0x315)?showConfirmModal('Confirm\x20Switch',_0x284380(0x1d8)+_0x48db1d+_0x284380(0x110),_0x42dfda=>{const _0x1c0ec2=_0x284380;_0x42dfda&&(timer[_0x1c0ec2(0x31f)](),timer['setPreset'](_0x48db1d),renderAll(),toast(_0x1c0ec2(0x29a)+_0x48db1d+'.'));}):(timer[_0x284380(0x285)](_0x48db1d),renderAll(),toast(_0x284380(0x29a)+_0x48db1d+'.'));});}),on($(_0x20ccc7(0x2d5)),_0x20ccc7(0x2ad),()=>timer[_0x20ccc7(0x36d)]()),on($(_0x20ccc7(0x1be)),_0x20ccc7(0x2ad),()=>timer[_0x20ccc7(0x12c)]()),on($('#btnPause'),_0x20ccc7(0x2ad),()=>timer['pause']()),on($(_0x20ccc7(0x276)),_0x20ccc7(0x2ad),()=>timer[_0x20ccc7(0x1ef)]()),on($(_0x20ccc7(0x13b)),_0x20ccc7(0x2ad),()=>timer['skip']()),on($('#btnReset'),_0x20ccc7(0x2ad),()=>timer[_0x20ccc7(0x31f)]()),on($('#btnBreakEarly'),_0x20ccc7(0x2ad),()=>timer[_0x20ccc7(0x38d)]()),on($(_0x20ccc7(0x27b)),_0x20ccc7(0x330),_0x2c1d35=>{const _0x4a3cfe=_0x20ccc7;handleFileUpload(_0x2c1d35['target']['files'][0x0],async _0x19cfaa=>{data['settings']['customBg']=_0x19cfaa,await saveData(),applyCustomBg(),toast('Background\x20updated.');}),_0x2c1d35[_0x4a3cfe(0xa4)]['value']=null;}),on($('#btnClearBg'),_0x20ccc7(0x2ad),async()=>{const _0x179622=_0x20ccc7;data['settings']['customBg']='',data['settings'][_0x179622(0x153)]=![],await saveData(),applyCustomBg(),toast(_0x179622(0x2e5)),$(_0x179622(0x146))[_0x179622(0x164)][_0x179622(0x136)](_0x179622(0x2e8))&&openSettings();}),on($(_0x20ccc7(0x17a)),_0x20ccc7(0x330),_0xef840c=>{const _0x96b533=_0x20ccc7;handleFileUpload(_0xef840c[_0x96b533(0xa4)][_0x96b533(0x21b)][0x0],async _0x279e14=>{const _0x39a893=_0x96b533;data[_0x39a893(0x1f9)][_0x39a893(0x291)][_0x39a893(0x30d)]=_0x279e14,await saveData(),toast(_0x39a893(0x332));}),_0xef840c[_0x96b533(0xa4)][_0x96b533(0x278)]=null;}),on($(_0x20ccc7(0x321)),_0x20ccc7(0x330),_0x219c6f=>{const _0x20ae51=_0x20ccc7;handleFileUpload(_0x219c6f['target'][_0x20ae51(0x21b)][0x0],async _0x3df56d=>{const _0x4a1b61=_0x20ae51;data['settings'][_0x4a1b61(0x291)][_0x4a1b61(0x394)]=_0x3df56d,await saveData(),toast('Saved\x20alert\x20for\x20SHORT\x20BREAK.');}),_0x219c6f[_0x20ae51(0xa4)][_0x20ae51(0x278)]=null;}),on($('#uploadSoundLong'),'change',_0x53e342=>{const _0x4711bb=_0x20ccc7;handleFileUpload(_0x53e342[_0x4711bb(0xa4)][_0x4711bb(0x21b)][0x0],async _0x147572=>{const _0x43237d=_0x4711bb;data[_0x43237d(0x1f9)][_0x43237d(0x291)][_0x43237d(0x170)]=_0x147572,await saveData(),toast('Saved\x20alert\x20for\x20LONG\x20BREAK.');}),_0x53e342[_0x4711bb(0xa4)][_0x4711bb(0x278)]=null;}),on($(_0x20ccc7(0x2fb)),_0x20ccc7(0x2ad),toggleFullScreen),document[_0x20ccc7(0x30e)](_0x20ccc7(0x196),updateFullscreenButton),window[_0x20ccc7(0x30e)]('keydown',_0x443029=>{const _0x119091=_0x20ccc7,_0x5a3450=_0x443029[_0x119091(0xa4)],_0x555fc9=(_0x5a3450[_0x119091(0x354)]||'')[_0x119091(0x2da)](),_0x3523d2=[_0x119091(0x2fe),_0x119091(0x239),_0x119091(0x17d)][_0x119091(0x359)](_0x555fc9)||_0x5a3450[_0x119091(0x36b)];if(_0x443029[_0x119091(0x1df)]===_0x119091(0x124)&&!_0x3523d2){_0x443029[_0x119091(0x288)]();if(timer['state']===_0x119091(0x315)||timer[_0x119091(0x23b)]==='paused')timer[_0x119091(0x36d)]();else timer[_0x119091(0x30f)]();}(_0x443029[_0x119091(0xf8)]==='n'||_0x443029[_0x119091(0xf8)]==='N')&&(!_0x3523d2&&(_0x443029[_0x119091(0x288)](),timer[_0x119091(0x322)]()));if(_0x443029['key']===_0x119091(0x172)){$$('.modal')[_0x119091(0x2dd)](_0x266741=>_0x266741[_0x119091(0x164)][_0x119091(0xf3)](_0x119091(0x2e8)));try{releaseFocus();}catch(_0x58abb3){}}if(_0x443029[_0x119091(0x31d)]&&!_0x3523d2){if(_0x443029[_0x119091(0xf8)]===_0x119091(0x2b1))_0x443029[_0x119091(0x288)](),_0x47fa93(0x0,-0xa);else{if(_0x443029[_0x119091(0xf8)]==='ArrowDown')_0x443029[_0x119091(0x288)](),_0x47fa93(0x0,0xa);else{if(_0x443029['key']===_0x119091(0xfb))_0x443029['preventDefault'](),_0x47fa93(-0xa,0x0);else _0x443029[_0x119091(0xf8)]===_0x119091(0x395)&&(_0x443029[_0x119091(0x288)](),_0x47fa93(0xa,0x0));}}}}),$$(_0x20ccc7(0x274))[_0x20ccc7(0x2dd)](_0x4601fa=>_0x4601fa[_0x20ccc7(0x30e)](_0x20ccc7(0x2ad),_0x55464a=>{const _0x43ed4a=_0x20ccc7;if(_0x55464a&&_0x55464a[_0x43ed4a(0xa4)]&&_0x55464a['target']['id']===_0x43ed4a(0xdc))return;if(_0x55464a[_0x43ed4a(0xa4)]===_0x4601fa){_0x4601fa[_0x43ed4a(0x164)][_0x43ed4a(0xf3)](_0x43ed4a(0x2e8));try{releaseFocus();}catch(_0x3935c4){}}})),window[_0x20ccc7(0x30e)](_0x20ccc7(0x2ad),_0x2132d2=>{const _0x2d9b9b=_0x20ccc7;!_0x2132d2['target'][_0x2d9b9b(0x336)]('.actions-menu-btn')&&!_0x2132d2[_0x2d9b9b(0xa4)][_0x2d9b9b(0x336)]('.actions-menu')&&closeAllMenus();});try{const _0x25b927=document['querySelector'](_0x20ccc7(0x38f));if(_0x25b927)_0x25b927[_0x20ccc7(0x30e)](_0x20ccc7(0x37f),closeAllMenus);}catch(_0x10fb77){}try{window['addEventListener'](_0x20ccc7(0x37f),closeAllMenus,!![]);}catch(_0x199dd9){}window['addEventListener'](_0x20ccc7(0x14a),()=>timer['persistTimerState'](!![]));try{const _0xc0568f=Array[_0x20ccc7(0x35a)](document[_0x20ccc7(0x1b7)](_0x20ccc7(0x264)));_0xc0568f[_0x20ccc7(0x370)]&&_0xc0568f[_0x20ccc7(0x2dd)](_0x2bbce2=>{const _0x4de150=_0x20ccc7;_0x2bbce2[_0x4de150(0x30e)](_0x4de150(0x27d),()=>{const _0x36eb2a=_0x4de150;_0x2bbce2[_0x36eb2a(0x109)]&&_0xc0568f['forEach'](_0x49bcca=>{const _0x25a89c=_0x36eb2a;if(_0x49bcca!==_0x2bbce2)_0x49bcca[_0x25a89c(0x109)]=![];});});});}catch(_0x69f618){}const _0x1411f2=$(_0x20ccc7(0x271));let _0x2496d1=![],_0x4fb9db,_0x14bce3;_0x1411f2&&(_0x1411f2[_0x20ccc7(0x30e)](_0x20ccc7(0x353),_0x1ac638=>{const _0x4dc93f=_0x20ccc7;_0x2496d1=!![];const _0x324c7=_0x1411f2['getBoundingClientRect']();_0x4fb9db=_0x1ac638[_0x4dc93f(0x1b3)]-_0x324c7[_0x4dc93f(0x283)],_0x14bce3=_0x1ac638[_0x4dc93f(0x2e9)]-_0x324c7[_0x4dc93f(0x32d)],_0x1411f2[_0x4dc93f(0x10e)][_0x4dc93f(0x22a)]=_0x4dc93f(0x219);}),document[_0x20ccc7(0x30e)](_0x20ccc7(0x19e),_0x5c0a0e=>{const _0x34820e=_0x20ccc7;if(!_0x2496d1)return;let _0x12fa7f=_0x5c0a0e[_0x34820e(0x1b3)]-_0x4fb9db,_0x1d14f9=_0x5c0a0e['clientY']-_0x14bce3;const _0x4aa7b8=window[_0x34820e(0x1d1)]-_0x1411f2[_0x34820e(0x2c8)],_0x4f8a97=window[_0x34820e(0x222)]-_0x1411f2[_0x34820e(0x7f)];_0x12fa7f=Math[_0x34820e(0xe4)](0x0,Math[_0x34820e(0x159)](_0x12fa7f,_0x4aa7b8)),_0x1d14f9=Math[_0x34820e(0xe4)](0x0,Math[_0x34820e(0x159)](_0x1d14f9,_0x4f8a97)),_0x1411f2[_0x34820e(0x10e)][_0x34820e(0x283)]=_0x12fa7f+'px',_0x1411f2[_0x34820e(0x10e)][_0x34820e(0x32d)]=_0x1d14f9+'px',_0x1411f2[_0x34820e(0x10e)][_0x34820e(0x162)]=_0x34820e(0x323),_0x1411f2[_0x34820e(0x10e)]['right']=_0x34820e(0x323);}),document[_0x20ccc7(0x30e)]('mouseup',()=>{const _0x1b03f9=_0x20ccc7;if(!_0x2496d1)return;_0x2496d1=![],_0x1411f2[_0x1b03f9(0x10e)][_0x1b03f9(0x22a)]='';}));function _0x57965c(_0x38f9be){const _0x267f1f=_0x20ccc7,_0x2f6716=$(_0x267f1f(0x271));if(!_0x2f6716)return;_0x2f6716[_0x267f1f(0x10e)][_0x267f1f(0x1ab)]='fixed',_0x2f6716[_0x267f1f(0x10e)][_0x267f1f(0x22a)]='',_0x2f6716['style'][_0x267f1f(0x283)]=_0x267f1f(0x323),_0x2f6716[_0x267f1f(0x10e)][_0x267f1f(0x32d)]=_0x267f1f(0x323),_0x2f6716[_0x267f1f(0x10e)][_0x267f1f(0x93)]='auto',_0x2f6716[_0x267f1f(0x10e)][_0x267f1f(0x162)]='auto';const _0x31737e=0x10;_0x38f9be==='tl'&&(_0x2f6716[_0x267f1f(0x10e)][_0x267f1f(0x283)]=_0x31737e+'px',_0x2f6716[_0x267f1f(0x10e)][_0x267f1f(0x32d)]=_0x31737e+'px'),_0x38f9be==='tr'&&(_0x2f6716[_0x267f1f(0x10e)][_0x267f1f(0x93)]=_0x31737e+'px',_0x2f6716['style'][_0x267f1f(0x32d)]=_0x31737e+'px'),_0x38f9be==='bl'&&(_0x2f6716['style'][_0x267f1f(0x283)]=_0x31737e+'px',_0x2f6716['style'][_0x267f1f(0x162)]=_0x31737e+'px'),_0x38f9be==='br'&&(_0x2f6716[_0x267f1f(0x10e)]['right']=_0x31737e+'px',_0x2f6716[_0x267f1f(0x10e)][_0x267f1f(0x162)]=_0x31737e+'px');}function _0x47fa93(_0x331234,_0x3e2035){const _0x4f9049=_0x20ccc7,_0x29deac=$(_0x4f9049(0x271));if(!_0x29deac)return;const _0x4c169c=_0x29deac[_0x4f9049(0x24a)](),_0x136398=Math['max'](0x0,Math[_0x4f9049(0x159)](_0x4c169c['left']+_0x331234,window[_0x4f9049(0x1d1)]-_0x29deac[_0x4f9049(0x2c8)])),_0x41f60d=Math[_0x4f9049(0xe4)](0x0,Math[_0x4f9049(0x159)](_0x4c169c['top']+_0x3e2035,window[_0x4f9049(0x222)]-_0x29deac['offsetHeight']));_0x29deac[_0x4f9049(0x10e)][_0x4f9049(0x283)]=_0x136398+'px',_0x29deac['style'][_0x4f9049(0x32d)]=_0x41f60d+'px',_0x29deac[_0x4f9049(0x10e)]['right']=_0x4f9049(0x323),_0x29deac[_0x4f9049(0x10e)][_0x4f9049(0x162)]='auto';}}function toggleBackgroundView(){const _0x19c1b3=_0x1f8e33,_0xe6108b=document[_0x19c1b3(0x22c)];_0xe6108b['classList']['toggle']('bg-view-mode');const _0x6ff474=_0xe6108b[_0x19c1b3(0x164)][_0x19c1b3(0x136)]('bg-view-mode'),_0x53b440=$('#btnToggleBg');if(!_0x53b440)return;_0x6ff474?(_0x53b440['title']=_0x19c1b3(0xef),_0x53b440[_0x19c1b3(0xa6)]=_0x19c1b3(0x33a)):(_0x53b440[_0x19c1b3(0x2b7)]=_0x19c1b3(0x11b),_0x53b440[_0x19c1b3(0xa6)]='<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M2\x2012s3-7\x2010-7\x2010\x207\x2010\x207-3\x207-10\x207-10-7-10-7Z\x22/><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x223\x22/></svg>');}function updateMainViewVisibility(){const _0x484863=_0x1f8e33,_0x3cd69c=!!getCurrentSubtopic(),_0x5073c1=$(_0x484863(0x39b)),_0x3e6eba=$(_0x484863(0x120));_0x3e6eba&&_0x3e6eba['classList'][_0x484863(0x27d)](_0x484863(0xcf),_0x3cd69c),_0x5073c1&&(_0x3cd69c?_0x5073c1[_0x484863(0x164)][_0x484863(0xf3)](_0x484863(0x265)):_0x5073c1['classList'][_0x484863(0x2d4)](_0x484863(0x265)));}function updatePresetButtonsText(){const _0xdcc487=_0x1f8e33,_0xd35d26=data[_0xdcc487(0x1f9)],_0x388ba2=_0xd35d26['cyclesA'],_0xf52c09=_0xd35d26[_0xdcc487(0x184)],_0x1d0f63=_0xd35d26[_0xdcc487(0x1c9)]['A_work'],_0x1363b5=_0xd35d26['durations'][_0xdcc487(0x247)],_0x52dac7=$(_0xdcc487(0x26d)),_0x193d66=$(_0xdcc487(0x2ea)),_0x11f981=$('#btnPresetC');_0x52dac7&&(_0x52dac7[_0xdcc487(0x1a6)]=_0x388ba2+'√ó'+_0x1d0f63+'\x20(A)'),_0x193d66&&(_0x193d66['textContent']=_0xf52c09+'√ó'+_0x1363b5+_0xdcc487(0x1bf)),_0x11f981&&(_0x11f981[_0xdcc487(0x1a6)]=_0xdcc487(0x20b));}function renderAll(){const _0x5252f9=_0x1f8e33;updatePresetButtonsText();const _0x2f16d0=data[_0x5252f9(0x1f9)]['preset'];$$(_0x5252f9(0x312))[_0x5252f9(0x2dd)](_0xdff7d0=>{const _0x531c85=_0x5252f9,_0x440907=_0xdff7d0[_0x531c85(0xe5)][_0x531c85(0x206)]===_0x2f16d0;_0xdff7d0[_0x531c85(0x164)][_0x531c85(0x27d)]('acc',_0x440907),_0xdff7d0[_0x531c85(0x164)][_0x531c85(0x27d)]('ghost',!_0x440907),_0xdff7d0[_0x531c85(0xc5)]('aria-pressed',_0x440907);}),updateMainViewVisibility(),timer[_0x5252f9(0x285)](data['settings'][_0x5252f9(0x206)],{'silent':!![]}),renderTopics(),renderContextBadge(),renderStatsHistory(),renderGeneralNotes(),renderMethods(),renderChat(),applyCustomBg(),applyPanelOpacity(),renderSubtopicTasks(),updateFullscreenButton(),switchView(data['settings'][_0x5252f9(0x37e)]);}function toggleFullScreen(){const _0x23a753=_0x1f8e33;!document[_0x23a753(0x37a)]?document[_0x23a753(0x16c)][_0x23a753(0x1b1)]()[_0x23a753(0x1aa)](_0x342cc0=>{const _0xd3be3b=_0x23a753;toast(_0xd3be3b(0x234)+_0x342cc0[_0xd3be3b(0x36e)]);}):document['exitFullscreen']&&document['exitFullscreen']();}function updateFullscreenButton(){const _0x2e3d40=_0x1f8e33,_0x4dfd54=$('#btnFullscreen');document['fullscreenElement']?(_0x4dfd54[_0x2e3d40(0xa6)]='‚ÜôÔ∏è',_0x4dfd54['title']='Exit\x20fullscreen'):(_0x4dfd54['innerHTML']='‚ÜóÔ∏è',_0x4dfd54['title']=_0x2e3d40(0x16d));}async function initializeApp(){const _0x3b45a1=_0x1f8e33;try{await storageManager[_0x3b45a1(0x2d1)]();const [_0x4987e1,_0x5753fb,_0x11cd15]=await Promise[_0x3b45a1(0x2ae)]([storageManager[_0x3b45a1(0x1f3)](),storageManager[_0x3b45a1(0x23d)](_0x3b45a1(0x372)),storageManager[_0x3b45a1(0x23d)](_0x3b45a1(0x1c5))]);let _0x42c921;if(!_0x4987e1){const _0xfc83fb=JSON['parse'](JSON[_0x3b45a1(0x367)](defaults));await storageManager[_0x3b45a1(0x142)](_0xfc83fb[_0x3b45a1(0x1f9)]);for(const _0x2b2577 of _0xfc83fb[_0x3b45a1(0x372)]){const {subtopics:_0x18e7ca,..._0x20cff8}=_0x2b2577;await storageManager[_0x3b45a1(0x2d4)](_0x3b45a1(0x372),_0x20cff8);for(const _0x2a385c of _0x18e7ca){await storageManager[_0x3b45a1(0x2d4)](_0x3b45a1(0x1c5),{..._0x2a385c,'topicId':_0x2b2577['id']});}}_0x42c921=_0xfc83fb;}else{const _0x4bd11e={};for(const _0xf910f9 of _0x5753fb)_0x4bd11e[_0xf910f9['id']]={..._0xf910f9,'subtopics':[]};for(const _0x5073f0 of _0x11cd15)_0x4bd11e[_0x5073f0[_0x3b45a1(0x2c7)]]?.[_0x3b45a1(0x1c5)][_0x3b45a1(0x19f)](_0x5073f0);_0x42c921={'version':defaults[_0x3b45a1(0x398)],'settings':_0x4987e1,'topics':Object[_0x3b45a1(0x121)](_0x4bd11e)};}data=window[_0x3b45a1(0x34b)]=_0x42c921,normalizeDataStructure(data),await ensureValidSelection(),await migrateSharedMethodsToCurrentSubtopic(),await seedAchievedMilestones(),renderAll();try{storageManager['autoBackup'](data);}catch(_0x45178b){console[_0x3b45a1(0x1d0)]('AutoBackup\x20error:',_0x45178b);}bindEvents(),applyTheme();}catch(_0x5e3102){console['error']('Initialization\x20error:',_0x5e3102),toast(_0x3b45a1(0x218)+_0x5e3102['message']);}}callGeminiAPI=async function(_0x346a00,_0x450609=0x3,_0x2536ee=0x3e8){const _0x4bb74f=_0x1f8e33,_0x57ce5e=data?.[_0x4bb74f(0x1f9)]?.[_0x4bb74f(0x298)]||'';if(!_0x57ce5e)return toast(_0x4bb74f(0xb5)),null;const _0x2eea90=_0x4bb74f(0x2e2)+_0x57ce5e,_0x3c5f7d={'contents':[{'role':_0x4bb74f(0x35d),'parts':[{'text':_0x346a00}]}]};try{const _0x6b14e4=await fetch(_0x2eea90,{'method':_0x4bb74f(0x8e),'headers':{'Content-Type':'application/json'},'body':JSON['stringify'](_0x3c5f7d)});if(!_0x6b14e4['ok']){if(_0x6b14e4[_0x4bb74f(0x19d)]===0x1ad&&_0x450609>0x0)return await new Promise(_0x138eb7=>setTimeout(_0x138eb7,_0x2536ee)),callGeminiAPI(_0x346a00,_0x450609-0x1,_0x2536ee*0x2);let _0x554050=null;try{_0x554050=await _0x6b14e4[_0x4bb74f(0x9a)]();}catch(_0x4332f0){}let _0x55a568=_0x4bb74f(0x128)+_0x6b14e4[_0x4bb74f(0x19d)];if(_0x6b14e4['status']===0x190)_0x55a568=_0x4bb74f(0x30b);else{if(_0x6b14e4[_0x4bb74f(0x19d)]===0x1ad)_0x55a568=_0x4bb74f(0xbf);else _0x554050?.['error']?.[_0x4bb74f(0x36e)]&&(_0x55a568=_0x4bb74f(0x27f)+_0x554050['error']['message']);}return toast(_0x55a568,0xfa0),console['error']('Gemini\x20API\x20Error:',_0x554050||_0x6b14e4[_0x4bb74f(0x363)]),null;}const _0x4cf467=await _0x6b14e4['json']();if(_0x4cf467['candidates']&&_0x4cf467['candidates'][0x0]?.[_0x4bb74f(0x152)]?.['parts']?.[0x0]?.[_0x4bb74f(0x38a)])return formatGeminiResponse(_0x4cf467[_0x4bb74f(0x346)][0x0]['content']['parts'][0x0][_0x4bb74f(0x38a)]);else{console[_0x4bb74f(0x132)](_0x4bb74f(0x1f6),_0x4cf467);if(_0x4cf467[_0x4bb74f(0x14d)]?.[_0x4bb74f(0x19b)])return _0x4bb74f(0x313)+_0x4cf467['promptFeedback'][_0x4bb74f(0x19b)]+_0x4bb74f(0x1c8);return _0x4bb74f(0x92);}}catch(_0x2ad340){return console[_0x4bb74f(0x132)](_0x4bb74f(0x188),_0x2ad340),toast(_0x4bb74f(0x33e),0xfa0),null;}},loadLanguage(localStorage[_0x1f8e33(0x86)](_0x1f8e33(0x1ea))||'en')[_0x1f8e33(0x17f)](initializeApp);
    </script>
</body>
</html>

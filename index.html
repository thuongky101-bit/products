<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Ứng dụng Pomodoro hỗ trợ học tập với tích hợp Gemini AI và giao diện hiện đại." />
    <title>Pomodoro Study App — Tích hợp Gemini AI (Giao diện mới)</title>
    <style>
    /*
    =============================================
    POMODORO STUDY APP — PHIÊN BẢN GIAO DIỆN TẬP TRUNG (v1.0)
    =============================================
    */

    :root {
      /* Theme Dark (Mặc định) - Cập nhật từ file 2 */
      --bg: #0f1222;
      --panel: #171a2e;
      --panel-rgb: 23, 26, 46; /* Thêm biến RGB cho panel */
      --muted: #212646;
      --text: #f4f6ff;
      --sub: #b7c1ff;
      --acc: #6c8cff;
      --acc-rgb: 108, 140, 255;
      --acc-2: #27d3a2;
      --purple: #a78bfa;
      --warn: #ffb020;
      --danger: #ff5c7a;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.054), 0px 4.3px 5.3px rgba(0, 0, 0, 0.077), 0px 8.1px 10px rgba(0, 0, 0, 0.095), 0px 14.5px 17.9px rgba(0, 0, 0, 0.113), 0px 27.2px 33.4px rgba(0, 0, 0, 0.136), 0px 65px 80px rgba(0, 0, 0, 0.19);
      --radius: 16px;
      --panel-opacity: 0.85;
      --gradient-border: linear-gradient(135deg, var(--acc), var(--acc-2));
    }
    
    /* === START: THÊM CÁC THEME MỚI === */
    [data-theme='light'] {
      --bg: #f5f0e8; --panel: #ffffff; --panel-rgb: 255, 255, 255; --muted: #eaddcf; --text: #4a4a4a; --sub: #8a817c; --acc: #d4a373; --acc-rgb: 212, 163, 115; --acc-2: #a3b18a; --warn: #e76f51; --danger: #d00000;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.024), 0px 4.3px 5.3px rgba(0, 0, 0, 0.037), 0px 8.1px 10px rgba(0, 0, 0, 0.045), 0px 14.5px 17.9px rgba(0, 0, 0, 0.053), 0px 27.2px 33.4px rgba(0, 0, 0, 0.066), 0px 65px 80px rgba(0, 0, 0, 0.09);
      --panel-opacity: 0.9;
      /* Ngăn nền tối mặc định khi không có ảnh */
      --bg-image: none;
    }

    [data-theme='pastel'] {
      --bg: #fde2e4; --panel: #fff1f2; --panel-rgb: 255, 241, 242; --muted: #fad2e1; --text: #595260; --sub: #8c7a8a; --acc: #c78283; --acc-rgb: 199, 130, 131; --acc-2: #7ec4cf; --warn: #f9bf45; --danger: #d7263d;
      --shadow: 0 5px 20px rgba(200,150,150,0.2);
      --panel-opacity: 0.9;
      /* Ngăn nền tối mặc định khi không có ảnh */
      --bg-image: none;
    }
    
    [data-theme='lofi'] {
      --bg: #2a2a3e; --panel: #3c3c52; --panel-rgb: 60, 60, 82; --muted: #4d4d66; --text: #e0e0ff; --sub: #a0a0c0; --acc: #ff8c69; --acc-rgb: 255, 140, 105; --acc-2: #69c6ff; --warn: #ffd700; --danger: #ff6961;
      /* === Replaced external GIF with inline data URI (offline-safe) === */
      --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9J2cnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAlJyBzdG9wLWNvbG9yPScjMmEyYTNlJy8+PHN0b3Agb2Zmc2V0PScxMDAlJyBzdG9wLWNvbG9yPScjM2MzYzUyJy8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9JzEwMCUnIGhlaWdodD0nMTAwJScgZmlsbD0ndXJsKCNnKScvPjwvc3ZnPg==');
      --panel-opacity: 0.8;
    }
    
    [data-theme='space'] {
        --bg: #000000; --panel: #1a1a2e; --panel-rgb: 26, 26, 46; --muted: #2a2a4e; --text: #e0e0ff; --sub: #b0b0e0; --acc: #00aaff; --acc-rgb: 0, 170, 255; --acc-2: #aaff00; --warn: #ffaa00; --danger: #ff0055;
        /* === Replaced external GIF with inline data URI (offline-safe) === */
        --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9J2cnIGN4PSc1MCUnIGN5PSc0MCUnIHI9JzcwJSc+PHN0b3Agb2Zmc2V0PScwJScgc3RvcC1jb2xvcj0nIzBiMGIxYScvPjxzdG9wIG9mZnNldD0nMTAwJScgc3RvcC1jb2xvcj0nIzAwMDAwMCcvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZpbGw9J3VybCgjZyknLz48L3N2Zz4=');
        --panel-opacity: 0.75;
    }
    /* === END: THÊM CÁC THEME MỚI === */

    *:focus-visible {
      outline: 2px solid var(--acc); outline-offset: 2px; border-radius: 4px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin:0; 
      font-family: system-ui, -apple-system, 'Segoe UI Variable', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Inter', sans-serif; 
      
      background-color: var(--bg);
      background-image: var(--bg-image, radial-gradient(1200px 800px at 10% -10%, #20285b 0%, #0f1222 50%, #0b0e1a 100%));
      
      background-size: cover; 
      background-position: center; 
      color:var(--text); 
      transition: background 0.5s ease, color 0.5s ease, filter 0.5s ease;
      text-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    a{color:var(--acc)}

    .app{display:flex; min-height:100vh}
    
    .app-nav {
        width: 60px;
        padding: 16px 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
        z-index: 100;
    }
    .nav-btn {
        background: transparent;
        border: none;
        color: var(--sub);
        width: 44px;
        height: 44px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all .2s ease;
        position: relative;
    }
    .nav-btn:hover { background: var(--muted); color: var(--text); }
    .nav-btn.active { background: var(--acc); color: white; }
    .nav-btn svg { width: 24px; height: 24px; }
    .nav-btn .tooltip {
        position: absolute;
        left: 110%;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        box-shadow: var(--shadow);
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        pointer-events: none;
        z-index: 200;
    }
    .nav-btn:hover .tooltip { opacity: 1; visibility: visible; }

    .app-content {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        max-height: 100vh;
    }

    .view { display: none; }
    .view.active { display: grid; gap: 24px; animation: fadeIn .3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .main.reloading { opacity: 0; transition: opacity 0.2s ease-out; }

    .panel-bg{
        background: rgba(23, 26, 46, var(--panel-opacity));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border:1px solid rgba(255,255,255,.08);
    }
    /* Thêm các quy tắc border cho theme light/pastel */
    [data-theme='light'] .panel-bg, [data-theme='pastel'] .panel-bg { border:1px solid rgba(0,0,0,0.05); }
    [data-theme='lofi'] .panel-bg { border:1px solid rgba(255,255,255,0.1); }
    [data-theme='space'] .panel-bg { border:1px solid rgba(255,255,255,0.12); }


header.app-header{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-radius:var(--radius); box-shadow:var(--shadow); margin-bottom: 24px; position: relative; z-index: 2000;}
    header .actions{display:flex; gap:8px; align-items:center}
    
    .btn {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text);
      border: none; /* Sửa đổi: bỏ border mặc định */
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,0.08);
      font-weight: 600;
      transition: all .15s ease;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        border: 2px solid transparent; border-radius: 12px; background: var(--gradient-border) border-box;
        -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: destination-out; mask-composite: exclude; opacity: 0; transition: opacity 0.3s ease;
    }
    .btn:hover::before { opacity: 1; }
    .btn:hover { background: rgba(255, 255, 255, 0.12); }
    .btn:active { transform: translateY(1px) scale(0.98); filter: brightness(1); }
    .btn:disabled { cursor: not-allowed; filter: brightness(0.8) saturate(0.5); }
    .btn.ghost { background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); }
    .btn.ghost:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); }
    .btn.acc { background: var(--acc); color: white; }
    .btn.warn { background: var(--warn); color: white; }
    .btn.danger { background: var(--danger); color: white; }
    .btn.small { padding: 6px 10px; font-size: 14px; border-radius: 9px; }
    .btn.small::before { border-radius: 9px; }
    .btn > svg { width: 16px; height: 16px; stroke-width: 2.5px; }

    /* === START: CẬP NHẬT GIAO DIỆN QUẢN LÝ CHỦ ĐỀ === */
    #view-topics { grid-template-columns: 1fr; }
    .topic-item { background:rgba(255,255,255,.04); border:1px solid var(--muted); border-radius:12px; padding:8px; margin-bottom:8px; } /* Sửa đổi */
    .topic-header, .sub-row { display:flex; align-items:center; gap:8px; position: relative; }
    .topic-header { cursor: pointer; }
    .topic-header .topic-actions { cursor: default; }
    .topic-header .topic-actions * { cursor: pointer; }
    .topic-item { cursor: pointer; }
    .topic-item .topic-actions { cursor: default; }
    .topic-item .topic-actions * { cursor: pointer; }
    .topic-title { flex:1; font-weight:600; cursor: pointer; }
    .chev { width:28px; height:28px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; flex-shrink: 0; cursor: pointer; }
    .chev .ico { display:inline-block; transition: transform .18s ease; }
    .chev[aria-expanded="false"] .ico { transform: rotate(-90deg); }
    .subtopics { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .subtopics.hidden { display:none; }
    
    .topic-actions, .sub-row .actions {
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        display: flex;
        gap: 6px;
        align-items: center;
    }
    .topic-item:hover .topic-actions, .topic-item:focus-within .topic-actions,
    .sub-row:hover .actions, .sub-row:focus-within .actions {
      opacity: 1;
      visibility: visible;
    }
    .actions-menu-btn {
        padding: 0;
        width: 28px;
        height: 28px;
        font-size: 1.2em;
        line-height: 1;
    }
    .actions-menu {
        position: absolute;
        top: 100%;
        right: 0;
        border-radius: 8px;
        padding: 6px;
        box-shadow: var(--shadow);
        z-index: 10;
        min-width: 150px;
        display: none;
        flex-direction: column;
        gap: 4px;
    }
    /* Nâng khối đang mở menu lên trên các khối khác */
    .topic-item.menu-active { position: relative; z-index: 20; }
    
    .actions-menu.show { display: flex; }
    .menu-item {
        background: transparent; border: none; color: var(--text);
        padding: 8px 10px; border-radius: 6px; text-align: left;
        width: 100%; cursor: pointer; transition: background .2s ease;
        display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500;
    }
    .menu-item:hover { background: var(--acc); color: white; }
    .menu-item.danger:hover { background: var(--danger); }
    /* === END: CẬP NHẬT GIAO DIỆN QUẢN LÝ CHỦ ĐỀ === */

    .subtopic-btn{
        flex:1; 
        text-align:left;
        background-color: rgba(0,0,0,0.02); /* Sửa đổi */
    }
    .subtopic-btn:hover {
        background-color: transparent; /* Hover transparent to avoid blue background */
    }
    .subtopic-btn.active{
        outline:2px solid var(--acc); 
    }
    .subtopic-btn.active:hover {
        background: transparent; /* Giữ nền trong suốt khi di chuột qua */
    }
    
    .panel{border-radius:var(--radius); padding:24px; box-shadow:var(--shadow)}

    .timer-header { display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; }
    .timer{display:grid; gap:16px; grid-template-columns: 1fr; align-items:center; text-align:center}
    .big-time{font-size: clamp(60px, 12vw, 96px); letter-spacing:1px; font-weight:700; color: var(--text)}
    .state{font-weight:700; letter-spacing:.6px}
    .state.work{color:var(--acc-2)} /* Sửa đổi màu */
    .state.break{color:var(--warn)}
    .state.long{color:var(--danger)} /* Sửa đổi màu */
    .controls{display:flex; flex-wrap:wrap; gap:12px; justify-content:center}    
    #btnStart { padding: 14px 28px; font-size: 1.2em; }
    #btnPause, #btnResume { padding: 12px 24px; font-size: 1.1em; }

    /* === START: TÙY CHỈNH DẢI PHÂN CÁCH MỀM MẠI HƠN === */
    #view-timer .panel-bg hr {
        border: none; /* Bỏ đường viền mặc định */
        height: 1px;  /* Đặt chiều cao cho đường kẻ */
        background-color: var(--muted); /* Sử dụng màu phụ của theme */
        opacity: 0.3; /* Làm cho nó mờ đi, hòa vào nền */
        margin-top: 0; /* Điều chỉnh lại khoảng cách */
    }
    /* === END: TÙY CHỈNH DẢI PHÂN CÁCH MỀM MẠI HƠN === */

    .stats-grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px}
    .stat-card{background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:14px; padding:12px; text-align:center} /* Sửa đổi */
    .stat-card h4{margin:4px 0 8px; color:var(--sub); font-weight:600; font-size: 14px;}
    .stat-value{font-size: 20px; font-weight: 600;}
    .tiny{font-size:12px; color:var(--sub)}
    .history{display:grid; gap:8px; max-height:300px; overflow:auto; padding-right:6px}
    .hist-item{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:start; background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:10px; padding:10px} /* Sửa đổi */

    .row{display:flex; gap:8px; align-items:center}
    .row > * {flex:1}
    input[type="text"], input[type="password"], input[type="number"], select, textarea{width:100%; background:rgba(255,255,255,0.04); color:var(--text); border:1px solid var(--muted); border-radius:10px; padding:10px; outline:none}
    textarea{min-height:80px; resize: vertical;}

    .toasts{position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:9999}
    .toast{
        background: var(--panel); /* Sửa đổi */
        border:1px solid var(--muted);
        color:var(--text);
        padding:10px 12px; border-radius:12px; box-shadow:var(--shadow);
        animation: toast-in .3s ease; transform-origin: bottom right;
    }
    @keyframes toast-in { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,var(--panel-opacity)); z-index:10000; backdrop-filter: blur(5px);} /* Nâng z-index để nằm trên header */
    .modal.show{display:flex}
    .modal-card{
        position: relative;
        z-index: 10001;
        width:min(720px, 94vw);
        border-radius:16px;
        padding:16px;
        box-shadow:var(--shadow);
        animation: modal-in .25s ease-out;
        max-height: 90vh;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }
    body.modal-open { overflow: hidden; }
    @keyframes modal-in { from { opacity: 0; transform: scale(0.92) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .modal-card h3{margin-top:0}
    .dashboard-table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    .dashboard-table th, .dashboard-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--muted); }
    .dashboard-table th { color: var(--sub); }

    .footer-note{font-size:12px; color:var(--sub)}
    .hidden{display:none !important}

    .notes-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; padding-right: 6px; }
    .note-item { background: rgba(255,255,255,0.04); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; cursor: pointer; } /* Sửa đổi */
    .note-content-wrapper { flex: 1; min-width: 0; }
    .note-content { white-space: pre-wrap; word-break: break-word; max-height: 60px; overflow: hidden; position: relative; transition: max-height 0.35s ease-in-out; }
    .note-content:not(.expanded)::after {
        content: ''; position: absolute; bottom: 0; right: 0; width: 100%; height: 20px; background: linear-gradient(to top, var(--panel) 20%, transparent);
    }
    .note-content.expanded { max-height: 500px; }
    .note-meta { font-size: 11px; color: var(--sub); margin-top: 4px; }
    
    .spinner { border: 2px solid var(--muted); border-top-color: var(--text); border-radius: 50%; width: 16px; height: 16px; animation: spin 1s linear infinite; } /* Sửa đổi */
    @keyframes spin { to { transform: rotate(360deg); } }

    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .panel-header h3 { margin: 0; }
    .panel-header .actions { display: flex; gap: 8px; }
    
    .aux-panel { margin-top: 24px; }
    .tab-nav { display: flex; gap: 4px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 16px; }
    .tab-btn { background: transparent; border: none; color: var(--sub); padding: 8px 16px; cursor: pointer; border-bottom: 2px solid transparent; transition: all .2s ease; font-weight: 600; }
    .tab-btn:hover { color: var(--text); }
    .tab-btn.active { color: var(--acc); border-bottom-color: var(--acc); }
    .tab-content {
      display: none;
      padding-top: 8px;
    }
    .tab-content.active {
      animation: fadeIn 0.25s ease-out;
    }
    #tasks.tab-content.active,
    #notes.tab-content.active,
    #ai.tab-content.active {
        display: block;
    }

    #settings-timer.tab-content.active,
    #settings-ui.tab-content.active,
    #settings-integrations.tab-content.active {
        display: flex;
    }

    .settings-row-toggle {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
    }
    .settings-row-toggle span {
      flex: 1;
      cursor: pointer;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle-switch .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--muted);
      transition: .3s;
      border-radius: 24px;
    }
    .toggle-switch .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    .toggle-switch input:checked + .slider {
      background-color: var(--acc-2);
    }
    .toggle-switch input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    .chat-messages { max-height: 250px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; padding: 4px; }
    .chat-msg { padding: 8px 12px; border-radius: 12px; max-width: 85%; word-break: break-word; }
    .chat-msg.user { background: var(--acc); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
    .chat-msg.model { background: var(--muted); align-self: flex-start; border-bottom-left-radius: 4px; }
    .chat-input-area { display: flex; gap: 8px; }

    .methods-list { list-style: none; padding: 0; }
    .method-item { align-items: flex-start; padding: 12px; display: flex; gap: 10px; border-radius: 8px; }
    .method-item:hover { background: rgba(0,0,0,0.03); } /* Sửa đổi */
    .method-item input[type="checkbox"] { width: 18px; height: 18px; margin-top: 2px; flex-shrink: 0;}
    .method-item label { flex: 1; }
    .method-item label.completed { text-decoration: line-through; color: var(--sub); }
    .method-item .content-wrapper { flex: 1; cursor: pointer; }
    .method-item .concept { font-size: 14px; color: var(--sub); margin-top: 8px; border-left: 2px solid var(--muted); padding-left: 12px; white-space: pre-wrap; word-break: break-word; }
    /* Highlight section titles and bold text inside method content */
    .method-content h4 {
        color: var(--acc-2);
        font-size: 1.1em;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    .method-content strong {
        color: var(--acc);
        font-weight: 600;
    }
    /* Apply the same highlight to the Guide view */
    #view-guide h4 { color: var(--acc-2); }
    #view-guide strong { color: var(--acc-2); }
    /* Show hand cursor to indicate clickability */
    .method-item, .method-item summary { cursor: pointer; }
    .subtopic-todo-list { list-style: none; padding: 0; margin: 0; max-height: 100px; overflow-y: auto; text-align: left; }
    .subtopic-todo-list li { display: flex; align-items: center; gap: 8px; padding: 4px; transition: all 0.2s ease-out; }
    .subtopic-todo-list li.removing { transform: translateX(100%); opacity: 0; }
    .subtopic-todo-list label { flex: 1; }

    #youtube-player-container { position: absolute; top: -9999px; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 10px; } /* Sửa đổi */
    ::-webkit-scrollbar-thumb { background: var(--muted); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
    ::-webkit-scrollbar-thumb:hover { background: var(--sub); background-clip: content-box; }
    
    .timer-circle-container {
        position: relative; width: clamp(250px, 40vw, 320px); height: clamp(250px, 40vw, 320px); margin: 24px auto; display: flex; align-items: center; justify-content: center;
    }
    .timer-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform: rotate(-90deg); }
    .timer-circle-bg, .timer-circle-progress { fill: none; stroke-width: 8; }
    .timer-circle-bg { stroke: var(--muted); } /* Sửa đổi */
    .timer-circle-progress { stroke: var(--acc); stroke-linecap: round; transition: stroke-dashoffset 0.3s linear, stroke 0.5s ease; }
    @keyframes flash { 0%, 100% { box-shadow: 0 0 10px 2px transparent; } 50% { box-shadow: 0 0 20px 8px currentColor; } }
    .timer-circle-container.finished { color: var(--acc-2); animation: flash 1s ease-out; }
    @keyframes breathing-effect { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    .timer-circle-container.breathing { animation: breathing-effect 3s ease-in-out infinite; }
    
    
    
    @media (max-width: 1024px) {
      .app-content { padding: 20px; }
      .panel { padding: 20px; }
      .timer-circle-container { width: clamp(220px, 50vw, 300px); height: clamp(220px, 50vw, 300px); }
    }

    @media (max-width: 768px) {
      .app { flex-direction: column; }
      .app-nav { width: 100%; height: 60px; flex-direction: row; justify-content: center; border-right: none; border-top: 1px solid rgba(255,255,255,.08); order: 2; padding: 0 16px; }
      .app-content { padding: 16px; order: 1; }
      .panel { padding: 16px; }
      .modal-card .tab-nav { overflow-x: auto; }
    }

    @media (max-width: 480px) {
      .app-nav { height: 50px; }
      .nav-btn { flex: 1; }
      header.app-header { flex-direction: column; align-items: stretch; gap: 8px; }
      .btn { padding: 8px 12px; }
      .timer-circle-container { width: clamp(180px, 80vw, 220px); height: clamp(180px, 80vw, 220px); margin: 16px auto; }
      .panel { padding: 12px; }
      .app-content { padding: 12px; }
    }

    #view-timer.no-subtopic-selected > .panel-bg:not(:first-child) { display: none; }
    #view-timer.no-subtopic-selected .timer-header > .presets { display: none; }
    #view-timer.no-subtopic-selected .timer { display: none; }

    header.app-header .actions #btnFullscreen { background: transparent; border: none; box-shadow: none; }
    header.app-header .actions #btnFullscreen:hover { background: var(--muted); filter: none; }
    header.app-header .actions #btnFullscreen:hover::before { opacity: 0; }

    input[type="text"], input[type="password"], input[type="number"], select, textarea {
        background: rgba(255,255,255,0.04) !important; /* Sửa đổi: chuyển sang nền trắng trong suốt */
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.1); /* Viền trắng mờ */
        transition: background .2s ease, border-color .2s ease;
    }
    input[type="text"]:focus, input[type="password"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
        background: rgba(255,255,255,0.06) !important; /* Tinh chỉnh: sát mẫu hơn */
        border-color: var(--acc);
    }
    /* === START: SỬA LỖI NỀN INPUT/SELECT TRÊN THEME SÁNG === */
    [data-theme='light'] input, [data-theme='light'] select, [data-theme='light'] textarea,
    [data-theme='pastel'] input, [data-theme='pastel'] select, [data-theme='pastel'] textarea {
        background: rgba(0, 0, 0, 0.05) !important; /* Dùng nền đen mờ thay vì trắng mờ */
        border-color: rgba(0, 0, 0, 0.1); /* Viền đen mờ trên theme sáng */
    }

    [data-theme='light'] input:focus, [data-theme='light'] select:focus, [data-theme='light'] textarea:focus,
    [data-theme='pastel'] input:focus, [data-theme='pastel'] select:focus, [data-theme='pastel'] textarea:focus {
        background: rgba(0, 0, 0, 0.07) !important; /* Tăng độ đậm khi focus */
    }
    /* === END: SỬA LỖI NỀN INPUT/SELECT TRÊN THEME SÁNG === */

    /* Cải thiện nền và màu chữ cho option trong select theo theme hiện tại */
    select option {
        background: var(--panel);
        color: var(--text);
    }
    
    ::placeholder { color: var(--sub); opacity: 0.7; } /* Sửa đổi */
    ::-ms-input-placeholder { color: var(--sub); }
    :-ms-input-placeholder { color: var(--sub); }

    
    
    .draggable-timer {
        position: fixed;
        bottom: 20px;
        right: 20px;
        color: var(--text);
        padding: 8px 16px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        font-size: 2em;
        font-weight: 600;
        cursor: move;
        user-select: none;
        z-index: 9998;
        opacity: 0;
        transform: scale(0.9);
        pointer-events: none;
        transition: opacity 0.35s ease, transform 0.35s ease;
    }
    body.bg-view-mode .draggable-timer {
        opacity: 1;
        transform: scale(1);
        pointer-events: auto;
    }
    .app-nav, .panel-bg, .app-header .actions > *, .app-header > .row {
        transition: opacity 0.35s ease, transform 0.35s ease, background 0.35s ease, border-color 0.35s ease, box-shadow 0.35s ease;
    }
    body.bg-view-mode .app-nav,
    body.bg-view-mode .view.active > .panel-bg {
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
    }
    body.bg-view-mode .app-header {
        background: transparent !important;
        border-color: transparent !important;
        box-shadow: none !important;
    }
    body.bg-view-mode .app-header .actions > *:not(#btnToggleBg),
    body.bg-view-mode .app-header > .row {
        opacity: 0;
        pointer-events: none;
    }
    body.bg-view-mode #btnToggleBg {
        opacity: 1;
        pointer-events: auto;
    }
    .sound-permission-bar {
      position: fixed; left: 50%; transform: translateX(-50%);
      bottom: 48px; z-index: 9999;
      border-radius: 12px; padding: 10px 14px;
      display: none; align-items: center; gap: 10px;
      box-shadow: var(--shadow);
    }
    .sound-permission-bar.show { display: flex; }
    .sound-permission-bar .msg { font-size: 14px; color: var(--text); }
    .draggable-timer { text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.9); }

    /* Giảm/loại bỏ bóng chữ cho theme sáng để tránh nhòe/lóa */
    body[data-theme='light'],
    body[data-theme='pastel'] { text-shadow: none; }
    body[data-theme='light'] .draggable-timer,
    body[data-theme='pastel'] .draggable-timer { text-shadow: none; }

    /* ============================================= */
/* ========================================================= */
/* START: THI?T L?P PANEL KI?U M?  ?C (FROSTED GLASS)        */
/* ========================================================= */

/* --- 1.  p d?ng hi?u ?ng n?n m? chung cho t?t c? c c panel --- */
.app-nav,
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    background: rgba(var(--panel-rgb), var(--panel-opacity));
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* --- 2.  ?nh nghia vi?n cho t?ng lo?i panel --- */
.app-nav {
    border-right: 1px solid rgba(255, 255, 255, 0.1);
}
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* --- 3. Tinh ch?nh vi?n cho c c theme S NG (Light/Pastel) --- */
[data-theme='light'] .app-nav,
[data-theme='light'] .panel-bg,
[data-theme='light'] .modal-card,
[data-theme='light'] .actions-menu,
[data-theme='light'] .nav-btn .tooltip,
[data-theme='light'] .draggable-timer,
[data-theme='light'] .sound-permission-bar,
[data-theme='light'] .toast,
[data-theme='light'] .topic-item,
[data-theme='light'] .stat-card,
[data-theme='light'] .hist-item,
[data-theme='light'] .method-item,
[data-theme='pastel'] .app-nav,
[data-theme='pastel'] .panel-bg,
[data-theme='pastel'] .modal-card,
[data-theme='pastel'] .actions-menu,
[data-theme='pastel'] .nav-btn .tooltip,
[data-theme='pastel'] .draggable-timer,
[data-theme='pastel'] .sound-permission-bar,
[data-theme='pastel'] .toast,
[data-theme='pastel'] .topic-item,
[data-theme='pastel'] .stat-card,
[data-theme='pastel'] .hist-item,
[data-theme='pastel'] .method-item {
    border-color: rgba(0, 0, 0, 0.1);
}

/* --- 4. S?a l?i hi?u ?ng fade-out c?a ghi ch  cho ph  h?p --- */
.note-content:not(.expanded)::after {
    background: linear-gradient(to top, rgba(var(--panel-rgb), 1) 20%, transparent);
}

/* --- C c quy t?c c n l?i gi? nguy n t? file g?c --- */
[data-theme='light'] .tab-nav,
[data-theme='pastel'] .tab-nav {
    border-bottom-color: rgba(0, 0, 0, 0.1);
}
.subtopic-btn {
    background-color: transparent;
}
.subtopic-btn:hover {
    background-color: transparent; /* Hover transparent to avoid blue background */
}
.method-item[open] summary {
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
    [data-theme='light'] .method-item[open] summary,
    [data-theme='pastel'] .method-item[open] summary {
        border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    /* Editor container (single pane, Rich Text) */
    .editor-container { height: 350px; }
    .editable-content { height: 100%; border: 1px solid var(--muted); border-radius: 10px; padding: 10px; overflow-y: auto; background: var(--bg); }
    .editable-content:focus-within { border-color: var(--acc); outline: none; }
    .editable-content h4 { color: var(--acc-2); font-size: 1.1em; margin-top: 1.5em; margin-bottom: 0.5em; }
    .editable-content strong, .editable-content b { color: var(--acc); font-weight: 600; }
    .editable-content ol, .editable-content ul { padding-left: 20px; }

    /* Editor toolbar for Methods modal */
    .editor-toolbar { display: flex; gap: 6px; margin-bottom: 6px; padding: 4px; background: var(--muted); border-radius: 8px; }
    .editor-toolbar button { font-weight: bold; width: 32px; height: 32px; padding: 0; }
    .editor-toolbar .btn.ghost:hover { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.15); }
    .editor-toolbar .btn.ghost.active { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.25); }
    .color-picker-wrapper { position: relative; }
    .color-palette { position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; padding: 6px; border-radius: 8px; border: 1px solid var(--muted); background: var(--panel); box-shadow: var(--shadow); z-index: 10; }
    .color-swatch { width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255, 255, 255, 0.5); cursor: pointer; transition: transform 0.15s ease; }
    .color-swatch:hover { transform: scale(1.15); }

    /* Method actions inline with summary and show on hover */
    .method-item summary { display: flex; align-items: center; justify-content: space-between; }
    .method-item summary > span { flex: 1; }
    .method-item summary .topic-actions { margin-left: 8px; }
    .method-title { cursor: pointer; }
    .method-item:hover .topic-actions, .method-item:focus-within .topic-actions { opacity: 1; visibility: visible; }

    </style>
</head>
<body data-theme="default"> <div class="app" id="app">
    <nav class="app-nav">
        <button class="nav-btn active" id="navBtnTimer" data-view="timer" aria-label="Đồng hồ">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span class="tooltip">Đồng hồ</span>
        </button>
        <button class="nav-btn" id="navBtnTopics" data-view="topics" aria-label="Chủ đề">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
            <span class="tooltip">Chủ đề</span>
        </button>
        <button class="nav-btn" id="navBtnStats" data-view="stats" aria-label="Thống kê">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
            <span class="tooltip">Thống kê</span>
        </button>
        <button class="nav-btn" id="navBtnMethods" data-view="methods" aria-label="Kho Tri Thức">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.042 21.672L13.684 16.6s.408-1.947 1.25-3.25c.842-1.303 2.002-2.5 3.5-3.5s3.25-1.25 3.25-1.25l5.072 1.358c.27.072.358.42.128.628l-3.35 3.35a.499.499 0 0 1-.594.052l-2.07-1.486c-.44-.314-.82-.53-1.11-.665-.29-.135-.55-.22-.78-.245s-.45.045-.63.155c-.18.11-.3.29-.36.5-.06.21.02.48.18.78.16.3.385.68.665 1.11l1.486 2.07a.499.499 0 0 1-.052.594l-3.35 3.35c-.208.23-.556.142-.628-.128z"/><path d="M12 15l-3-3 3-3 3 3-3 3z"/><path d="M9.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/><path d="M5.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/></svg>
            <span class="tooltip">Kho Tri Thức</span>
        </button>
        <button class="nav-btn" id="btnSettings" style="margin-top: auto;" aria-label="Cài đặt">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            <span class="tooltip">Cài đặt</span>
        </button>
        <button class="nav-btn" id="navBtnGuide" data-view="guide" aria-label="Hướng dẫn">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            <span class="tooltip">Hướng dẫn</span>
        </button>
    </nav>

    <main class="app-content">
      <header class="app-header panel-bg">
        <div class="row" style="gap:12px; align-items:center; flex:0 1 auto">
          <strong>📚 Pomodoro Study App</strong>
          <span class="badge" id="selectedContext">Chưa chọn Chủ đề con</span>
        </div>
        <div class="actions">
          <button class="btn ghost small" id="btnDashboard" title="Dashboard Tổng quan">📊 Tổng Quan </button>
          <a href="https://forms.gle/EfFqBJFTbFtDo5H4A" target="_blank" rel="noopener noreferrer" class="btn ghost small" title="Gửi phản hồi của bạn">💬 Phản Hồi</a>
          <button class="btn ghost small" id="btnExport" title="Xuất JSON">⬇️ Xuất File</button>
          <label class="btn ghost small" for="importFile" title="Nhập JSON">⬆️ Nhập File</label>
          <input type="file" id="importFile" accept="application/json" style="display:none" />
          <button class="btn small" id="btnToggleBg" title="Ẩn/Hiện giao diện">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
          <button class="btn small" id="btnFullscreen" title="Toàn màn hình">↗️</button>
        </div>
      </header>
      

      <div id="view-timer" class="view active">
        <section class="panel panel-bg">
          <div class="timer-header">
            <div id="welcomePanel" class="hidden panel-bg" style="text-align:center; padding: 20px; border-radius: var(--radius); width: 100%;">
                <h3>Chào mừng đến với Pomodoro Study App!</h3>
                <p>Hãy bắt đầu bằng cách chọn một <strong>Chủ đề con</strong> hoặc tạo Chủ đề/Chủ đề con mới.</p>
                <button class="btn acc" id="btnHelpCreateTopic">＋ Tạo Chủ đề Mới</button>
            </div>
            <div class="presets" role="group" aria-label="Chọn chế độ preset">
                <button id="btnPresetA" class="btn small ghost" data-preset="A"></button>
                <button id="btnPresetB" class="btn small ghost" data-preset="B"></button>
                <button id="btnPresetC" class="btn small ghost" data-preset="C">🌊 Flow</button>
            </div>
          </div>
          <hr />
          <div class="timer" aria-live="polite">
            <div class="badge" id="stateBadge">TRẠNG THÁI</div>
            
            <div class="timer-circle-container">
              <svg class="timer-svg" viewBox="0 0 100 100">
                  <circle class="timer-circle-bg" cx="50" cy="50" r="45"></circle>
                  <circle class="timer-circle-progress" cx="50" cy="50" r="45"></circle>
              </svg>
              <div id="timeDisplay" class="big-time">00:00</div>
            </div>

            <div class="tiny" id="cycleInfo"></div>

            <div class="tiny" id="breakSuggestionDisplay" style="min-height: 1.5em; font-style: italic; opacity: 0.8; transition: opacity 0.3s ease;"></div>

            <div id="windDownChecklist" class="hidden" style="text-align: left; max-width: 300px; margin: 0 auto; padding: 0 10px;">
              <h4 style="margin: 8px 0 4px; color: var(--acc); text-align: center;">Checklist Hạ nhiệt</h4>
              <ul style="list-style: '✓ '; margin: 0; padding-left: 20px; color: var(--sub);">
                <li>Lưu công việc đang làm (Save/Commit).</li>
                <li>Ghi chú nhanh "Next step".</li>
                <li>Dọn dẹp không gian làm việc.</li>
              </ul>
            </div>
            
            <div class="controls">
              <button class="btn acc" id="btnStart" aria-label="Bắt đầu (Space)">▶️ Bắt đầu</button>
              <button class="btn warn hidden" id="btnFinishFlow" aria-label="Kết thúc phiên làm việc">🧘 Bắt đầu nghỉ</button>
              <button class="btn" id="btnPause" aria-label="Tạm dừng (Space)">⏸️ Tạm dừng</button>
              <button class="btn" id="btnResume" aria-label="Tiếp tục (Space)">⏵ Tiếp tục</button>
              <button class="btn warn" id="btnSkip" aria-label="Bỏ qua (N)">⏭️ Bỏ qua</button>
              <button class="btn danger" id="btnReset">↺ Đặt lại</button>
              <button class="btn acc small hidden" id="btnBreakEarly">🧘 Nghỉ sớm</button>
            </div>
            <div class="tiny">Phím tắt: <strong>Space</strong> = Bắt đầu/Tạm dừng/Tiếp tục, <strong>N</strong> = Tiếp theo/Bỏ qua</div>
          </div>
        </section>

        <section class="panel panel-bg aux-panel">
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="tasks">Nhiệm vụ</button>
                <button class="tab-btn" data-tab="notes">Ghi chú</button>
                <button class="tab-btn" data-tab="ai">Gemini AI</button>
            </nav>
            <div id="tasks" class="tab-content active">
                <h4 style="margin: 0 0 8px; color: var(--sub);">To-do cho chủ đề con này:</h4>
                <ul id="subtopicTasksList" class="subtopic-todo-list"></ul>
                <div class="row" style="gap:8px; margin-top: 8px;">
                    <input type="text" id="newSubtopicTaskInput" placeholder="Thêm một task mới..." />
                    <button id="btnAddSubtopicTask" class="btn small" style="flex: 0 1 auto;">Thêm</button>
                </div>
            </div>
            <div id="notes" class="tab-content">
                <div id="generalNotesList" class="notes-list"></div>
                <div class="add-note-area" style="margin-top: 12px;">
                    <textarea id="newGeneralNoteText" placeholder="Thêm ghi chú mới..."></textarea>
                    <div style="text-align: right; margin-top: 8px;">
                        <button class="btn acc small" id="btnAddGeneralNote">＋ Thêm ghi chú</button>
                    </div>
                </div>
            </div>
            <div id="ai" class="tab-content">
                <div class="panel-header" style="margin-bottom: 8px; padding: 0;">
                    <h4 style="margin:0;">Gemini cho: <span id="currentSubtopicNameChat">(chưa chọn)</span></h4>
                    <div class="actions">
                        <button id="btnClearChat" class="btn small danger" title="Xóa lịch sử">🗑️</button>
                    </div>
                </div>
                <div id="chatMessages" class="chat-messages"></div>
                <div id="aiPromptSuggestions" style="display: flex; gap: 6px; margin: 8px 0; flex-wrap: wrap;">
                  <button class="btn small ghost" data-prompt="Giải thích khái niệm chính của chủ đề này">Giải thích khái niệm</button>
                  <button class="btn small ghost" data-prompt="Tạo một dàn ý chi tiết cho chủ đề này">Tạo dàn ý</button>
                  <button class="btn small ghost" data-prompt="Liệt kê 5 câu hỏi ôn tập quan trọng về chủ đề này">Tạo câu hỏi ôn tập</button>
                </div>
                <div class="chat-input-area">
                  <input type="text" id="chatInput" placeholder="Hỏi Gemini điều gì đó..." />
                  <button id="btnSendMessage" class="btn acc">Gửi</button>
                </div>
            </div>
        </section>
      </div>

      <div id="view-topics" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin: 0;">Quản lý Chủ đề</h3>
                <button class="btn small acc" id="btnAddTopic" style="margin-left: auto;">＋ Thêm Chủ đề</button>
            </div>
            <div id="topicsList"></div>
            <div class="footer-note">Nhấp mũi tên để mở/đóng danh sách chủ đề con.</div>
        </div>
      </div>
      
      <div id="view-stats" class="view">
        <section class="panel panel-bg">
            <h3 style="margin:0 0 12px 0;">Thống kê & Lịch sử — <span id="currentSubtopicName">(chưa chọn)</span></h3>
            <div class="stats-grid">
              <div class="stat-card"><h4>Tổng thời gian</h4><div class="stat-value" id="statTotal">0 phút</div></div>
              <div class="stat-card"><h4>Phiên</h4><div class="stat-value" id="statSessions">0</div></div>
              <div class="stat-card"><h4>Nhiệm vụ Hoàn thành</h4><div class="stat-value" id="statTasks">0</div></div>
            </div>
            <div style="margin-top:12px">
              <h4 style="margin:4px 0 8px; color:var(--sub)">Lịch sử (LÀM VIỆC)</h4>
              <div class="history" id="historyList"></div>
            </div>
        </section>
      </div>
      
      <div id="view-methods" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin:0;">💡 Kho Tri Thức Cá Nhân Hóa</h3>
                <button class="btn small acc" id="btnAddMethod" style="margin-left: auto;">＋ Thêm tri thức</button>
            </div>
            <p class="tiny" style="margin-top: -8px; margin-bottom: 20px;">Nhấp vào từng mục để xem chi tiết.</p>
            <div class="methods-container"></div>
        </div>
      </div>

      <div id="view-guide" class="view">
          <div class="panel panel-bg">
              <h3 style="margin-top: 0;">📖 Khám Phá Pomodoro Study App</h3>
              <p>
                  Chào mừng bạn đến với không gian học tập được thiết kế dành riêng cho sự tập trung và hiệu quả. Hãy cùng khám phá những tính năng sẽ đồng hành cùng bạn trên hành trình chinh phục tri thức.
              </p>

              <h4>🚀 Khởi Đầu Nhanh Chỉ Trong 4 Bước</h4>
              <p>Để hành trình của bạn luôn mạch lạc, mọi thứ trong ứng dụng được sắp xếp theo cấu trúc <strong>Chủ đề Lớn → Chủ đề con</strong>.</p>
              <ol>
                  <li>Mở mục <strong>📚 Chủ đề</strong> từ thanh điều hướng bên cạnh.</li>
                  <li>Nhấn <strong>＋ Thêm Chủ đề</strong> để tạo một lĩnh vực lớn (ví dụ: "Tiếng Anh Giao Tiếp").</li>
                  <li>Bên cạnh chủ đề vừa tạo, nhấn <strong>＋ Thêm</strong> để tạo một chủ đề con, chi tiết hơn (ví dụ: "Bài 1: Luyện phát âm IPA").</li>
                  <li>Chọn chủ đề con đó. Giờ đây, bạn đã sẵn sàng để bắt đầu phiên học đầu tiên của mình!</li>
              </ol>

              <hr />
              <h4>✨ Những Tính Năng Đáng Chú Ý</h4>

              <h4>Các Chế Độ Đồng Hồ Linh Hoạt ⏱️</h4>
              <p>Ứng dụng không chỉ có Pomodoro. Hãy chọn phương pháp phù hợp với công việc của bạn:</p>
              <ul>
                  <li><strong>Pomodoro Cổ Điển (Kiểu A/B):</strong> Làm việc tập trung trong các phiên định sẵn (ví dụ: 25 phút làm, 5 phút nghỉ) để xây dựng kỷ luật và nhịp độ.</li>
                  <li><strong>Chế độ Flowtime (Kiểu 🌊 Flow):</strong> Dành cho công việc cần dòng chảy sâu. Đồng hồ sẽ đếm lên, cho phép bạn làm việc đến khi tự cảm thấy cần nghỉ. Thời gian nghỉ sẽ được đề xuất dựa trên thời gian bạn đã làm việc.</li>
                  <li><strong>Đệm "Hạ nhiệt" (Wind-down):</strong> Một khoảng đệm tùy chỉnh giữa lúc làm và lúc nghỉ, giúp bạn kết thúc công việc đang dở, ghi chú lại "bước tiếp theo" và chuyển trạng thái một cách mượt mà, không bị cắt ngang đột ngột.</li>
              </ul> 
              <h4>Kho Tri Thức Theo Từng Chủ Đề Con 💡</h4>
<p>
    Mỗi một <strong>Chủ đề con</strong> giờ đây sẽ có một "Kho Tri Thức" hoàn toàn riêng biệt. Tính năng này cho phép bạn xây dựng một thư viện kiến thức chuyên sâu, chỉ liên quan đến lĩnh vực bạn đang học.
</p>
<p>
    Ví dụ, các ghi chú và phương pháp học "Tiếng Anh Giao Tiếp" sẽ chỉ xuất hiện khi bạn chọn chủ đề con đó, và sẽ không bị lẫn với các công thức trong chủ đề con "Giải tích Toán học".
</p>
<p>
    Với trình soạn thảo mạnh mẽ, bạn vẫn có thể dễ dàng định dạng tiêu đề, in đậm, tạo danh sách và làm nổi bật những thông tin quan trọng nhất cho từng môn học của mình.
</p>

              <h4>Quản Lý Chủ Đề Trực Quan</h4>
              <p>Dễ dàng sắp xếp các mục tiêu học tập của bạn. Sử dụng thao tác <strong>kéo và thả</strong> để sắp xếp lại thứ tự các Chủ đề hoặc di chuyển một Chủ đề con sang một lĩnh vực khác một cách trực quan.</p>

              <h4>Nhiệm Vụ & Ghi Chú Tích Hợp 📝</h4>
              <p>Ngay trong màn hình đồng hồ, bạn có thể tạo danh sách việc cần làm (to-do) cho từng chủ đề con hoặc ghi lại những ý tưởng chợt nảy ra mà không làm gián đoạn dòng chảy công việc.</p>

              <h4>Chế Độ Zen 🧘</h4>
              <p>Khi cần tập trung tuyệt đối, hãy nhấn vào biểu tượng con mắt (👁️). Giao diện sẽ ẩn đi, chỉ để lại hình nền và chiếc đồng hồ. Trong chế độ này, bạn có thể <strong>kéo thả đồng hồ</strong> đến bất kỳ vị trí nào trên màn hình để có một không gian làm việc gọn gàng nhất.</p>

              <h4>Thống Kê & Cột Mốc 🏆</h4>
              <p>Theo dõi hành trình của bạn qua những con số biết nói. Ứng dụng sẽ tự động ghi nhận và chúc mừng khi bạn đạt được những cột mốc quan trọng về thời gian tập trung, biến mỗi nỗ lực thành một thành tựu đáng tự hào.</p>

              <hr />
              <h4>⌨️ Phím Tắt Thông Minh</h4>
              <ul>
                  <li><kbd>Space</kbd>: Bắt đầu / Tạm dừng / Tiếp tục phiên học.</li>
                  <li><kbd>N</kbd>: Bỏ qua phiên làm việc hoặc nghỉ hiện tại.</li>
                  <li><kbd>Esc</kbd>: Đóng các cửa sổ đang mở (như Cài đặt).</li>
              </ul>

              <hr />
              <h4>🛠️ Cài Đặt Nâng Cao & Tích Hợp</h4>

              <h4>Trợ Lý Gemini AI 🧠</h4>
              <p>Biến ứng dụng thành một người bạn đồng hành thông minh. Ngoài việc hỏi đáp, bạn còn có thể:</p>
              <ul>
                  <li><strong>Tự động Định dạng Thông minh:</strong> Khi soạn thảo trong mục "Phương pháp", hãy để AI tự động phân tích và định dạng văn bản thô của bạn—tự nhận diện tiêu đề, các ý chính cần in đậm và danh sách.</li>
                  <li><strong>Thiết lập:</strong> Truy cập Google AI Studio để tạo API Key miễn phí và dán vào ô "Gemini API Key" trong Cài đặt của ứng dụng.</li>
              </ul>

              <h4>Tùy Biến Giao Diện & Âm Thanh 🎨</h4>
              <p>Biến không gian học tập thành của riêng bạn:</p>
              <ul>
                  <li><strong>Nhiều Theme & Hình nền:</strong> Lựa chọn giữa các theme có sẵn (Sáng, Tối, Pastel...) hoặc <strong>tải lên hình nền của riêng bạn</strong> để tạo cảm hứng.</li>
                  <li><strong>Âm báo Tùy chỉnh:</strong> Bạn có thể <strong>tải lên các file âm thanh (.mp3, .wav...) của riêng mình</strong> để sử dụng làm chuông báo cho các phiên làm việc và nghỉ ngơi.</li>
              </ul>

              <h4>Nhạc Nền YouTube 🎶</h4>
              <p>Tạo không gian học tập hoàn hảo bằng cách phát một video hoặc danh sách phát YouTube làm nhạc nền. Dán đường dẫn (URL) vào ô "Nhạc nền YouTube" trong Cài đặt.</p>

              <h4>An Toàn Dữ Liệu: Sao Lưu & Phục Hồi 🛡️</h4>
              <p>Ứng dụng tự động sao lưu tiến trình của bạn mỗi ngày. Bạn có thể tùy chỉnh số ngày lưu giữ bản sao lưu và phục hồi dữ liệu từ một ngày trong quá khứ nếu cần. ⚠️ <strong>Cảnh báo:</strong> Phục hồi sẽ ghi đè toàn bộ dữ liệu hiện tại.</p>
          </div>
      </div>
    </main>
  </div>

  <div class="modal" id="modalMilestone" role="dialog" aria-modal="true" aria-labelledby="milestoneTitle">
    <div class="modal-card" style="width: min(600px, 94vw);">
        <h3 id="milestoneTitle">🎉 Chúc mừng Bạn!</h3>
        <p id="milestoneMessage" style="white-space: pre-wrap; line-height: 1.6;"></p>
        <div class="row" style="justify-content:flex-end; margin-top:12px">
            <button class="btn acc" id="btnMilestoneClose">Tiếp tục hành trình!</button>
        </div>
    </div>
  </div>
  <div class="modal" id="modalSettings" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="modal-card">
          <h3 id="settingsTitle">⚙️ Cài đặt</h3>
          <nav class="tab-nav">
              <button class="tab-btn active" data-tab="settings-timer">Đồng hồ</button>
              <button class="tab-btn" data-tab="settings-ui">Giao diện & Âm thanh</button>
              <button class="tab-btn" data-tab="settings-integrations">Tích hợp</button>
          </nav>
          <div class="settings-content">
              <div id="settings-timer" class="tab-content active" style="flex-direction:column; gap:20px;">
                  <div class="row" id="timerPresetSelector" style="margin-bottom:16px;">
                      <button class="btn acc" data-preset-target="A"> Kiểu A </button>
                      <button class="btn ghost" data-preset-target="B"> Kiểu B </button>
                      <button class="btn ghost" data-preset-target="C"> Kiểu C (Flow) </button>
                  </div>
                  <div id="settings-pomodoro">
                      <h4>Thời lượng Pomodoro</h4>
                      <div class="row">
                          <label>LÀM VIỆC (phút)<input type="number" id="set_work" min="1" /></label>
                          <label>HẠ NHIỆT (phút)<input type="number" id="set_winddown" min="0" /></label>
                          <label>NGHỈ NGẮN (phút)<input type="number" id="set_short" min="1" /></label>
                          <label>NGHỈ DÀI (phút)<input type="number" id="set_long" min="1" /></label>
                      </div>
                      <div class="row">
                          <label>Chu kỳ Pomodoro<input type="number" id="set_cycles" min="1" /></label>
                          <label>Chu kỳ nghỉ dài<input type="number" id="set_interval" min="2" /></label>
                      </div>
                  </div>
                  <div id="settings-flowtime" class="hidden">
                      <h4>Flowtime</h4>
                      <div class="row">
                          <label>Tỷ lệ nghỉ (Làm việc / X)
                              <input type="number" id="set_flowRatio" min="1" max="20" />
                          </label>
                      </div>
                      <p class="tiny" style="margin-top: 4px;">Gợi ý: Thời gian nghỉ = tổng thời gian làm việc / X. Mặc định là 5.</p>
                  </div>
                  <div class="settings-row-toggle">
                          <label for="set_autoStartNext">Tự động bắt đầu phiên tiếp theo</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_autoStartNext">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableWinddown">Bật Hạ nhiệt sau phiên làm</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableWinddown">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableSessionNotes">Nhắc ghi chú sau mỗi phiên</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableSessionNotes">
                              <span class="slider"></span>
                          </label>
                      </div>
              </div>
              <div id="settings-ui" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Giao diện</h4>
                      <div class="row">
                          <label>Theme Giao Diện
                                <select id="set_theme_color">
                                    <option value="default">Mặc định (Dark Blue)</option>
                                    <option value="light">Light - Trà Sữa</option>
                                    <option value="pastel">Pastel - Dễ thương</option>
                                    <option value="lofi">Lofi Study Room</option>
                                    <option value="space">Space Station</option>
                                </select>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 12px;">
                          <label>Chế độ hiển thị nền
                              <select id="set_backgroundMode">
                                  <option value="cover">Lấp đầy (Mặc định)</option>
                                  <option value="contain">Vừa vặn (Sắc nét)</option>
                                  <option value="auto">Kích thước gốc (Lặp lại)</option>
                              </select>
                          </label>
                      </div>
                      <div class="row">
                          <label>Hình nền
                              <label class="btn small ghost" for="uploadBg">Tải ảnh mới</label>
                              <input type="file" id="uploadBg" accept="image/*" class="hidden" />
                          </label>
                          <button class="btn small danger" id="btnClearBg">Xóa nền</button>
                      </div>
                      <div class="row">
                          <label style="flex: 1;">Độ trong suốt của nền</label>
                          <input type="range" id="set_panelOpacity" min="0.1" max="1" step="0.05" style="flex: 2;">
                      </div>
                      
                      
                   </div>
                  
                   <div>
                      <h4>Âm thanh</h4>
                      <div class="row">
                          <label>Âm lượng (0–1)<input type="number" id="set_volume" step="0.05" min="0" max="1"/></label>
                          <label>Kiểu âm báo
                              <select id="set_theme">
                                  <option value="beep">Beep</option>
                                  <option value="chime">Chime</option>
                              </select>
                          </label>
                           <button class="btn" id="btnTestSound" style="flex: 0 1 auto; align-self: center;">Test</button>
                      </div>
                      <div style="text-align: right; margin-top: 12px;">
                          <button class="btn ghost small" id="btnToggleCustomSounds">Tùy chỉnh âm báo</button>
                      </div>

                      <div id="customSoundsContainer" class="hidden" style="margin-top: 8px;">
                      <div class="row" style="display: flex; gap: 8px; justify-content: flex-end;">
                          <div>
                              <small>Âm báo hết LÀM VIỆC</small>
                              <label title="Âm báo hết LÀM VIỆC" class="btn small ghost" for="uploadSoundWork">LÀM VIỆC</label>
                              <input type="file" id="uploadSoundWork" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Âm báo hết NGHỈ NGẮN</small>
                              <label title="Âm báo hết NGHỈ NGẮN" class="btn small ghost" for="uploadSoundBreak">NGHỈ NGẮN</label>
                              <input type="file" id="uploadSoundBreak" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Âm báo hết NGHỈ DÀI</small>
                              <label title="Âm báo hết NGHỈ DÀI" class="btn small ghost" for="uploadSoundLong">NGHỈ DÀI</label>
                              <input type="file" id="uploadSoundLong" accept="audio/*" class="hidden" />
                          </div>
                      </div>
                      </div>
                      
                  </div>
              </div>
              <div id="settings-integrations" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Tích hợp AI</h4>
                      <label>Gemini API Key
                          <input type="password" id="set_apiKey" placeholder="Dán API Key của bạn vào đây..." />
                      </label>
                      <div class="tiny">Cần có để sử dụng các tính năng AI. Lấy key miễn phí tại <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a>.</div>
                  </div>
                  <div>
                      <h4>🎵 Nhạc nền YouTube</h4>
                      <div class="row" style="gap:8px; align-items:center;">
                          <input type="text" id="set_youtubeUrl" placeholder="Dán link YouTube vào đây..." style="flex:1;">
                          </div>
                      <div id="ytUrlFeedback" class="tiny" style="min-height: 1.2em; padding: 4px 0;"></div>
                      <div class="row" style="margin-top: 4px;">
                          <label style="flex: 0 1 auto; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                              <input type="checkbox" id="set_ytThumbAsBg">
                              <span>Dùng ảnh bìa video làm nền</span>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 8px;">
                          <button id="btnToggleYtSound" class="btn small" style="flex:0 1 auto;" title="Dừng sẽ không tự phát lại cho đến khi bạn bấm ▶️">▶️</button>
                          <input type="range" id="ytSoundVolume" min="0" max="100" step="1" value="80" style="flex:1;">
                      </div>
                      <div class="tiny" style="text-align:center; margin-top:4px;">Âm lượng</div>
                  </div>
                  <div>
                      <h4>🛡️ Cài đặt sao lưu</h4>
                      <div class="row">
                          <label>Số ngày sao lưu cần giữ lại
                               <input type="number" id="set_backupDays" min="1" max="30" />
                          </label>
                      </div>
                  </div>
                  <div>
                      <h4>🛡️ Phục hồi dữ liệu</h4>
                      <p class="tiny">Phục hồi dữ liệu từ một bản sao lưu tự động hàng ngày. Hành động này sẽ ghi đè lên dữ liệu hiện tại của bạn.</p>
                      <div class="row">
                          <select id="backupList" style="flex: 3;"></select>
                          <button id="btnRestoreBackup" class="btn warn small" style="flex: 1;">Phục hồi</button>
                      </div>
                  </div>
              </div>
          </div>
          <div class="row" style="margin-top:16px; justify-content:flex-end">
              <button class="btn ghost" id="btnDefaults">Mặc định</button>
              <button class="btn acc" id="btnSaveSettings">Lưu</button>
              <button class="btn" id="btnCloseSettings">Đóng</button>
          </div>
      </div>
  </div>

  <div class="modal" id="modalNote" role="dialog" aria-modal="true" aria-labelledby="noteTitle">
    <div class="modal-card">
      <h3 id="noteTitle">📝 Ghi chú cho phiên vừa hoàn thành</h3>
      <div class="row"><textarea id="noteText" placeholder="Bạn học được gì? Khó khăn? Next steps?"></textarea></div>
      <div class="row" style="justify-content:flex-end; margin-top:8px; gap: 12px;">
        <button class="btn" id="btnSummarizeNote">✨ Tóm tắt & Gợi ý</button>
        <button class="btn" id="btnSkipNote">Bỏ qua</button>
        <button class="btn acc" id="btnSaveNote">Lưu ghi chú</button>
      </div>
    </div>
  </div>

  <div class="modal" id="modalGeneric" role="dialog" aria-modal="true" aria-labelledby="genericTitle">
      <div class="modal-card" style="width: min(450px, 94vw);">
          <h3 id="genericTitle">Tiêu đề</h3>
          <p id="genericMessage" class="hidden"></p>
          <input type="text" id="genericInput" class="hidden" />
          <div class="row" style="justify-content:flex-end; margin-top:12px">
              <button class="btn" id="btnGenericCancel">Hủy</button>
              <button class="btn acc" id="btnGenericOk">OK</button>
          </div>
      </div>
  </div>
  
  <div class="modal" id="modalDashboard" role="dialog" aria-modal="true" aria-labelledby="dashboardTitle">
    <div class="modal-card" style="width: min(800px, 95vw);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h3 id="dashboardTitle">📊 Tổng quan</h3>
            <button class="btn ghost small" id="btnCloseDashboard">Đóng</button>
        </div>
        <p class="tiny">Tổng hợp thời gian và số phiên đã hoàn thành trên tất cả các chủ đề.</p>
        <div id="dashboardContent" style="max-height: 60vh; overflow-y: auto;"></div>
    </div>
  </div>

  <div class="modal" id="modalMethodEditor" role="dialog" aria-modal="true">
    <div class="modal-card" style="width: min(800px, 95vw);">
      <h3 id="methodEditorTitle">Chỉnh-sửa Phương-pháp</h3>
      
      <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
        <input type="hidden" id="methodEditorId">
        <label>Tiêu-đề<input type="text" id="methodEditorTitleInput"></label>
        
        <label>Nội-dung</label>
        <div class="editor-toolbar">
          <button id="toolH4" class="btn small ghost" title="Tiêu-đề nhỏ">H</button>
          <button id="toolBold" class="btn small ghost" title="In đậm">B</button>
          <button id="toolItalic" class="btn small ghost" title="In nghiêng">I</button>
          <button id="toolList" class="btn small ghost" title="Danh-sách">1.</button>
          <button id="toolBullet" class="btn small ghost" title="Danh sách chấm tròn">•</button>

          <div class="color-picker-wrapper">
            <button id="toolColor" class="btn small ghost" title="Màu chữ">A</button>
            <div class="color-palette hidden">
              <button class="color-swatch" style="background-color: var(--text);" data-color="var(--text)" title="Màu chữ mặc định"></button>
              <button class="color-swatch" style="background-color: var(--acc);" data-color="var(--acc)" title="Màu nhấn mạnh"></button>
              <button class="color-swatch" style="background-color: var(--acc-2);" data-color="var(--acc-2)" title="Màu tích cực"></button>
              <button class="color-swatch" style="background-color: var(--warn);" data-color="var(--warn)" title="Màu cảnh báo"></button>
              <button class="color-swatch" style="background-color: var(--danger);" data-color="var(--danger)" title="Màu nguy hiểm"></button>
              <button class="color-swatch" style="background-color: var(--purple);" data-color="var(--purple)" title="Màu tím"></button>
            </div>
          </div>
        </div>

        <div class="editor-container">
            <div id="methodEditorContentInput" class="editable-content" contenteditable="true"></div>
        </div>

      </div>

      <div class="row" style="justify-content:space-between; margin-top:16px">
        <button id="btnAutoFormat" class="btn small" disabled title="Tính năng này yêu cầu Gemini API Key">✨ Tự động định dạng</button>
        <div>
          <button class="btn" id="btnCancelMethodEditor">Hủy</button>
          <button class="btn acc" id="btnSaveMethod">Lưu</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toasts" id="toasts"></div>
  <audio id="audioWorkEnd"></audio>
  <audio id="audioBreakEnd"></audio>
  <audio id="audioLongEnd"></audio>
  <div id="youtube-player-container"></div>

  <div id="draggableTimer" class="draggable-timer">00:00</div>

  <div id="soundPermissionBar" class="sound-permission-bar" role="alert" aria-live="polite">
    <span class="msg">Nhấn "Bật âm thanh" để cho phép phát nhạc nền.</span>
    <button id="btnEnableSound" class="btn small acc">Bật âm thanh</button>
  </div>
<!-- YouTube Iframe API is loaded dynamically when needed -->
<!-- === START: Inline Minimal Sortable (Offline-Safe) === -->
<script>
// Minimal Sortable shim for offline single-file usage.
// Supports: draggable selector, cross-list via same group, onEnd callback.
(function(){
  if (window.Sortable) return; // Respect existing if loaded
  const DND = { src: null, from: null, selector: null, group: null };
  function makeDraggable(container, selector){
    Array.from(container.querySelectorAll(selector)).forEach(el => {
      try { el.setAttribute('draggable','true'); } catch(_) {}
    });
  }
  function closestItem(e, selector){
    const t = e.target && e.target.closest ? e.target.closest(selector) : null;
    return t || null;
  }
  function Sortable(container, opts){
    this.el = container;
    this.options = opts || {};
    const selector = this.options.draggable || '*';
    const group = this.options.group || null;
    makeDraggable(container, selector);
    const handleDragStart = (e) => {
      const item = closestItem(e, selector);
      if (!item) return;
      DND.src = item; DND.from = container; DND.selector = selector; DND.group = group;
      e.dataTransfer.effectAllowed = 'move';
      try { e.dataTransfer.setData('text/plain', ''); } catch(_) {}
    };
    const handleDragOver = (e) => {
      if (!DND.src) return;
      // Only allow drop if same selector and group matches (or no group)
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
    };
    const handleDrop = (e) => {
      if (!DND.src) return;
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
      const from = DND.from;
      const to = container;
      const children = Array.from(from.querySelectorAll(DND.selector));
      const oldIndex = children.indexOf(DND.src);
      if (target && DND.src && target !== DND.src) {
        to.insertBefore(DND.src, target);
      }
      const newChildren = Array.from(to.querySelectorAll(DND.selector));
      const newIndex = newChildren.indexOf(DND.src);
      if (typeof this.options.onEnd === 'function') {
        try { this.options.onEnd({ oldIndex, newIndex, from, to, item: DND.src }); } catch(_) {}
      }
      DND.src = null; DND.from = null; DND.selector = null; DND.group = null;
    };
    this._listeners = { handleDragStart, handleDragOver, handleDrop };
    container.addEventListener('dragstart', handleDragStart);
    container.addEventListener('dragover', handleDragOver);
    container.addEventListener('drop', handleDrop);
    this.destroy = () => {
      container.removeEventListener('dragstart', handleDragStart);
      container.removeEventListener('dragover', handleDragOver);
      container.removeEventListener('drop', handleDrop);
    };
  }
  window.Sortable = Sortable;
})();
</script>
<!-- === END: Inline Minimal Sortable === -->
  <script>
   const _0x36046b=_0x365d;(function(_0x10e1fd,_0x68f8a6){const _0x263d5f=_0x365d,_0x11d4b2=_0x10e1fd();while(!![]){try{const _0x2cd99c=-parseInt(_0x263d5f(0x368))/0x1*(parseInt(_0x263d5f(0x2ee))/0x2)+parseInt(_0x263d5f(0x2ad))/0x3+parseInt(_0x263d5f(0x275))/0x4*(-parseInt(_0x263d5f(0x34f))/0x5)+parseInt(_0x263d5f(0x23c))/0x6*(-parseInt(_0x263d5f(0x1f2))/0x7)+-parseInt(_0x263d5f(0x448))/0x8+-parseInt(_0x263d5f(0x353))/0x9*(parseInt(_0x263d5f(0x1e6))/0xa)+parseInt(_0x263d5f(0x2ac))/0xb*(parseInt(_0x263d5f(0x4a2))/0xc);if(_0x2cd99c===_0x68f8a6)break;else _0x11d4b2['push'](_0x11d4b2['shift']());}catch(_0x5e1db3){_0x11d4b2['push'](_0x11d4b2['shift']());}}}(_0x5cd2,0x617fa),window['addEventListener'](_0x36046b(0x40a),()=>{try{updateFullscreenButton();}catch(_0x86e155){}}));const IS_FILE_PROTOCOL=window['location'][_0x36046b(0x444)]===_0x36046b(0x1d5);function startYtApiWatchdog(){const _0xeee0d9=_0x36046b,_0x214e0b=document[_0xeee0d9(0x2ab)](_0xeee0d9(0x3eb));if(!_0x214e0b)return;const _0x4a79c7=setTimeout(()=>{const _0x1b9535=_0xeee0d9;try{(!window['YT']||!window['YT'][_0x1b9535(0x366)])&&(_0x214e0b['textContent']=_0x1b9535(0x35b),_0x214e0b[_0x1b9535(0x335)][_0x1b9535(0x27a)]=_0x1b9535(0x1f8));}catch(_0x2a574c){}},0x5dc),_0x15d0b9=setTimeout(()=>{const _0x549a82=_0xeee0d9;try{(!window['YT']||!window['YT'][_0x549a82(0x366)])&&(_0x214e0b['textContent']='Failed\x20to\x20load\x20the\x20YouTube\x20API.\x20Check\x20your\x20network\x20or\x20reload\x20the\x20page.',_0x214e0b[_0x549a82(0x335)][_0x549a82(0x27a)]=_0x549a82(0x4e1));}catch(_0x24370c){}},0x1b58);window[_0xeee0d9(0x495)]={'cancel'(){clearTimeout(_0x4a79c7),clearTimeout(_0x15d0b9);}};}(function(){const _0xf9d59=_0x36046b,_0x148602={'timer.cycleInfo':({current:current=0x0,target:target=0x0}={})=>_0xf9d59(0x4ea)+current+'/'+target,'timer.selectSubtopicPrompt':_0xf9d59(0x461)};window['t']=function _0x12f8f5(_0x53ff52,_0x49c720){const _0xe13e6a=_0xf9d59;try{const _0x173ee2=_0x148602[_0x53ff52];if(typeof _0x173ee2===_0xe13e6a(0x3d5))return _0x173ee2(_0x49c720||{});if(typeof _0x173ee2==='string')return _0x173ee2;}catch(_0x2e2f4b){}return _0x53ff52;},window['loadLanguage']=function _0x44f091(_0x51e320){const _0x5041ac=_0xf9d59;try{localStorage['setItem'](_0x5041ac(0x49e),_0x51e320||'en');}catch(_0x5c4125){}return Promise[_0x5041ac(0x39e)]();};}());function ensureYouTubeAPI(){const _0x4b0724=_0x36046b;if(IS_FILE_PROTOCOL)return Promise[_0x4b0724(0x39e)](![]);try{if(window['YT']&&window['YT'][_0x4b0724(0x366)])return Promise[_0x4b0724(0x39e)](!![]);}catch(_0x4abe98){}if(window[_0x4b0724(0x450)])return window['__ytApiPromise'];return startYtApiWatchdog(),window[_0x4b0724(0x450)]=new Promise((_0x366f52,_0x535454)=>{const _0x209486=_0x4b0724;try{const _0x1a3c9c=document[_0x209486(0x1da)](_0x209486(0x28d));_0x1a3c9c[_0x209486(0x26c)]=_0x209486(0x466),_0x1a3c9c['async']=!![],_0x1a3c9c['defer']=!![],_0x1a3c9c[_0x209486(0x2c7)]=()=>_0x366f52(!![]),_0x1a3c9c[_0x209486(0x3cb)]=()=>_0x535454(new Error(_0x209486(0x261))),document[_0x209486(0x1e2)][_0x209486(0x406)](_0x1a3c9c);}catch(_0x529446){_0x535454(_0x529446);}}),window['__ytApiPromise'];}const storageManager={'DB_NAME':_0x36046b(0x230),'DB_VERSION':0x1,'db':null,async 'initDB'(){return new Promise((_0x182246,_0x284797)=>{const _0x164228=_0x365d;if(this['db'])return _0x182246(this['db']);const _0x4030ef=indexedDB[_0x164228(0x30d)](this['DB_NAME'],this[_0x164228(0x4b5)]);_0x4030ef[_0x164228(0x330)]=_0x199f84=>{const _0x3d83f5=_0x164228,_0x6d2276=_0x199f84[_0x3d83f5(0x2e7)][_0x3d83f5(0x4c6)];!_0x6d2276[_0x3d83f5(0x48e)][_0x3d83f5(0x2ec)](_0x3d83f5(0x476))&&_0x6d2276[_0x3d83f5(0x243)](_0x3d83f5(0x476));!_0x6d2276[_0x3d83f5(0x48e)][_0x3d83f5(0x2ec)](_0x3d83f5(0x20a))&&_0x6d2276[_0x3d83f5(0x243)](_0x3d83f5(0x20a),{'keyPath':'id'});if(!_0x6d2276[_0x3d83f5(0x48e)]['contains'](_0x3d83f5(0x25c))){const _0x7122f=_0x6d2276[_0x3d83f5(0x243)](_0x3d83f5(0x25c),{'keyPath':'id'});_0x7122f[_0x3d83f5(0x4cf)](_0x3d83f5(0x344),'topicId');}!_0x6d2276[_0x3d83f5(0x48e)][_0x3d83f5(0x2ec)]('backups')&&_0x6d2276[_0x3d83f5(0x243)](_0x3d83f5(0x2e3),{'keyPath':_0x3d83f5(0x270)});},_0x4030ef['onsuccess']=_0xf02ea5=>{const _0x2c2ef4=_0x164228;this['db']=_0xf02ea5[_0x2c2ef4(0x2e7)]['result'],console[_0x2c2ef4(0x32c)](_0x2c2ef4(0x442)),_0x182246(this['db']);},_0x4030ef[_0x164228(0x3cb)]=_0x10225e=>{const _0x4d8937=_0x164228;console[_0x4d8937(0x4ad)](_0x4d8937(0x31f),_0x10225e[_0x4d8937(0x2e7)]['errorCode']),_0x284797(_0x10225e['target'][_0x4d8937(0x4ad)]);};});},async '_getStore'(_0x10d2a3,_0x343255='readonly'){const _0x38c65a=_0x36046b;await this[_0x38c65a(0x1ec)]();const _0x4d68fb=this['db'][_0x38c65a(0x3ec)]([_0x10d2a3],_0x343255);return _0x4d68fb[_0x38c65a(0x48b)](_0x10d2a3);},async 'getSettings'(){const _0x59e920=await this['_getStore']('settings');return new Promise((_0x3f2e4a,_0x29c08b)=>{const _0x425149=_0x365d,_0x2806c7=_0x59e920[_0x425149(0x427)](_0x425149(0x49a));_0x2806c7[_0x425149(0x266)]=()=>_0x3f2e4a(_0x2806c7['result']),_0x2806c7[_0x425149(0x3cb)]=()=>_0x29c08b(_0x2806c7[_0x425149(0x4ad)]);});},async 'updateSettings'(_0x3d867b){const _0xf47200=_0x36046b,_0x3704b3=await this[_0xf47200(0x471)](_0xf47200(0x476),_0xf47200(0x3c7));return new Promise((_0x4af382,_0x113ba7)=>{const _0x42035f=_0xf47200,_0x53ea9a=_0x3704b3[_0x42035f(0x2cc)](_0x3d867b,'main_settings');_0x53ea9a[_0x42035f(0x266)]=()=>_0x4af382(_0x53ea9a[_0x42035f(0x4c6)]),_0x53ea9a[_0x42035f(0x3cb)]=()=>_0x113ba7(_0x53ea9a[_0x42035f(0x4ad)]);});},async 'getAll'(_0x644e66){const _0x2afdb2=_0x36046b,_0x43458d=await this[_0x2afdb2(0x471)](_0x644e66);return new Promise((_0x206b6d,_0x19e648)=>{const _0x1bb1bb=_0x2afdb2,_0x106860=_0x43458d['getAll']();_0x106860[_0x1bb1bb(0x266)]=()=>_0x206b6d(_0x106860[_0x1bb1bb(0x4c6)]),_0x106860[_0x1bb1bb(0x3cb)]=()=>_0x19e648(_0x106860[_0x1bb1bb(0x4ad)]);});},async 'update'(_0x2a73f8,_0x111571){const _0x48833c=_0x36046b,_0x20d88f=await this[_0x48833c(0x471)](_0x2a73f8,_0x48833c(0x3c7));return new Promise((_0x25cffa,_0x2d86bd)=>{const _0x304461=_0x48833c,_0x2bea4e=_0x20d88f[_0x304461(0x2cc)](_0x111571);_0x2bea4e['onsuccess']=()=>_0x25cffa(_0x2bea4e['result']),_0x2bea4e[_0x304461(0x3cb)]=()=>_0x2d86bd(_0x2bea4e[_0x304461(0x4ad)]);});},async 'add'(_0x5b37e8,_0x8811b7){const _0x1f97ac=_0x36046b,_0x4cba54=await this[_0x1f97ac(0x471)](_0x5b37e8,'readwrite');return new Promise((_0x407b81,_0x3884fa)=>{const _0x9400d1=_0x1f97ac,_0x1fa5a4=_0x4cba54['add'](_0x8811b7);_0x1fa5a4[_0x9400d1(0x266)]=()=>_0x407b81(_0x1fa5a4[_0x9400d1(0x4c6)]),_0x1fa5a4[_0x9400d1(0x3cb)]=()=>_0x3884fa(_0x1fa5a4[_0x9400d1(0x4ad)]);});},async 'delete'(_0x173115,_0x1ff184){const _0x24d2fe=_0x36046b,_0x23a0ab=await this[_0x24d2fe(0x471)](_0x173115,_0x24d2fe(0x3c7));return new Promise((_0x128392,_0x402423)=>{const _0x4d8e37=_0x24d2fe,_0x238bb3=_0x23a0ab[_0x4d8e37(0x36c)](_0x1ff184);_0x238bb3[_0x4d8e37(0x266)]=()=>_0x128392(_0x238bb3[_0x4d8e37(0x4c6)]),_0x238bb3[_0x4d8e37(0x3cb)]=()=>_0x402423(_0x238bb3[_0x4d8e37(0x4ad)]);});},async 'save'(_0x296c06){const _0x24425a=_0x36046b;return await this[_0x24425a(0x1ec)](),new Promise((_0x4ae0da,_0x50bd12)=>{const _0x49f3b9=_0x24425a,_0x1ea900=this['db']['transaction']([_0x49f3b9(0x476),'topics',_0x49f3b9(0x25c)],_0x49f3b9(0x3c7)),_0x4f7ca4=_0x1ea900[_0x49f3b9(0x48b)](_0x49f3b9(0x476)),_0x1cbd22=_0x1ea900[_0x49f3b9(0x48b)]('topics'),_0x39f335=_0x1ea900[_0x49f3b9(0x48b)](_0x49f3b9(0x25c));_0x4f7ca4[_0x49f3b9(0x2cc)](_0x296c06[_0x49f3b9(0x476)],_0x49f3b9(0x49a)),_0x1cbd22[_0x49f3b9(0x201)](),_0x39f335[_0x49f3b9(0x201)](),_0x296c06[_0x49f3b9(0x20a)]['forEach'](_0x382f26=>{const _0x46b70e=_0x49f3b9,{subtopics:_0x10b447,..._0x2bd402}=_0x382f26;_0x1cbd22[_0x46b70e(0x2cc)](_0x2bd402),(_0x10b447||[])['forEach'](_0x40981d=>_0x39f335[_0x46b70e(0x2cc)](_0x40981d));}),_0x1ea900[_0x49f3b9(0x2a8)]=()=>_0x4ae0da(),_0x1ea900[_0x49f3b9(0x3cb)]=_0xbf72c8=>_0x50bd12(_0xbf72c8['target'][_0x49f3b9(0x4ad)]);});},async 'autoBackup'(_0x24c653){const _0x2fdeb0=_0x36046b;await this[_0x2fdeb0(0x1ec)]();const _0x480110=new Date()[_0x2fdeb0(0x3d7)]()[_0x2fdeb0(0x2b0)](0x0,0xa),_0x1d1941=localStorage[_0x2fdeb0(0x3bb)](_0x2fdeb0(0x276));if(_0x480110!==_0x1d1941){console[_0x2fdeb0(0x32c)](_0x2fdeb0(0x3bc)+_0x480110+_0x2fdeb0(0x214));const _0x49df64={'date':_0x480110,'data':JSON[_0x2fdeb0(0x2bc)](JSON[_0x2fdeb0(0x3dd)](_0x24c653))},_0x118573=this['db'][_0x2fdeb0(0x3ec)](['backups'],'readwrite'),_0x1bebbc=_0x118573[_0x2fdeb0(0x48b)]('backups'),_0x38e742=_0x1bebbc[_0x2fdeb0(0x2cc)](_0x49df64);_0x38e742[_0x2fdeb0(0x266)]=()=>{const _0x3407ab=_0x2fdeb0;localStorage['setItem'](_0x3407ab(0x276),_0x480110),console['log']('Daily\x20backup\x20successful.'),this[_0x3407ab(0x3cd)](_0x24c653?.[_0x3407ab(0x476)]?.[_0x3407ab(0x3a5)]||0x7);},_0x38e742[_0x2fdeb0(0x3cb)]=_0x4cf339=>{const _0x130433=_0x2fdeb0;console[_0x130433(0x4ad)](_0x130433(0x2df),_0x4cf339[_0x130433(0x2e7)][_0x130433(0x4ad)]);};}},async 'cleanupOldBackups'(_0x39919e){const _0x4843a1=_0x36046b;await this[_0x4843a1(0x1ec)]();const _0x7d81c=this['db'][_0x4843a1(0x3ec)]([_0x4843a1(0x2e3)],_0x4843a1(0x3c7)),_0x5109fb=_0x7d81c['objectStore']('backups'),_0x5aac6a=_0x5109fb[_0x4843a1(0x324)]();_0x5aac6a[_0x4843a1(0x266)]=()=>{const _0x2f4664=_0x4843a1,_0xd497db=_0x5aac6a[_0x2f4664(0x4c6)][_0x2f4664(0x3c0)]()[_0x2f4664(0x394)]();if(_0xd497db[_0x2f4664(0x1e7)]>_0x39919e){const _0x161472=_0xd497db[_0x2f4664(0x2b0)](_0x39919e);_0x161472[_0x2f4664(0x229)](_0x16b910=>{const _0x5d9df0=_0x2f4664;_0x5109fb['delete'](_0x16b910),console[_0x5d9df0(0x32c)]('Deleted\x20old\x20backup:\x20'+_0x16b910);});}};},async 'getBackupList'(){const _0x2742a7=_0x36046b;return await this[_0x2742a7(0x1ec)](),new Promise((_0x44a641,_0x1cb109)=>{const _0x971217=_0x2742a7,_0x25248f=this['db'][_0x971217(0x3ec)]([_0x971217(0x2e3)],'readonly'),_0x2d5855=_0x25248f[_0x971217(0x48b)](_0x971217(0x2e3)),_0x298b40=_0x2d5855[_0x971217(0x35a)]();_0x298b40[_0x971217(0x266)]=()=>_0x44a641(_0x298b40[_0x971217(0x4c6)][_0x971217(0x3c0)]((_0x5e04cb,_0x25f032)=>_0x25f032[_0x971217(0x270)][_0x971217(0x43e)](_0x5e04cb[_0x971217(0x270)]))),_0x298b40[_0x971217(0x3cb)]=_0x25b96b=>_0x1cb109(_0x25b96b['target'][_0x971217(0x4ad)]);});},async 'restoreBackup'(_0x1c6661){const _0x5571bc=_0x36046b;return await this[_0x5571bc(0x1ec)](),new Promise((_0x4e4f97,_0x4a611e)=>{const _0x17c927=_0x5571bc,_0x3eeb60=this['db'][_0x17c927(0x3ec)]([_0x17c927(0x2e3)],'readonly'),_0x5dea7=_0x3eeb60[_0x17c927(0x48b)](_0x17c927(0x2e3)),_0x126e03=_0x5dea7['get'](_0x1c6661);_0x126e03['onsuccess']=()=>{const _0x15de81=_0x17c927;_0x126e03[_0x15de81(0x4c6)]&&_0x126e03['result'][_0x15de81(0x2b2)]?(localStorage[_0x15de81(0x45b)](_0x15de81(0x3e8),JSON['stringify'](_0x126e03[_0x15de81(0x4c6)][_0x15de81(0x2b2)])),_0x4e4f97(_0x126e03[_0x15de81(0x4c6)][_0x15de81(0x2b2)])):_0x4a611e(new Error(_0x15de81(0x4ae)));},_0x126e03[_0x17c927(0x3cb)]=_0x4db22f=>_0x4a611e(_0x4db22f['target']['error']);});},'exportData'(_0xee0a2b){const _0x866b20=_0x36046b;let _0x480000={};try{_0x480000=JSON[_0x866b20(0x2bc)](JSON[_0x866b20(0x3dd)](_0xee0a2b||{}));}catch(_0x215754){_0x480000=_0xee0a2b;}try{if(_0x480000&&_0x480000[_0x866b20(0x476)])_0x480000[_0x866b20(0x476)]['apiKey']='';}catch(_0x47e946){}const _0x16ea7d=new Blob([JSON[_0x866b20(0x3dd)](_0x480000,null,0x2)],{'type':'application/json'}),_0x306a32=document['createElement']('a'),_0x3312db=new Date(),_0x2f746f=_0x1c9fae=>(''+_0x1c9fae)['padStart'](0x2,'0');_0x306a32['href']=URL[_0x866b20(0x323)](_0x16ea7d),_0x306a32[_0x866b20(0x483)]=_0x866b20(0x3a9)+_0x3312db['getFullYear']()+_0x2f746f(_0x3312db[_0x866b20(0x210)]()+0x1)+_0x2f746f(_0x3312db[_0x866b20(0x2ce)]())+'.json',_0x306a32[_0x866b20(0x3ef)](),URL[_0x866b20(0x2c9)](_0x306a32[_0x866b20(0x2fe)]);},async 'importData'(_0x50d186){const _0x2e9ed3=_0x36046b,_0x5e3439=await _0x50d186[_0x2e9ed3(0x268)](),_0x2a6e8f=JSON[_0x2e9ed3(0x2bc)](_0x5e3439);if(!_0x2a6e8f[_0x2e9ed3(0x1f5)]||!_0x2a6e8f[_0x2e9ed3(0x476)]||!Array[_0x2e9ed3(0x4c7)](_0x2a6e8f[_0x2e9ed3(0x20a)]))throw new Error(_0x2e9ed3(0x24e));try{const _0x3545ce=window['data']&&window[_0x2e9ed3(0x2b2)][_0x2e9ed3(0x476)]&&window['data']['settings']['apiKey']||'';(!('apiKey'in _0x2a6e8f[_0x2e9ed3(0x476)])||_0x2a6e8f[_0x2e9ed3(0x476)][_0x2e9ed3(0x43b)]==='')&&(_0x2a6e8f['settings'][_0x2e9ed3(0x43b)]=_0x3545ce);}catch(_0x4a83dd){}return localStorage[_0x2e9ed3(0x45b)](_0x2e9ed3(0x3e8),JSON[_0x2e9ed3(0x3dd)](_0x2a6e8f)),_0x2a6e8f;}},$=(_0x5f5d15,_0x520bf4=document)=>_0x520bf4[_0x36046b(0x3b1)](_0x5f5d15),breakSuggestions=[_0x36046b(0x383),_0x36046b(0x4d3),_0x36046b(0x3a2),_0x36046b(0x3c4),_0x36046b(0x3ce),'Tidy\x20or\x20rearrange\x20your\x20workspace.','Play\x20a\x20favorite\x20song\x20briefly.',_0x36046b(0x249),'Loosen\x20wrists\x20and\x20shoulders\x20for\x2030\x20seconds.',_0x36046b(0x235),_0x36046b(0x378),_0x36046b(0x1d9),'Gently\x20massage\x20your\x20temples.',_0x36046b(0x4a3),'Count\x20down\x20slowly\x20from\x2020\x20to\x200.',_0x36046b(0x30c),_0x36046b(0x236),'Gently\x20close\x20your\x20eyes\x20and\x20smile\x20to\x20yourself.',_0x36046b(0x2f7),'Notice\x20the\x20room’s\x20temperature\x20and\x20lighting.',_0x36046b(0x1e5),_0x36046b(0x231),_0x36046b(0x412),_0x36046b(0x317),_0x36046b(0x4ca),_0x36046b(0x2e5),_0x36046b(0x1e8),_0x36046b(0x38a),_0x36046b(0x2f0),_0x36046b(0x487),_0x36046b(0x40d),_0x36046b(0x26f)],$$=(_0x4c89a1,_0x8ce355=document)=>Array[_0x36046b(0x22e)](_0x8ce355[_0x36046b(0x482)](_0x4c89a1));function on(_0x8b726d,_0x27d643,_0x56da21){const _0x1f21b7=_0x36046b;if(!_0x8b726d){console['warn']('Missing\x20element',_0x27d643);return;}_0x8b726d[_0x1f21b7(0x2f6)](_0x27d643,_0x56da21);}const formatMMSS=_0x309ef1=>{const _0x4a4160=_0x36046b,_0x54505a=Math['floor'](_0x309ef1/0x3c)[_0x4a4160(0x222)]()['padStart'](0x2,'0'),_0x372b03=Math[_0x4a4160(0x1f4)](_0x309ef1%0x3c)['toString']()[_0x4a4160(0x4af)](0x2,'0');return _0x54505a+':'+_0x372b03;},uid=(_0x502159='id')=>_0x502159+'_'+Date[_0x36046b(0x31e)]()+'_'+Math[_0x36046b(0x326)]()[_0x36046b(0x222)](0x24)[_0x36046b(0x2b0)](0x2,0x9);let __releaseFocusTrap=null;function trapFocus(_0x39b83f){const _0x1df623=_0x36046b;try{const _0x5d1a3a=_0x39b83f[_0x1df623(0x482)](_0x1df623(0x4b0));if(!_0x5d1a3a[_0x1df623(0x1e7)])return;const _0x5e5817=_0x5d1a3a[0x0],_0x2d572b=_0x5d1a3a[_0x5d1a3a[_0x1df623(0x1e7)]-0x1],_0x202972=_0x4f7995=>{const _0x31a74e=_0x1df623;if(_0x4f7995['key']===_0x31a74e(0x434)){if(_0x4f7995[_0x31a74e(0x384)]&&document[_0x31a74e(0x332)]===_0x5e5817)_0x4f7995[_0x31a74e(0x242)](),_0x2d572b['focus']();else!_0x4f7995[_0x31a74e(0x384)]&&document[_0x31a74e(0x332)]===_0x2d572b&&(_0x4f7995[_0x31a74e(0x242)](),_0x5e5817['focus']());}};_0x39b83f[_0x1df623(0x2f6)]('keydown',_0x202972),_0x5e5817['focus'](),__releaseFocusTrap=()=>{const _0xc6be7b=_0x1df623;try{_0x39b83f['removeEventListener'](_0xc6be7b(0x46f),_0x202972);}catch(_0x2e3914){}};}catch(_0x10a57f){}}function releaseFocus(){if(__releaseFocusTrap){try{__releaseFocusTrap();}catch(_0x5b950c){}__releaseFocusTrap=null;}}const todayISO=()=>new Date()[_0x36046b(0x3d7)]();function toast(_0x15d465,_0x33d31d=0xa28){const _0x165c62=_0x36046b,_0x3444fb=$(_0x165c62(0x1ee)),_0x529e72=document[_0x165c62(0x1da)](_0x165c62(0x4ac));_0x529e72[_0x165c62(0x4b1)]=_0x165c62(0x3d1),_0x529e72['textContent']=_0x15d465,_0x3444fb[_0x165c62(0x406)](_0x529e72),setTimeout(()=>{const _0x2906f7=_0x165c62;_0x529e72[_0x2906f7(0x335)][_0x2906f7(0x22b)]='0';},_0x33d31d-0x12c),setTimeout(()=>_0x3444fb[_0x165c62(0x4bf)](_0x529e72),_0x33d31d);}function escapeHTML(_0x48a14a){const _0x29d19d=_0x36046b;return _0x48a14a[_0x29d19d(0x32f)](/[&<>"']/g,_0xb679b7=>({'&':_0x29d19d(0x3d9),'<':_0x29d19d(0x4d6),'>':_0x29d19d(0x49c),'\x22':_0x29d19d(0x4e0),'\x27':'&#39;'}[_0xb679b7]));}function formatDaysHoursMinutes(_0x1eb93c){const _0x1698b5=_0x36046b;if(!_0x1eb93c||_0x1eb93c<0x1)return'0\x20min';const _0x3c1a9d=Math['floor'](_0x1eb93c/0x3c),_0x5e0d8e=_0x1eb93c%0x3c,_0x29daf1=_0x5e0d8e[_0x1698b5(0x222)]()['padStart'](0x2,'0');return _0x3c1a9d+_0x1698b5(0x430)+_0x29daf1+_0x1698b5(0x451);}function formatGeminiResponse(_0x5f0197){return _0x5f0197['replace'](/(\*\*|__|\*|_|#+\s*)/g,'');}function parseSimpleMarkdown(_0x20842f){const _0x12d8aa=_0x36046b,_0x43ce79=(_0x20842f||'')['split']('\x0a');let _0x438390='',_0x36c904=null;const _0x559c16=()=>{_0x36c904&&(_0x438390+=_0x36c904==='ol'?'</ol>':'</ul>',_0x36c904=null);};for(let _0x33b755 of _0x43ce79){let _0x4062d5=(_0x33b755||'')['trim']();if(!_0x4062d5){_0x559c16();continue;}if(_0x4062d5[_0x12d8aa(0x402)](_0x12d8aa(0x30b)))_0x559c16(),_0x438390+=_0x12d8aa(0x4d7)+escapeHTML(_0x4062d5[_0x12d8aa(0x2f5)](0x5))+_0x12d8aa(0x3b7);else{if(/^\d+\.\s/[_0x12d8aa(0x407)](_0x4062d5)){_0x36c904!=='ol'&&(_0x559c16(),_0x438390+=_0x12d8aa(0x4cc),_0x36c904='ol');const _0x2b591f=_0x4062d5[_0x12d8aa(0x2f5)](_0x4062d5[_0x12d8aa(0x428)]('\x20')+0x1);_0x438390+=_0x12d8aa(0x1e0)+escapeHTML(_0x2b591f)+'</li>';}else _0x4062d5['startsWith']('-\x20')?(_0x36c904!=='ul'&&(_0x559c16(),_0x438390+=_0x12d8aa(0x463),_0x36c904='ul'),_0x438390+=_0x12d8aa(0x1e0)+escapeHTML(_0x4062d5[_0x12d8aa(0x2f5)](0x2))+_0x12d8aa(0x304)):(_0x559c16(),_0x4062d5=escapeHTML(_0x4062d5)['replace'](/\*\*(.*?)\*\*/g,'<strong>$1</strong>')[_0x12d8aa(0x32f)](/_(.*?)_/g,'<i>$1</i>'),_0x438390+='<p>'+_0x4062d5+'</p>');}}return _0x559c16(),_0x438390;}function wrapTextInMarkdown(_0x2f02ad,_0x38c0ac,_0x4c5046=''){const _0x3dfbe4=_0x36046b;if(!_0x2f02ad)return;const _0x172759=_0x2f02ad['selectionStart']||0x0,_0x2dff1d=_0x2f02ad[_0x3dfbe4(0x23e)]||0x0,_0xc2a50b=_0x2f02ad['value']['substring'](_0x172759,_0x2dff1d),_0x51fa95=_0x38c0ac+_0xc2a50b+(_0x4c5046||_0x38c0ac);_0x2f02ad[_0x3dfbe4(0x39c)](_0x51fa95,_0x172759,_0x2dff1d,_0x3dfbe4(0x449)),_0x2f02ad['focus']();}function updateEditorPreview(){const _0x1a7d73=_0x36046b,_0x518e31=$('#methodEditorContentInput'),_0x2755b2=$('#editorPreview');if(!_0x518e31||!_0x2755b2)return;const _0x2e1d4c=_0x518e31[_0x1a7d73(0x327)]||'';_0x2755b2[_0x1a7d73(0x3c3)]=parseSimpleMarkdown(_0x2e1d4c);}function normalizeDataStructure(_0x3a2ee6){const _0xdbd916=_0x36046b;if(!_0x3a2ee6||typeof _0x3a2ee6!=='object')return;const _0x217ad1=_0x3a2ee6[_0xdbd916(0x476)]||{},_0x33e78a={...defaults['settings'],..._0x217ad1,'durations':{...defaults['settings'][_0xdbd916(0x370)],..._0x217ad1[_0xdbd916(0x370)]||{}}};if(!Array[_0xdbd916(0x4c7)](_0x33e78a[_0xdbd916(0x470)]))_0x33e78a[_0xdbd916(0x470)]=[];_0x3a2ee6[_0xdbd916(0x476)]=_0x33e78a,_0x3a2ee6[_0xdbd916(0x20a)]=Array[_0xdbd916(0x4c7)](_0x3a2ee6[_0xdbd916(0x20a)])?_0x3a2ee6[_0xdbd916(0x20a)]:[],_0x3a2ee6['topics'][_0xdbd916(0x229)](_0x21ef9f=>{const _0x23e899=_0xdbd916;_0x21ef9f[_0x23e899(0x25c)]=Array[_0x23e899(0x4c7)](_0x21ef9f[_0x23e899(0x25c)])?_0x21ef9f['subtopics']:[],_0x21ef9f['subtopics'][_0x23e899(0x229)](_0x4f8a1b=>{const _0x3af0fe=_0x23e899;_0x4f8a1b[_0x3af0fe(0x2e1)]=_0x4f8a1b[_0x3af0fe(0x2e1)]||[],_0x4f8a1b[_0x3af0fe(0x3ab)]=_0x4f8a1b[_0x3af0fe(0x3ab)]||[],_0x4f8a1b[_0x3af0fe(0x2c8)]=_0x4f8a1b[_0x3af0fe(0x2c8)]||[],_0x4f8a1b[_0x3af0fe(0x417)]=_0x4f8a1b[_0x3af0fe(0x417)]||[],_0x4f8a1b[_0x3af0fe(0x1f7)]=Array[_0x3af0fe(0x4c7)](_0x4f8a1b['methods'])?_0x4f8a1b['methods']:[],_0x4f8a1b[_0x3af0fe(0x4d2)]=_0x4f8a1b['stats']||{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},_0x4f8a1b[_0x3af0fe(0x351)]=_0x4f8a1b[_0x3af0fe(0x351)]||[],_0x4f8a1b[_0x3af0fe(0x387)]=_0x4f8a1b[_0x3af0fe(0x387)]||{'state':_0x3af0fe(0x3cf),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0};});});}function extractYouTubeID(_0x272bbc){const _0x4f2a4c=_0x36046b;if(!_0x272bbc)return null;const _0x1a7b06=/^.*(?:youtu.be\/|shorts\/|live\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([A-Za-z0-9_-]{11}).*/,_0x2b2edb=_0x272bbc[_0x4f2a4c(0x371)](_0x1a7b06);return _0x2b2edb?_0x2b2edb[0x1]:null;}let sessionYoutubeUrl='';function getActiveYoutubeUrl(){const _0x43294b=_0x36046b;try{if(sessionYoutubeUrl)return sessionYoutubeUrl;const _0xded44d=document[_0x43294b(0x2ab)](_0x43294b(0x390)),_0x50dd82=(_0xded44d&&_0xded44d[_0x43294b(0x327)]?_0xded44d[_0x43294b(0x327)]:'')[_0x43294b(0x4dd)]();return _0x50dd82;}catch(_0x409452){return'';}}function getActiveVideoId(){return extractYouTubeID(getActiveYoutubeUrl());}async function migrateSharedMethodsToCurrentSubtopic(){const _0x2a6c9f=_0x36046b;try{const _0x3fb7ac=data?.[_0x2a6c9f(0x476)]?.[_0x2a6c9f(0x1f7)]||[];if(!Array[_0x2a6c9f(0x4c7)](_0x3fb7ac)||_0x3fb7ac['length']===0x0)return;const _0x40009d=getCurrentSubtopic();if(!_0x40009d)return;(!Array[_0x2a6c9f(0x4c7)](_0x40009d[_0x2a6c9f(0x1f7)])||_0x40009d['methods'][_0x2a6c9f(0x1e7)]===0x0)&&(_0x40009d[_0x2a6c9f(0x1f7)]=_0x3fb7ac,data[_0x2a6c9f(0x476)][_0x2a6c9f(0x1f7)]=[],await saveData());}catch(_0x590624){}}function handleYoutubeUrlInput(){const _0x628824=_0x36046b,_0x5632b0=$(_0x628824(0x285)),_0x55378f=$(_0x628824(0x329)),_0x47c031=$(_0x628824(0x4a8)),_0x46fa62=_0x5632b0[_0x628824(0x327)][_0x628824(0x4dd)](),_0x89681e=extractYouTubeID(_0x46fa62);if(_0x89681e){_0x55378f[_0x628824(0x2a4)]='OK.\x20Valid\x20link.\x20Preparing\x20to\x20play...',_0x55378f['style']['color']='var(--acc-2)',_0x47c031[_0x628824(0x4e8)]=![],sessionYoutubeUrl=_0x46fa62;try{ytUserPaused=![];}catch(_0x5e46d8){}try{const _0x22ae7a='https://img.youtube.com/vi/'+_0x89681e+_0x628824(0x462),_0x536f64=new Image();_0x536f64[_0x628824(0x2c7)]=async()=>{const _0x2cf846=_0x628824;data['settings'][_0x2cf846(0x1de)]=_0x22ae7a;try{await saveData();}catch(_0x297c4e){}applyCustomBg();},_0x536f64[_0x628824(0x3cb)]=async()=>{const _0x125570=_0x628824,_0x3630c9=_0x125570(0x43f)+_0x89681e+_0x125570(0x356);data[_0x125570(0x476)][_0x125570(0x1de)]=_0x3630c9;try{await saveData();}catch(_0x4e78f5){}applyCustomBg();},_0x536f64['src']=_0x22ae7a;}catch(_0x382234){}try{if(IS_FILE_PROTOCOL){const _0x27b50d=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x89681e,{'autoplay':0x1,'mute':_0x27b50d});try{setTimeout(()=>{try{fallbackPostMessage('playVideo');}catch(_0x18ba4e){}},0xfa);}catch(_0x42c7f3){}!_ytUnlocked&&showSoundPermission();try{setTimeout(()=>{const _0x2a6dd2=_0x628824,_0x52186a=document[_0x2a6dd2(0x2ab)](_0x2a6dd2(0x3eb));if(_0x52186a)_0x52186a['textContent']=_0x2a6dd2(0x20f);},0x1f4);}catch(_0x32bec1){}}else ensureYouTubeAPI()['then'](()=>{const _0x238a04=_0x628824;updateYouTubePlayer();try{if(_ytUnlocked)ytFadeInPlay();else ytPlayer&&ytPlayer[_0x238a04(0x372)]&&ytPlayer[_0x238a04(0x3d6)]&&(ytPlayer['mute'](),ytPlayer['playVideo'](),_ytPrimed=!![],showSoundPermission());}catch(_0x338324){}})['catch'](()=>{});}catch(_0x311654){}}else{if(_0x46fa62===''){_0x55378f['textContent']='',_0x47c031[_0x628824(0x4e8)]=!![];if(IS_FILE_PROTOCOL)try{fallbackStop();}catch(_0xbc7104){}else ytPlayer&&ytPlayer[_0x628824(0x355)]&&ytPlayer[_0x628824(0x355)]();}else _0x55378f['textContent']='❌\x20Invalid\x20or\x20unsupported\x20link.',_0x55378f[_0x628824(0x335)][_0x628824(0x27a)]=_0x628824(0x4e1),_0x47c031[_0x628824(0x4e8)]=!![];}}function applyTheme(_0x30fb5e){const _0x49cad5=_0x36046b,_0x5cb6f6=_0x30fb5e||data[_0x49cad5(0x476)][_0x49cad5(0x4a5)]||_0x49cad5(0x208);document[_0x49cad5(0x350)][_0x49cad5(0x227)][_0x49cad5(0x4a5)]=_0x5cb6f6;const _0x43e49f=['lofi',_0x49cad5(0x30a)][_0x49cad5(0x3f9)](_0x5cb6f6),_0x4e8b44=_0x5cb6f6==='light'||_0x5cb6f6==='pastel',_0x24d244=data[_0x49cad5(0x476)][_0x49cad5(0x1de)],_0x30320a=()=>{const _0x3c4096=_0x49cad5;try{document[_0x3c4096(0x350)][_0x3c4096(0x335)][_0x3c4096(0x281)]='';}catch(_0x3e8629){}};if(_0x24d244&&!data[_0x49cad5(0x476)]['useYtThumbnailAsBg'])document[_0x49cad5(0x350)][_0x49cad5(0x335)][_0x49cad5(0x2ea)](_0x49cad5(0x37f),_0x49cad5(0x340)+_0x24d244+')'),_0x30320a();else{if(_0x24d244&&data['settings'][_0x49cad5(0x419)])document[_0x49cad5(0x350)][_0x49cad5(0x335)][_0x49cad5(0x2ea)](_0x49cad5(0x37f),_0x49cad5(0x340)+_0x24d244+')'),_0x30320a();else{if(_0x43e49f)document['body'][_0x49cad5(0x335)]['removeProperty'](_0x49cad5(0x37f)),_0x30320a();else _0x4e8b44?(document[_0x49cad5(0x350)][_0x49cad5(0x335)][_0x49cad5(0x2ea)](_0x49cad5(0x37f),_0x49cad5(0x224)),_0x30320a()):(document[_0x49cad5(0x350)][_0x49cad5(0x335)][_0x49cad5(0x2ea)](_0x49cad5(0x37f),''),document[_0x49cad5(0x350)]['style'][_0x49cad5(0x281)]=_0x49cad5(0x250));}}}const defaults={'version':0x1,'settings':{'apiKey':'','currentView':_0x36046b(0x310),'preset':'A','autoStartNext':!![],'soundOn':!![],'volume':0.8,'soundTheme':'beep','theme':_0x36046b(0x208),'cyclesA':0x4,'longBreakIntervalA':0x4,'cyclesB':0x4,'longBreakIntervalB':0x4,'flowtimeBreakRatio':0x5,'enableSessionNotes':!![],'enableWinddown':!![],'durations':{'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},'selectedTopicId':'','selectedSubtopicId':'','collapsedTopics':{},'customBg':'','customSounds':{'work_end':'','break_end':'','long_end':''},'youtubeUrl':'','youtubeVolume':0x50,'useYtThumbnailAsBg':!![],'panelOpacity':0.85,'panelBlur':0xa,'backgroundMode':'cover','backupDaysToKeep':0x7,'achievedMilestones':[],'methods':[{'id':uid('m'),'title':_0x36046b(0x1f0),'content':_0x36046b(0x1eb)},{'id':uid('m'),'title':_0x36046b(0x41e),'content':'<p>Benjamin\x20Franklin\x20trained\x20himself\x20from\x20a\x20poor\x20writer\x20into\x20a\x20master\x20by\x20practicing\x20actively—rather\x20than\x20reading\x20passively.\x20The\x20core\x20is\x20to\x20deconstruct,\x20recreate,\x20and\x20compare\x20with\x20a\x20high-quality\x20piece.</p><p>This\x20is\x20a\x20classic\x20example\x20of\x20<i>Deliberate\x20Practice</i>:\x20target\x20weaknesses,\x20set\x20clear\x20goals,\x20and\x20get\x20immediate\x20feedback.</p><h4>Core\x203-Step\x20Process</h4><ol><li><strong>Deconstruct:</strong>\x20Read\x20an\x20excellent\x20sample.\x20Then\x20jot\x20down\x20only\x20the\x20key\x20points\x20of\x20each\x20paragraph\x20or\x20sentence\x20on\x20a\x20separate\x20sheet.</li><li><strong>Recreate:</strong>\x20A\x20few\x20days\x20later—once\x20you’ve\x20forgotten\x20the\x20original\x20style—use\x20those\x20key-point\x20notes\x20to\x20rewrite\x20the\x20piece\x20entirely\x20in\x20your\x20own\x20words.</li><li><strong>Compare\x20&\x20Correct:</strong>\x20Compare\x20your\x20version\x20with\x20the\x20original.\x20This\x20crucial\x20step\x20reveals\x20errors\x20in\x20vocabulary,\x20sentence\x20structure,\x20and\x20idea\x20organization\x20so\x20you\x20can\x20fix\x20them.</li></ol><p>Franklin\x20also\x20practiced\x20advanced\x20variations:\x20shuffling\x20the\x20order\x20of\x20ideas\x20to\x20train\x20logic,\x20or\x20turning\x20prose\x20into\x20poetry\x20to\x20enrich\x20vocabulary.</p><h4>The\x20Golden\x20Rule</h4><p>Success\x20here\x20doesn’t\x20come\x20from\x20mindless\x20repetition,\x20but\x20from\x20direct\x20feedback\x20loops.\x20Comparing\x20to\x20the\x20original\x20forces\x20you\x20to\x20confront\x20and\x20correct\x20specific\x20weaknesses—turning\x20vague\x20learning\x20into\x20measurable\x20practice.</p><p><i>To\x20write\x20better,\x20don’t\x20just\x20read.\x20Choose\x20a\x20great\x20piece,\x20analyze\x20it,\x20try\x20to\x20recreate\x20it,\x20then\x20compare\x20and\x20correct.</i></p>'},{'id':uid('m'),'title':_0x36046b(0x256),'content':_0x36046b(0x3a8)},{'id':uid('m'),'title':_0x36046b(0x322),'content':_0x36046b(0x3ad)},{'id':uid('m'),'title':_0x36046b(0x2ef),'content':_0x36046b(0x3c8)}]},'topics':[]};let data,editingPreset='A',AUDIO_CTX=null;function ensureAudio(){const _0x30426c=_0x36046b;if(!AUDIO_CTX)AUDIO_CTX=new(window[(_0x30426c(0x400))]||window[(_0x30426c(0x45d))])();}function tone(_0x37d3a0=0x370,_0x4af754=0xc8,_0x4ac16f=0.2,_0x256316='sine',_0x515f86=0x0){const _0x392c74=_0x36046b;ensureAudio();const _0x3a9293=AUDIO_CTX,_0x39297c=_0x3a9293[_0x392c74(0x25f)](),_0x10bf79=_0x3a9293[_0x392c74(0x2d4)]();_0x39297c[_0x392c74(0x4bc)]=_0x256316,_0x39297c[_0x392c74(0x27f)][_0x392c74(0x327)]=_0x37d3a0,_0x39297c[_0x392c74(0x35e)](_0x10bf79),_0x10bf79[_0x392c74(0x35e)](_0x3a9293['destination']);const _0xed559a=_0x3a9293[_0x392c74(0x47e)]+_0x515f86;_0x10bf79[_0x392c74(0x292)]['setValueAtTime'](0x0,_0xed559a),_0x10bf79['gain'][_0x392c74(0x2bb)](_0x4ac16f,_0xed559a+0.01),_0x10bf79[_0x392c74(0x292)][_0x392c74(0x40f)](0.0001,_0xed559a+_0x4af754/0x3e8),_0x39297c[_0x392c74(0x40c)](_0xed559a),_0x39297c['stop'](_0xed559a+_0x4af754/0x3e8+0.05);}function playSound(_0x16b78a){const _0x3b7242=_0x36046b;if(!data['settings']['soundOn'])return;const _0x492cab=Math[_0x3b7242(0x4ab)](0x0,Math['min'](0x1,data[_0x3b7242(0x476)][_0x3b7242(0x4df)]??0.8)),_0x2644f7=data[_0x3b7242(0x476)][_0x3b7242(0x2f1)]?.[_0x16b78a];let _0x2c2c83;if(_0x16b78a===_0x3b7242(0x282))_0x2c2c83=$(_0x3b7242(0x3e4));else{if(_0x16b78a===_0x3b7242(0x31c))_0x2c2c83=$(_0x3b7242(0x22c));else{if(_0x16b78a===_0x3b7242(0x2e0))_0x2c2c83=$('#audioLongEnd');}}if(_0x2644f7&&_0x2c2c83){_0x2644f7[_0x3b7242(0x402)](_0x3b7242(0x1e9))||_0x2644f7[_0x3b7242(0x402)]('http')||_0x2644f7['startsWith']('blob:')?(_0x2c2c83[_0x3b7242(0x26c)]=_0x2644f7,_0x2c2c83[_0x3b7242(0x4df)]=_0x492cab,_0x2c2c83[_0x3b7242(0x1f1)]()[_0x3b7242(0x2c6)](_0x133ded=>console[_0x3b7242(0x4ad)]('Audio\x20playback\x20error:',_0x133ded))):getStoredFileUrl(_0x2644f7)[_0x3b7242(0x472)](_0x1b3063=>{const _0x2cbc69=_0x3b7242;_0x1b3063&&(_0x2c2c83[_0x2cbc69(0x26c)]=_0x1b3063,_0x2c2c83['volume']=_0x492cab,_0x2c2c83[_0x2cbc69(0x1f1)]()[_0x2cbc69(0x2c6)](_0xba73fa=>console[_0x2cbc69(0x4ad)](_0x2cbc69(0x2d3),_0xba73fa)));});return;}const _0x358d6e=data['settings'][_0x3b7242(0x3e6)]||_0x3b7242(0x2a6);if(_0x358d6e===_0x3b7242(0x2a6)){if(_0x16b78a===_0x3b7242(0x282))tone(0x370,0xfa,_0x492cab),tone(0x294,0xb4,_0x492cab*0.8,'sine',0.22);else{if(_0x16b78a===_0x3b7242(0x31c))tone(0x294,0xdc,_0x492cab*0.9);else _0x16b78a===_0x3b7242(0x2e0)&&(tone(0x208,0xc8,_0x492cab),tone(0x30c,0xc8,_0x492cab,_0x3b7242(0x3de),0.22),tone(0x410,0xdc,_0x492cab,'sine',0.44));}}else{if(_0x16b78a===_0x3b7242(0x282))tone(0x4b0,0xa0,_0x492cab*0.9,_0x3b7242(0x42f)),tone(0x384,0xdc,_0x492cab*0.8,'triangle',0.18);else{if(_0x16b78a===_0x3b7242(0x31c))tone(0x370,0xf0,_0x492cab*0.8,_0x3b7242(0x42f));else _0x16b78a===_0x3b7242(0x2e0)&&(tone(0x258,0xdc,_0x492cab*0.9,'triangle'),tone(0x3b6,0xf0,_0x492cab*0.9,'triangle',0.22),tone(0x4b0,0xf0,_0x492cab,_0x3b7242(0x42f),0.44));}}}async function saveData(){const _0x5df9ad=_0x36046b;try{await storageManager[_0x5df9ad(0x311)](data);}catch(_0x2912ef){console[_0x5df9ad(0x4ad)](_0x5df9ad(0x477),_0x2912ef),toast('Error\x20saving\x20data:\x20'+_0x2912ef[_0x5df9ad(0x232)]);}}async function ensureValidSelection(){const _0x437fa5=_0x36046b,_0x38d3a2=data[_0x437fa5(0x476)];if(!data[_0x437fa5(0x20a)]||data[_0x437fa5(0x20a)][_0x437fa5(0x1e7)]===0x0){_0x38d3a2[_0x437fa5(0x4d9)]='',_0x38d3a2[_0x437fa5(0x362)]='',await saveData();return;}const _0x4a999e=data[_0x437fa5(0x20a)][_0x437fa5(0x21f)](_0x5eb592=>_0x5eb592['id']===_0x38d3a2[_0x437fa5(0x4d9)]),_0xc5543e=_0x4a999e?.['subtopics'][_0x437fa5(0x21f)](_0x113815=>_0x113815['id']===_0x38d3a2['selectedSubtopicId']);if(!_0x4a999e||!_0xc5543e){const _0xbe5058=data['topics'][0x0],_0x2e2c8a=_0xbe5058?.[_0x437fa5(0x25c)]?.[0x0];_0x38d3a2[_0x437fa5(0x4d9)]=_0xbe5058?.['id']||'',_0x38d3a2[_0x437fa5(0x362)]=_0x2e2c8a?.['id']||'',await saveData();}}function showInputModal(_0x2f8e57,_0x42585b,_0x3b368b=''){const _0x44aa98=_0x36046b;$(_0x44aa98(0x263))[_0x44aa98(0x2a4)]=_0x2f8e57,$(_0x44aa98(0x422))[_0x44aa98(0x3fa)][_0x44aa98(0x478)](_0x44aa98(0x454));const _0x4c6218=$(_0x44aa98(0x3cc));_0x4c6218[_0x44aa98(0x327)]=_0x3b368b,_0x4c6218[_0x44aa98(0x3fa)][_0x44aa98(0x30e)](_0x44aa98(0x454)),$(_0x44aa98(0x418))[_0x44aa98(0x3fa)][_0x44aa98(0x478)](_0x44aa98(0x3e9));try{trapFocus($(_0x44aa98(0x418)));}catch(_0x4b9c0c){}_0x4c6218[_0x44aa98(0x3f8)](),_0x4c6218[_0x44aa98(0x20b)]();const _0x4c7d5c=()=>{const _0x5a83c3=_0x44aa98;_0x42585b(_0x4c6218[_0x5a83c3(0x327)]),_0x43efde();},_0x992837=()=>_0x43efde(),_0xc06b9a=_0x2c2b53=>{const _0x431c10=_0x44aa98;if(_0x2c2b53[_0x431c10(0x468)]===_0x431c10(0x287))_0x4c7d5c();if(_0x2c2b53[_0x431c10(0x468)]==='Escape')_0x992837();};$(_0x44aa98(0x241))[_0x44aa98(0x251)]=_0x4c7d5c,$(_0x44aa98(0x3ba))[_0x44aa98(0x251)]=_0x992837,_0x4c6218[_0x44aa98(0x303)]=_0xc06b9a;function _0x43efde(){const _0x2ef6f9=_0x44aa98;$(_0x2ef6f9(0x418))[_0x2ef6f9(0x3fa)][_0x2ef6f9(0x30e)](_0x2ef6f9(0x3e9)),$(_0x2ef6f9(0x241))[_0x2ef6f9(0x251)]=null,$(_0x2ef6f9(0x3ba))[_0x2ef6f9(0x251)]=null,_0x4c6218[_0x2ef6f9(0x303)]=null;try{releaseFocus();}catch(_0x9645a1){}}}function showConfirmModal(_0x3f8f85,_0x4f4973,_0x184fb2){const _0x3b8564=_0x36046b;$('#genericTitle')[_0x3b8564(0x2a4)]=_0x3f8f85;const _0x2794b3=$(_0x3b8564(0x422));_0x2794b3[_0x3b8564(0x2a4)]=_0x4f4973,_0x2794b3[_0x3b8564(0x3fa)][_0x3b8564(0x30e)]('hidden'),$(_0x3b8564(0x3cc))[_0x3b8564(0x3fa)][_0x3b8564(0x478)](_0x3b8564(0x454)),$(_0x3b8564(0x418))[_0x3b8564(0x3fa)][_0x3b8564(0x478)](_0x3b8564(0x3e9));try{trapFocus($(_0x3b8564(0x418)));}catch(_0x146599){}const _0x2269d9=()=>{_0x184fb2(!![]),_0x304f0b();},_0x3cf20a=()=>{_0x184fb2(![]),_0x304f0b();};$(_0x3b8564(0x241))[_0x3b8564(0x251)]=_0x2269d9,$('#btnGenericCancel')[_0x3b8564(0x251)]=_0x3cf20a;function _0x304f0b(){const _0x17e0ab=_0x3b8564;$(_0x17e0ab(0x418))[_0x17e0ab(0x3fa)][_0x17e0ab(0x30e)](_0x17e0ab(0x3e9)),$(_0x17e0ab(0x241))['onclick']=null,$(_0x17e0ab(0x3ba))['onclick']=null;try{releaseFocus();}catch(_0x19ff89){}}}let pendingNoteSessionId=null;function openNoteModal(_0x3230b4){const _0x490af6=_0x36046b;pendingNoteSessionId=_0x3230b4||null;const _0x3f42bf=$(_0x490af6(0x446));if(!_0x3f42bf)return;const _0x329237=$(_0x490af6(0x288));if(_0x329237)try{_0x329237[_0x490af6(0x327)]='';}catch(_0x5a50e4){}_0x3f42bf[_0x490af6(0x3fa)]['add']('show');try{trapFocus(_0x3f42bf);}catch(_0x584002){}}function closeNoteModal(){const _0x5b8e50=_0x36046b,_0x57b3b2=$(_0x5b8e50(0x446));if(!_0x57b3b2)return;_0x57b3b2[_0x5b8e50(0x3fa)][_0x5b8e50(0x30e)](_0x5b8e50(0x3e9)),pendingNoteSessionId=null;try{releaseFocus();}catch(_0xf561d9){}}async function switchView(_0x3e1012){const _0x2a8c45=_0x36046b;$$(_0x2a8c45(0x1fc))[_0x2a8c45(0x229)](_0x46a3b1=>_0x46a3b1['classList'][_0x2a8c45(0x30e)]('active')),$(_0x2a8c45(0x4a9)+_0x3e1012)[_0x2a8c45(0x3fa)]['add'](_0x2a8c45(0x3b5)),$$('.nav-btn')[_0x2a8c45(0x229)](_0x36d882=>_0x36d882[_0x2a8c45(0x3fa)][_0x2a8c45(0x30e)](_0x2a8c45(0x3b5)));const _0x376423=$(_0x2a8c45(0x424)+_0x3e1012+'\x22]');if(_0x376423)_0x376423[_0x2a8c45(0x3fa)][_0x2a8c45(0x478)]('active');data['settings'][_0x2a8c45(0x469)]=_0x3e1012,await saveData(),_0x3e1012==='stats'&&renderDashboard();}function closeAllMenus(){const _0x29fc71=_0x36046b;$$(_0x29fc71(0x313))[_0x29fc71(0x229)](_0x3dfa74=>_0x3dfa74['classList'][_0x29fc71(0x30e)](_0x29fc71(0x3e9))),$$('.topic-item.menu-active')[_0x29fc71(0x229)](_0x3bedb5=>_0x3bedb5[_0x29fc71(0x3fa)][_0x29fc71(0x30e)](_0x29fc71(0x2ca)));}function renderTopics(){const _0xfb40c6=_0x36046b,_0x5d1e6b=$('#topicsList');if(!_0x5d1e6b)return;_0x5d1e6b['innerHTML']='';const _0x21d14f=data[_0xfb40c6(0x476)][_0xfb40c6(0x202)]||{};data[_0xfb40c6(0x20a)]['forEach'](_0x1e352e=>{const _0x3f3ace=_0xfb40c6,_0x4ca946=document[_0x3f3ace(0x1da)](_0x3f3ace(0x4ac));_0x4ca946[_0x3f3ace(0x4b1)]='topic-item',_0x4ca946[_0x3f3ace(0x227)][_0x3f3ace(0x1fd)]=_0x1e352e['id'];const _0x1247db=document['createElement'](_0x3f3ace(0x4ac));_0x1247db['className']=_0x3f3ace(0x31b);const _0x3cfa82=!!_0x21d14f[_0x1e352e['id']],_0x329f54=document[_0x3f3ace(0x1da)](_0x3f3ace(0x31d));_0x329f54[_0x3f3ace(0x4b1)]=_0x3f3ace(0x32b),_0x329f54['setAttribute'](_0x3f3ace(0x4b6),String(!_0x3cfa82)),_0x329f54[_0x3f3ace(0x3c3)]=_0x3f3ace(0x3bf);const _0x53e045=document[_0x3f3ace(0x1da)](_0x3f3ace(0x4ac));_0x53e045[_0x3f3ace(0x4b1)]=_0x3f3ace(0x367),_0x53e045[_0x3f3ace(0x2a4)]=_0x1e352e[_0x3f3ace(0x2ff)];const _0x2e37af=document[_0x3f3ace(0x1da)](_0x3f3ace(0x4ac));_0x2e37af['className']='topic-actions';const _0x506f19=document[_0x3f3ace(0x1da)](_0x3f3ace(0x31d));_0x506f19['className']=_0x3f3ace(0x21d),_0x506f19[_0x3f3ace(0x3c3)]='＋\x20Add',_0x506f19[_0x3f3ace(0x49b)]=_0x3f3ace(0x26e);const _0x512ead=document[_0x3f3ace(0x1da)](_0x3f3ace(0x4ac));_0x512ead[_0x3f3ace(0x335)][_0x3f3ace(0x321)]=_0x3f3ace(0x3a4);const _0x56fbb1=document['createElement'](_0x3f3ace(0x31d));_0x56fbb1[_0x3f3ace(0x4b1)]=_0x3f3ace(0x4ba),_0x56fbb1['innerHTML']=_0x3f3ace(0x214),_0x56fbb1['title']=_0x3f3ace(0x47b);const _0xbb7b34=document[_0x3f3ace(0x1da)]('div');_0xbb7b34[_0x3f3ace(0x4b1)]='actions-menu';const _0x2c0cee=document[_0x3f3ace(0x1da)](_0x3f3ace(0x31d));_0x2c0cee[_0x3f3ace(0x4b1)]=_0x3f3ace(0x3d8),_0x2c0cee['innerHTML']='Rename\x20Topic';const _0x617122=document[_0x3f3ace(0x1da)](_0x3f3ace(0x31d));_0x617122[_0x3f3ace(0x4b1)]=_0x3f3ace(0x3c6),_0x617122['innerHTML']=_0x3f3ace(0x26b),_0xbb7b34[_0x3f3ace(0x39d)](_0x2c0cee,_0x617122),_0x512ead['append'](_0x56fbb1,_0xbb7b34),_0x2e37af[_0x3f3ace(0x39d)](_0x506f19,_0x512ead),_0x1247db[_0x3f3ace(0x39d)](_0x329f54,_0x53e045,_0x2e37af),_0x329f54[_0x3f3ace(0x2f6)](_0x3f3ace(0x3ef),async _0x5c20c3=>{const _0xde850b=_0x3f3ace;_0x5c20c3['stopPropagation']();const _0x198432=!!_0x21d14f[_0x1e352e['id']];_0x198432?delete _0x21d14f[_0x1e352e['id']]:_0x21d14f[_0x1e352e['id']]=!![],data[_0xde850b(0x476)][_0xde850b(0x202)]=_0x21d14f,await storageManager[_0xde850b(0x3f6)](data[_0xde850b(0x476)]),renderTopics();});const _0x3a7db5=async()=>{const _0x55ec05=_0x3f3ace,_0x25a91c=!!_0x21d14f[_0x1e352e['id']];_0x25a91c?delete _0x21d14f[_0x1e352e['id']]:_0x21d14f[_0x1e352e['id']]=!![],data[_0x55ec05(0x476)]['collapsedTopics']=_0x21d14f,await storageManager[_0x55ec05(0x3f6)](data['settings']),renderTopics();};_0x1247db[_0x3f3ace(0x2f6)](_0x3f3ace(0x3ef),async _0x1ccd34=>{const _0x1b7271=_0x3f3ace,_0x307fe6=_0x1ccd34['target'];if(_0x307fe6&&_0x307fe6[_0x1b7271(0x44c)]){if(_0x307fe6[_0x1b7271(0x44c)](_0x1b7271(0x1e3))||_0x307fe6[_0x1b7271(0x44c)]('.actions-menu-btn')||_0x307fe6[_0x1b7271(0x44c)](_0x1b7271(0x31d))||_0x307fe6[_0x1b7271(0x44c)](_0x1b7271(0x299)))return;}_0x1ccd34[_0x1b7271(0x1e4)](),await _0x3a7db5();}),_0x53e045[_0x3f3ace(0x2f6)]('click',async _0x59c16a=>{const _0x4a8ff1=_0x3f3ace;_0x59c16a[_0x4a8ff1(0x1e4)](),await _0x3a7db5();}),_0x4ca946['addEventListener'](_0x3f3ace(0x3ef),async _0x134ab8=>{const _0x496a65=_0x3f3ace,_0x3c9de3=_0x134ab8[_0x496a65(0x2e7)];if(_0x3c9de3&&_0x3c9de3[_0x496a65(0x44c)]){if(_0x3c9de3[_0x496a65(0x44c)](_0x496a65(0x4d1)))return;if(_0x3c9de3[_0x496a65(0x44c)](_0x496a65(0x1e3))||_0x3c9de3[_0x496a65(0x44c)](_0x496a65(0x32a))||_0x3c9de3[_0x496a65(0x44c)]('button')||_0x3c9de3['closest'](_0x496a65(0x299)))return;}await _0x3a7db5();});const _0x1cc9f7=document[_0x3f3ace(0x1da)]('div');_0x1cc9f7['className']='subtopics'+(_0x3cfa82?_0x3f3ace(0x4c5):''),_0x1cc9f7[_0x3f3ace(0x227)]['tid']=_0x1e352e['id'],_0x1e352e['subtopics'][_0x3f3ace(0x229)](_0x55da3e=>{const _0x5a50b1=_0x3f3ace,_0x297db1=document[_0x5a50b1(0x1da)](_0x5a50b1(0x4ac));_0x297db1[_0x5a50b1(0x4b1)]=_0x5a50b1(0x361),_0x297db1[_0x5a50b1(0x227)][_0x5a50b1(0x336)]=_0x55da3e['id'];const _0x33cbb8=document['createElement'](_0x5a50b1(0x31d));_0x33cbb8[_0x5a50b1(0x4b1)]=_0x5a50b1(0x2e8),_0x33cbb8['textContent']='•\x20'+_0x55da3e[_0x5a50b1(0x2ff)],_0x33cbb8['dataset'][_0x5a50b1(0x336)]=_0x55da3e['id'],_0x33cbb8[_0x5a50b1(0x227)]['tid']=_0x1e352e['id'];if(data[_0x5a50b1(0x476)][_0x5a50b1(0x362)]===_0x55da3e['id'])_0x33cbb8[_0x5a50b1(0x3fa)][_0x5a50b1(0x478)](_0x5a50b1(0x3b5));const _0x163129=document[_0x5a50b1(0x1da)](_0x5a50b1(0x4ac));_0x163129[_0x5a50b1(0x4b1)]='actions';const _0x3d3047=document[_0x5a50b1(0x1da)](_0x5a50b1(0x4ac));_0x3d3047[_0x5a50b1(0x335)][_0x5a50b1(0x321)]=_0x5a50b1(0x3a4);const _0x3f1caa=document['createElement'](_0x5a50b1(0x31d));_0x3f1caa[_0x5a50b1(0x4b1)]=_0x5a50b1(0x4ba),_0x3f1caa[_0x5a50b1(0x3c3)]=_0x5a50b1(0x214),_0x3f1caa[_0x5a50b1(0x49b)]='More\x20options';const _0x1934cc=document['createElement'](_0x5a50b1(0x4ac));_0x1934cc[_0x5a50b1(0x4b1)]='actions-menu';const _0x51a428=document[_0x5a50b1(0x1da)](_0x5a50b1(0x31d));_0x51a428[_0x5a50b1(0x4b1)]='menu-item',_0x51a428['innerHTML']=_0x5a50b1(0x2b4);const _0x779488=document[_0x5a50b1(0x1da)]('button');_0x779488[_0x5a50b1(0x4b1)]=_0x5a50b1(0x3c6),_0x779488[_0x5a50b1(0x3c3)]=_0x5a50b1(0x4d4),_0x1934cc['append'](_0x51a428,_0x779488),_0x3d3047[_0x5a50b1(0x39d)](_0x3f1caa,_0x1934cc),_0x163129[_0x5a50b1(0x39d)](_0x3d3047),_0x297db1[_0x5a50b1(0x39d)](_0x33cbb8,_0x163129),_0x1cc9f7[_0x5a50b1(0x406)](_0x297db1),_0x33cbb8['addEventListener'](_0x5a50b1(0x3ef),()=>selectSubtopic(_0x1e352e['id'],_0x55da3e['id'])),_0x3f1caa[_0x5a50b1(0x2f6)](_0x5a50b1(0x3ef),_0x4f81e4=>{const _0x5d92fc=_0x5a50b1;_0x4f81e4['stopPropagation']();const _0x1d989c=_0x1934cc[_0x5d92fc(0x3fa)][_0x5d92fc(0x2ec)](_0x5d92fc(0x3e9));closeAllMenus(),_0x1d989c?_0x4ca946[_0x5d92fc(0x3fa)][_0x5d92fc(0x30e)]('menu-active'):(_0x1934cc['classList'][_0x5d92fc(0x478)](_0x5d92fc(0x3e9)),_0x4ca946[_0x5d92fc(0x3fa)]['add'](_0x5d92fc(0x2ca)));}),_0x51a428[_0x5a50b1(0x2f6)](_0x5a50b1(0x3ef),()=>showInputModal(_0x5a50b1(0x2b4),async _0x40aee2=>{const _0x39eb32=_0x5a50b1;if(!_0x40aee2)return;_0x55da3e[_0x39eb32(0x2ff)]=_0x40aee2,await storageManager[_0x39eb32(0x2be)](_0x39eb32(0x25c),_0x55da3e),renderAll();},_0x55da3e[_0x5a50b1(0x2ff)])),_0x779488[_0x5a50b1(0x2f6)](_0x5a50b1(0x3ef),()=>showConfirmModal(_0x5a50b1(0x248),'Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20subtopic\x20\x22'+_0x55da3e['name']+_0x5a50b1(0x1dc),async _0x54b806=>{const _0x28fde5=_0x5a50b1;if(!_0x54b806)return;_0x1e352e[_0x28fde5(0x25c)]=_0x1e352e[_0x28fde5(0x25c)][_0x28fde5(0x1f9)](_0xdc1a74=>_0xdc1a74['id']!==_0x55da3e['id']);const _0x3f8cb1=data[_0x28fde5(0x476)];_0x3f8cb1['selectedSubtopicId']===_0x55da3e['id']&&(_0x3f8cb1['selectedSubtopicId']='',_0x3f8cb1[_0x28fde5(0x4d9)]='',ensureValidSelection()),await storageManager[_0x28fde5(0x36c)](_0x28fde5(0x25c),_0x55da3e['id']),renderAll();}));}),_0x56fbb1[_0x3f3ace(0x2f6)](_0x3f3ace(0x3ef),_0x14c1dc=>{const _0x3a38fc=_0x3f3ace;_0x14c1dc['stopPropagation']();const _0x4ece1b=_0xbb7b34[_0x3a38fc(0x3fa)][_0x3a38fc(0x2ec)]('show');closeAllMenus(),_0x4ece1b?_0x4ca946['classList'][_0x3a38fc(0x30e)](_0x3a38fc(0x2ca)):(_0xbb7b34[_0x3a38fc(0x3fa)][_0x3a38fc(0x478)](_0x3a38fc(0x3e9)),_0x4ca946[_0x3a38fc(0x3fa)][_0x3a38fc(0x478)](_0x3a38fc(0x2ca)));}),_0x506f19['addEventListener'](_0x3f3ace(0x3ef),()=>showInputModal('New\x20Subtopic\x20name?',async _0x2d489f=>{const _0x63c6b4=_0x3f3ace;if(!_0x2d489f)return;const _0x4ae0b4={'id':uid('s'),'topicId':_0x1e352e['id'],'name':_0x2d489f,'tasks':[],'generalNotes':[],'summaries':[],'chatHistory':[],'methods':[],'stats':{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},'sessions':[],'timerState':{'state':_0x63c6b4(0x3cf),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0}};try{const _0x4f304d=data?.[_0x63c6b4(0x476)]?.['methods']||[];Array[_0x63c6b4(0x4c7)](_0x4f304d)&&_0x4f304d['length']>0x0&&(_0x4ae0b4[_0x63c6b4(0x1f7)]=_0x4f304d,data['settings'][_0x63c6b4(0x1f7)]=[],await storageManager[_0x63c6b4(0x3f6)](data[_0x63c6b4(0x476)]));}catch(_0x9aba23){}_0x1e352e[_0x63c6b4(0x25c)][_0x63c6b4(0x298)](_0x4ae0b4),await storageManager[_0x63c6b4(0x478)](_0x63c6b4(0x25c),_0x4ae0b4),renderTopics();})),_0x2c0cee[_0x3f3ace(0x2f6)](_0x3f3ace(0x3ef),()=>showInputModal(_0x3f3ace(0x3f0),async _0x5d35fe=>{const _0x35e1c6=_0x3f3ace;if(!_0x5d35fe)return;_0x1e352e[_0x35e1c6(0x2ff)]=_0x5d35fe,await storageManager['update'](_0x35e1c6(0x20a),_0x1e352e),renderTopics();},_0x1e352e[_0x3f3ace(0x2ff)])),_0x617122[_0x3f3ace(0x2f6)](_0x3f3ace(0x3ef),()=>showConfirmModal(_0x3f3ace(0x248),_0x3f3ace(0x48d)+_0x1e352e[_0x3f3ace(0x2ff)]+_0x3f3ace(0x22a),async _0x1aa637=>{const _0x14f2be=_0x3f3ace;if(!_0x1aa637)return;data[_0x14f2be(0x20a)]=data[_0x14f2be(0x20a)]['filter'](_0x3ec2c3=>_0x3ec2c3['id']!==_0x1e352e['id']),delete _0x21d14f[_0x1e352e['id']];data[_0x14f2be(0x476)][_0x14f2be(0x4d9)]===_0x1e352e['id']&&(data[_0x14f2be(0x476)][_0x14f2be(0x4d9)]='',data['settings']['selectedSubtopicId']='',ensureValidSelection());await storageManager[_0x14f2be(0x36c)]('topics',_0x1e352e['id']);for(const _0x627f48 of _0x1e352e[_0x14f2be(0x25c)]){await storageManager[_0x14f2be(0x36c)](_0x14f2be(0x25c),_0x627f48['id']);}renderAll();})),_0x506f19[_0x3f3ace(0x2f6)]('click',_0x411461=>_0x411461[_0x3f3ace(0x1e4)]()),_0x2c0cee['addEventListener'](_0x3f3ace(0x3ef),_0x4144af=>_0x4144af[_0x3f3ace(0x1e4)]()),_0x617122['addEventListener'](_0x3f3ace(0x3ef),_0x4673b7=>_0x4673b7[_0x3f3ace(0x1e4)]()),_0x4ca946[_0x3f3ace(0x39d)](_0x1247db,_0x1cc9f7),_0x5d1e6b[_0x3f3ace(0x406)](_0x4ca946);});if(window[_0xfb40c6(0x4c2)]){const _0x3f98a3=document[_0xfb40c6(0x2ab)](_0xfb40c6(0x27e));if(_0x3f98a3){if(_0x3f98a3[_0xfb40c6(0x447)])try{_0x3f98a3['_sortable']['destroy']();}catch(_0x5ea946){}_0x3f98a3[_0xfb40c6(0x447)]=new Sortable(_0x3f98a3,{'animation':0x96,'draggable':_0xfb40c6(0x239),'onEnd':async function(_0x4baacd){const _0x1e7369=_0xfb40c6;if(_0x4baacd[_0x1e7369(0x491)]===_0x4baacd['newIndex'])return;const _0x436a91=data[_0x1e7369(0x20a)][_0x1e7369(0x307)](_0x4baacd[_0x1e7369(0x491)],0x1)[0x0];data[_0x1e7369(0x20a)][_0x1e7369(0x307)](_0x4baacd[_0x1e7369(0x401)],0x0,_0x436a91),await saveData(),renderTopics();}}),_0x3f98a3['querySelectorAll'](_0xfb40c6(0x4d1))[_0xfb40c6(0x229)](_0x596e7e=>{const _0x5ef61d=_0xfb40c6;new Sortable(_0x596e7e,{'group':_0x5ef61d(0x339),'animation':0x96,'draggable':_0x5ef61d(0x445),'onEnd':async function(_0x259c28){const _0x35977c=_0x5ef61d,_0x138952=_0x259c28['from']?.['dataset']?.[_0x35977c(0x1fd)]||_0x259c28[_0x35977c(0x22e)]?.['closest'](_0x35977c(0x239))?.['dataset']?.[_0x35977c(0x1fd)],_0x25bc8e=_0x259c28['to']?.[_0x35977c(0x227)]?.['tid']||_0x259c28['to']?.[_0x35977c(0x44c)](_0x35977c(0x239))?.[_0x35977c(0x227)]?.[_0x35977c(0x1fd)],_0x3dd9b7=data[_0x35977c(0x20a)][_0x35977c(0x21f)](_0x3d56c2=>_0x3d56c2['id']===_0x138952),_0x776580=data[_0x35977c(0x20a)]['find'](_0x3444e2=>_0x3444e2['id']===_0x25bc8e);if(!_0x3dd9b7||!_0x776580)return;let _0x1cdfdb=null;const _0x588f84=_0x259c28[_0x35977c(0x291)]?.[_0x35977c(0x227)]?.[_0x35977c(0x336)]||_0x259c28['item']?.[_0x35977c(0x3b1)](_0x35977c(0x29b))?.[_0x35977c(0x227)]?.[_0x35977c(0x336)];if(_0x588f84){const _0x831d48=_0x3dd9b7[_0x35977c(0x25c)][_0x35977c(0x34c)](_0x18d0be=>_0x18d0be['id']===_0x588f84);if(_0x831d48>=0x0)_0x1cdfdb=_0x3dd9b7[_0x35977c(0x25c)][_0x35977c(0x307)](_0x831d48,0x1)[0x0];}!_0x1cdfdb&&(_0x1cdfdb=_0x3dd9b7['subtopics'][_0x35977c(0x307)](_0x259c28[_0x35977c(0x491)],0x1)[0x0]);if(!_0x1cdfdb)return;_0x1cdfdb[_0x35977c(0x459)]=_0x776580['id'],_0x776580[_0x35977c(0x25c)][_0x35977c(0x307)](_0x259c28['newIndex'],0x0,_0x1cdfdb),data['settings']['selectedSubtopicId']===_0x1cdfdb['id']&&(data[_0x35977c(0x476)][_0x35977c(0x4d9)]=_0x776580['id']),await saveData(),renderTopics();}});});}}}function selectSubtopic(_0x5a43eb,_0x2ab29f){const _0x3c1547=_0x36046b,_0x43fe89=$('.app-content'),_0x5c9f0f=getCurrentSubtopic();_0x5c9f0f&&timer[_0x3c1547(0x392)]!==_0x3c1547(0x3cf)&&(_0x5c9f0f[_0x3c1547(0x387)]={'state':timer[_0x3c1547(0x392)],'prevState':timer[_0x3c1547(0x357)],'remaining':timer['remaining'],'segmentTotal':timer[_0x3c1547(0x37a)],'cycleIndex':timer[_0x3c1547(0x4a0)]}),_0x43fe89[_0x3c1547(0x3fa)][_0x3c1547(0x478)](_0x3c1547(0x3b4)),setTimeout(async()=>{const _0x3c19c0=_0x3c1547;data[_0x3c19c0(0x476)][_0x3c19c0(0x4d9)]=_0x5a43eb,data[_0x3c19c0(0x476)][_0x3c19c0(0x362)]=_0x2ab29f;const _0x18f734=getCurrentSubtopic();_0x18f734['timerState']?(timer['state']=_0x18f734[_0x3c19c0(0x387)][_0x3c19c0(0x392)],timer[_0x3c19c0(0x357)]=_0x18f734[_0x3c19c0(0x387)][_0x3c19c0(0x357)]||null,timer[_0x3c19c0(0x1ed)]=_0x18f734['timerState'][_0x3c19c0(0x1ed)],timer[_0x3c19c0(0x37a)]=_0x18f734[_0x3c19c0(0x387)][_0x3c19c0(0x37a)],timer['cycleIndex']=_0x18f734[_0x3c19c0(0x387)][_0x3c19c0(0x4a0)]):timer[_0x3c19c0(0x44a)](),await saveData(),timer[_0x3c19c0(0x40e)](),renderAll(),switchView(_0x3c19c0(0x310)),_0x43fe89['classList'][_0x3c19c0(0x30e)](_0x3c19c0(0x3b4));},0xc8);}function getCurrentSubtopic(){const _0x227b9e=_0x36046b,_0x4b23e6=data[_0x227b9e(0x476)][_0x227b9e(0x4d9)],_0x4c417c=data[_0x227b9e(0x476)][_0x227b9e(0x362)];if(!_0x4b23e6||!_0x4c417c)return null;const _0x3b30ba=data[_0x227b9e(0x20a)][_0x227b9e(0x21f)](_0x44dcae=>_0x44dcae['id']===_0x4b23e6);if(!_0x3b30ba)return null;return _0x3b30ba[_0x227b9e(0x25c)][_0x227b9e(0x21f)](_0x1ba9ce=>_0x1ba9ce['id']===_0x4c417c)||null;}function renderContextBadge(){const _0x352e2e=_0x36046b,_0x2ea48b=getCurrentSubtopic(),_0x15c210=_0x2ea48b?_0x2ea48b[_0x352e2e(0x2ff)]:_0x352e2e(0x20e),_0x196741=$(_0x352e2e(0x36b)),_0x109cfd=$(_0x352e2e(0x3b9)),_0x1b45f3=$('#currentSubtopicNameChat');if(_0x196741)_0x196741[_0x352e2e(0x2a4)]=_0x2ea48b?_0x352e2e(0x36f)+_0x2ea48b['name']:_0x352e2e(0x4e3);if(_0x109cfd)_0x109cfd['textContent']=_0x15c210;if(_0x1b45f3)_0x1b45f3[_0x352e2e(0x2a4)]=_0x15c210;}function renderSubtopicTasks(){const _0x328906=_0x36046b,_0x153a32=getCurrentSubtopic(),_0x100678=$(_0x328906(0x3a0)),_0x2b7fcf=$('#newSubtopicTaskInput');if(!_0x100678||!_0x2b7fcf)return;const _0x5a4220=_0x2b7fcf['parentElement'];if(!_0x153a32){_0x100678[_0x328906(0x3c3)]='<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Select\x20a\x20subtopic\x20to\x20view\x20the\x20to-do\x20list.</li>',_0x5a4220[_0x328906(0x3fa)][_0x328906(0x478)](_0x328906(0x454));return;}_0x5a4220[_0x328906(0x3fa)][_0x328906(0x30e)](_0x328906(0x454)),_0x100678[_0x328906(0x3c3)]='';const _0x5569f2=_0x153a32[_0x328906(0x2e1)]?_0x153a32[_0x328906(0x2e1)][_0x328906(0x1f9)](_0x2017bc=>!_0x2017bc[_0x328906(0x360)]):[];_0x5569f2[_0x328906(0x1e7)]===0x0&&(_0x100678[_0x328906(0x3c3)]='<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Great!\x20No\x20tasks\x20left.</li>'),_0x5569f2[_0x328906(0x229)](_0x96386=>{const _0x5594d5=_0x328906,_0x31485a=document['createElement']('li');_0x31485a[_0x5594d5(0x3c3)]='<input\x20type=\x22checkbox\x22\x20id=\x22'+_0x96386['id']+'\x22\x20title=\x22Complete\x20task\x22>\x20<label\x20for=\x22'+_0x96386['id']+'\x22>'+escapeHTML(_0x96386[_0x5594d5(0x268)])+_0x5594d5(0x35f),_0x31485a[_0x5594d5(0x3b1)](_0x5594d5(0x3f3))['addEventListener'](_0x5594d5(0x23f),_0x3c0b93=>toggleSubtopicTask(_0x3c0b93['target']['id'],_0x31485a)),_0x100678[_0x5594d5(0x406)](_0x31485a);});}async function addSubtopicTask(){const _0x5ca521=_0x36046b,_0x1a2bb2=getCurrentSubtopic();if(!_0x1a2bb2){toast(t(_0x5ca521(0x3b8)));return;}const _0x1d8466=$(_0x5ca521(0x2cb)),_0x2dd5ef=_0x1d8466[_0x5ca521(0x327)][_0x5ca521(0x4dd)]();if(_0x2dd5ef){if(!_0x1a2bb2[_0x5ca521(0x2e1)])_0x1a2bb2[_0x5ca521(0x2e1)]=[];_0x1a2bb2[_0x5ca521(0x2e1)][_0x5ca521(0x298)]({'id':uid(_0x5ca521(0x3ac)),'text':_0x2dd5ef,'isCompleted':![],'createdAt':todayISO()}),await saveData(),renderSubtopicTasks(),_0x1d8466['value']='';}_0x1d8466['focus']();}async function toggleSubtopicTask(_0x51c49b,_0x4050f9){const _0x2af2f5=_0x36046b,_0x47d2d1=getCurrentSubtopic();if(!_0x47d2d1||!_0x47d2d1[_0x2af2f5(0x2e1)])return;const _0x20b3bc=_0x47d2d1[_0x2af2f5(0x2e1)][_0x2af2f5(0x21f)](_0x7feff6=>_0x7feff6['id']===_0x51c49b);_0x20b3bc&&(_0x20b3bc[_0x2af2f5(0x360)]=!![],_0x47d2d1['stats']['tasksCompleted']=(_0x47d2d1['stats'][_0x2af2f5(0x2d1)]||0x0)+0x1,await saveData(),_0x4050f9['classList'][_0x2af2f5(0x478)](_0x2af2f5(0x300)),setTimeout(()=>{renderSubtopicTasks(),renderStatsHistory();},0xc8));}const timer={'state':'idle','prevState':null,'tickHandle':null,'endAt':null,'remaining':0x0,'segmentTotal':0x0,'cyclesTarget':0x4,'cycleIndex':0x0,'mode':'A','persistInterval':0x3c*0x3e8,'lastPersist':0x0,async 'setPreset'(_0x3ad5d0,{silent:silent=![]}={}){const _0x2f445a=_0x36046b,_0xf60605=data[_0x2f445a(0x476)];this[_0x2f445a(0x480)]=_0x3ad5d0,this[_0x2f445a(0x314)]=_0x3ad5d0==='A'?_0xf60605[_0x2f445a(0x413)]:_0x3ad5d0==='B'?_0xf60605['cyclesB']:0x0,_0xf60605['preset']=_0x3ad5d0,await saveData(),this[_0x2f445a(0x392)]==='idle'&&this[_0x2f445a(0x44a)]();},'currentDurations'(){const _0x33ad50=_0x36046b,_0x2b237a=data['settings'][_0x33ad50(0x370)];if(this[_0x33ad50(0x480)]==='A')return{'work':_0x2b237a[_0x33ad50(0x4da)],'short':_0x2b237a[_0x33ad50(0x342)],'long':_0x2b237a['A_long'],'winddown':_0x2b237a[_0x33ad50(0x398)]??0x0};if(this[_0x33ad50(0x480)]==='B')return{'work':_0x2b237a['B_work'],'short':_0x2b237a[_0x33ad50(0x24d)],'long':_0x2b237a[_0x33ad50(0x4de)],'winddown':_0x2b237a['B_winddown']??0x0};return{'work':0x0,'short':0x0,'long':0x0,'winddown':0x0};},'currentConfig'(){const _0x2bac98=_0x36046b,_0x47ff6e=data[_0x2bac98(0x476)];if(this['mode']==='A')return{'cycles':_0x47ff6e[_0x2bac98(0x413)],'interval':_0x47ff6e[_0x2bac98(0x4b8)]};if(this['mode']==='B')return{'cycles':_0x47ff6e[_0x2bac98(0x301)],'interval':_0x47ff6e['longBreakIntervalB']};return{'cycles':0x0,'interval':0x0};},'updateUI'(){const _0x497231=_0x36046b,_0x1b4c18=$('#stateBadge'),_0x43593c=$(_0x497231(0x1d7)),_0x35a7e0=$(_0x497231(0x42d));if(!_0x1b4c18||!_0x43593c||!_0x35a7e0)return;const _0x5b4911=this[_0x497231(0x480)]==='C';$(_0x497231(0x257))[_0x497231(0x3fa)][_0x497231(0x4c3)](_0x497231(0x454),this[_0x497231(0x392)]!==_0x497231(0x3cf)||_0x5b4911&&this[_0x497231(0x392)]===_0x497231(0x252)),$(_0x497231(0x411))[_0x497231(0x3fa)][_0x497231(0x4c3)](_0x497231(0x454),!(_0x5b4911&&this[_0x497231(0x392)]==='work')),$(_0x497231(0x46e))[_0x497231(0x3fa)][_0x497231(0x4c3)](_0x497231(0x454),!['work',_0x497231(0x331),_0x497231(0x209)][_0x497231(0x3f9)](this[_0x497231(0x392)])),$(_0x497231(0x3b3))[_0x497231(0x3fa)]['toggle'](_0x497231(0x454),this[_0x497231(0x392)]!=='paused');let _0x2c87ee=_0x497231(0x3da);if(this[_0x497231(0x392)]===_0x497231(0x252))_0x1b4c18[_0x497231(0x2a4)]=_0x5b4911?_0x497231(0x39b):_0x497231(0x33b),_0x1b4c18['className']='badge\x20state\x20work',_0x2c87ee='var(--acc)';else{if(this[_0x497231(0x392)]==='break')_0x1b4c18[_0x497231(0x2a4)]='SHORT\x20BREAK',_0x1b4c18[_0x497231(0x4b1)]=_0x497231(0x2c2),_0x2c87ee=_0x497231(0x217);else{if(this['state']===_0x497231(0x209))_0x1b4c18[_0x497231(0x2a4)]=_0x497231(0x2af),_0x1b4c18[_0x497231(0x4b1)]=_0x497231(0x2bd),_0x2c87ee='var(--danger)';else{if(this[_0x497231(0x392)]===_0x497231(0x2e4)){_0x1b4c18[_0x497231(0x2a4)]=_0x497231(0x3c1),_0x1b4c18[_0x497231(0x4b1)]=_0x497231(0x27c),_0x2c87ee=_0x497231(0x3a3);try{$(_0x497231(0x206))[_0x497231(0x3fa)]['remove'](_0x497231(0x454)),$(_0x497231(0x3db))['classList'][_0x497231(0x30e)]('hidden');}catch(_0x15d132){}}else this['state']===_0x497231(0x3a6)?(_0x1b4c18[_0x497231(0x2a4)]=_0x497231(0x334),_0x1b4c18[_0x497231(0x4b1)]='badge'):(_0x1b4c18[_0x497231(0x2a4)]=_0x497231(0x4dc),_0x1b4c18[_0x497231(0x4b1)]=_0x497231(0x273));}}}[_0x497231(0x252),_0x497231(0x331),_0x497231(0x209),_0x497231(0x2e4)][_0x497231(0x3f9)](this['state'])?_0x35a7e0[_0x497231(0x3fa)][_0x497231(0x478)](_0x497231(0x484)):_0x35a7e0['classList']['remove'](_0x497231(0x484));_0x43593c['style'][_0x497231(0x4a1)]=_0x2c87ee,_0x35a7e0[_0x497231(0x3fa)]['remove'](_0x497231(0x404));const _0xa9a642=$(_0x497231(0x33f));if(_0xa9a642)_0xa9a642[_0x497231(0x2a4)]=formatMMSS(this[_0x497231(0x1ed)]);const _0x44349f=_0x43593c['r']['baseVal']['value'],_0x211887=0x2*Math['PI']*_0x44349f,_0x57833d=this[_0x497231(0x37a)]>0x0?_0x211887-this[_0x497231(0x1ed)]/this[_0x497231(0x37a)]*_0x211887:_0x211887;_0x43593c[_0x497231(0x335)][_0x497231(0x4a4)]=_0x211887,_0x43593c[_0x497231(0x335)][_0x497231(0x277)]=isNaN(_0x57833d)?_0x211887:_0x57833d;const _0x3d0cd4=$(_0x497231(0x308));if(_0x3d0cd4){const _0x2710e9=this[_0x497231(0x23d)]();_0x3d0cd4[_0x497231(0x2a4)]=t(_0x497231(0x25d),{'current':this[_0x497231(0x4a0)],'target':_0x2710e9['cycles']}),_0x3d0cd4[_0x497231(0x3fa)][_0x497231(0x4c3)]('hidden',_0x5b4911);}const _0x19ec20=$('#breakSuggestionDisplay');_0x19ec20&&_0x19ec20['classList']['toggle']('hidden',_0x5b4911&&this[_0x497231(0x392)]===_0x497231(0x252));const _0xf5081b=$(_0x497231(0x2cd));if(_0xf5081b)_0xf5081b[_0x497231(0x2a4)]=formatMMSS(this[_0x497231(0x1ed)]);if(this[_0x497231(0x392)]!==_0x497231(0x2e4))try{$('#windDownChecklist')[_0x497231(0x3fa)][_0x497231(0x478)](_0x497231(0x454)),$(_0x497231(0x3db))[_0x497231(0x3fa)][_0x497231(0x478)](_0x497231(0x454));}catch(_0x2ff698){}},'persistTimerState'(_0x2adb52=![]){const _0x393540=_0x36046b;try{const _0x56c69f=getCurrentSubtopic();if(!_0x56c69f)return;const _0x1d4775={'state':this[_0x393540(0x392)],'prevState':this[_0x393540(0x357)],'remaining':this[_0x393540(0x1ed)],'segmentTotal':this[_0x393540(0x37a)],'cycleIndex':this[_0x393540(0x4a0)]};_0x56c69f[_0x393540(0x387)]=_0x1d4775;try{localStorage[_0x393540(0x45b)](_0x393540(0x3e1)+_0x56c69f['id'],JSON[_0x393540(0x3dd)](_0x1d4775));}catch(_0x3db8e8){}this['lastPersist']=Date[_0x393540(0x31e)]();}catch(_0x1438fb){}},'_startTick'(){const _0x57fb21=_0x36046b;if(this[_0x57fb21(0x3e5)])clearInterval(this[_0x57fb21(0x3e5)]);if(this[_0x57fb21(0x480)]==='C'&&this['state']===_0x57fb21(0x252)){this[_0x57fb21(0x3e5)]=setInterval(()=>{const _0x107940=_0x57fb21;this[_0x107940(0x1ed)]+=0x1,this[_0x107940(0x40e)](),this[_0x107940(0x492)]();},0x3e8);return;}this['tickHandle']=setInterval(()=>{const _0x1d964b=_0x57fb21;this[_0x1d964b(0x1ed)]>0x0&&(this['remaining']-=0x1,this[_0x1d964b(0x40e)](),this[_0x1d964b(0x492)]()),this[_0x1d964b(0x1ed)]<=0x0&&(clearInterval(this[_0x1d964b(0x3e5)]),this[_0x1d964b(0x3e5)]=null,this['_onFinishSegment']());},0x3e8);},'_onFinishSegment'(){const _0xffc451=_0x36046b;if(this[_0xffc451(0x392)]===_0xffc451(0x252)){const _0x3e0982=getCurrentSubtopic();if(_0x3e0982){const _0xf0719c=this[_0xffc451(0x3f7)]()['work'];_0x3e0982[_0xffc451(0x4d2)][_0xffc451(0x4c0)]=(_0x3e0982[_0xffc451(0x4d2)][_0xffc451(0x4c0)]||0x0)+_0xf0719c,_0x3e0982['stats'][_0xffc451(0x262)]=(_0x3e0982[_0xffc451(0x4d2)][_0xffc451(0x262)]||0x0)+0x1;const _0x101089={'id':uid(_0xffc451(0x2a7)),'dateISO':todayISO(),'durationMinutes':_0xf0719c,'mode':this[_0xffc451(0x480)],'note':''};if(!_0x3e0982[_0xffc451(0x351)])_0x3e0982[_0xffc451(0x351)]=[];_0x3e0982[_0xffc451(0x351)][_0xffc451(0x416)](_0x101089);if(data?.[_0xffc451(0x476)]?.[_0xffc451(0x44d)])try{openNoteModal(_0x101089['id']);}catch(_0x3fc3fb){}saveData(),renderStatsHistory(),checkAndShowMilestones();}this[_0xffc451(0x4a0)]++;}if(typeof data!==_0xffc451(0x29d)&&data&&data[_0xffc451(0x476)]&&data['settings'][_0xffc451(0x403)]===![]&&this[_0xffc451(0x392)]===_0xffc451(0x252))playSound('work_end');else(this[_0xffc451(0x392)]==='wind_down'||this[_0xffc451(0x392)]===_0xffc451(0x331)||this[_0xffc451(0x392)]==='long_break')&&playSound(_0xffc451(0x31c));const _0x1efdd9=$('.timer-circle-container');if(_0x1efdd9)_0x1efdd9[_0xffc451(0x3fa)][_0xffc451(0x478)](_0xffc451(0x404));if(data['settings'][_0xffc451(0x373)]){if(this['state']===_0xffc451(0x252))data[_0xffc451(0x476)][_0xffc451(0x403)]===![]?this['beginBreak']():this[_0xffc451(0x2b3)]();else this[_0xffc451(0x392)]===_0xffc451(0x2e4)?this[_0xffc451(0x23b)]():this[_0xffc451(0x4e4)]();}else this[_0xffc451(0x3e5)]&&(clearInterval(this[_0xffc451(0x3e5)]),this[_0xffc451(0x3e5)]=null),this[_0xffc451(0x392)]=_0xffc451(0x3cf),this['prevState']=null,this[_0xffc451(0x40e)](),toast(_0xffc451(0x33c));},'beginWindDown'(){const _0x39c028=_0x36046b;if(data?.[_0x39c028(0x476)]?.[_0x39c028(0x403)]===![]){this[_0x39c028(0x23b)]();return;}this[_0x39c028(0x357)]=this['state'],this['state']=_0x39c028(0x2e4);const _0x3f3dec=(this[_0x39c028(0x3f7)]()[_0x39c028(0x38c)]||0x0)*0x3c;if(_0x3f3dec<=0x0){this[_0x39c028(0x23b)]();return;}this['segmentTotal']=_0x3f3dec,this[_0x39c028(0x1ed)]=_0x3f3dec;try{playSound(_0x39c028(0x31c));}catch(_0x531028){}try{toast(_0x39c028(0x297));}catch(_0x236ab0){}this[_0x39c028(0x32d)](),this[_0x39c028(0x40e)]();},'beginWork'(){const _0x449c5b=_0x36046b;this[_0x449c5b(0x357)]=this[_0x449c5b(0x392)],this['state']=_0x449c5b(0x252);if(this[_0x449c5b(0x480)]==='C'){this[_0x449c5b(0x37a)]=0x0;if(this[_0x449c5b(0x357)]!=='paused')this[_0x449c5b(0x1ed)]=0x0;}else{const _0x226862=this[_0x449c5b(0x3f7)]()[_0x449c5b(0x252)]*0x3c;this[_0x449c5b(0x37a)]=_0x226862;if(this[_0x449c5b(0x357)]!==_0x449c5b(0x3a6))this[_0x449c5b(0x1ed)]=_0x226862;}const _0x181304=$(_0x449c5b(0x39f));_0x181304&&(_0x181304[_0x449c5b(0x2a4)]=''),this['_startTick'](),this['updateUI']();},'finishFlowSession'(){const _0x88886f=_0x36046b;if(this[_0x88886f(0x480)]!=='C'||this[_0x88886f(0x392)]!==_0x88886f(0x252))return;this[_0x88886f(0x3e5)]&&(clearInterval(this[_0x88886f(0x3e5)]),this[_0x88886f(0x3e5)]=null);const _0xdba696=Math[_0x88886f(0x4ab)](0x1,parseInt(data[_0x88886f(0x476)][_0x88886f(0x2d9)]??0x5,0xa)),_0x371a39=Math[_0x88886f(0x4ab)](0x0,this[_0x88886f(0x1ed)]|0x0),_0x369443=Math[_0x88886f(0x4ab)](0x3c,Math[_0x88886f(0x1f4)](_0x371a39/_0xdba696));try{const _0x6a3a30=getCurrentSubtopic();if(_0x6a3a30){const _0x25ca4b=Math['max'](0x1,Math[_0x88886f(0x25e)](_0x371a39/0x3c));_0x6a3a30[_0x88886f(0x4d2)][_0x88886f(0x4c0)]=(_0x6a3a30[_0x88886f(0x4d2)]['totalMinutes']||0x0)+_0x25ca4b,_0x6a3a30[_0x88886f(0x4d2)][_0x88886f(0x262)]=(_0x6a3a30['stats'][_0x88886f(0x262)]||0x0)+0x1;const _0x222bdd={'id':uid(_0x88886f(0x2a7)),'dateISO':todayISO(),'durationMinutes':_0x25ca4b,'mode':this['mode'],'note':''};if(!_0x6a3a30[_0x88886f(0x351)])_0x6a3a30[_0x88886f(0x351)]=[];_0x6a3a30['sessions'][_0x88886f(0x416)](_0x222bdd),saveData(),renderStatsHistory(),data?.[_0x88886f(0x476)]?.[_0x88886f(0x44d)]&&openNoteModal(_0x222bdd['id']);}}catch(_0x1f6d3c){}this[_0x88886f(0x392)]=_0x88886f(0x331),this[_0x88886f(0x37a)]=_0x369443,this[_0x88886f(0x1ed)]=_0x369443,this[_0x88886f(0x32d)](),this[_0x88886f(0x40e)](),this['persistTimerState'](!![]);try{toast(_0x88886f(0x3d2)+Math[_0x88886f(0x25e)](_0x369443/0x3c)+_0x88886f(0x460)+_0xdba696+').');}catch(_0x5605ad){}},'beginBreak'(){const _0x190762=_0x36046b;this[_0x190762(0x357)]=this[_0x190762(0x392)];const _0x2d0040=this[_0x190762(0x23d)](),_0x35d19e=this[_0x190762(0x3f7)]();if(this[_0x190762(0x4a0)]>0x0&&this['cycleIndex']%_0x2d0040[_0x190762(0x42b)]===0x0){this[_0x190762(0x392)]=_0x190762(0x209);const _0xfe6c68=_0x35d19e[_0x190762(0x3ee)]*0x3c;this[_0x190762(0x37a)]=_0xfe6c68;if(this[_0x190762(0x357)]!==_0x190762(0x3a6))this[_0x190762(0x1ed)]=_0xfe6c68;toast(_0x190762(0x429));}else{this[_0x190762(0x392)]=_0x190762(0x331);const _0xde5806=_0x35d19e[_0x190762(0x2d8)]*0x3c;this['segmentTotal']=_0xde5806;if(this['prevState']!=='paused')this[_0x190762(0x1ed)]=_0xde5806;}const _0x42ce7f=$(_0x190762(0x39f));if(_0x42ce7f){const _0x2704a0=Math[_0x190762(0x1f4)](Math[_0x190762(0x326)]()*breakSuggestions['length']);_0x42ce7f['textContent']=_0x190762(0x2b9)+breakSuggestions[_0x2704a0];}this[_0x190762(0x32d)](),this[_0x190762(0x40e)]();},async 'start'(){const _0x2ed56b=_0x36046b;if(!getCurrentSubtopic()){toast(_0x2ed56b(0x414));return;}ensureAudio();if(this[_0x2ed56b(0x480)]==='C'&&this[_0x2ed56b(0x392)]==='idle')this[_0x2ed56b(0x392)]=_0x2ed56b(0x252),this['remaining']=0x0,this[_0x2ed56b(0x37a)]=0x0,this[_0x2ed56b(0x4a0)]=0x0,this[_0x2ed56b(0x32d)](),this[_0x2ed56b(0x40e)]();else{if(this[_0x2ed56b(0x392)]==='idle')this[_0x2ed56b(0x4a0)]=this['cycleIndex']||0x0,this[_0x2ed56b(0x4e4)]();else this['state']===_0x2ed56b(0x3a6)&&this[_0x2ed56b(0x221)]();}await this[_0x2ed56b(0x492)](!![]);},async 'pause'(){const _0x224367=_0x36046b;this['tickHandle']&&(clearInterval(this[_0x224367(0x3e5)]),this[_0x224367(0x3e5)]=null),this['prevState']=this[_0x224367(0x392)],this['state']='paused',this[_0x224367(0x40e)](),await this[_0x224367(0x492)](!![]);},async 'resume'(){const _0x43d802=_0x36046b;if(this[_0x43d802(0x392)]!==_0x43d802(0x3a6))return;this[_0x43d802(0x392)]=this[_0x43d802(0x357)]||'work',this['_startTick'](),this[_0x43d802(0x40e)](),await this[_0x43d802(0x492)](!![]);},async 'skip'(){const _0x3e790a=_0x36046b;if(this[_0x3e790a(0x480)]==='C'&&this[_0x3e790a(0x392)]===_0x3e790a(0x252)){this[_0x3e790a(0x25b)](),await this[_0x3e790a(0x492)](!![]);return;}this[_0x3e790a(0x392)]===_0x3e790a(0x252)?(this[_0x3e790a(0x3e5)]&&(clearInterval(this['tickHandle']),this[_0x3e790a(0x3e5)]=null),this[_0x3e790a(0x1ed)]=0x0,this[_0x3e790a(0x347)]()):(this['remaining']=0x0,this[_0x3e790a(0x3e5)]&&(clearInterval(this[_0x3e790a(0x3e5)]),this['tickHandle']=null),this[_0x3e790a(0x347)]()),await this[_0x3e790a(0x492)](!![]);},async 'reset'(){const _0x46d6d5=_0x36046b;this[_0x46d6d5(0x3e5)]&&(clearInterval(this[_0x46d6d5(0x3e5)]),this[_0x46d6d5(0x3e5)]=null);this['state']=_0x46d6d5(0x3cf),this[_0x46d6d5(0x357)]=null,this[_0x46d6d5(0x1ed)]=0x0,this['segmentTotal']=0x0,this[_0x46d6d5(0x4a0)]=0x0;const _0x3f8c1d=$(_0x46d6d5(0x39f));_0x3f8c1d&&(_0x3f8c1d[_0x46d6d5(0x2a4)]=''),this[_0x46d6d5(0x40e)](),await this[_0x46d6d5(0x492)](!![]);}};async function deleteSummary(_0x7dec9d){showConfirmModal('Confirm\x20Deletion','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20summary?',async _0x3120c1=>{const _0x4a21df=_0x365d;if(!_0x3120c1)return;const _0x26472c=getCurrentSubtopic();if(!_0x26472c||!_0x26472c[_0x4a21df(0x2c8)])return;const _0x1acb17=[..._0x26472c[_0x4a21df(0x2c8)]];_0x26472c['summaries']=_0x26472c[_0x4a21df(0x2c8)]['filter'](_0x14724f=>_0x14724f['id']!==_0x7dec9d);try{await storageManager['update'](_0x4a21df(0x25c),_0x26472c),renderSummaries(),toast(_0x4a21df(0x457));}catch(_0x133f17){console[_0x4a21df(0x4ad)](_0x4a21df(0x3f4),_0x133f17),_0x26472c[_0x4a21df(0x2c8)]=_0x1acb17,toast(_0x4a21df(0x24a));}});}function exportSummary(_0x1dacc6){const _0x35b9d7=_0x36046b,_0x5c8b20=new Blob([_0x1dacc6[_0x35b9d7(0x333)]],{'type':_0x35b9d7(0x3ff)}),_0x4e1b78=document['createElement']('a'),_0x404340=new Date(_0x1dacc6[_0x35b9d7(0x41b)]),_0x34a47c=_0x36d91d=>(''+_0x36d91d)[_0x35b9d7(0x4af)](0x2,'0');_0x4e1b78[_0x35b9d7(0x2fe)]=URL[_0x35b9d7(0x323)](_0x5c8b20),_0x4e1b78[_0x35b9d7(0x483)]=_0x35b9d7(0x238)+_0x404340[_0x35b9d7(0x386)]()+_0x34a47c(_0x404340['getMonth']()+0x1)+_0x34a47c(_0x404340[_0x35b9d7(0x2ce)]())+_0x35b9d7(0x309),_0x4e1b78[_0x35b9d7(0x3ef)](),URL[_0x35b9d7(0x2c9)](_0x4e1b78[_0x35b9d7(0x2fe)]);}function renderStatsHistory(){const _0x2e0d40=_0x36046b,_0x48d6e8=getCurrentSubtopic(),_0x439d20=$('#statTotal'),_0x2740cc=$(_0x2e0d40(0x4c9)),_0xd1b09f=$(_0x2e0d40(0x381)),_0x15ee39=$('#historyList');if(!_0x439d20||!_0x2740cc||!_0xd1b09f||!_0x15ee39)return;if(!_0x48d6e8){_0x439d20[_0x2e0d40(0x2a4)]='0\x20min',_0x2740cc[_0x2e0d40(0x2a4)]='0',_0xd1b09f['textContent']='0',_0x15ee39['innerHTML']=_0x2e0d40(0x1e1);return;}const _0x11c970=_0x48d6e8[_0x2e0d40(0x4d2)]&&_0x48d6e8[_0x2e0d40(0x4d2)][_0x2e0d40(0x4c0)]?_0x48d6e8[_0x2e0d40(0x4d2)][_0x2e0d40(0x4c0)]:0x0,_0x26577d=_0x48d6e8[_0x2e0d40(0x4d2)]&&_0x48d6e8['stats'][_0x2e0d40(0x262)]?_0x48d6e8[_0x2e0d40(0x4d2)][_0x2e0d40(0x262)]:0x0,_0x26de94=_0x48d6e8['tasks']?_0x48d6e8[_0x2e0d40(0x2e1)]['filter'](_0x20fdca=>_0x20fdca[_0x2e0d40(0x360)])[_0x2e0d40(0x1e7)]:0x0;_0x439d20[_0x2e0d40(0x2a4)]=formatDaysHoursMinutes(_0x11c970),_0x2740cc['textContent']=String(_0x26577d),_0xd1b09f['textContent']=String(_0x26de94),_0x15ee39[_0x2e0d40(0x3c3)]='';const _0x38dded=Array[_0x2e0d40(0x4c7)](_0x48d6e8[_0x2e0d40(0x351)])?_0x48d6e8['sessions']:[];if(_0x38dded[_0x2e0d40(0x1e7)]===0x0){_0x15ee39[_0x2e0d40(0x3c3)]='<div\x20class=\x22tiny\x22>No\x20sessions\x20yet</div>';return;}_0x38dded[_0x2e0d40(0x229)](_0x1c0290=>{const _0x29e249=_0x2e0d40,_0x5e6f52=document[_0x29e249(0x1da)](_0x29e249(0x4ac));_0x5e6f52[_0x29e249(0x4b1)]=_0x29e249(0x2fd);const _0x2149d8=document[_0x29e249(0x1da)](_0x29e249(0x4ac)),_0x189dce=_0x1c0290['dateISO']?new Date(_0x1c0290[_0x29e249(0x452)]):new Date(),_0x1dec7a=_0x1c0290[_0x29e249(0x40b)]!=null?_0x1c0290['durationMinutes']:_0x1c0290[_0x29e249(0x1fa)]||0x0,_0x14c1ac=_0x29e249(0x497)+_0x189dce[_0x29e249(0x475)]()+_0x29e249(0x473)+_0x1dec7a+_0x29e249(0x3f2)+(_0x1c0290[_0x29e249(0x480)]||'')+_0x29e249(0x438);let _0x145cf1='';if(_0x1c0290[_0x29e249(0x458)])_0x145cf1='<div>'+escapeHTML(_0x1c0290[_0x29e249(0x458)])+_0x29e249(0x438);else data?.[_0x29e249(0x476)]?.[_0x29e249(0x44d)]&&(_0x145cf1=_0x29e249(0x27b));_0x2149d8[_0x29e249(0x3c3)]=_0x14c1ac+_0x145cf1,_0x5e6f52['appendChild'](_0x2149d8),_0x15ee39[_0x29e249(0x406)](_0x5e6f52);});}function renderGeneralNotes(){const _0x92bbf3=_0x36046b,_0x3ae5c3=$('#generalNotesList');if(!_0x3ae5c3)return;const _0x50ae92=getCurrentSubtopic();if(!_0x50ae92){_0x3ae5c3[_0x92bbf3(0x3c3)]='<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic.</div>';return;}_0x50ae92[_0x92bbf3(0x3ab)]=_0x50ae92['generalNotes']||[];if(_0x50ae92[_0x92bbf3(0x3ab)]['length']===0x0){_0x3ae5c3[_0x92bbf3(0x3c3)]=_0x92bbf3(0x44f);return;}_0x3ae5c3[_0x92bbf3(0x3c3)]='',_0x50ae92[_0x92bbf3(0x3ab)][_0x92bbf3(0x229)](_0x25cb01=>{const _0x52010f=_0x92bbf3,_0x37b3b3=document[_0x52010f(0x1da)]('div');_0x37b3b3[_0x52010f(0x4b1)]=_0x52010f(0x2b6);const _0x59b268=document['createElement'](_0x52010f(0x4ac));_0x59b268['className']=_0x52010f(0x44e),_0x59b268[_0x52010f(0x2a4)]=typeof _0x25cb01===_0x52010f(0x45f)?_0x25cb01:_0x25cb01[_0x52010f(0x268)]||'';const _0x552eb3=document[_0x52010f(0x1da)]('div');_0x552eb3[_0x52010f(0x4b1)]=_0x52010f(0x315),_0x552eb3[_0x52010f(0x2a4)]=_0x25cb01[_0x52010f(0x41b)]?new Date(_0x25cb01[_0x52010f(0x41b)])[_0x52010f(0x475)]():'';const _0x4c9e52=document['createElement'](_0x52010f(0x4ac)),_0x4ad5c7=document[_0x52010f(0x1da)]('button');_0x4ad5c7[_0x52010f(0x4b1)]='btn\x20small\x20danger',_0x4ad5c7[_0x52010f(0x2a4)]=_0x52010f(0x3d3),_0x4ad5c7[_0x52010f(0x251)]=async _0x6ec60d=>{const _0x300d55=_0x52010f;_0x6ec60d[_0x300d55(0x1e4)]();const _0x58e2ea=getCurrentSubtopic();if(!_0x58e2ea)return;_0x58e2ea[_0x300d55(0x3ab)]=(_0x58e2ea[_0x300d55(0x3ab)]||[])['filter'](_0x1ab637=>(_0x1ab637['id']||_0x1ab637)!==(_0x25cb01['id']||_0x25cb01)),await saveData(),renderGeneralNotes();},_0x4c9e52[_0x52010f(0x406)](_0x4ad5c7);const _0x24af3=document[_0x52010f(0x1da)](_0x52010f(0x4ac));_0x24af3['className']='note-content-wrapper',_0x24af3[_0x52010f(0x39d)](_0x59b268,_0x552eb3),_0x37b3b3[_0x52010f(0x39d)](_0x24af3,_0x4c9e52),_0x3ae5c3[_0x52010f(0x406)](_0x37b3b3);});}function renderMethods(){const _0x1c8662=_0x36046b,_0x593305=document[_0x1c8662(0x3b1)](_0x1c8662(0x2f8));if(!_0x593305)return;_0x593305[_0x1c8662(0x3c3)]='';const _0x32e065=getCurrentSubtopic();if(!_0x32e065){_0x593305['innerHTML']=_0x1c8662(0x3e2);return;}const _0x12f471=Array[_0x1c8662(0x4c7)](_0x32e065[_0x1c8662(0x1f7)])?_0x32e065['methods']:[];if(_0x12f471[_0x1c8662(0x1e7)]===0x0){_0x593305['innerHTML']=_0x1c8662(0x385);return;}_0x12f471['forEach'](_0x2ee352=>{const _0x1487e8=_0x1c8662,_0xb2f64b=document[_0x1487e8(0x1da)](_0x1487e8(0x203));_0xb2f64b['className']='method-item',_0xb2f64b['dataset'][_0x1487e8(0x464)]=_0x2ee352['id'];const _0x1f320c=document[_0x1487e8(0x1da)](_0x1487e8(0x33e)),_0x32d2cf=document[_0x1487e8(0x1da)]('span');_0x32d2cf[_0x1487e8(0x4b1)]=_0x1487e8(0x3d4),_0x32d2cf['textContent']=_0x2ee352[_0x1487e8(0x49b)]||'Untitled',_0x32d2cf['addEventListener'](_0x1487e8(0x3ef),_0x309d7d=>{const _0x480086=_0x1487e8;_0x309d7d[_0x480086(0x242)](),_0x309d7d['stopPropagation'](),_0xb2f64b['open']=!_0xb2f64b['open'];});const _0x2ea129=document['createElement'](_0x1487e8(0x4ac));_0x2ea129[_0x1487e8(0x4b1)]=_0x1487e8(0x21e);const _0x43c1be=document[_0x1487e8(0x1da)]('button');_0x43c1be[_0x1487e8(0x4b1)]=_0x1487e8(0x237),_0x43c1be[_0x1487e8(0x2a4)]=_0x1487e8(0x2b1),_0x43c1be[_0x1487e8(0x227)]['id']=_0x2ee352['id'];const _0x16b106=document[_0x1487e8(0x1da)](_0x1487e8(0x31d));_0x16b106[_0x1487e8(0x4b1)]=_0x1487e8(0x479),_0x16b106[_0x1487e8(0x2a4)]=_0x1487e8(0x3d3),_0x16b106['dataset']['id']=_0x2ee352['id'],_0x2ea129['append'](_0x43c1be,_0x16b106),_0x1f320c[_0x1487e8(0x39d)](_0x32d2cf,_0x2ea129);const _0x5e01bf=document[_0x1487e8(0x1da)](_0x1487e8(0x4ac));_0x5e01bf[_0x1487e8(0x4b1)]='method-content',_0x5e01bf[_0x1487e8(0x3c3)]=_0x2ee352[_0x1487e8(0x333)]||'',_0xb2f64b[_0x1487e8(0x39d)](_0x1f320c,_0x5e01bf),_0x593305['appendChild'](_0xb2f64b),_0xb2f64b['addEventListener'](_0x1487e8(0x3ef),_0x5b6ff1=>{const _0x585e17=_0x1487e8,_0x137a15=_0x5b6ff1[_0x585e17(0x2e7)];if(!_0x137a15)return;if(_0x137a15['closest'](_0x585e17(0x31d))||_0x137a15[_0x585e17(0x44c)]('a')||_0x137a15[_0x585e17(0x44c)](_0x585e17(0x489))||_0x137a15[_0x585e17(0x44c)](_0x585e17(0x443)))return;if(!_0xb2f64b[_0x585e17(0x30d)])_0xb2f64b[_0x585e17(0x30d)]=!![];});});const _0x11b6ca=_0x593305['querySelectorAll'](_0x1c8662(0x272));_0x11b6ca[_0x1c8662(0x229)](_0x64a1db=>{_0x64a1db['addEventListener']('toggle',()=>{_0x64a1db['open']&&_0x11b6ca['forEach'](_0x268ba7=>{const _0x16955e=_0x365d;if(_0x268ba7!==_0x64a1db)_0x268ba7[_0x16955e(0x30d)]=![];});});});}function addGeneralNote(){const _0x30dd3b=_0x36046b;showInputModal(_0x30dd3b(0x213),async _0x696801=>{const _0x3e4a84=_0x30dd3b;if(!_0x696801)return;const _0x53a29c=getCurrentSubtopic();if(!_0x53a29c){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}_0x53a29c[_0x3e4a84(0x3ab)]=_0x53a29c[_0x3e4a84(0x3ab)]||[],_0x53a29c[_0x3e4a84(0x3ab)][_0x3e4a84(0x416)]({'id':uid('gn'),'text':_0x696801,'createdAt':todayISO()}),await saveData(),renderGeneralNotes();},'');}async function summarizeNotes(){const _0x58763e=_0x36046b,_0x2045a9=getCurrentSubtopic();if(!_0x2045a9){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}const _0xf9fdfe=(_0x2045a9[_0x58763e(0x3ab)]||[])['map'](_0x4eb42c=>typeof _0x4eb42c===_0x58763e(0x45f)?_0x4eb42c:_0x4eb42c[_0x58763e(0x268)]||'')['filter'](Boolean);if(_0xf9fdfe[_0x58763e(0x1e7)]===0x0){toast(_0x58763e(0x200));return;}const _0x498416=$('#btnSummarize');_0x498416&&(_0x498416['disabled']=!![],_0x498416['innerHTML']=_0x58763e(0x2ae));try{const _0x5dad77='Summarize\x20the\x20following\x20notes\x20as\x20concise,\x20clear\x20bullet\x20points:\x0a\x0a'+_0xf9fdfe['join'](_0x58763e(0x397)),_0x533385=await callGeminiAPI(_0x5dad77);if(!_0x2045a9[_0x58763e(0x2c8)])_0x2045a9[_0x58763e(0x2c8)]=[];_0x2045a9[_0x58763e(0x2c8)][_0x58763e(0x416)]({'id':uid(_0x58763e(0x2db)),'content':_0x533385||_0x58763e(0x49d),'createdAt':todayISO()}),await saveData(),renderSummaries();}catch(_0x3cc8b1){console['error'](_0x3cc8b1),toast(_0x58763e(0x37b));}finally{_0x498416&&(_0x498416[_0x58763e(0x4e8)]=![],_0x498416[_0x58763e(0x2a4)]=_0x58763e(0x46d));}}function renderSummaries(){const _0x4a209c=_0x36046b,_0x1448d4=$('#summariesList');if(!_0x1448d4)return;const _0x3ae498=getCurrentSubtopic();if(!_0x3ae498){_0x1448d4['innerHTML']=_0x4a209c(0x1ea);return;}_0x1448d4['innerHTML']='';if(!_0x3ae498[_0x4a209c(0x2c8)]||_0x3ae498[_0x4a209c(0x2c8)][_0x4a209c(0x1e7)]===0x0){_0x1448d4[_0x4a209c(0x3c3)]=_0x4a209c(0x496);return;}_0x3ae498[_0x4a209c(0x2c8)][_0x4a209c(0x229)](_0x2a40cc=>{const _0x423817=_0x4a209c,_0x26e648=document[_0x423817(0x1da)](_0x423817(0x4ac));_0x26e648[_0x423817(0x4b1)]=_0x423817(0x2b6);const _0x4a82fe=document[_0x423817(0x1da)](_0x423817(0x4ac));_0x4a82fe[_0x423817(0x4b1)]='note-content-wrapper';const _0x1bc0eb=document['createElement'](_0x423817(0x4ac));_0x1bc0eb[_0x423817(0x4b1)]='note-content',_0x1bc0eb[_0x423817(0x2a4)]=_0x2a40cc['content'];const _0x25d39b=document['createElement'](_0x423817(0x4ac));_0x25d39b[_0x423817(0x4b1)]=_0x423817(0x315),_0x25d39b['textContent']=new Date(_0x2a40cc['createdAt'])['toLocaleString'](),_0x4a82fe[_0x423817(0x39d)](_0x1bc0eb,_0x25d39b);const _0x1c68f3=document[_0x423817(0x1da)](_0x423817(0x4ac)),_0x45a0a5=document[_0x423817(0x1da)](_0x423817(0x31d));_0x45a0a5[_0x423817(0x4b1)]=_0x423817(0x21d),_0x45a0a5[_0x423817(0x2a4)]='Export',_0x45a0a5['onclick']=_0x57b656=>{const _0x4039e6=_0x423817;_0x57b656[_0x4039e6(0x1e4)](),exportSummary(_0x2a40cc);};const _0x4e50e3=document[_0x423817(0x1da)]('button');_0x4e50e3[_0x423817(0x4b1)]=_0x423817(0x2fa),_0x4e50e3[_0x423817(0x2a4)]=_0x423817(0x3d3),_0x4e50e3[_0x423817(0x251)]=_0x39916d=>{const _0x4eed31=_0x423817;_0x39916d[_0x4eed31(0x1e4)](),deleteSummary(_0x2a40cc['id']);},_0x1c68f3[_0x423817(0x39d)](_0x45a0a5,_0x4e50e3),_0x26e648[_0x423817(0x39d)](_0x4a82fe,_0x1c68f3),_0x26e648[_0x423817(0x2f6)]('click',()=>_0x1bc0eb[_0x423817(0x3fa)][_0x423817(0x4c3)](_0x423817(0x37e))),_0x1448d4[_0x423817(0x406)](_0x26e648);});}function loadEditingPresetFields(){const _0x51cdf4=_0x36046b,_0x180691=data[_0x51cdf4(0x476)],_0x13cefc=_0x180691[_0x51cdf4(0x370)],_0x1af3c8=$(_0x51cdf4(0x421)),_0x5060db=$('#settings-flowtime');if(_0x1af3c8&&_0x5060db){const _0x157d15=editingPreset==='C';_0x1af3c8[_0x51cdf4(0x3fa)][_0x51cdf4(0x4c3)](_0x51cdf4(0x454),_0x157d15),_0x5060db[_0x51cdf4(0x3fa)][_0x51cdf4(0x4c3)](_0x51cdf4(0x454),!_0x157d15);}if(editingPreset==='A'){$(_0x51cdf4(0x305))['value']=_0x13cefc[_0x51cdf4(0x4da)];if($(_0x51cdf4(0x216)))$(_0x51cdf4(0x216))['value']=_0x13cefc['A_winddown']??0x0;$(_0x51cdf4(0x337))['value']=_0x13cefc[_0x51cdf4(0x342)],$(_0x51cdf4(0x46a))[_0x51cdf4(0x327)]=_0x13cefc[_0x51cdf4(0x28a)],$('#set_cycles')[_0x51cdf4(0x327)]=_0x180691['cyclesA'],$(_0x51cdf4(0x223))[_0x51cdf4(0x327)]=_0x180691[_0x51cdf4(0x4b8)];}else{if(editingPreset==='B'){$(_0x51cdf4(0x305))['value']=_0x13cefc[_0x51cdf4(0x234)];if($(_0x51cdf4(0x216)))$('#set_winddown')[_0x51cdf4(0x327)]=_0x13cefc[_0x51cdf4(0x2b7)]??0x0;$(_0x51cdf4(0x337))[_0x51cdf4(0x327)]=_0x13cefc[_0x51cdf4(0x24d)],$(_0x51cdf4(0x46a))['value']=_0x13cefc[_0x51cdf4(0x4de)],$(_0x51cdf4(0x265))[_0x51cdf4(0x327)]=_0x180691['cyclesB'],$(_0x51cdf4(0x223))[_0x51cdf4(0x327)]=_0x180691[_0x51cdf4(0x28b)];}else{if(editingPreset==='C'){const _0x14cf8c=$(_0x51cdf4(0x346));if(_0x14cf8c)_0x14cf8c[_0x51cdf4(0x327)]=_0x180691[_0x51cdf4(0x2d9)]??0x5;}}}}function highlightPresetSelector(){const _0x559bc1=_0x36046b;$$(_0x559bc1(0x2e9))[_0x559bc1(0x229)](_0x5a10f6=>{const _0xca436e=_0x559bc1,_0x5ca81a=_0x5a10f6[_0xca436e(0x227)][_0xca436e(0x41c)]===editingPreset;_0x5a10f6[_0xca436e(0x3fa)][_0xca436e(0x4c3)](_0xca436e(0x245),_0x5ca81a),_0x5a10f6[_0xca436e(0x3fa)][_0xca436e(0x4c3)](_0xca436e(0x2f3),!_0x5ca81a);});}function openSettings(){const _0x209f8d=_0x36046b,_0x7b8aa6=data['settings'];editingPreset=_0x7b8aa6[_0x209f8d(0x219)],$(_0x209f8d(0x38b))[_0x209f8d(0x327)]=_0x7b8aa6[_0x209f8d(0x43b)]||'',loadEditingPresetFields(),highlightPresetSelector(),$('#set_volume')[_0x209f8d(0x327)]=_0x7b8aa6[_0x209f8d(0x4df)]??0.8,$(_0x209f8d(0x415))[_0x209f8d(0x327)]=_0x7b8aa6[_0x209f8d(0x3e6)]||'beep',$('#set_theme_color')[_0x209f8d(0x327)]=_0x7b8aa6['theme']||_0x209f8d(0x208);const _0x3f0544=getActiveYoutubeUrl();$(_0x209f8d(0x285))[_0x209f8d(0x327)]=_0x3f0544||'';const _0x1edc85=extractYouTubeID(_0x3f0544);$(_0x209f8d(0x4a8))[_0x209f8d(0x4e8)]=!_0x1edc85;$(_0x209f8d(0x329))&&($(_0x209f8d(0x329))[_0x209f8d(0x2a4)]='');$('#ytSoundVolume')[_0x209f8d(0x327)]=_0x7b8aa6[_0x209f8d(0x423)]||0x50,$(_0x209f8d(0x247))[_0x209f8d(0x2a1)]=!!_0x7b8aa6[_0x209f8d(0x419)],$(_0x209f8d(0x43d))[_0x209f8d(0x327)]=_0x7b8aa6['panelOpacity']||0.85;$(_0x209f8d(0x3c5))&&($(_0x209f8d(0x3c5))['value']=_0x7b8aa6[_0x209f8d(0x2fc)]||'cover');$(_0x209f8d(0x2aa))&&($(_0x209f8d(0x2aa))[_0x209f8d(0x2a1)]=!!_0x7b8aa6[_0x209f8d(0x373)]);$(_0x209f8d(0x2f2))&&($(_0x209f8d(0x2f2))[_0x209f8d(0x2a1)]=_0x7b8aa6['enableWinddown']!==![]);$(_0x209f8d(0x4ce))&&($(_0x209f8d(0x4ce))[_0x209f8d(0x2a1)]=!!_0x7b8aa6[_0x209f8d(0x44d)]);$(_0x209f8d(0x46b))&&($(_0x209f8d(0x46b))[_0x209f8d(0x327)]=_0x7b8aa6['backupDaysToKeep']||0x7);const _0x4ef34d=$('#backupList');_0x4ef34d&&storageManager[_0x209f8d(0x38d)]()[_0x209f8d(0x472)](_0x3a9858=>{const _0xaf943e=_0x209f8d;_0x4ef34d[_0xaf943e(0x3c3)]=_0xaf943e(0x246),_0x3a9858&&_0x3a9858[_0xaf943e(0x1e7)]>0x0?_0x3a9858[_0xaf943e(0x229)](_0x2bc376=>{const _0x9d8d67=_0xaf943e,_0x7e364b=document[_0x9d8d67(0x1da)](_0x9d8d67(0x1d4));_0x7e364b[_0x9d8d67(0x327)]=_0x2bc376[_0x9d8d67(0x270)],_0x7e364b[_0x9d8d67(0x2a4)]='Backup\x20from:\x20'+new Date(_0x2bc376[_0x9d8d67(0x270)])[_0x9d8d67(0x3ea)](_0x9d8d67(0x29e)),_0x4ef34d[_0x9d8d67(0x406)](_0x7e364b);}):_0x4ef34d[_0xaf943e(0x3c3)]=_0xaf943e(0x2c1);});$('#modalSettings')[_0x209f8d(0x3fa)]['add'](_0x209f8d(0x3e9));try{trapFocus($(_0x209f8d(0x294)));}catch(_0x4e5417){}}function closeSettings(){const _0x1e90f2=_0x36046b;$(_0x1e90f2(0x294))[_0x1e90f2(0x3fa)]['remove']('show');try{releaseFocus();}catch(_0x2bf8e3){}}async function setDefaults(){const _0x53b705=_0x36046b;data['settings'][_0x53b705(0x370)]={'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},data[_0x53b705(0x476)][_0x53b705(0x413)]=0x4,data[_0x53b705(0x476)][_0x53b705(0x4b8)]=0x4,data[_0x53b705(0x476)][_0x53b705(0x301)]=0x4,data[_0x53b705(0x476)]['longBreakIntervalB']=0x4,data['settings']['flowtimeBreakRatio']=0x5,data[_0x53b705(0x476)][_0x53b705(0x219)]='A',data[_0x53b705(0x476)][_0x53b705(0x4df)]=0.8,data[_0x53b705(0x476)][_0x53b705(0x3e6)]=_0x53b705(0x2a6),await saveData(),openSettings(),toast(_0x53b705(0x4c4));}async function saveSettings(){const _0x5e0926=_0x36046b,_0x1ed265=data[_0x5e0926(0x476)];_0x1ed265['apiKey']=$(_0x5e0926(0x38b))[_0x5e0926(0x327)][_0x5e0926(0x4dd)]();const _0x57f911=_0x1ed265[_0x5e0926(0x370)];if(editingPreset==='A')_0x57f911[_0x5e0926(0x4da)]=clampInt($(_0x5e0926(0x305))['value'],0x1,0x3e7),_0x57f911['A_winddown']=clampInt($(_0x5e0926(0x216))[_0x5e0926(0x327)],0x0,0x3e7),_0x57f911[_0x5e0926(0x342)]=clampInt($(_0x5e0926(0x337))['value'],0x1,0x3e7),_0x57f911[_0x5e0926(0x28a)]=clampInt($(_0x5e0926(0x46a))[_0x5e0926(0x327)],0x1,0x3e7),_0x1ed265[_0x5e0926(0x413)]=clampInt($(_0x5e0926(0x265))[_0x5e0926(0x327)],0x1,0xc),_0x1ed265[_0x5e0926(0x4b8)]=clampInt($(_0x5e0926(0x223))[_0x5e0926(0x327)],0x2,0xc);else{if(editingPreset==='B')_0x57f911['B_work']=clampInt($('#set_work')[_0x5e0926(0x327)],0x1,0x3e7),_0x57f911[_0x5e0926(0x2b7)]=clampInt($(_0x5e0926(0x216))[_0x5e0926(0x327)],0x0,0x3e7),_0x57f911[_0x5e0926(0x24d)]=clampInt($(_0x5e0926(0x337))[_0x5e0926(0x327)],0x1,0x3e7),_0x57f911['B_long']=clampInt($(_0x5e0926(0x46a))['value'],0x1,0x3e7),_0x1ed265[_0x5e0926(0x301)]=clampInt($(_0x5e0926(0x265))[_0x5e0926(0x327)],0x1,0xc),_0x1ed265[_0x5e0926(0x28b)]=clampInt($(_0x5e0926(0x223))['value'],0x2,0xc);else{if(editingPreset==='C'){const _0xcd6296=$(_0x5e0926(0x346));if(_0xcd6296)_0x1ed265[_0x5e0926(0x2d9)]=clampInt(_0xcd6296['value'],0x1,0x14);}}}_0x1ed265[_0x5e0926(0x4df)]=clampFloat($(_0x5e0926(0x269))[_0x5e0926(0x327)],0x0,0x1,0.8),_0x1ed265['soundTheme']=$('#set_theme')[_0x5e0926(0x327)]==='chime'?'chime':_0x5e0926(0x2a6),_0x1ed265[_0x5e0926(0x4a5)]=$('#set_theme_color')[_0x5e0926(0x327)],_0x1ed265['panelOpacity']=parseFloat($(_0x5e0926(0x43d))[_0x5e0926(0x327)])||0.85;$(_0x5e0926(0x3c5))&&(_0x1ed265['backgroundMode']=$(_0x5e0926(0x3c5))[_0x5e0926(0x327)]);_0x1ed265['autoStartNext']=!!($('#set_autoStartNext')&&$('#set_autoStartNext')[_0x5e0926(0x2a1)]),_0x1ed265[_0x5e0926(0x403)]=!!($(_0x5e0926(0x2f2))&&$(_0x5e0926(0x2f2))[_0x5e0926(0x2a1)]),_0x1ed265[_0x5e0926(0x44d)]=!!($(_0x5e0926(0x4ce))&&$(_0x5e0926(0x4ce))[_0x5e0926(0x2a1)]);$(_0x5e0926(0x46b))&&(_0x1ed265[_0x5e0926(0x3a5)]=clampInt($(_0x5e0926(0x46b))['value'],0x1,0x1e));_0x1ed265[_0x5e0926(0x4a5)]==='light'||_0x1ed265[_0x5e0926(0x4a5)]===_0x5e0926(0x4c1)?(_0x1ed265[_0x5e0926(0x419)]=![],typeof _0x1ed265[_0x5e0926(0x1de)]===_0x5e0926(0x45f)&&_0x1ed265[_0x5e0926(0x1de)][_0x5e0926(0x3f9)](_0x5e0926(0x2a3))&&(_0x1ed265[_0x5e0926(0x1de)]='')):_0x1ed265[_0x5e0926(0x419)]=!![];const _0xf442c4=$(_0x5e0926(0x285))['value']['trim']();_0x1ed265['useYtThumbnailAsBg']=$(_0x5e0926(0x247))['checked'],_0x1ed265[_0x5e0926(0x423)]=parseInt($(_0x5e0926(0x4b2))[_0x5e0926(0x327)],0xa),sessionYoutubeUrl=_0xf442c4;try{if(!IS_FILE_PROTOCOL){if(ytPlayer&&ytPlayer[_0x5e0926(0x2d5)])ytPlayer['setVolume'](_0x1ed265[_0x5e0926(0x423)]);}else try{fallbackPostMessage(_0x5e0926(0x2d5),[_0x1ed265['youtubeVolume']]);}catch(_0x2fb5a2){}}catch(_0x40f9d6){}await saveData(),applyTheme(),applyCustomBg(),applyPanelOpacity(),updatePresetButtonsText(),timer[_0x5e0926(0x1f6)](_0x1ed265[_0x5e0926(0x219)],{'silent':!![]}),closeSettings(),toast(_0x5e0926(0x488));}function clampInt(_0x3e37e4,_0x19ea82,_0x12eb42){const _0x159600=_0x36046b;_0x3e37e4=parseInt(_0x3e37e4||0x0,0xa);if(isNaN(_0x3e37e4))_0x3e37e4=_0x19ea82;return Math[_0x159600(0x4ab)](_0x19ea82,Math[_0x159600(0x3bd)](_0x12eb42,_0x3e37e4));}function clampFloat(_0x27f413,_0x3f8726,_0x23874f,_0x206955){const _0x535840=_0x36046b;_0x27f413=parseFloat(_0x27f413);if(Number['isNaN'](_0x27f413))_0x27f413=_0x206955;return Math[_0x535840(0x4ab)](_0x3f8726,Math[_0x535840(0x3bd)](_0x23874f,_0x27f413));}const dbPromise=new Promise((_0x35c876,_0x27ede2)=>{const _0x190f20=_0x36046b,_0x8c4531=indexedDB['open'](_0x190f20(0x395),0x1);_0x8c4531[_0x190f20(0x330)]=_0x55baa7=>_0x55baa7[_0x190f20(0x2e7)][_0x190f20(0x4c6)][_0x190f20(0x243)](_0x190f20(0x28e)),_0x8c4531['onsuccess']=_0x258e25=>_0x35c876(_0x258e25[_0x190f20(0x2e7)]['result']),_0x8c4531[_0x190f20(0x3cb)]=_0x248a54=>_0x27ede2(_0x248a54);}),fileCache={};function handleFileUpload(_0x40714f,_0x2377c1){if(!_0x40714f)return;dbPromise['then'](_0x3838e8=>{const _0x4df61e=_0x365d,_0x4b252f=uid(_0x4df61e(0x42e)),_0x55181f=_0x3838e8[_0x4df61e(0x3ec)](_0x4df61e(0x28e),_0x4df61e(0x3c7));_0x55181f[_0x4df61e(0x48b)]('files')[_0x4df61e(0x2cc)](_0x40714f,_0x4b252f),_0x55181f['oncomplete']=()=>_0x2377c1(_0x4b252f),_0x55181f[_0x4df61e(0x3cb)]=()=>toast('File\x20save\x20error.');});}function _0x365d(_0x26e1a3,_0x4eaa41){const _0x5cd2e0=_0x5cd2();return _0x365d=function(_0x365ddd,_0x38a6ad){_0x365ddd=_0x365ddd-0x1d4;let _0x1c2247=_0x5cd2e0[_0x365ddd];return _0x1c2247;},_0x365d(_0x26e1a3,_0x4eaa41);}function getStoredFileUrl(_0xdd868c){const _0x58496e=_0x36046b;if(!_0xdd868c)return Promise[_0x58496e(0x39e)]('');if(fileCache[_0xdd868c])return Promise['resolve'](fileCache[_0xdd868c]);return dbPromise[_0x58496e(0x472)](_0x27cc31=>new Promise(_0x1bbbdd=>{const _0x159146=_0x58496e,_0x5cde92=_0x27cc31['transaction'](_0x159146(0x28e),_0x159146(0x1fe)),_0x35b058=_0x5cde92['objectStore'](_0x159146(0x28e))[_0x159146(0x427)](_0xdd868c);_0x35b058[_0x159146(0x266)]=_0xacadfc=>{const _0x57855a=_0x159146,_0xad7d84=_0xacadfc[_0x57855a(0x2e7)]['result'];if(_0xad7d84){const _0x5d6f69=URL[_0x57855a(0x323)](_0xad7d84);fileCache[_0xdd868c]=_0x5d6f69,_0x1bbbdd(_0x5d6f69);}else _0x1bbbdd('');},_0x35b058[_0x159146(0x3cb)]=()=>_0x1bbbdd('');}));}function applyCustomBg(){const _0x41e2d4=_0x36046b,_0x56f0a0=data['settings'],_0x32b039=_0x56f0a0[_0x41e2d4(0x1de)],_0x26978b=_0x56f0a0['theme'],_0x54d419=[_0x41e2d4(0x36a),'space'][_0x41e2d4(0x3f9)](_0x26978b),_0x205620=_0x26978b===_0x41e2d4(0x45a)||_0x26978b===_0x41e2d4(0x4c1),_0x41a1f0=_0x56f0a0[_0x41e2d4(0x2fc)]||_0x41e2d4(0x25a);document['body'][_0x41e2d4(0x335)][_0x41e2d4(0x494)]=_0x41a1f0,document['body'][_0x41e2d4(0x335)]['backgroundRepeat']=_0x41a1f0==='auto'?_0x41e2d4(0x34b):'no-repeat';const _0x521984=()=>{const _0x328c7f=_0x41e2d4;try{document[_0x328c7f(0x350)]['style']['backgroundImage']='';}catch(_0x4a400f){}};if(_0x32b039){const _0x2613d4=_0x32b039[_0x41e2d4(0x402)](_0x41e2d4(0x1e9))||_0x32b039[_0x41e2d4(0x402)](_0x41e2d4(0x22d))||_0x32b039['startsWith'](_0x41e2d4(0x24f))?Promise['resolve'](_0x32b039):getStoredFileUrl(_0x32b039);_0x2613d4[_0x41e2d4(0x472)](_0x3c6af0=>{const _0x324216=_0x41e2d4;_0x3c6af0?document['body'][_0x324216(0x335)][_0x324216(0x2ea)](_0x324216(0x37f),_0x324216(0x340)+_0x3c6af0+')'):document[_0x324216(0x350)][_0x324216(0x335)][_0x324216(0x2ea)](_0x324216(0x37f),_0x205620?_0x324216(0x224):''),_0x521984();});}else!_0x54d419?_0x205620?(document[_0x41e2d4(0x350)][_0x41e2d4(0x335)]['setProperty'](_0x41e2d4(0x37f),_0x41e2d4(0x224)),_0x521984()):document[_0x41e2d4(0x350)][_0x41e2d4(0x335)][_0x41e2d4(0x2ea)](_0x41e2d4(0x37f),_0x41e2d4(0x250)):(document[_0x41e2d4(0x350)][_0x41e2d4(0x335)][_0x41e2d4(0x30f)](_0x41e2d4(0x37f)),_0x521984());}function applyPanelOpacity(){const _0x40603a=_0x36046b;document[_0x40603a(0x29a)][_0x40603a(0x335)][_0x40603a(0x2ea)](_0x40603a(0x3e3),data['settings'][_0x40603a(0x1ff)]);}function renderDashboard(){const _0x148e1f=_0x36046b,_0x47f51a=data[_0x148e1f(0x20a)]['flatMap'](_0x1f3cb1=>_0x1f3cb1[_0x148e1f(0x25c)][_0x148e1f(0x220)](_0x5e6808=>({'topic':_0x1f3cb1[_0x148e1f(0x2ff)],'subtopic':_0x5e6808[_0x148e1f(0x2ff)],'m':_0x5e6808[_0x148e1f(0x4d2)][_0x148e1f(0x4c0)]||0x0,'c':_0x5e6808[_0x148e1f(0x4d2)]['sessionsCompleted']||0x0,'t':_0x5e6808[_0x148e1f(0x4d2)][_0x148e1f(0x2d1)]||0x0}))),_0x1f6d69=_0x47f51a[_0x148e1f(0x29c)]((_0x39930e,_0x1270a0)=>_0x39930e+_0x1270a0['m'],0x0),_0x221b81=_0x47f51a['reduce']((_0x410b02,_0x5e9615)=>_0x410b02+_0x5e9615['c'],0x0),_0x5af23b=_0x47f51a[_0x148e1f(0x29c)]((_0x2e00fb,_0xf18c2e)=>_0x2e00fb+_0xf18c2e['t'],0x0);let _0x419f2b='<p\x20class=\x22tiny\x22><strong>Total\x20time:</strong>\x20'+formatDaysHoursMinutes(_0x1f6d69)+_0x148e1f(0x2d6)+_0x221b81+_0x148e1f(0x319)+_0x5af23b+_0x148e1f(0x39a);_0x47f51a[_0x148e1f(0x229)](_0x2579d1=>{const _0x13d933=_0x148e1f;_0x419f2b+='<tr><td>'+escapeHTML(_0x2579d1[_0x13d933(0x33a)])+_0x13d933(0x338)+escapeHTML(_0x2579d1[_0x13d933(0x278)])+_0x13d933(0x338)+formatDaysHoursMinutes(_0x2579d1['m'])+_0x13d933(0x338)+_0x2579d1['c']+_0x13d933(0x338)+_0x2579d1['t']+_0x13d933(0x46c);}),_0x419f2b+=_0x148e1f(0x2dc);const _0x543289=$(_0x148e1f(0x37d));if(_0x543289)_0x543289[_0x148e1f(0x3c3)]=_0x419f2b;}function getMilestones(){const _0x4bc3b1=_0x36046b;return[{'hours':0x5,'title':_0x4bc3b1(0x23a),'message':_0x4bc3b1(0x349)},{'hours':0x14,'title':_0x4bc3b1(0x481),'message':'Congrats\x20on\x20doing\x20the\x20hardest\x20part:\x20starting\x20and\x20staying\x20consistent.\x0a\x0aThese\x2020\x20hours\x20aren’t\x20just\x20time—they’re\x2020\x20hours\x20of\x20winning\x20against\x20distraction.\x20You’re\x20building\x20a\x20strong\x20foundation\x20of\x20discipline.\x20Be\x20proud\x20of\x20this\x20start.'},{'hours':0x32,'title':_0x4bc3b1(0x205),'message':'50\x20focused\x20hours!\x20Your\x20habits\x20are\x20creating\x20momentum.\x20Small\x20daily\x20consistencies\x20compound\x20into\x20big\x20steps\x20forward.\x20You’re\x20on\x20the\x20right\x20path—keep\x20going.'},{'hours':0x64,'title':_0x4bc3b1(0x3fe),'message':'100\x20hours!\x20This\x20is\x20no\x20longer\x20an\x20experiment—it’s\x20a\x20serious\x20investment\x20in\x20your\x20goals.\x0a\x0aTake\x20a\x20moment\x20to\x20reflect:\x20how\x20far\x20have\x20these\x20100\x20focused\x20hours\x20taken\x20you?\x20Your\x20energy\x20is\x20shaping\x20real\x20outcomes.'},{'hours':0xfa,'title':_0x4bc3b1(0x1fb),'message':_0x4bc3b1(0x2ba)},{'hours':0x1f4,'title':_0x4bc3b1(0x2c5),'message':_0x4bc3b1(0x2d0)},{'hours':0x3e8,'title':_0x4bc3b1(0x215),'message':'Welcome\x20to\x20the\x201,000-Hour\x20Club.\x0a\x0aThis\x20number\x20is\x20not\x20just\x20time—it\x20represents\x20transformation.\x20Focus\x20has\x20become\x20part\x20of\x20you,\x20a\x20‘superpower’\x20you\x20can\x20summon.\x20Your\x20journey\x20is\x20inspiring.'},{'hours':0x1388,'title':_0x4bc3b1(0x2f4),'message':_0x4bc3b1(0x453)}][_0x4bc3b1(0x3c0)]((_0x2fd579,_0x2461bb)=>_0x2461bb[_0x4bc3b1(0x36d)]-_0x2fd579[_0x4bc3b1(0x36d)]);}async function checkAndShowMilestones(){const _0x33c4b3=_0x36046b;if(!data||!data[_0x33c4b3(0x476)])return;if(!Array['isArray'](data[_0x33c4b3(0x476)][_0x33c4b3(0x470)]))data[_0x33c4b3(0x476)][_0x33c4b3(0x470)]=[];const _0x5da803=data[_0x33c4b3(0x20a)][_0x33c4b3(0x29c)]((_0x4462f5,_0x97d5b4)=>{const _0xa11822=_0x33c4b3;return _0x4462f5+_0x97d5b4[_0xa11822(0x25c)][_0xa11822(0x29c)]((_0x2f74b5,_0x4e78cf)=>{const _0x22e675=_0xa11822;return _0x2f74b5+(_0x4e78cf[_0x22e675(0x4d2)][_0x22e675(0x4c0)]||0x0);},0x0);},0x0),_0x2f73c9=_0x5da803/0x3c,_0x2096b9=getMilestones(),_0x4e58fe=Array[_0x33c4b3(0x4c7)](data[_0x33c4b3(0x476)][_0x33c4b3(0x470)])?data['settings']['achievedMilestones']:[],_0x517640=_0x2096b9[_0x33c4b3(0x1f9)](_0x2640c6=>_0x2f73c9>=_0x2640c6[_0x33c4b3(0x36d)]&&!_0x4e58fe[_0x33c4b3(0x3f9)](_0x2640c6['hours']));if(_0x517640[_0x33c4b3(0x1e7)]===0x0)return![];const _0x40574a=_0x517640[_0x33c4b3(0x29c)]((_0x2ccaaf,_0x4d513c)=>_0x2ccaaf&&_0x2ccaaf['hours']>_0x4d513c[_0x33c4b3(0x36d)]?_0x2ccaaf:_0x4d513c,null);if(!_0x40574a)return![];$(_0x33c4b3(0x274))[_0x33c4b3(0x2a4)]=_0x40574a[_0x33c4b3(0x49b)],$(_0x33c4b3(0x1db))['textContent']=_0x40574a[_0x33c4b3(0x232)],$('#modalMilestone')[_0x33c4b3(0x3fa)][_0x33c4b3(0x478)](_0x33c4b3(0x3e9));try{trapFocus($('#modalMilestone'));}catch(_0x10e9ec){}return data['settings'][_0x33c4b3(0x470)][_0x33c4b3(0x298)](_0x40574a[_0x33c4b3(0x36d)]),await saveData(),!![];}async function seedAchievedMilestones(){const _0x4990a3=_0x36046b;if(!data||!data[_0x4990a3(0x476)])return;!Array[_0x4990a3(0x4c7)](data[_0x4990a3(0x476)][_0x4990a3(0x470)])&&(data[_0x4990a3(0x476)][_0x4990a3(0x470)]=[],await saveData());}async function handleSendMessage(){const _0x59bc87=_0x36046b,_0x45d10d=$(_0x59bc87(0x37c)),_0x55caaa=$(_0x59bc87(0x499)),_0x44c664=_0x55caaa[_0x59bc87(0x327)][_0x59bc87(0x4dd)](),_0x38c782=getCurrentSubtopic();if(!_0x44c664)return;if(!_0x38c782){toast(t('timer.selectSubtopicPrompt'));return;}_0x55caaa[_0x59bc87(0x327)]='',_0x45d10d[_0x59bc87(0x4e8)]=!![],_0x45d10d[_0x59bc87(0x3c3)]='<div\x20class=\x22spinner\x22></div>',_0x38c782[_0x59bc87(0x417)][_0x59bc87(0x298)]({'role':_0x59bc87(0x44b),'text':_0x44c664}),renderChat();const _0x2b5c6b=await callGeminiAPI(_0x44c664);_0x2b5c6b&&(_0x38c782['chatHistory']['push']({'role':_0x59bc87(0x43a),'text':_0x2b5c6b}),await saveData(),renderChat()),_0x45d10d[_0x59bc87(0x4e8)]=![],_0x45d10d['innerHTML']=_0x59bc87(0x1d8);}function renderChat(){const _0x4da513=_0x36046b,_0x1f996e=getCurrentSubtopic(),_0x3d454a=$(_0x4da513(0x426)),_0x54b96b=$(_0x4da513(0x499)),_0x49a605=$(_0x4da513(0x37c));if(!_0x3d454a||!_0x54b96b||!_0x49a605)return;if(!_0x1f996e){_0x3d454a['innerHTML']=_0x4da513(0x4bb),_0x54b96b[_0x4da513(0x4e8)]=!![],_0x49a605[_0x4da513(0x4e8)]=!![];return;}_0x54b96b['disabled']=![],_0x49a605[_0x4da513(0x4e8)]=![],_0x3d454a[_0x4da513(0x3c3)]='';if(!_0x1f996e[_0x4da513(0x417)]||_0x1f996e[_0x4da513(0x417)][_0x4da513(0x1e7)]===0x0){_0x3d454a[_0x4da513(0x3c3)]=_0x4da513(0x48a);return;}_0x1f996e[_0x4da513(0x417)]['forEach'](_0x2b9ae8=>{const _0x5e926d=_0x4da513,_0x49967d=document[_0x5e926d(0x1da)](_0x5e926d(0x4ac));_0x49967d['className']=_0x5e926d(0x34a)+_0x2b9ae8['role'],_0x49967d['textContent']=_0x2b9ae8[_0x5e926d(0x268)],_0x3d454a[_0x5e926d(0x406)](_0x49967d);}),_0x3d454a[_0x4da513(0x41f)]=_0x3d454a[_0x4da513(0x2c0)];}async function handleSummarizeNote(){const _0x4f7ad1=_0x36046b,_0x1b6ddc=$(_0x4f7ad1(0x45c)),_0x325601=$('#noteText'),_0xee563d=_0x325601[_0x4f7ad1(0x327)][_0x4f7ad1(0x4dd)](),_0x12eaad=getCurrentSubtopic();if(!_0xee563d){toast('Please\x20enter\x20a\x20note\x20before\x20summarizing.');return;}const _0x9ae622=_0x1b6ddc[_0x4f7ad1(0x3c3)];_0x1b6ddc[_0x4f7ad1(0x3c3)]='<div\x20class=\x22spinner\x22></div>',_0x1b6ddc[_0x4f7ad1(0x4e8)]=!![];const _0x19ad96=_0x4f7ad1(0x3b0)+(_0x12eaad?.['name']||_0x4f7ad1(0x47f))+_0x4f7ad1(0x4db)+_0xee563d+_0x4f7ad1(0x3af),_0xbf410f=await callGeminiAPI(_0x19ad96);_0xbf410f&&(_0x325601[_0x4f7ad1(0x327)]+='\x0a\x0a'+_0xbf410f),_0x1b6ddc[_0x4f7ad1(0x3c3)]=_0x9ae622,_0x1b6ddc[_0x4f7ad1(0x4e8)]=![];}function clearChat(){const _0x45bd22=_0x36046b,_0x51e88e=getCurrentSubtopic();if(!_0x51e88e){toast(t(_0x45bd22(0x3b8)));return;}showConfirmModal(_0x45bd22(0x248),_0x45bd22(0x22f),async _0x5342e6=>{const _0x4fe875=_0x45bd22;_0x5342e6&&(_0x51e88e[_0x4fe875(0x417)]=[],await saveData(),renderChat(),toast(_0x4fe875(0x2a5)));});}let ytPlayer,ytUserPaused=![],ytFallbackFrame=null,ytFallbackIsPlaying=![];function buildFallbackSrc(_0x5f4f37,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x52f2ca=_0x36046b,_0xf581ca=new URLSearchParams({'autoplay':String(autoplay),'mute':String(mute),'controls':'0','playsinline':'1','loop':'1','playlist':_0x5f4f37,'enablejsapi':'1','origin':_0x52f2ca(0x474)})[_0x52f2ca(0x222)]();return'https://www.youtube.com/embed/'+_0x5f4f37+'?'+_0xf581ca;}function ensureFallbackFrame(){const _0x2964a6=_0x36046b,_0xf80563=document[_0x2964a6(0x2ab)]('youtube-player-container');if(!_0xf80563)return null;if(ytFallbackFrame&&ytFallbackFrame[_0x2964a6(0x33d)])return ytFallbackFrame;const _0x422796=document['createElement'](_0x2964a6(0x364));return _0x422796['id']=_0x2964a6(0x4b9),_0x422796[_0x2964a6(0x343)]='1',_0x422796[_0x2964a6(0x4b7)]='1',_0x422796['style']['position']='absolute',_0x422796[_0x2964a6(0x335)][_0x2964a6(0x306)]=_0x2964a6(0x2b8),_0x422796[_0x2964a6(0x335)][_0x2964a6(0x377)]=_0x2964a6(0x2b8),_0x422796['allow']=_0x2964a6(0x41a),_0xf80563[_0x2964a6(0x3c3)]='',_0xf80563[_0x2964a6(0x406)](_0x422796),ytFallbackFrame=_0x422796,_0x422796;}function fallbackLoadVideo(_0x416871,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x1108db=_0x36046b,_0x25554c=document[_0x1108db(0x2ab)](_0x1108db(0x388));if(!_0x25554c)return;_0x25554c[_0x1108db(0x3c3)]='';const _0x3cb6ae=document[_0x1108db(0x1da)](_0x1108db(0x364));_0x3cb6ae['id']=_0x1108db(0x4b9),_0x3cb6ae['width']='1',_0x3cb6ae[_0x1108db(0x4b7)]='1',_0x3cb6ae[_0x1108db(0x335)][_0x1108db(0x321)]='absolute',_0x3cb6ae[_0x1108db(0x335)][_0x1108db(0x306)]=_0x1108db(0x2b8),_0x3cb6ae[_0x1108db(0x335)][_0x1108db(0x377)]=_0x1108db(0x2b8),_0x3cb6ae[_0x1108db(0x391)]=_0x1108db(0x41a),_0x3cb6ae['src']=buildFallbackSrc(_0x416871,{'autoplay':autoplay,'mute':mute}),_0x25554c[_0x1108db(0x406)](_0x3cb6ae),ytFallbackFrame=_0x3cb6ae,ytFallbackIsPlaying=!!autoplay;try{const _0x119f47=document[_0x1108db(0x2ab)]('btnToggleYtSound');if(_0x119f47)_0x119f47[_0x1108db(0x2a4)]=ytFallbackIsPlaying?'⏸️':'▶️';}catch(_0xef3a3a){}}function fallbackPostMessage(_0x2051e0,_0x148163=[]){const _0x272631=_0x36046b;try{if(!ytFallbackFrame||!ytFallbackFrame[_0x272631(0x312)])return;ytFallbackFrame[_0x272631(0x312)][_0x272631(0x380)](JSON[_0x272631(0x3dd)]({'event':_0x272631(0x38e),'func':_0x2051e0,'args':_0x148163}),_0x272631(0x474));}catch(_0xf069ac){}}function fallbackPlay(){fallbackPostMessage('playVideo');}function fallbackStop(){const _0x3b0a09=_0x36046b;try{ytFallbackFrame&&(ytFallbackFrame['src']=_0x3b0a09(0x49f),ytFallbackIsPlaying=![]);}catch(_0x23ca05){}}function fallbackPause(){fallbackStop();}function fallbackUnMute(){fallbackPostMessage('unMute');}function fallbackMute(){const _0x2a3a6e=_0x36046b;fallbackPostMessage(_0x2a3a6e(0x372));}window['onYouTubeIframeAPIReady']=function(){const _0x4b990a=_0x36046b;if(IS_FILE_PROTOCOL){try{window[_0x4b990a(0x495)]&&window[_0x4b990a(0x495)]['cancel']();}catch(_0xdd9a7e){}return;}const _0x3b8f54={'height':'1','width':'1','playerVars':{'autoplay':0x0,'controls':0x0,'playsinline':0x1},'events':{'onReady':onPlayerReady,'onStateChange':onPlayerStateChange},'host':_0x4b990a(0x474)};(window[_0x4b990a(0x316)][_0x4b990a(0x444)]===_0x4b990a(0x4ec)||window[_0x4b990a(0x316)][_0x4b990a(0x444)]===_0x4b990a(0x4cd))&&(_0x3b8f54[_0x4b990a(0x1dd)]=window[_0x4b990a(0x316)][_0x4b990a(0x1dd)]);ytPlayer=new YT[(_0x4b990a(0x366))](_0x4b990a(0x388),_0x3b8f54);try{window[_0x4b990a(0x495)]&&window['__ytApiWatchdog'][_0x4b990a(0x4eb)]();const _0x14ffd2=document[_0x4b990a(0x2ab)](_0x4b990a(0x3eb));_0x14ffd2&&(_0x14ffd2[_0x4b990a(0x2a4)]='');}catch(_0x4d7102){}};let _ytPrimed=![],_ytUnlocked=![];try{_ytUnlocked=localStorage['getItem'](_0x36046b(0x1d6))==='1';}catch(_0x2798e4){}function showSoundPermission(){const _0x10542e=_0x36046b,_0x4a08a1=document[_0x10542e(0x2ab)](_0x10542e(0x4aa));if(!_0x4a08a1)return;if(_ytUnlocked){_0x4a08a1[_0x10542e(0x3fa)][_0x10542e(0x30e)](_0x10542e(0x3e9));return;}_0x4a08a1[_0x10542e(0x3fa)][_0x10542e(0x478)](_0x10542e(0x3e9));}function hideSoundPermission(){const _0x24c47d=_0x36046b,_0x22b3cc=document[_0x24c47d(0x2ab)](_0x24c47d(0x4aa));if(!_0x22b3cc)return;_0x22b3cc[_0x24c47d(0x3fa)]['remove'](_0x24c47d(0x3e9));}function unlockAudioChain(){const _0x345608=_0x36046b;try{if(AUDIO_CTX&&typeof AUDIO_CTX[_0x345608(0x221)]==='function')AUDIO_CTX[_0x345608(0x221)]();}catch(_0x5d4d3c){}try{if(IS_FILE_PROTOCOL)fallbackUnMute(),fallbackPlay();else ytPlayer&&ytPlayer[_0x345608(0x48f)]&&(ytPlayer[_0x345608(0x48f)](),ytPlayer[_0x345608(0x3d6)]());}catch(_0x442ca6){}_ytUnlocked=!![];try{localStorage[_0x345608(0x45b)]('sound_unlocked','1');}catch(_0x16d420){}hideSoundPermission(),toast(_0x345608(0x376));}function _0x5cd2(){const _0x313764=['#btnFinishFlow','Listen\x20closely\x20to\x20your\x20in-breath\x20and\x20out-breath.','cyclesA','Please\x20select\x20a\x20Subtopic\x20first','#set_theme','unshift','chatHistory','#modalGeneric','useYtThumbnailAsBg','autoplay;\x20encrypted-media;\x20picture-in-picture','createdAt','presetTarget','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M9.88\x209.88a3\x203\x200\x201\x200\x204.24\x204.24\x22/><path\x20d=\x22M10.73\x205.08A10.43\x2010.43\x200\x200\x201\x2012\x205c7\x200\x2010\x207\x2010\x207a13.16\x2013.16\x200\x200\x201-1.67\x202.68\x22/><path\x20d=\x22M6.61\x206.61A13.526\x2013.526\x200\x200\x200\x202\x2012s3\x207\x2010\x207a9.74\x209.74\x200\x200\x200\x205.39-1.61\x22/><line\x20x1=\x222\x22\x20y1=\x222\x22\x20x2=\x2222\x22\x20y2=\x2222\x22/></svg>','Benjamin\x20Franklin’s\x20Writing\x20Method:\x20Learn\x20by\x20Recreating','scrollTop','ArrowDown','#settings-pomodoro','#genericMessage','youtubeVolume','.nav-btn[data-view=\x22','#methodEditorTitle','#chatMessages','get','indexOf','Great!\x20Time\x20for\x20a\x20long\x20break.','Switched\x20to\x20Style\x20','interval','Confirm\x20Restore','.timer-circle-container','file','triangle','\x20hours\x20','Saved\x20alert\x20for\x20FOCUS.','API\x20response\x20structure\x20is\x20unexpected:','BUFFERING','Tab','#btnTestSound','#modalDashboard','exitFullscreen','</div>','#view-timer','model','apiKey','#uploadSoundBreak','#set_panelOpacity','localeCompare','https://img.youtube.com/vi/','values','.presets\x20button','IndexedDB\x20initialized\x20successfully.','.color-palette','protocol','.sub-row','#modalNote','_sortable','3625616OxcfAu','end','reset','user','closest','enableSessionNotes','note-content','<div\x20class=\x22tiny\x22>No\x20notes\x20yet.</div>','__ytApiPromise','\x20min','dateISO','5,000\x20hours\x20of\x20deliberate\x20focus.\x20Few\x20ever\x20reach\x20this.\x0a\x0aAt\x20this\x20milestone,\x20the\x20question\x20shifts\x20from\x20‘How\x20do\x20I\x20focus?’\x20to\x20‘What\x20value\x20will\x20this\x20focus\x20create?’.\x20You’re\x20not\x20just\x20working—you’re\x20building\x20a\x20legacy.','hidden','exportData','Background\x20updated.','Summary\x20deleted.','note','topicId','light','setItem','#btnSummarizeNote','webkitAudioContext','#methodEditorContentInput','string','\x20min\x20via\x20Flowtime\x20(','Please\x20select\x20a\x20Subtopic\x20before\x20proceeding.','/maxresdefault.jpg','<ul>','methodId','insertUnorderedList','https://www.youtube.com/iframe_api','autoBackup','key','currentView','#set_long','#set_backupDays','</td></tr>','Summarize','#btnPause','keydown','achievedMilestones','_getStore','then','\x20·\x20','https://www.youtube.com','toLocaleString','settings','Failed\x20to\x20save\x20data:','add','btn\x20small\x20danger\x20method-delete','textarea','More\x20options','#btnPresetC','Data\x20imported\x20successfully!','currentTime','unknown','mode','To\x20You,\x2020\x20Hours\x20(Foundation)','querySelectorAll','download','breathing','.modal','Initialization\x20error:','Step\x20onto\x20a\x20balcony\x20and\x20enjoy\x20natural\x20light.','Settings\x20saved','.color-picker-wrapper','<div\x20class=\x22tiny\x22>No\x20messages\x20yet.</div>','objectStore','#modalMethodEditor','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20topic\x20\x22','objectStoreNames','unMute','fixed','oldIndex','persistTimerState','execCommand','backgroundSize','__ytApiWatchdog','<div\x20class=\x22tiny\x22>No\x20summaries\x20yet.</div>','<div\x20class=\x22hist-meta\x22>','auto','#chatInput','main_settings','title','&gt;','(Could\x20not\x20generate\x20summary)','lang','about:blank','cycleIndex','stroke','12GUnKhS','Look\x20at\x20something\x20cute\x20or\x20uplifting.','strokeDasharray','theme','transition','#btnSettings','#btnToggleYtSound','#view-','soundPermissionBar','max','div','error','Backup\x20not\x20found.','padStart','button,\x20[href],\x20input,\x20select,\x20textarea,\x20[tabindex]:not([tabindex=\x22-1\x22])','className','#ytSoundVolume','#btnAddMethod','#btnCloseSettings','DB_VERSION','aria-expanded','height','longBreakIntervalA','yt-fallback','btn\x20small\x20ghost\x20actions-menu-btn','<div\x20class=\x22tiny\x22>Select\x20a\x20subtopic\x20to\x20start\x20chatting.</div>','type','?\x20This\x20will\x20stop\x20and\x20reset\x20the\x20current\x20session.','AI\x20finished\x20formatting!','removeChild','totalMinutes','pastel','Sortable','toggle','Defaults\x20restored','\x20hidden','result','isArray','#btnRestoreBackup','#statSessions','Stand\x20up\x20and\x20take\x20a\x20few\x20steps.','ArrowUp','<ol>','https:','#set_enableSessionNotes','createIndex','Analyze\x20and\x20reformat\x20the\x20following\x20plain\x20text\x20into\x20clean\x20HTML.\x20Use\x20these\x20tags:\x0a-\x20Use\x20<h4>\x20for\x20main\x20section\x20headings.\x0a-\x20Use\x20<strong>\x20to\x20emphasize\x20important\x20terms\x20or\x20ideas.\x0a-\x20Use\x20<i>\x20for\x20notes\x20or\x20quotes.\x0a-\x20Use\x20<ol>\x20and\x20<li>\x20for\x20ordered\x20lists.\x0a-\x20Use\x20<ul>\x20and\x20<li>\x20for\x20unordered\x20lists.\x0a-\x20Wrap\x20normal\x20paragraphs\x20with\x20<p>.\x0aText\x20to\x20format:\x0a\x0a\x22','.subtopics','stats','Drink\x20a\x20glass\x20of\x20water\x20to\x20stay\x20hydrated.','Delete\x20Subtopic','HTTP\x20error:\x20','&lt;','<h4>','Did\x20not\x20receive\x20valid\x20content\x20from\x20AI.','selectedTopicId','A_work','\x22\x0a-\x20User\x27s\x20note\x20after\x20a\x20focus\x20session:\x20\x22','READY','trim','B_long','volume','&quot;','var(--danger)','all','No\x20Subtopic\x20Selected','beginWork','pauseVideo','?\x20Current\x20data\x20will\x20be\x20overwritten.','restoreBackup','disabled','#toolBold','Cycle\x20','cancel','http:','option','file:','sound_unlocked','.timer-circle-progress','Send','Open\x20a\x20window\x20for\x20some\x20fresh\x20air.','createElement','#milestoneMessage','\x22?\x20All\x20related\x20data\x20will\x20be\x20lost.','origin','customBg','clientX','<li>','<div\x20class=\x22tiny\x22>No\x20data\x20yet</div>','head','.actions-menu','stopPropagation','Count\x20your\x20breaths\x20slowly\x20up\x20to\x20ten.','2315560RJWSyx','length','Splash\x20water\x20on\x20your\x20face\x20or\x20pat\x20it\x20gently.','data:','<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20summaries.</div>','<p>The\x20core\x20idea:\x20\x22If\x20you\x20can’t\x20explain\x20a\x20topic\x20simply,\x20you\x20don’t\x20truly\x20understand\x20it.\x22\x20The\x20goal\x20is\x20to\x20turn\x20complex\x20knowledge\x20into\x20explanations\x20simple\x20enough\x20that\x20a\x20child\x20could\x20understand.</p><h4>Streamlined\x204-Step\x20Process</h4><ol><li><strong>Learn:</strong>\x20Pick\x20a\x20topic\x20and\x20write\x20down\x20everything\x20you\x20know\x20about\x20it.</li><li><strong>Teach:</strong>\x20Pretend\x20to\x20teach\x20it\x20using\x20the\x20simplest\x20language\x20possible.\x20Write\x20or\x20speak\x20it\x20out\x20loud.</li><li><strong>Find\x20&\x20Fix\x20Gaps:</strong>\x20Whenever\x20you\x20get\x20\x22stuck\x22,\x20rely\x20on\x20jargon,\x20or\x20can’t\x20explain\x20smoothly,\x20you’ve\x20found\x20a\x20knowledge\x20gap.\x20Go\x20back\x20to\x20the\x20source\x20and\x20learn\x20until\x20the\x20gap\x20is\x20filled.</li><li><strong>Simplify:</strong>\x20Reorganize\x20your\x20final\x20explanation,\x20using\x20simple\x20examples\x20or\x20analogies\x20so\x20it’s\x20clear\x20and\x20easy\x20to\x20grasp.</li></ol><h4>Essence</h4><p>The\x20Feynman\x20Technique\x20forces\x20you\x20to\x20move\x20from\x20passive\x20intake\x20(reading,\x20listening)\x20to\x20actively\x20processing\x20information.\x20The\x20moment\x20you\x20\x22get\x20stuck\x22\x20is\x20a\x20powerful\x20diagnostic\x20tool—pinpointing\x20exactly\x20where\x20you’re\x20weak.</p><p><i>The\x20quickest\x20way\x20to\x20check\x20and\x20strengthen\x20understanding\x20is\x20to\x20try\x20teaching\x20it\x20simply\x20to\x20someone\x20else.</i></p>','initDB','remaining','#toasts','ENDED','The\x20Feynman\x20Technique:\x20Understand\x20Deeply\x20by\x20Explaining\x20Simply','play','699391fnRVYM','#btnSaveMethod','floor','version','setPreset','methods','var(--sub)','filter','workMinutes','To\x20You,\x20250\x20Hours\x20(Perseverance)','.view','tid','readonly','panelOpacity','No\x20notes\x20to\x20summarize.','clear','collapsedTopics','details','No\x20valid\x20link.\x20Paste\x20a\x20link\x20then\x20press\x20▶️.','To\x20You,\x2050\x20Hours\x20(Momentum)','#windDownChecklist','Please\x20enter\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings.','default','long_break','topics','select','fullscreenElement','bg-view-mode','(none\x20selected)','Playing','getMonth','pointerdown','.nav-btn[data-view]','Add\x20note','...','To\x20You,\x201,000\x20Hours\x20(Transformation)','#set_winddown','var(--warn)','application/json','preset','.aux-panel,\x20.modal-card','insertOrderedList','formatBlock','btn\x20small','topic-actions','find','map','resume','toString','#set_interval','none','#uploadSoundWork','flex','dataset','json','forEach','\x22?\x20All\x20subtopics\x20and\x20related\x20data\x20will\x20be\x20lost.','opacity','#audioBreakEnd','http','from','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20all\x20chat\x20history\x20for\x20this\x20subtopic?','PomodoroAppDB','Take\x20one\x20deep\x20sigh\x20and\x20relax\x20your\x20shoulders.','message','Initialization\x20error:\x20','B_work','Relax\x20your\x20body\x20and\x20notice\x20your\x20breath.','Check\x20and\x20correct\x20your\x20sitting\x20posture.','btn\x20small\x20ghost\x20method-edit','summary_','.topic-item','To\x20You,\x20The\x20First\x205\x20Hours\x20(Warm-up)','beginBreak','6XLNMxe','currentConfig','selectionEnd','change','#btnAddTopic','#btnGenericOk','preventDefault','createObjectStore','AutoBackup\x20error:','acc','<option\x20value=\x22\x22>--\x20Select\x20a\x20date\x20to\x20restore\x20--</option>','#set_ytThumbAsBg','Confirm\x20Deletion','Close\x20your\x20eyes\x20and\x20relax\x20for\x20one\x20minute.','Unable\x20to\x20save\x20changes.','importData','parts','B_short','Invalid\x20file\x20format','blob:','radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)','onclick','work','Import\x20failed:\x20','#uploadSoundLong','New\x20Topic\x20name?','The\x2080/20\x20Principle\x20for\x20Mastering\x20a\x20New\x20Field','#btnStart','Error:\x20','#btnToggleCustomSounds','cover','finishFlowSession','subtopics','timer.cycleInfo','round','createOscillator','Gemini\x20API\x20Error:','Failed\x20to\x20load\x20YouTube\x20API','sessionsCompleted','#genericTitle','\x20(B)','#set_cycles','onsuccess','Network\x20error\x20connecting\x20to\x20Gemini.\x20Please\x20check\x20your\x20internet\x20connection.','text','#set_volume','#btnCancelMethodEditor','Delete\x20Topic','src','no-subtopic-selected','Add\x20subtopic','Remind\x20yourself:\x20Resting\x20well\x20helps\x20you\x20work\x20better!','date','Custom\x20background\x20removed.','.method-item','badge','#milestoneTitle','4RmYeQv','lastBackupDate','strokeDashoffset','subtopic','status','color','<div><span\x20class=\x22tiny\x22>(no\x20note\x20yet)</span></div>','badge\x20state\x20work','Exit\x20fullscreen','topicsList','frequency','#btnFullscreen','backgroundImage','work_end','🌊\x20Flow','code','#set_youtubeUrl','PlayerState','Enter','#noteText','pause','A_long','longBreakIntervalB','styleWithCSS','script','files','#btnToggleBg','#btnClearBg','item','gain','AI\x20cannot\x20format\x20at\x20the\x20moment.','#modalSettings','#btnMilestoneClose','ArrowRight','Time\x20to\x20wind\x20down.\x20Please\x20wrap\x20up\x20and\x20prepare\x20to\x20rest.','push','input,select,textarea','documentElement','.subtopic-btn','reduce','undefined','en-US','#toolH4','#toolBullet','checked','mousedown','img.youtube.com/vi/','textContent','Chat\x20history\x20cleared.','beep','sess','oncomplete','https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=','#set_autoStartNext','getElementById','23853181pGHrMp','754317SOBLsp','<div\x20class=\x22spinner\x22></div>','LONG\x20BREAK','slice','Edit','data','beginWindDown','Rename\x20Subtopic','innerHeight','note-item','B_winddown','-9999px','💡\x20Suggestion:\x20','250\x20hours\x20is\x20proof\x20of\x20incredible\x20perseverance.\x20You’ve\x20met\x20hard\x20days\x20and\x20distractions—and\x20you\x20kept\x20returning.\x20Real\x20strength\x20lies\x20in\x20this\x20consistency.','linearRampToValueAtTime','parse','badge\x20state\x20long','update','scroll','scrollHeight','<option\x20value=\x22\x22>No\x20backups\x20available</option>','badge\x20state\x20break','.method-edit','skip','To\x20You,\x20500\x20Hours\x20(Focus\x20Mastery)','catch','onload','summaries','revokeObjectURL','menu-active','#newSubtopicTaskInput','put','#draggableTimer','getDate','#view-methods\x20.method-item','Half\x20a\x20thousand\x20hours\x20of\x20focus.\x20You’ve\x20devoted\x20meaningful\x20time\x20to\x20what\x20matters.\x20This\x20level\x20of\x20dedication\x20creates\x20deep,\x20distinctive\x20results.\x20Admirable.','tasksCompleted','clientY','Audio\x20playback\x20error:','createGain','setVolume','\x20|\x20<strong>Total\x20sessions:</strong>\x20','#methodEditorId','short','flowtimeBreakRatio','Show\x20interface','sum','</tbody></table>','removeEventListener','getIframe','Backup\x20failed:','long_end','tasks','Saved\x20alert\x20for\x20SHORT\x20BREAK.','backups','wind_down','Blink\x20ten\x20times\x20to\x20prevent\x20dry\x20eyes.','Use\x20AI\x20to\x20auto-format\x20text','target','btn\x20subtopic-btn','#timerPresetSelector\x20button','setProperty','Error\x20calling\x20Gemini\x20API:','contains','Fullscreen','2FnrIpg','Spaced\x20Repetition:\x20Learning\x20at\x20the\x20Right\x20Time','Refuel\x20with\x20a\x20healthy\x20snack.','customSounds','#set_enableWinddown','ghost','To\x20You,\x205,000+\x20Hours\x20(Legacy)','substring','addEventListener','Relax\x20your\x20legs\x20and\x20rotate\x20your\x20ankles\x20under\x20the\x20desk.','#view-methods\x20.methods-container','cueVideoById','btn\x20small\x20danger','.tab-btn','backgroundMode','hist-item','href','name','removing','cyclesB','Space','onkeydown','</li>','#set_work','top','splice','#cycleInfo','.txt','space','####\x20','Ask\x20yourself:\x20‘How\x20do\x20I\x20feel\x20right\x20now?’','open','remove','removeProperty','timer','save','contentWindow','.actions-menu.show','cyclesTarget','note-meta','location','Have\x20a\x20sip\x20of\x20water.','#toolColor','\x20|\x20<strong>Total\x20tasks:</strong>\x20','#btnExport','topic-header','break_end','button','now','IndexedDB\x20error:','offsetWidth','position','Active\x20Recall:\x20The\x20Core\x20Principle\x20for\x20Deep\x20Learning','createObjectURL','getAllKeys','promptFeedback','random','value','offsetHeight','#ytUrlFeedback','.actions-menu-btn','chev\x20btn\x20small\x20ghost','log','_startTick','Are\x20you\x20sure\x20you\x20want\x20to\x20restore\x20data\x20from\x20','replace','onupgradeneeded','break','activeElement','content','PAUSED','style','sid','#set_short','</td><td>','subtopics-group','topic','FOCUS','Session\x20completed!\x20Press\x20Start\x20to\x20begin\x20the\x20next\x20session.','isConnected','summary','#timeDisplay','url(','block','A_short','width','by_topic','Playing\x20background\x20music...','#set_flowRatio','_onFinishSegment','bottom','Five\x20focused\x20hours!\x20You’ve\x20overcome\x20the\x20biggest\x20barrier:\x20procrastination.\x20Every\x20minute\x20invested\x20is\x20a\x20statement\x20of\x20your\x20intent.\x20Keep\x20the\x20fire\x20burning!','chat-msg\x20','repeat','findIndex','#btnReset','Edit\x20Knowledge','2586215tZNErF','body','sessions','Content\x20required\x20for\x20AI\x20formatting.','9SlcYUf','altKey','stopVideo','/hqdefault.jpg','prevState','tagName','btnToggleYtSound','getAll','Loading\x20YouTube\x20API...','Data\x20restored\x20successfully!\x20Reloading...','Escape','connect','</label>','isCompleted','sub-row','selectedSubtopicId','Hide\x20interface','iframe','warn','Player','topic-title','718642gxMLWY','setAttribute','lofi','#selectedContext','delete','hours','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M2\x2012s3-7\x2010-7\x2010\x207\x2010\x207-3\x207-10\x207-10-7-10-7Z\x22/><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x223\x22/></svg>','Subtopic:\x20','durations','match','mute','autoStartNext','#btnSaveNote','beforeunload','Sound\x20has\x20been\x20enabled!','left','Place\x20a\x20hand\x20on\x20your\x20chest\x20and\x20feel\x20your\x20heartbeat.','#welcomePanel','segmentTotal','Summary\x20failed.','#btnSendMessage','#dashboardContent','expanded','--bg-image','postMessage','#statTasks','getVolume','Stand\x20up\x20and\x20stretch.','shiftKey','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>No\x20knowledge\x20items\x20added\x20yet.</p>','getFullYear','timerState','youtube-player-container','#btnAddGeneralNote','Loosen\x20your\x20finger\x20joints\x20after\x20typing.','#set_apiKey','winddown','getBackupList','command','Background\x20music\x20stopped.','set_youtubeUrl','allow','state','innerWidth','reverse','pomodoro_files','candidates','\x0a-\x20','A_winddown','#uploadBg','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22dashboard-table\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead><tr><th>Topic</th><th>Subtopic</th><th>Time</th><th>Sessions</th><th>Tasks</th></tr></thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','FOCUS\x20(FLOW)','setRangeText','append','resolve','#breakSuggestionDisplay','#subtopicTasksList','aria-pressed','Gaze\x20out\x20the\x20window\x20for\x2020\x20seconds.','var(--acc-2)','relative','backupDaysToKeep','paused','#methodEditorTitleInput','<p>To\x20avoid\x20overwhelm\x20in\x20a\x20new\x20domain,\x20focus\x20on\x20the\x20vital\x2020%\x20that\x20delivers\x2080%\x20of\x20the\x20results\x20(Minimum\x20Effective\x20Dose).</p><h4>The\x20Core\x2020%:\x20Use\x20this\x205-Step\x20Analysis\x20Framework\x20to\x20identify\x20the\x20critical\x2020%:</h4><ol><li><strong>Define\x20Outcomes:</strong>\x20What\x20is\x20your\x20end\x20goal?\x20(e.g.,\x20ship\x20a\x20basic\x20website).</li><li><strong>Analyze\x20Fundamentals:</strong>\x20Identify\x203–5\x20invariant\x20principles\x20of\x20the\x20field.</li><li><strong>Spot\x20Common\x20Pitfalls:</strong>\x20Learn\x20the\x20mistakes\x20beginners\x20make\x20and\x20avoid\x20them.</li><li><strong>Find\x20the\x20“Force\x20Multiplier”:</strong>\x20Which\x20meta-skill\x20makes\x20learning\x20everything\x20else\x20easier?\x20(e.g.,\x20music\x20theory\x20in\x20music).</li><li><strong>Map\x20Practical\x20Application:</strong>\x20Focus\x20on\x20the\x2020%\x20of\x20tasks\x20that\x20consume\x2080%\x20of\x20real-world\x20time.</li></ol>','pomodoro_backup_','getPlayerState','generalNotes','task','<p>Active\x20Recall\x20is\x20the\x20effortful\x20retrieval\x20of\x20information\x20from\x20memory\x20without\x20looking\x20at\x20materials.\x20It\x20outperforms\x20passive\x20methods\x20like\x20rereading,\x20highlighting,\x20or\x20summarizing.</p><h4>The\x2020/80\x20Principle</h4><p><strong>The\x20vital\x2020%:</strong>\x20Forcing\x20yourself\x20to\x20recall\x20strengthens\x20neural\x20connections\x20and\x20consolidates\x20long-term\x20memory.\x20The\x20difficulty\x20you\x20feel\x20while\x20recalling\x20is\x20the\x20sign\x20of\x20effective\x20learning.</p><p><strong>The\x2080%\x20result:</strong>\x20You\x20retain\x20knowledge\x20longer\x20and\x20know\x20exactly\x20where\x20you’re\x20weak.</p><h4>Most\x20Effective\x20Techniques</h4><ul><li><strong>Self-testing:</strong>\x20Hide\x20your\x20notes\x20and\x20quiz\x20yourself.\x20For\x20example,\x20use\x20flashcards\x20and\x20always\x20answer\x20before\x20flipping\x20them\x20over.</li><li><strong>Blurting:</strong>\x20After\x20studying\x20a\x20topic,\x20close\x20the\x20book\x20and\x20write\x20everything\x20you\x20can\x20remember.\x20Then\x20compare\x20with\x20the\x20source\x20to\x20fill\x20gaps.</li><li><strong>Teach\x20someone\x20else:</strong>\x20Explaining\x20a\x20concept\x20forces\x20retrieval,\x20simplification,\x20and\x20coherent\x20structuring.</li></ul><p><i>Bottom\x20line:\x20Don’t\x20just\x20reread.\x20Pause,\x20cover\x20your\x20materials,\x20and\x20ask:\x20\x22What\x20do\x20I\x20actually\x20remember?\x22</i></p>','.\x20Please\x20try\x20again\x20with\x20different\x20content.','\x22\x0a\x0aProduce\x20a\x20concise\x20summary\x20of\x20what\x20was\x20done\x20and\x20propose\x20a\x20reasonable\x20next\x20step.\x20Format\x20the\x20answer\x20like\x20this:\x0a\x0a---\x0a**✨\x20AI\x20Summary:**\x0a[Summary\x20here]\x0a\x0a**🚀\x20Next\x20Suggestion:**\x0a[Suggestion\x20here]','Based\x20on\x20the\x20following:\x0a-\x20Topic/Subtopic:\x20\x22','querySelector','.tab-content','#btnResume','reloading','active','Please\x20select\x20a\x20subtopic\x20first.','</h4>','timer.selectSubtopicPrompt','#currentSubtopicName','#btnGenericCancel','getItem','Creating\x20backup\x20for\x20','min','#welcomePanel\x20p','<span\x20class=\x22ico\x22>▾</span>','sort','WIND-DOWN','Please\x20select\x20a\x20backup.','innerHTML','Take\x20a\x20short\x20walk\x20around\x20the\x20room.','#set_backgroundMode','menu-item\x20danger','readwrite','<p>If\x20Active\x20Recall\x20is\x20about\x20<i>how</i>\x20you\x20learn,\x20Spaced\x20Repetition\x20is\x20about\x20<i>when</i>.\x20It\x20schedules\x20reviews\x20to\x20move\x20knowledge\x20into\x20long-term\x20memory\x20most\x20efficiently.</p><h4>Core\x20Principle:\x20Resist\x20Forgetting\x20🧠</h4><p>Based\x20on\x20the\x20“Forgetting\x20Curve,”\x20we\x20forget\x20fastest\x20right\x20after\x20learning.\x20Spaced\x20Repetition\x20prompts\x20review\x20right\x20before\x20you’re\x20about\x20to\x20forget.</p><p>Each\x20successful\x20review\x20lengthens\x20retention\x20intervals.\x20You\x20might\x20forget\x20after\x201\x20day\x20initially,\x20but\x20after\x20review,\x20you’ll\x20remember\x20for\x203\x20days,\x20then\x20a\x20week,\x20a\x20month,\x20and\x20so\x20on.</p><h4>Most\x20Effective\x20Tool:\x20SRS\x20Apps\x20📱</h4><p>Instead\x20of\x20manual\x20schedules,\x20use\x20Spaced\x20Repetition\x20Software\x20(SRS).\x20Anki\x20is\x20the\x20gold\x20standard:\x20it\x20automates\x20scheduling\x20for\x20thousands\x20of\x20cards\x20based\x20on\x20your\x20self-rated\x20difficulty,\x20ensuring\x20optimal\x20review\x20timing.</p><h4>Biggest\x20Pitfall\x20to\x20Avoid\x20❌</h4><p>The\x20#1\x20cause\x20of\x20failure\x20is\x20<i>Review\x20Overload</i>—creating\x20too\x20many\x20new\x20cards\x20daily\x20or\x20skipping\x20days,\x20leading\x20to\x20a\x20discouraging\x20backlog.</p><p><strong>Solution\x20(20%\x20effort,\x2080%\x20results):</strong>\x20Be\x20consistent.\x20Set\x20realistic\x20new-card\x20limits\x20(e.g.,\x2010–20/day)\x20and\x20review\x20daily.\x20Better\x20to\x20study\x20a\x20little\x20every\x20day\x20than\x20to\x20cram.</p><h4>Essential\x20Combo:\x20AR\x20+\x20SR</h4><p>Spaced\x20Repetition\x20(SR)\x20and\x20Active\x20Recall\x20(AR)\x20are\x20two\x20sides\x20of\x20the\x20same\x20coin.\x20SR\x20tells\x20you\x20<i>when</i>\x20to\x20review;\x20AR\x20is\x20what\x20you\x20do\x20<i>during</i>\x20the\x20review.\x20Together\x20they\x20ensure\x20your\x20recall\x20efforts\x20hit\x20memory’s\x20“sweet\x20spot.”\x20Anki\x20is\x20the\x20most\x20effective\x20way\x20to\x20implement\x20this\x20combo.</p>','bold','Content\x20blocked\x20for:\x20','onerror','#genericInput','cleanupOldBackups','Do\x20a\x20few\x20deep-breathing\x20cycles.','idle','right','toast','Break\x20','Delete','method-title','function','playVideo','toISOString','menu-item','&amp;','var(--muted)','#btnBreakEarly','reload','stringify','sine','getPropertyValue','foreColor','timerState_','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20its\x20Knowledge\x20Base.</p>','--panel-opacity','#audioWorkEnd','tickHandle','soundTheme','PLAYING','pomodoroData_v11','show','toLocaleDateString','ytUrlFeedback','transaction','#btnDashboard','long','click','Rename\x20Topic','Note\x20saved','\x27\x20·\x20Mode\x20','input','Failed\x20to\x20delete\x20summary:','getSettings','updateSettings','currentDurations','focus','includes','classList','display','Gemini\x20error:\x20','#btnEnableSound','To\x20You,\x20100\x20Hours\x20of\x20Dedication\x20(Commitment)','text/plain','AudioContext','newIndex','startsWith','enableWinddown','finished','Saved\x20alert\x20for\x20LONG\x20BREAK.','appendChild','test','getBoundingClientRect','#btnAutoFormat','load','durationMinutes','start','Check\x20your\x20breathing—if\x20rushed,\x20slow\x20it\x20down.','updateUI','exponentialRampToValueAtTime','Disabled\x20YouTube\x20background\x20to\x20suit\x20the\x20light\x20theme.'];_0x5cd2=function(){return _0x313764;};return _0x5cd2();}function onPlayerReady(_0x3220ef){const _0x24c226=_0x36046b;try{const _0x54da9f=ytPlayer&&ytPlayer[_0x24c226(0x2de)]?ytPlayer[_0x24c226(0x2de)]():null;_0x54da9f&&_0x54da9f[_0x24c226(0x369)]('allow',_0x24c226(0x41a));}catch(_0x1eb873){}try{if(ytPlayer&&ytPlayer[_0x24c226(0x2d5)])ytPlayer['setVolume'](data&&data[_0x24c226(0x476)]&&data[_0x24c226(0x476)][_0x24c226(0x423)]||0x50);}catch(_0x23aa5){}try{const _0x532c65=getActiveVideoId&&getActiveVideoId();if(_0x532c65&&ytPlayer&&ytPlayer[_0x24c226(0x372)]&&ytPlayer[_0x24c226(0x3d6)]){ytPlayer[_0x24c226(0x372)](),ytPlayer[_0x24c226(0x3d6)](),_ytPrimed=!![];const _0x167c4a=()=>{const _0x3d6a8d=_0x24c226;if(_ytUnlocked)return;try{unlockAudioChain();}catch(_0x444862){}window[_0x3d6a8d(0x2dd)](_0x3d6a8d(0x211),_0x167c4a,!![]),window[_0x3d6a8d(0x2dd)](_0x3d6a8d(0x46f),_0x167c4a,!![]);};window[_0x24c226(0x2f6)](_0x24c226(0x211),_0x167c4a,!![]),window[_0x24c226(0x2f6)](_0x24c226(0x46f),_0x167c4a,!![]),showSoundPermission();}}catch(_0x4d9760){}updateYouTubePlayer();}function onPlayerStateChange(_0x486a43){const _0xffdcbd=_0x36046b,_0x446665=$(_0xffdcbd(0x4a8));_0x486a43['data']==YT[_0xffdcbd(0x286)][_0xffdcbd(0x3e7)]?(_0x446665['textContent']='⏸️',hideSoundPermission()):_0x446665[_0xffdcbd(0x2a4)]='▶️';if(_0x486a43[_0xffdcbd(0x2b2)]===YT['PlayerState'][_0xffdcbd(0x1ef)]){if(!ytUserPaused)ytPlayer[_0xffdcbd(0x3d6)]();}}async function ytFadeTo(_0x53bc3a,_0x1f6a52=0xfa){const _0x4a8c79=_0x36046b;try{if(!ytPlayer||!ytPlayer[_0x4a8c79(0x382)]||!ytPlayer[_0x4a8c79(0x2d5)])return;ytPlayer[_0x4a8c79(0x48f)]();const _0x166a13=ytPlayer[_0x4a8c79(0x382)](),_0x5bf309=_0x53bc3a-_0x166a13;if(Math['abs'](_0x5bf309)<0x1||_0x1f6a52<=0x0){ytPlayer[_0x4a8c79(0x2d5)](_0x53bc3a);return;}const _0x5cf665=performance[_0x4a8c79(0x31e)]();await new Promise(_0x5ed611=>{const _0x710189=_0x50ed88=>{const _0x434361=_0x365d,_0x2fceaa=Math[_0x434361(0x3bd)](0x1,(_0x50ed88-_0x5cf665)/_0x1f6a52),_0x759991=Math[_0x434361(0x25e)](_0x166a13+_0x5bf309*_0x2fceaa);ytPlayer['setVolume'](_0x759991);if(_0x2fceaa<0x1)requestAnimationFrame(_0x710189);else _0x5ed611();};requestAnimationFrame(_0x710189);});}catch(_0x355cc9){}}async function ytFadeInPlay(_0x5daf47=0xdc){const _0x1e70fd=_0x36046b;try{const _0x53bde9=Math[_0x1e70fd(0x4ab)](0x0,Math['min'](0x64,data&&data[_0x1e70fd(0x476)]&&data['settings'][_0x1e70fd(0x423)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;ytPlayer[_0x1e70fd(0x48f)](),ytPlayer[_0x1e70fd(0x3d6)]();try{ytPlayer[_0x1e70fd(0x2d5)](0x0);}catch(_0x2bf4de){}await ytFadeTo(_0x53bde9,_0x5daf47);}else{const _0x3c51f5=getActiveVideoId();_0x3c51f5&&fallbackLoadVideo(_0x3c51f5,{'autoplay':0x1,'mute':0x0});}}catch(_0x53b9da){}}async function ytFadeOutPause(_0x531390=0xb4){const _0xe0d987=_0x36046b;try{const _0x4f8168=Math[_0xe0d987(0x4ab)](0x0,Math[_0xe0d987(0x3bd)](0x64,data&&data['settings']&&data[_0xe0d987(0x476)][_0xe0d987(0x423)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;await ytFadeTo(0x0,_0x531390);try{ytPlayer[_0xe0d987(0x4e5)](),ytPlayer[_0xe0d987(0x2d5)](_0x4f8168);}catch(_0x523744){}}else try{fallbackPause();}catch(_0x4e55f3){}}catch(_0x31bbc3){}}async function updateYouTubePlayer(){const _0xe11cac=_0x36046b,_0x318a9b=getActiveVideoId();if(data[_0xe11cac(0x476)][_0xe11cac(0x419)]&&_0x318a9b){const _0x1a03bf=_0xe11cac(0x43f)+_0x318a9b+_0xe11cac(0x462),_0x1ce306=new Image();_0x1ce306[_0xe11cac(0x2c7)]=async()=>{const _0x25ad63=_0xe11cac;data[_0x25ad63(0x476)]['customBg']=_0x1a03bf,await saveData(),applyCustomBg();},_0x1ce306[_0xe11cac(0x3cb)]=async()=>{const _0x3b7f75=_0xe11cac,_0x1cb3de=_0x3b7f75(0x43f)+_0x318a9b+_0x3b7f75(0x356);data[_0x3b7f75(0x476)][_0x3b7f75(0x1de)]=_0x1cb3de,await saveData(),applyCustomBg();},_0x1ce306[_0xe11cac(0x26c)]=_0x1a03bf;}else!_0x318a9b&&(data[_0xe11cac(0x476)][_0xe11cac(0x1de)]='',await saveData(),applyCustomBg());if(IS_FILE_PROTOCOL){if(!_0x318a9b){fallbackStop(),hideSoundPermission();return;}const _0x26cad=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x318a9b,{'autoplay':0x1,'mute':_0x26cad});!_ytUnlocked&&showSoundPermission();return;}if(!ytPlayer||!ytPlayer[_0xe11cac(0x2f9)]){try{ensureYouTubeAPI();}catch(_0x505716){}return;}if(!_0x318a9b){if(ytPlayer['stopVideo'])ytPlayer['stopVideo']();hideSoundPermission();return;}ytPlayer[_0xe11cac(0x2f9)](_0x318a9b),ytPlayer['setVolume'](data[_0xe11cac(0x476)][_0xe11cac(0x423)]);}function toggleYtSound(){const _0x5eea25=_0x36046b;if(!_ytUnlocked){try{ensureAudio();}catch(_0x42aa18){}try{unlockAudioChain();}catch(_0x207961){}return;}if(IS_FILE_PROTOCOL){const _0x259b14=getActiveVideoId();if(!ytFallbackFrame||!ytFallbackFrame[_0x5eea25(0x33d)]){if(!_0x259b14){toast(_0x5eea25(0x204));return;}fallbackLoadVideo(_0x259b14,{'autoplay':0x1,'mute':0x0}),ytFallbackIsPlaying=!![];try{const _0x367dde=document[_0x5eea25(0x2ab)](_0x5eea25(0x359));if(_0x367dde)_0x367dde[_0x5eea25(0x2a4)]='⏸️';}catch(_0x25e6f3){}toast(_0x5eea25(0x345));return;}if(ytFallbackIsPlaying)fallbackPostMessage('pauseVideo'),ytFallbackIsPlaying=![],toast(_0x5eea25(0x38f));else{if(!_0x259b14){toast(_0x5eea25(0x204));return;}fallbackPostMessage(_0x5eea25(0x3d6)),ytFallbackIsPlaying=!![],toast(_0x5eea25(0x345));}try{const _0x59c4b1=document[_0x5eea25(0x2ab)](_0x5eea25(0x359));if(_0x59c4b1)_0x59c4b1['textContent']=ytFallbackIsPlaying?'⏸️':'▶️';}catch(_0x5452c9){}return;}if(!ytPlayer||typeof ytPlayer[_0x5eea25(0x3aa)]!==_0x5eea25(0x3d5)){try{ensureYouTubeAPI();}catch(_0x887077){}return;}const _0x1d2473=ytPlayer[_0x5eea25(0x3aa)]();_0x1d2473===YT['PlayerState']['PLAYING']||_0x1d2473===YT[_0x5eea25(0x286)][_0x5eea25(0x433)]?(ytFadeOutPause(),ytUserPaused=!![],toast('Background\x20music\x20stopped.')):(ytFadeInPlay(),ytUserPaused=![],toast(_0x5eea25(0x345)));}function bindEvents(){const _0x17256d=_0x36046b;try{const _0x2da089=document[_0x17256d(0x3b1)](_0x17256d(0x3be));_0x2da089&&(_0x2da089[_0x17256d(0x3c3)]='Get\x20started\x20by\x20selecting\x20a\x20<strong>Subtopic</strong>\x20or\x20creating\x20a\x20Topic.');}catch(_0x5a5c10){}on($(_0x17256d(0x28f)),_0x17256d(0x3ef),toggleBackgroundView),on($(_0x17256d(0x295)),_0x17256d(0x3ef),()=>{const _0xbba86a=_0x17256d;$('#modalMilestone')[_0xbba86a(0x3fa)][_0xbba86a(0x30e)](_0xbba86a(0x3e9));try{releaseFocus();}catch(_0x337373){}}),on($('#btnAddTopic'),'click',()=>showInputModal(_0x17256d(0x255),async _0x197234=>{const _0x443f81=_0x17256d;if(!_0x197234)return;data[_0x443f81(0x20a)][_0x443f81(0x298)]({'id':uid('t'),'name':_0x197234,'subtopics':[]}),await saveData(),renderTopics();})),on($(_0x17256d(0x31a)),'click',()=>storageManager[_0x17256d(0x455)](data)),on($('#importFile'),_0x17256d(0x23f),_0x13054a=>{const _0x4f4fd9=_0x17256d,_0x1f49b9=_0x13054a['target'][_0x4f4fd9(0x28e)][0x0];if(!_0x1f49b9)return;storageManager[_0x4f4fd9(0x24b)](_0x1f49b9)[_0x4f4fd9(0x472)](async _0x5444a5=>{const _0x14cf20=_0x4f4fd9;data=_0x5444a5,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),toast(_0x14cf20(0x47d)),renderAll();})['catch'](_0x5b1cd7=>toast(_0x4f4fd9(0x253)+_0x5b1cd7['message'])),_0x13054a[_0x4f4fd9(0x2e7)][_0x4f4fd9(0x327)]=null;}),on($(_0x17256d(0x4c8)),_0x17256d(0x3ef),()=>{const _0x43f40e=_0x17256d,_0x36955f=$('#backupList'),_0x6fdc11=_0x36955f?_0x36955f['value']:'';if(!_0x6fdc11){toast(_0x43f40e(0x3c2));return;}showConfirmModal(_0x43f40e(0x42c),_0x43f40e(0x32e)+new Date(_0x6fdc11)['toLocaleDateString']()+_0x43f40e(0x4e6),_0x142de5=>{const _0x47b795=_0x43f40e;_0x142de5&&storageManager[_0x47b795(0x4e7)](_0x6fdc11)[_0x47b795(0x472)](_0x2b93ae=>{const _0x5e6341=_0x47b795;data=_0x2b93ae,toast(_0x5e6341(0x35c)),setTimeout(()=>window[_0x5e6341(0x316)][_0x5e6341(0x3dc)](),0x5dc);})[_0x47b795(0x2c6)](_0x32888c=>{const _0x555260=_0x47b795;toast(_0x555260(0x258)+_0x32888c['message']);});});}),on($('#set_theme_color'),_0x17256d(0x3f3),_0x23bdba=>{const _0x3943dc=_0x17256d,_0x286e1f=_0x23bdba[_0x3943dc(0x2e7)]['value'];applyTheme(_0x286e1f);if(_0x286e1f===_0x3943dc(0x45a)||_0x286e1f==='pastel'){const _0x4cc492=$('#set_ytThumbAsBg');_0x4cc492&&(_0x4cc492[_0x3943dc(0x2a1)]=![],toast(_0x3943dc(0x410),0x7d0));try{document[_0x3943dc(0x350)][_0x3943dc(0x335)][_0x3943dc(0x2ea)](_0x3943dc(0x37f),_0x3943dc(0x224));}catch(_0x4c9134){}}else{const _0x4aa139=$('#set_ytThumbAsBg');_0x4aa139&&(_0x4aa139['checked']=!![]);try{updateYouTubePlayer();}catch(_0x440059){}}}),on($(_0x17256d(0x4a7)),'click',openSettings),on($('#btnHelpCreateTopic'),'click',()=>{const _0x32192a=_0x17256d;switchView(_0x32192a(0x20a)),$(_0x32192a(0x240))['click']();}),on($(_0x17256d(0x3ed)),'click',()=>{const _0x292fcd=_0x17256d;renderDashboard(),$(_0x292fcd(0x436))['classList']['add']('show');}),on($('#btnCloseDashboard'),_0x17256d(0x3ef),()=>{const _0x15c4e9=_0x17256d;$(_0x15c4e9(0x436))[_0x15c4e9(0x3fa)][_0x15c4e9(0x30e)](_0x15c4e9(0x3e9));}),on($(_0x17256d(0x4b4)),'click',closeSettings),on($('#btnSaveSettings'),_0x17256d(0x3ef),saveSettings),on($('#btnDefaults'),_0x17256d(0x3ef),setDefaults),on($(_0x17256d(0x435)),_0x17256d(0x3ef),()=>{const _0xaee311=_0x17256d;ensureAudio(),playSound(_0xaee311(0x282));}),on($(_0x17256d(0x259)),_0x17256d(0x3ef),_0x62aecd=>{const _0x40faa5=_0x17256d;_0x62aecd[_0x40faa5(0x242)]();const _0x520572=$('#customSoundsContainer');if(_0x520572)_0x520572[_0x40faa5(0x3fa)]['toggle'](_0x40faa5(0x454));}),on($(_0x17256d(0x374)),_0x17256d(0x3ef),async()=>{const _0x2b8e87=_0x17256d,_0xa9f2a9=getCurrentSubtopic();if(!_0xa9f2a9)return;const _0x4cda79=pendingNoteSessionId,_0x5a23ed=_0xa9f2a9[_0x2b8e87(0x351)][_0x2b8e87(0x21f)](_0xbd63c2=>_0xbd63c2['id']===_0x4cda79);_0x5a23ed&&(_0x5a23ed[_0x2b8e87(0x458)]=$(_0x2b8e87(0x288))[_0x2b8e87(0x327)][_0x2b8e87(0x4dd)](),await saveData(),renderStatsHistory(),toast(_0x2b8e87(0x3f1))),closeNoteModal();}),on($('#btnSkipNote'),_0x17256d(0x3ef),()=>closeNoteModal()),on($(_0x17256d(0x389)),_0x17256d(0x3ef),addGeneralNote),on($(_0x17256d(0x45c)),'click',handleSummarizeNote),on($(_0x17256d(0x37c)),'click',handleSendMessage),on($('#chatInput'),_0x17256d(0x46f),_0x36bddd=>{const _0x307216=_0x17256d;if(_0x36bddd[_0x307216(0x468)]===_0x307216(0x287))handleSendMessage();}),$$('#aiPromptSuggestions\x20button')[_0x17256d(0x229)](_0x107ea5=>{const _0x39835a=_0x17256d;on(_0x107ea5,_0x39835a(0x3ef),()=>{const _0x10d111=_0x39835a,_0x2099f6=_0x107ea5[_0x10d111(0x227)]['prompt'];$(_0x10d111(0x499))[_0x10d111(0x327)]=_0x2099f6,$(_0x10d111(0x499))[_0x10d111(0x3f8)]();});}),on($('#btnClearChat'),'click',clearChat),on($('#btnAddSubtopicTask'),_0x17256d(0x3ef),addSubtopicTask),on($('#newSubtopicTaskInput'),_0x17256d(0x46f),_0x154967=>{const _0xd02d52=_0x17256d;if(_0x154967[_0xd02d52(0x468)]===_0xd02d52(0x287))addSubtopicTask();}),on($(_0x17256d(0x4a8)),_0x17256d(0x3ef),toggleYtSound),on($(_0x17256d(0x3fd)),_0x17256d(0x3ef),()=>{ensureAudio(),unlockAudioChain();}),on($(_0x17256d(0x4b2)),'input',_0x31278a=>{const _0x5a7000=_0x17256d,_0x462b11=parseInt(_0x31278a[_0x5a7000(0x2e7)][_0x5a7000(0x327)],0xa);ytPlayer&&ytPlayer['setVolume']&&ytPlayer[_0x5a7000(0x2d5)](_0x462b11);}),on($(_0x17256d(0x285)),'input',handleYoutubeUrlInput),$$(_0x17256d(0x212))[_0x17256d(0x229)](_0x50e38c=>{const _0x3926ec=_0x17256d;_0x50e38c['addEventListener'](_0x3926ec(0x3ef),()=>{const _0x4f3ad7=_0x3926ec,_0x5818b8=_0x50e38c[_0x4f3ad7(0x227)]['view'],_0x546a78=data?.[_0x4f3ad7(0x476)]?.[_0x4f3ad7(0x469)]||_0x4f3ad7(0x310);if(_0x546a78===_0x5818b8&&_0x5818b8!==_0x4f3ad7(0x310))switchView(_0x4f3ad7(0x310));else switchView(_0x5818b8);});}),$$(_0x17256d(0x2fb))[_0x17256d(0x229)](_0xd138e9=>{const _0x5c4d3d=_0x17256d;_0xd138e9[_0x5c4d3d(0x2f6)](_0x5c4d3d(0x3ef),()=>{const _0x57b9bf=_0x5c4d3d,_0x5d9a18=_0xd138e9[_0x57b9bf(0x227)]['tab'],_0x5db990=_0xd138e9[_0x57b9bf(0x44c)](_0x57b9bf(0x21a));if(!_0x5db990)return;_0x5db990[_0x57b9bf(0x482)]('.tab-btn')[_0x57b9bf(0x229)](_0x44f45b=>_0x44f45b[_0x57b9bf(0x3fa)][_0x57b9bf(0x30e)]('active')),_0xd138e9['classList']['add'](_0x57b9bf(0x3b5)),_0x5db990[_0x57b9bf(0x482)](_0x57b9bf(0x3b2))[_0x57b9bf(0x229)](_0x228ae3=>{const _0x745de6=_0x57b9bf;_0x228ae3[_0x745de6(0x3fa)][_0x745de6(0x30e)]('active'),_0x228ae3['style'][_0x745de6(0x3fb)]='none';});const _0x54ff71=_0x5db990[_0x57b9bf(0x3b1)]('#'+_0x5d9a18);_0x54ff71&&(_0x54ff71[_0x57b9bf(0x3fa)]['add'](_0x57b9bf(0x3b5)),_0x54ff71[_0x57b9bf(0x335)]['display']=_0x57b9bf(0x341),_0x5db990[_0x57b9bf(0x44c)](_0x57b9bf(0x294))&&(_0x54ff71['style'][_0x57b9bf(0x3fb)]=_0x57b9bf(0x226)));});});const _0x41fcf8=$(_0x17256d(0x45e));function _0x276660(_0x33495a,_0x12a32d=null){const _0x5c9188=_0x17256d;try{document[_0x5c9188(0x493)](_0x5c9188(0x28c),![],!![]);}catch(_0x57ec78){}try{document[_0x5c9188(0x493)](_0x33495a,![],_0x12a32d);}catch(_0x47f0c1){}if(_0x41fcf8)_0x41fcf8[_0x5c9188(0x3f8)]();}on($(_0x17256d(0x4e9)),_0x17256d(0x3ef),()=>_0x276660(_0x17256d(0x3c9))),on($('#toolItalic'),_0x17256d(0x3ef),()=>_0x276660('italic')),on($(_0x17256d(0x29f)),_0x17256d(0x3ef),()=>_0x276660(_0x17256d(0x21c),_0x17256d(0x4d7))),on($('#toolList'),_0x17256d(0x3ef),()=>_0x276660(_0x17256d(0x21b))),on($(_0x17256d(0x2a0)),_0x17256d(0x3ef),()=>_0x276660(_0x17256d(0x465)));const _0xebe22a=$('.color-picker-wrapper'),_0x1def63=$(_0x17256d(0x443));on($(_0x17256d(0x318)),_0x17256d(0x3ef),_0x4f3861=>{const _0x1c4857=_0x17256d;if(!_0x1def63)return;_0x4f3861['stopPropagation'](),_0x1def63[_0x1c4857(0x3fa)]['toggle'](_0x1c4857(0x454));}),$$('.color-swatch')[_0x17256d(0x229)](_0x474dc0=>{const _0x4f24b3=_0x17256d;on(_0x474dc0,_0x4f24b3(0x3ef),_0x1d3255=>{const _0x377d9d=_0x4f24b3;_0x1d3255['preventDefault']();const _0x433561=_0x474dc0[_0x377d9d(0x227)][_0x377d9d(0x27a)]||'';let _0x504d39=_0x433561;try{const _0x4fadd3=_0x433561['match'](/--[a-zA-Z0-9_-]+/);if(_0x4fadd3)_0x504d39=getComputedStyle(document[_0x377d9d(0x350)])[_0x377d9d(0x3df)](_0x4fadd3[0x0])[_0x377d9d(0x4dd)]();}catch(_0x1388b4){}_0x276660(_0x377d9d(0x3e0),_0x504d39);if(_0x1def63)_0x1def63[_0x377d9d(0x3fa)][_0x377d9d(0x478)]('hidden');});}),on(document,_0x17256d(0x3ef),_0x15f7d5=>{const _0x4aade7=_0x17256d;if(!_0xebe22a||!_0x1def63)return;!_0xebe22a[_0x4aade7(0x2ec)](_0x15f7d5[_0x4aade7(0x2e7)])&&!_0x1def63[_0x4aade7(0x3fa)][_0x4aade7(0x2ec)](_0x4aade7(0x454))&&_0x1def63[_0x4aade7(0x3fa)][_0x4aade7(0x478)](_0x4aade7(0x454));});function _0x4da600(_0x2e124f){const _0x103f1d=_0x17256d,_0x1caa9f=getCurrentSubtopic();if(!_0x1caa9f){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}const _0x1ccc71=Array[_0x103f1d(0x4c7)](_0x1caa9f[_0x103f1d(0x1f7)])?_0x1caa9f[_0x103f1d(0x1f7)]:[],_0x5aa40e=_0x2e124f?_0x1ccc71[_0x103f1d(0x21f)](_0x2f3f47=>_0x2f3f47['id']===_0x2e124f):null;$('#methodEditorId')[_0x103f1d(0x327)]=_0x5aa40e&&_0x5aa40e['id']||'',$(_0x103f1d(0x425))[_0x103f1d(0x2a4)]=_0x5aa40e?_0x103f1d(0x34e):'Add\x20New\x20Knowledge',$('#methodEditorTitleInput')[_0x103f1d(0x327)]=_0x5aa40e&&_0x5aa40e[_0x103f1d(0x49b)]||'';const _0x107d04=$('#methodEditorContentInput');if(_0x107d04)_0x107d04[_0x103f1d(0x3c3)]=_0x5aa40e&&_0x5aa40e[_0x103f1d(0x333)]||'';$('#modalMethodEditor')['classList'][_0x103f1d(0x478)](_0x103f1d(0x3e9));try{trapFocus($('#modalMethodEditor'));}catch(_0x330da1){}try{const _0x3b10a7=$('#btnAutoFormat');if(_0x3b10a7){const _0x5157ae=!!(data?.[_0x103f1d(0x476)]?.['apiKey']&&data[_0x103f1d(0x476)][_0x103f1d(0x43b)][_0x103f1d(0x4dd)]());_0x3b10a7[_0x103f1d(0x4e8)]=!_0x5157ae,_0x3b10a7[_0x103f1d(0x49b)]=_0x5157ae?_0x103f1d(0x2e6):'Please\x20add\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings\x20to\x20use\x20this\x20feature.';}}catch(_0x5226bd){}}on($(_0x17256d(0x26a)),_0x17256d(0x3ef),()=>{const _0x11ecb4=_0x17256d;$('#modalMethodEditor')[_0x11ecb4(0x3fa)][_0x11ecb4(0x30e)](_0x11ecb4(0x3e9));try{releaseFocus();}catch(_0x40c4fc){}}),on($(_0x17256d(0x1f3)),'click',async()=>{const _0x12458a=_0x17256d,_0x2fcba0=$(_0x12458a(0x2d7))[_0x12458a(0x327)]||uid('m'),_0x1f5fd8=($(_0x12458a(0x3a7))[_0x12458a(0x327)]||'')['trim'](),_0x5747fd=$(_0x12458a(0x45e)),_0xb00260=_0x5747fd?_0x5747fd['innerHTML']||'':'',_0x4a59ec=getCurrentSubtopic();if(!_0x4a59ec){toast(_0x12458a(0x3b6));return;}if(!Array[_0x12458a(0x4c7)](_0x4a59ec[_0x12458a(0x1f7)]))_0x4a59ec[_0x12458a(0x1f7)]=[];const _0x95713c=_0x4a59ec[_0x12458a(0x1f7)][_0x12458a(0x34c)](_0x3f3c3a=>_0x3f3c3a['id']===_0x2fcba0),_0x233a07={'id':_0x2fcba0,'title':_0x1f5fd8,'content':_0xb00260};if(_0x95713c>=0x0)_0x4a59ec[_0x12458a(0x1f7)][_0x95713c]=_0x233a07;else _0x4a59ec[_0x12458a(0x1f7)][_0x12458a(0x416)](_0x233a07);await saveData(),renderMethods(),$(_0x12458a(0x48c))[_0x12458a(0x3fa)][_0x12458a(0x30e)](_0x12458a(0x3e9));try{releaseFocus();}catch(_0x2e8450){}}),on($(_0x17256d(0x409)),_0x17256d(0x3ef),async()=>{const _0x13348a=_0x17256d,_0x4326b8=$(_0x13348a(0x45e));if(!_0x4326b8)return;const _0x50dcfb=(_0x4326b8[_0x13348a(0x2a4)]||'')[_0x13348a(0x4dd)]();if(!_0x50dcfb||_0x50dcfb[_0x13348a(0x1e7)]<0x14){toast(_0x13348a(0x352));return;}const _0x288bee=$(_0x13348a(0x409));_0x288bee&&(_0x288bee['disabled']=!![],_0x288bee['innerHTML']='<div\x20class=\x22spinner\x22></div>');const _0x49fdca=_0x13348a(0x4d0)+_0x50dcfb+'\x22',_0x47c4b3=await callGeminiAPI(_0x49fdca);_0x47c4b3?(_0x4326b8['innerHTML']=_0x47c4b3,toast(_0x13348a(0x4be))):toast(_0x13348a(0x293)),_0x288bee&&(_0x288bee['disabled']=![],_0x288bee['innerHTML']='✨\x20Auto-format');}),on($(_0x17256d(0x4b3)),_0x17256d(0x3ef),()=>_0x4da600());const _0x92a868=document[_0x17256d(0x3b1)]('#view-methods');_0x92a868&&_0x92a868[_0x17256d(0x2f6)](_0x17256d(0x3ef),_0x4a9f59=>{const _0x1f3347=_0x17256d,_0x5b6a02=_0x4a9f59['target'][_0x1f3347(0x44c)]&&_0x4a9f59[_0x1f3347(0x2e7)][_0x1f3347(0x44c)](_0x1f3347(0x2c3)),_0x44d9b7=!_0x5b6a02&&_0x4a9f59[_0x1f3347(0x2e7)][_0x1f3347(0x44c)]&&_0x4a9f59[_0x1f3347(0x2e7)][_0x1f3347(0x44c)]('.method-delete');if(_0x5b6a02){_0x4a9f59[_0x1f3347(0x242)](),_0x4a9f59[_0x1f3347(0x1e4)]();const _0x40462c=_0x5b6a02['dataset']['id'];if(_0x40462c)_0x4da600(_0x40462c);return;}if(_0x44d9b7){_0x4a9f59[_0x1f3347(0x242)](),_0x4a9f59[_0x1f3347(0x1e4)]();const _0x39500b=_0x44d9b7['dataset']['id'];if(!_0x39500b)return;const _0x239fa8=getCurrentSubtopic();if(!_0x239fa8){toast(_0x1f3347(0x3b6));return;}const _0x2c9b72=Array[_0x1f3347(0x4c7)](_0x239fa8[_0x1f3347(0x1f7)])?_0x239fa8[_0x1f3347(0x1f7)]:[],_0x3952f1=_0x2c9b72[_0x1f3347(0x21f)](_0x147635=>_0x147635['id']===_0x39500b);if(!_0x3952f1)return;showConfirmModal(_0x1f3347(0x248),'Delete\x20knowledge\x20\x22'+(_0x3952f1[_0x1f3347(0x49b)]||'')+'\x22?',async _0x140371=>{if(!_0x140371)return;_0x239fa8['methods']=_0x2c9b72['filter'](_0x1e56bc=>_0x1e56bc['id']!==_0x39500b),await saveData(),renderMethods();});}});$$(_0x17256d(0x2e9))['forEach'](_0x2df5e6=>{const _0x28634f=_0x17256d;_0x2df5e6[_0x28634f(0x2f6)](_0x28634f(0x3ef),()=>{const _0x574f89=_0x28634f;editingPreset=_0x2df5e6[_0x574f89(0x227)][_0x574f89(0x41c)],highlightPresetSelector(),loadEditingPresetFields();});}),$$(_0x17256d(0x441))['forEach'](_0x1c4eb3=>{const _0x2f07e1=_0x17256d;_0x1c4eb3[_0x2f07e1(0x2f6)](_0x2f07e1(0x3ef),_0x477a13=>{const _0x26507f=_0x2f07e1,_0xb5afc7=_0x477a13[_0x26507f(0x2e7)][_0x26507f(0x227)][_0x26507f(0x219)],_0xbabd45=data['settings'][_0x26507f(0x219)];if(_0xb5afc7===_0xbabd45)return;timer[_0x26507f(0x392)]!==_0x26507f(0x3cf)?showConfirmModal('Confirm\x20Switch','Switch\x20to\x20Style\x20'+_0xb5afc7+_0x26507f(0x4bd),_0x4a0392=>{const _0x2e26e0=_0x26507f;_0x4a0392&&(timer['reset'](),timer[_0x2e26e0(0x1f6)](_0xb5afc7),renderAll(),toast(_0x2e26e0(0x42a)+_0xb5afc7+'.'));}):(timer['setPreset'](_0xb5afc7),renderAll(),toast('Switched\x20to\x20Style\x20'+_0xb5afc7+'.'));});}),on($(_0x17256d(0x257)),_0x17256d(0x3ef),()=>timer[_0x17256d(0x40c)]()),on($(_0x17256d(0x411)),_0x17256d(0x3ef),()=>timer[_0x17256d(0x25b)]()),on($(_0x17256d(0x46e)),_0x17256d(0x3ef),()=>timer[_0x17256d(0x289)]()),on($(_0x17256d(0x3b3)),_0x17256d(0x3ef),()=>timer[_0x17256d(0x221)]()),on($('#btnSkip'),'click',()=>timer[_0x17256d(0x2c4)]()),on($(_0x17256d(0x34d)),_0x17256d(0x3ef),()=>timer[_0x17256d(0x44a)]()),on($(_0x17256d(0x3db)),_0x17256d(0x3ef),()=>timer['beginBreak']()),on($(_0x17256d(0x399)),_0x17256d(0x23f),_0x6343fa=>{const _0x3031c9=_0x17256d;handleFileUpload(_0x6343fa[_0x3031c9(0x2e7)][_0x3031c9(0x28e)][0x0],async _0xe69842=>{const _0x5a6380=_0x3031c9;data['settings']['customBg']=_0xe69842,await saveData(),applyCustomBg(),toast(_0x5a6380(0x456));}),_0x6343fa[_0x3031c9(0x2e7)]['value']=null;}),on($(_0x17256d(0x290)),_0x17256d(0x3ef),async()=>{const _0x55a033=_0x17256d;data[_0x55a033(0x476)]['customBg']='',data['settings']['useYtThumbnailAsBg']=![],await saveData(),applyCustomBg(),toast(_0x55a033(0x271)),$(_0x55a033(0x294))[_0x55a033(0x3fa)][_0x55a033(0x2ec)](_0x55a033(0x3e9))&&openSettings();}),on($(_0x17256d(0x225)),_0x17256d(0x23f),_0x65cd82=>{const _0x530552=_0x17256d;handleFileUpload(_0x65cd82[_0x530552(0x2e7)][_0x530552(0x28e)][0x0],async _0x318533=>{const _0x5b048d=_0x530552;data['settings'][_0x5b048d(0x2f1)][_0x5b048d(0x282)]=_0x318533,await saveData(),toast(_0x5b048d(0x431));}),_0x65cd82[_0x530552(0x2e7)][_0x530552(0x327)]=null;}),on($(_0x17256d(0x43c)),_0x17256d(0x23f),_0xae2992=>{const _0x3948db=_0x17256d;handleFileUpload(_0xae2992[_0x3948db(0x2e7)][_0x3948db(0x28e)][0x0],async _0x18d4ae=>{const _0x935f2f=_0x3948db;data[_0x935f2f(0x476)][_0x935f2f(0x2f1)][_0x935f2f(0x31c)]=_0x18d4ae,await saveData(),toast(_0x935f2f(0x2e2));}),_0xae2992[_0x3948db(0x2e7)][_0x3948db(0x327)]=null;}),on($(_0x17256d(0x254)),_0x17256d(0x23f),_0x3066b8=>{const _0x3ba757=_0x17256d;handleFileUpload(_0x3066b8[_0x3ba757(0x2e7)]['files'][0x0],async _0x254050=>{const _0x2c556c=_0x3ba757;data[_0x2c556c(0x476)]['customSounds']['long_end']=_0x254050,await saveData(),toast(_0x2c556c(0x405));}),_0x3066b8['target'][_0x3ba757(0x327)]=null;}),on($(_0x17256d(0x280)),_0x17256d(0x3ef),toggleFullScreen),document['addEventListener']('fullscreenchange',updateFullscreenButton),window[_0x17256d(0x2f6)](_0x17256d(0x46f),_0x17edc4=>{const _0x56ff9e=_0x17256d,_0x165970=_0x17edc4[_0x56ff9e(0x2e7)],_0x224798=(_0x165970[_0x56ff9e(0x358)]||'')['toLowerCase'](),_0x479431=[_0x56ff9e(0x3f3),_0x56ff9e(0x47a),'select'][_0x56ff9e(0x3f9)](_0x224798)||_0x165970['isContentEditable'];if(_0x17edc4[_0x56ff9e(0x284)]===_0x56ff9e(0x302)&&!_0x479431){_0x17edc4['preventDefault']();if(timer[_0x56ff9e(0x392)]==='idle'||timer[_0x56ff9e(0x392)]==='paused')timer['start']();else timer[_0x56ff9e(0x289)]();}(_0x17edc4['key']==='n'||_0x17edc4[_0x56ff9e(0x468)]==='N')&&(!_0x479431&&(_0x17edc4['preventDefault'](),timer[_0x56ff9e(0x2c4)]()));if(_0x17edc4[_0x56ff9e(0x468)]===_0x56ff9e(0x35d)){$$(_0x56ff9e(0x485))[_0x56ff9e(0x229)](_0x2c003e=>_0x2c003e['classList'][_0x56ff9e(0x30e)](_0x56ff9e(0x3e9)));try{releaseFocus();}catch(_0x4defe3){}}if(_0x17edc4[_0x56ff9e(0x354)]&&!_0x479431){if(_0x17edc4[_0x56ff9e(0x468)]===_0x56ff9e(0x4cb))_0x17edc4[_0x56ff9e(0x242)](),_0x291c7a(0x0,-0xa);else{if(_0x17edc4['key']===_0x56ff9e(0x420))_0x17edc4[_0x56ff9e(0x242)](),_0x291c7a(0x0,0xa);else{if(_0x17edc4[_0x56ff9e(0x468)]==='ArrowLeft')_0x17edc4['preventDefault'](),_0x291c7a(-0xa,0x0);else _0x17edc4[_0x56ff9e(0x468)]===_0x56ff9e(0x296)&&(_0x17edc4[_0x56ff9e(0x242)](),_0x291c7a(0xa,0x0));}}}}),$$(_0x17256d(0x485))['forEach'](_0xc967bd=>_0xc967bd[_0x17256d(0x2f6)](_0x17256d(0x3ef),_0xac32dd=>{const _0x2d363f=_0x17256d;if(_0xac32dd&&_0xac32dd[_0x2d363f(0x2e7)]&&_0xac32dd[_0x2d363f(0x2e7)]['id']==='modalMethodEditor')return;if(_0xac32dd[_0x2d363f(0x2e7)]===_0xc967bd){_0xc967bd[_0x2d363f(0x3fa)][_0x2d363f(0x30e)](_0x2d363f(0x3e9));try{releaseFocus();}catch(_0x3782dc){}}})),window[_0x17256d(0x2f6)]('click',_0xbdf94d=>{const _0x58632f=_0x17256d;!_0xbdf94d[_0x58632f(0x2e7)]['closest'](_0x58632f(0x32a))&&!_0xbdf94d[_0x58632f(0x2e7)]['closest'](_0x58632f(0x1e3))&&closeAllMenus();});try{const _0x1fd381=document['querySelector']('.app-content');if(_0x1fd381)_0x1fd381[_0x17256d(0x2f6)]('scroll',closeAllMenus);}catch(_0x1ec9b6){}try{window[_0x17256d(0x2f6)](_0x17256d(0x2bf),closeAllMenus,!![]);}catch(_0x232946){}window[_0x17256d(0x2f6)](_0x17256d(0x375),()=>timer[_0x17256d(0x492)](!![]));try{const _0xd3e6c=Array[_0x17256d(0x22e)](document['querySelectorAll'](_0x17256d(0x2cf)));_0xd3e6c['length']&&_0xd3e6c['forEach'](_0x1b1a6d=>{const _0xc30645=_0x17256d;_0x1b1a6d[_0xc30645(0x2f6)](_0xc30645(0x4c3),()=>{_0x1b1a6d['open']&&_0xd3e6c['forEach'](_0x2bd105=>{const _0xa9e364=_0x365d;if(_0x2bd105!==_0x1b1a6d)_0x2bd105[_0xa9e364(0x30d)]=![];});});});}catch(_0x4acfef){}const _0xe46fee=$(_0x17256d(0x2cd));let _0x44992f=![],_0x3bbedc,_0x3ac4f6;_0xe46fee&&(_0xe46fee['addEventListener'](_0x17256d(0x2a2),_0x5044e2=>{const _0x1a63d1=_0x17256d;_0x44992f=!![];const _0x35d528=_0xe46fee[_0x1a63d1(0x408)]();_0x3bbedc=_0x5044e2['clientX']-_0x35d528[_0x1a63d1(0x377)],_0x3ac4f6=_0x5044e2[_0x1a63d1(0x2d2)]-_0x35d528[_0x1a63d1(0x306)],_0xe46fee[_0x1a63d1(0x335)]['transition']=_0x1a63d1(0x224);}),document[_0x17256d(0x2f6)]('mousemove',_0x114ea4=>{const _0x870658=_0x17256d;if(!_0x44992f)return;let _0x400789=_0x114ea4[_0x870658(0x1df)]-_0x3bbedc,_0xabbf58=_0x114ea4[_0x870658(0x2d2)]-_0x3ac4f6;const _0x181d52=window[_0x870658(0x393)]-_0xe46fee[_0x870658(0x320)],_0x5227a8=window[_0x870658(0x2b5)]-_0xe46fee[_0x870658(0x328)];_0x400789=Math[_0x870658(0x4ab)](0x0,Math['min'](_0x400789,_0x181d52)),_0xabbf58=Math[_0x870658(0x4ab)](0x0,Math['min'](_0xabbf58,_0x5227a8)),_0xe46fee['style'][_0x870658(0x377)]=_0x400789+'px',_0xe46fee[_0x870658(0x335)]['top']=_0xabbf58+'px',_0xe46fee[_0x870658(0x335)][_0x870658(0x348)]=_0x870658(0x498),_0xe46fee['style']['right']=_0x870658(0x498);}),document[_0x17256d(0x2f6)]('mouseup',()=>{const _0x193273=_0x17256d;if(!_0x44992f)return;_0x44992f=![],_0xe46fee['style'][_0x193273(0x4a6)]='';}));function _0xb3abe(_0xd8a02f){const _0x416443=_0x17256d,_0x3c6309=$(_0x416443(0x2cd));if(!_0x3c6309)return;_0x3c6309[_0x416443(0x335)]['position']=_0x416443(0x490),_0x3c6309[_0x416443(0x335)][_0x416443(0x4a6)]='',_0x3c6309[_0x416443(0x335)][_0x416443(0x377)]=_0x416443(0x498),_0x3c6309[_0x416443(0x335)][_0x416443(0x306)]='auto',_0x3c6309['style'][_0x416443(0x3d0)]=_0x416443(0x498),_0x3c6309[_0x416443(0x335)][_0x416443(0x348)]='auto';const _0x26b05d=0x10;_0xd8a02f==='tl'&&(_0x3c6309['style'][_0x416443(0x377)]=_0x26b05d+'px',_0x3c6309['style']['top']=_0x26b05d+'px'),_0xd8a02f==='tr'&&(_0x3c6309[_0x416443(0x335)][_0x416443(0x3d0)]=_0x26b05d+'px',_0x3c6309[_0x416443(0x335)][_0x416443(0x306)]=_0x26b05d+'px'),_0xd8a02f==='bl'&&(_0x3c6309[_0x416443(0x335)][_0x416443(0x377)]=_0x26b05d+'px',_0x3c6309[_0x416443(0x335)]['bottom']=_0x26b05d+'px'),_0xd8a02f==='br'&&(_0x3c6309[_0x416443(0x335)][_0x416443(0x3d0)]=_0x26b05d+'px',_0x3c6309['style']['bottom']=_0x26b05d+'px');}function _0x291c7a(_0x5e913f,_0x3d24d1){const _0x339193=_0x17256d,_0x662091=$('#draggableTimer');if(!_0x662091)return;const _0x162c25=_0x662091[_0x339193(0x408)](),_0x4be6b=Math[_0x339193(0x4ab)](0x0,Math[_0x339193(0x3bd)](_0x162c25[_0x339193(0x377)]+_0x5e913f,window[_0x339193(0x393)]-_0x662091[_0x339193(0x320)])),_0x24d2a3=Math[_0x339193(0x4ab)](0x0,Math[_0x339193(0x3bd)](_0x162c25[_0x339193(0x306)]+_0x3d24d1,window['innerHeight']-_0x662091[_0x339193(0x328)]));_0x662091['style'][_0x339193(0x377)]=_0x4be6b+'px',_0x662091[_0x339193(0x335)][_0x339193(0x306)]=_0x24d2a3+'px',_0x662091[_0x339193(0x335)][_0x339193(0x3d0)]=_0x339193(0x498),_0x662091[_0x339193(0x335)][_0x339193(0x348)]='auto';}}function toggleBackgroundView(){const _0x585813=_0x36046b,_0x10de69=document['body'];_0x10de69[_0x585813(0x3fa)]['toggle'](_0x585813(0x20d));const _0x27cfe4=_0x10de69[_0x585813(0x3fa)][_0x585813(0x2ec)](_0x585813(0x20d)),_0x330ef2=$(_0x585813(0x28f));if(!_0x330ef2)return;_0x27cfe4?(_0x330ef2[_0x585813(0x49b)]=_0x585813(0x2da),_0x330ef2[_0x585813(0x3c3)]=_0x585813(0x41d)):(_0x330ef2['title']=_0x585813(0x363),_0x330ef2['innerHTML']=_0x585813(0x36e));}function updateMainViewVisibility(){const _0x2fd263=_0x36046b,_0x3bb035=!!getCurrentSubtopic(),_0x58dc32=$(_0x2fd263(0x439)),_0x22e2e6=$(_0x2fd263(0x379));_0x22e2e6&&_0x22e2e6['classList']['toggle'](_0x2fd263(0x454),_0x3bb035),_0x58dc32&&(_0x3bb035?_0x58dc32['classList'][_0x2fd263(0x30e)](_0x2fd263(0x26d)):_0x58dc32[_0x2fd263(0x3fa)][_0x2fd263(0x478)]('no-subtopic-selected'));}function updatePresetButtonsText(){const _0x1eb4f9=_0x36046b,_0x4b30db=data[_0x1eb4f9(0x476)],_0x266fc8=_0x4b30db[_0x1eb4f9(0x413)],_0x53f268=_0x4b30db[_0x1eb4f9(0x301)],_0x171d4c=_0x4b30db[_0x1eb4f9(0x370)]['A_work'],_0x47d3ff=_0x4b30db[_0x1eb4f9(0x370)]['B_work'],_0x40c97a=$('#btnPresetA'),_0x32ad79=$('#btnPresetB'),_0x34cb40=$(_0x1eb4f9(0x47c));_0x40c97a&&(_0x40c97a['textContent']=_0x266fc8+'×'+_0x171d4c+'\x20(A)'),_0x32ad79&&(_0x32ad79[_0x1eb4f9(0x2a4)]=_0x53f268+'×'+_0x47d3ff+_0x1eb4f9(0x264)),_0x34cb40&&(_0x34cb40['textContent']=_0x1eb4f9(0x283));}function renderAll(){const _0xcc78d8=_0x36046b;updatePresetButtonsText();const _0x385d11=data[_0xcc78d8(0x476)][_0xcc78d8(0x219)];$$('.presets\x20button')[_0xcc78d8(0x229)](_0x3127ce=>{const _0x3705a7=_0xcc78d8,_0x311b54=_0x3127ce[_0x3705a7(0x227)][_0x3705a7(0x219)]===_0x385d11;_0x3127ce[_0x3705a7(0x3fa)][_0x3705a7(0x4c3)](_0x3705a7(0x245),_0x311b54),_0x3127ce[_0x3705a7(0x3fa)][_0x3705a7(0x4c3)](_0x3705a7(0x2f3),!_0x311b54),_0x3127ce['setAttribute'](_0x3705a7(0x3a1),_0x311b54);}),updateMainViewVisibility(),timer[_0xcc78d8(0x1f6)](data['settings'][_0xcc78d8(0x219)],{'silent':!![]}),renderTopics(),renderContextBadge(),renderStatsHistory(),renderGeneralNotes(),renderMethods(),renderChat(),applyCustomBg(),applyPanelOpacity(),renderSubtopicTasks(),updateFullscreenButton(),switchView(data['settings']['currentView']);}function toggleFullScreen(){const _0x376a7c=_0x36046b;!document[_0x376a7c(0x20c)]?document[_0x376a7c(0x29a)]['requestFullscreen']()[_0x376a7c(0x2c6)](_0x441f86=>{const _0x261d5e=_0x376a7c;toast('Error:\x20Unable\x20to\x20enter\x20fullscreen:\x20'+_0x441f86[_0x261d5e(0x232)]);}):document[_0x376a7c(0x437)]&&document[_0x376a7c(0x437)]();}function updateFullscreenButton(){const _0x110046=_0x36046b,_0x321a3f=$('#btnFullscreen');document[_0x110046(0x20c)]?(_0x321a3f['innerHTML']='↙️',_0x321a3f[_0x110046(0x49b)]=_0x110046(0x27d)):(_0x321a3f[_0x110046(0x3c3)]='↗️',_0x321a3f[_0x110046(0x49b)]=_0x110046(0x2ed));}async function initializeApp(){const _0x1e2a95=_0x36046b;try{await storageManager[_0x1e2a95(0x1ec)]();const [_0x3bd008,_0xefa733,_0xef19ed]=await Promise[_0x1e2a95(0x4e2)]([storageManager[_0x1e2a95(0x3f5)](),storageManager['getAll'](_0x1e2a95(0x20a)),storageManager[_0x1e2a95(0x35a)]('subtopics')]);let _0x280012;if(!_0x3bd008){const _0x877d0c=JSON['parse'](JSON[_0x1e2a95(0x3dd)](defaults));await storageManager[_0x1e2a95(0x3f6)](_0x877d0c[_0x1e2a95(0x476)]);for(const _0x3164a0 of _0x877d0c['topics']){const {subtopics:_0x2dbb99,..._0x1316bc}=_0x3164a0;await storageManager[_0x1e2a95(0x478)](_0x1e2a95(0x20a),_0x1316bc);for(const _0x3d0fb3 of _0x2dbb99){await storageManager[_0x1e2a95(0x478)](_0x1e2a95(0x25c),{..._0x3d0fb3,'topicId':_0x3164a0['id']});}}_0x280012=_0x877d0c;}else{const _0x1fa453={};for(const _0x1baf35 of _0xefa733)_0x1fa453[_0x1baf35['id']]={..._0x1baf35,'subtopics':[]};for(const _0x8b3778 of _0xef19ed)_0x1fa453[_0x8b3778[_0x1e2a95(0x459)]]?.['subtopics'][_0x1e2a95(0x298)](_0x8b3778);_0x280012={'version':defaults[_0x1e2a95(0x1f5)],'settings':_0x3bd008,'topics':Object[_0x1e2a95(0x440)](_0x1fa453)};}data=window['data']=_0x280012,normalizeDataStructure(data),await ensureValidSelection(),await migrateSharedMethodsToCurrentSubtopic(),await seedAchievedMilestones(),renderAll();try{storageManager[_0x1e2a95(0x467)](data);}catch(_0x1cc674){console[_0x1e2a95(0x365)](_0x1e2a95(0x244),_0x1cc674);}bindEvents(),applyTheme();}catch(_0x2212d5){console[_0x1e2a95(0x4ad)](_0x1e2a95(0x486),_0x2212d5),toast(_0x1e2a95(0x233)+_0x2212d5[_0x1e2a95(0x232)]);}}callGeminiAPI=async function(_0x26830c,_0x4add96=0x3,_0x19cd3b=0x3e8){const _0xdb5b36=_0x36046b,_0x2b0e8b=data?.[_0xdb5b36(0x476)]?.[_0xdb5b36(0x43b)]||'';if(!_0x2b0e8b)return toast(_0xdb5b36(0x207)),null;const _0x5e86b1=_0xdb5b36(0x2a9)+_0x2b0e8b,_0x17b22d={'contents':[{'role':'user','parts':[{'text':_0x26830c}]}]};try{const _0x34f73e=await fetch(_0x5e86b1,{'method':'POST','headers':{'Content-Type':_0xdb5b36(0x218)},'body':JSON['stringify'](_0x17b22d)});if(!_0x34f73e['ok']){if(_0x34f73e[_0xdb5b36(0x279)]===0x1ad&&_0x4add96>0x0)return await new Promise(_0x56cbf2=>setTimeout(_0x56cbf2,_0x19cd3b)),callGeminiAPI(_0x26830c,_0x4add96-0x1,_0x19cd3b*0x2);let _0xfecd15=null;try{_0xfecd15=await _0x34f73e[_0xdb5b36(0x228)]();}catch(_0x17a3e9){}let _0x534bf4=_0xdb5b36(0x4d5)+_0x34f73e[_0xdb5b36(0x279)];if(_0x34f73e[_0xdb5b36(0x279)]===0x190)_0x534bf4='Error:\x20Invalid\x20or\x20changed\x20Gemini\x20API\x20Key.\x20Please\x20verify\x20in\x20Settings.';else{if(_0x34f73e[_0xdb5b36(0x279)]===0x1ad)_0x534bf4='Error:\x20Rate\x20limit\x20exceeded\x20for\x20Gemini.\x20Please\x20try\x20again\x20in\x20a\x20few\x20minutes.';else _0xfecd15?.[_0xdb5b36(0x4ad)]?.[_0xdb5b36(0x232)]&&(_0x534bf4=_0xdb5b36(0x3fc)+_0xfecd15[_0xdb5b36(0x4ad)][_0xdb5b36(0x232)]);}return toast(_0x534bf4,0xfa0),console[_0xdb5b36(0x4ad)](_0xdb5b36(0x260),_0xfecd15||_0x34f73e['statusText']),null;}const _0x6ca64e=await _0x34f73e[_0xdb5b36(0x228)]();if(_0x6ca64e['candidates']&&_0x6ca64e[_0xdb5b36(0x396)][0x0]?.[_0xdb5b36(0x333)]?.[_0xdb5b36(0x24c)]?.[0x0]?.[_0xdb5b36(0x268)])return formatGeminiResponse(_0x6ca64e[_0xdb5b36(0x396)][0x0][_0xdb5b36(0x333)]['parts'][0x0][_0xdb5b36(0x268)]);else{console[_0xdb5b36(0x4ad)](_0xdb5b36(0x432),_0x6ca64e);if(_0x6ca64e[_0xdb5b36(0x325)]?.['blockReason'])return _0xdb5b36(0x3ca)+_0x6ca64e[_0xdb5b36(0x325)]['blockReason']+_0xdb5b36(0x3ae);return _0xdb5b36(0x4d8);}}catch(_0x4d23b8){return console[_0xdb5b36(0x4ad)](_0xdb5b36(0x2eb),_0x4d23b8),toast(_0xdb5b36(0x267),0xfa0),null;}},loadLanguage(localStorage[_0x36046b(0x3bb)](_0x36046b(0x49e))||'en')['then'](initializeApp);
    </script>
</body>
</html>

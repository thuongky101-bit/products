<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Ứng dụng Pomodoro hỗ trợ học tập với tích hợp Gemini AI và giao diện hiện đại." />
    <title>Pomodoro Study App — Tích hợp Gemini AI (Giao diện mới)</title>
    <style>
    /*
    =============================================
    POMODORO STUDY APP — PHIÊN BẢN GIAO DIỆN TẬP TRUNG (v1.0)
    =============================================
    */

    :root {
      /* Theme Dark (Mặc định) - Cập nhật từ file 2 */
      --bg: #0f1222;
      --panel: #171a2e;
      --panel-rgb: 23, 26, 46; /* Thêm biến RGB cho panel */
      --muted: #212646;
      --text: #f4f6ff;
      --sub: #b7c1ff;
      --acc: #6c8cff;
      --acc-rgb: 108, 140, 255;
      --acc-2: #27d3a2;
      --purple: #a78bfa;
      --warn: #ffb020;
      --danger: #ff5c7a;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.054), 0px 4.3px 5.3px rgba(0, 0, 0, 0.077), 0px 8.1px 10px rgba(0, 0, 0, 0.095), 0px 14.5px 17.9px rgba(0, 0, 0, 0.113), 0px 27.2px 33.4px rgba(0, 0, 0, 0.136), 0px 65px 80px rgba(0, 0, 0, 0.19);
      --radius: 16px;
      --panel-opacity: 0.85;
      --gradient-border: linear-gradient(135deg, var(--acc), var(--acc-2));
    }
    
    /* === START: THÊM CÁC THEME MỚI === */
    [data-theme='light'] {
      --bg: #f5f0e8; --panel: #ffffff; --panel-rgb: 255, 255, 255; --muted: #eaddcf; --text: #4a4a4a; --sub: #8a817c; --acc: #d4a373; --acc-rgb: 212, 163, 115; --acc-2: #a3b18a; --warn: #e76f51; --danger: #d00000;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.024), 0px 4.3px 5.3px rgba(0, 0, 0, 0.037), 0px 8.1px 10px rgba(0, 0, 0, 0.045), 0px 14.5px 17.9px rgba(0, 0, 0, 0.053), 0px 27.2px 33.4px rgba(0, 0, 0, 0.066), 0px 65px 80px rgba(0, 0, 0, 0.09);
      --panel-opacity: 0.9;
      /* Ngăn nền tối mặc định khi không có ảnh */
      --bg-image: none;
    }

    [data-theme='pastel'] {
      --bg: #fde2e4; --panel: #fff1f2; --panel-rgb: 255, 241, 242; --muted: #fad2e1; --text: #595260; --sub: #8c7a8a; --acc: #c78283; --acc-rgb: 199, 130, 131; --acc-2: #7ec4cf; --warn: #f9bf45; --danger: #d7263d;
      --shadow: 0 5px 20px rgba(200,150,150,0.2);
      --panel-opacity: 0.9;
      /* Ngăn nền tối mặc định khi không có ảnh */
      --bg-image: none;
    }
    
    [data-theme='lofi'] {
      --bg: #2a2a3e; --panel: #3c3c52; --panel-rgb: 60, 60, 82; --muted: #4d4d66; --text: #e0e0ff; --sub: #a0a0c0; --acc: #ff8c69; --acc-rgb: 255, 140, 105; --acc-2: #69c6ff; --warn: #ffd700; --danger: #ff6961;
      /* === Replaced external GIF with inline data URI (offline-safe) === */
      --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9J2cnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAlJyBzdG9wLWNvbG9yPScjMmEyYTNlJy8+PHN0b3Agb2Zmc2V0PScxMDAlJyBzdG9wLWNvbG9yPScjM2MzYzUyJy8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9JzEwMCUnIGhlaWdodD0nMTAwJScgZmlsbD0ndXJsKCNnKScvPjwvc3ZnPg==');
      --panel-opacity: 0.8;
    }
    
    [data-theme='space'] {
        --bg: #000000; --panel: #1a1a2e; --panel-rgb: 26, 26, 46; --muted: #2a2a4e; --text: #e0e0ff; --sub: #b0b0e0; --acc: #00aaff; --acc-rgb: 0, 170, 255; --acc-2: #aaff00; --warn: #ffaa00; --danger: #ff0055;
        /* === Replaced external GIF with inline data URI (offline-safe) === */
        --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9J2cnIGN4PSc1MCUnIGN5PSc0MCUnIHI9JzcwJSc+PHN0b3Agb2Zmc2V0PScwJScgc3RvcC1jb2xvcj0nIzBiMGIxYScvPjxzdG9wIG9mZnNldD0nMTAwJScgc3RvcC1jb2xvcj0nIzAwMDAwMCcvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZpbGw9J3VybCgjZyknLz48L3N2Zz4=');
        --panel-opacity: 0.75;
    }
    /* === END: THÊM CÁC THEME MỚI === */

    *:focus-visible {
      outline: 2px solid var(--acc); outline-offset: 2px; border-radius: 4px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin:0; 
      font-family: system-ui, -apple-system, 'Segoe UI Variable', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Inter', sans-serif; 
      
      background-color: var(--bg);
      background-image: var(--bg-image, radial-gradient(1200px 800px at 10% -10%, #20285b 0%, #0f1222 50%, #0b0e1a 100%));
      
      background-size: cover; 
      background-position: center; 
      color:var(--text); 
      transition: background 0.5s ease, color 0.5s ease, filter 0.5s ease;
      text-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    a{color:var(--acc)}

    .app{display:flex; min-height:100vh}
    
    .app-nav {
        width: 60px;
        padding: 16px 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
        z-index: 100;
    }
    .nav-btn {
        background: transparent;
        border: none;
        color: var(--sub);
        width: 44px;
        height: 44px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all .2s ease;
        position: relative;
    }
    .nav-btn:hover { background: var(--muted); color: var(--text); }
    .nav-btn.active { background: var(--acc); color: white; }
    .nav-btn svg { width: 24px; height: 24px; }
    .nav-btn .tooltip {
        position: absolute;
        left: 110%;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        box-shadow: var(--shadow);
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        pointer-events: none;
        z-index: 200;
    }
    .nav-btn:hover .tooltip { opacity: 1; visibility: visible; }

    .app-content {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        max-height: 100vh;
    }

    .view { display: none; }
    .view.active { display: grid; gap: 24px; animation: fadeIn .3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .main.reloading { opacity: 0; transition: opacity 0.2s ease-out; }

    .panel-bg{
        background: rgba(23, 26, 46, var(--panel-opacity));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border:1px solid rgba(255,255,255,.08);
    }
    /* Thêm các quy tắc border cho theme light/pastel */
    [data-theme='light'] .panel-bg, [data-theme='pastel'] .panel-bg { border:1px solid rgba(0,0,0,0.05); }
    [data-theme='lofi'] .panel-bg { border:1px solid rgba(255,255,255,0.1); }
    [data-theme='space'] .panel-bg { border:1px solid rgba(255,255,255,0.12); }


header.app-header{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-radius:var(--radius); box-shadow:var(--shadow); margin-bottom: 24px; position: relative; z-index: 2000;}
    header .actions{display:flex; gap:8px; align-items:center}
    
    .btn {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text);
      border: none; /* Sửa đổi: bỏ border mặc định */
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,0.08);
      font-weight: 600;
      transition: all .15s ease;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        border: 2px solid transparent; border-radius: 12px; background: var(--gradient-border) border-box;
        -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: destination-out; mask-composite: exclude; opacity: 0; transition: opacity 0.3s ease;
    }
    .btn:hover::before { opacity: 1; }
    .btn:hover { background: rgba(255, 255, 255, 0.12); }
    .btn:active { transform: translateY(1px) scale(0.98); filter: brightness(1); }
    .btn:disabled { cursor: not-allowed; filter: brightness(0.8) saturate(0.5); }
    .btn.ghost { background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); }
    .btn.ghost:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); }
    .btn.acc { background: var(--acc); color: white; }
    .btn.warn { background: var(--warn); color: white; }
    .btn.danger { background: var(--danger); color: white; }
    .btn.small { padding: 6px 10px; font-size: 14px; border-radius: 9px; }
    .btn.small::before { border-radius: 9px; }
    .btn > svg { width: 16px; height: 16px; stroke-width: 2.5px; }

    /* === START: CẬP NHẬT GIAO DIỆN QUẢN LÝ CHỦ ĐỀ === */
    #view-topics { grid-template-columns: 1fr; }
    .topic-item { background:rgba(255,255,255,.04); border:1px solid var(--muted); border-radius:12px; padding:8px; margin-bottom:8px; } /* Sửa đổi */
    .topic-header, .sub-row { display:flex; align-items:center; gap:8px; position: relative; }
    .topic-header { cursor: pointer; }
    .topic-header .topic-actions { cursor: default; }
    .topic-header .topic-actions * { cursor: pointer; }
    .topic-item { cursor: pointer; }
    .topic-item .topic-actions { cursor: default; }
    .topic-item .topic-actions * { cursor: pointer; }
    .topic-title { flex:1; font-weight:600; cursor: pointer; }
    .chev { width:28px; height:28px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; flex-shrink: 0; cursor: pointer; }
    .chev .ico { display:inline-block; transition: transform .18s ease; }
    .chev[aria-expanded="false"] .ico { transform: rotate(-90deg); }
    .subtopics { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .subtopics.hidden { display:none; }
    
    .topic-actions, .sub-row .actions {
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        display: flex;
        gap: 6px;
        align-items: center;
    }
    .topic-item:hover .topic-actions, .topic-item:focus-within .topic-actions,
    .sub-row:hover .actions, .sub-row:focus-within .actions {
      opacity: 1;
      visibility: visible;
    }
    .actions-menu-btn {
        padding: 0;
        width: 28px;
        height: 28px;
        font-size: 1.2em;
        line-height: 1;
    }
    .actions-menu {
        position: absolute;
        top: 100%;
        right: 0;
        border-radius: 8px;
        padding: 6px;
        box-shadow: var(--shadow);
        z-index: 10;
        min-width: 150px;
        display: none;
        flex-direction: column;
        gap: 4px;
    }
    /* Nâng khối đang mở menu lên trên các khối khác */
    .topic-item.menu-active { position: relative; z-index: 20; }
    
    .actions-menu.show { display: flex; }
    .menu-item {
        background: transparent; border: none; color: var(--text);
        padding: 8px 10px; border-radius: 6px; text-align: left;
        width: 100%; cursor: pointer; transition: background .2s ease;
        display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500;
    }
    .menu-item:hover { background: var(--acc); color: white; }
    .menu-item.danger:hover { background: var(--danger); }
    /* === END: CẬP NHẬT GIAO DIỆN QUẢN LÝ CHỦ ĐỀ === */

    .subtopic-btn{
        flex:1; 
        text-align:left;
        background-color: rgba(0,0,0,0.02); /* Sửa đổi */
    }
    .subtopic-btn:hover {
        background-color: transparent; /* Hover transparent to avoid blue background */
    }
    .subtopic-btn.active{
        outline:2px solid var(--acc); 
    }
    .subtopic-btn.active:hover {
        background: transparent; /* Giữ nền trong suốt khi di chuột qua */
    }
    
    .panel{border-radius:var(--radius); padding:24px; box-shadow:var(--shadow)}

    .timer-header { display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; }
    .timer{display:grid; gap:16px; grid-template-columns: 1fr; align-items:center; text-align:center}
    .big-time{font-size: clamp(60px, 12vw, 96px); letter-spacing:1px; font-weight:700; color: var(--text)}
    .state{font-weight:700; letter-spacing:.6px}
    .state.work{color:var(--acc-2)} /* Sửa đổi màu */
    .state.break{color:var(--warn)}
    .state.long{color:var(--danger)} /* Sửa đổi màu */
    .controls{display:flex; flex-wrap:wrap; gap:12px; justify-content:center}    
    #btnStart { padding: 14px 28px; font-size: 1.2em; }
    #btnPause, #btnResume { padding: 12px 24px; font-size: 1.1em; }

    /* === START: TÙY CHỈNH DẢI PHÂN CÁCH MỀM MẠI HƠN === */
    #view-timer .panel-bg hr {
        border: none; /* Bỏ đường viền mặc định */
        height: 1px;  /* Đặt chiều cao cho đường kẻ */
        background-color: var(--muted); /* Sử dụng màu phụ của theme */
        opacity: 0.3; /* Làm cho nó mờ đi, hòa vào nền */
        margin-top: 0; /* Điều chỉnh lại khoảng cách */
    }
    /* === END: TÙY CHỈNH DẢI PHÂN CÁCH MỀM MẠI HƠN === */

    .stats-grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px}
    .stat-card{background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:14px; padding:12px; text-align:center} /* Sửa đổi */
    .stat-card h4{margin:4px 0 8px; color:var(--sub); font-weight:600; font-size: 14px;}
    .stat-value{font-size: 20px; font-weight: 600;}
    .tiny{font-size:12px; color:var(--sub)}
    .history{display:grid; gap:8px; max-height:300px; overflow:auto; padding-right:6px}
    .hist-item{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:start; background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:10px; padding:10px} /* Sửa đổi */

    .row{display:flex; gap:8px; align-items:center}
    .row > * {flex:1}
    input[type="text"], input[type="password"], input[type="number"], select, textarea{width:100%; background:rgba(255,255,255,0.04); color:var(--text); border:1px solid var(--muted); border-radius:10px; padding:10px; outline:none}
    textarea{min-height:80px; resize: vertical;}

    .toasts{position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:9999}
    .toast{
        background: var(--panel); /* Sửa đổi */
        border:1px solid var(--muted);
        color:var(--text);
        padding:10px 12px; border-radius:12px; box-shadow:var(--shadow);
        animation: toast-in .3s ease; transform-origin: bottom right;
    }
    @keyframes toast-in { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,var(--panel-opacity)); z-index:10000; backdrop-filter: blur(5px);} /* Nâng z-index để nằm trên header */
    .modal.show{display:flex}
    .modal-card{
        position: relative;
        z-index: 10001;
        width:min(720px, 94vw);
        border-radius:16px;
        padding:16px;
        box-shadow:var(--shadow);
        animation: modal-in .25s ease-out;
        max-height: 90vh;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }
    body.modal-open { overflow: hidden; }
    @keyframes modal-in { from { opacity: 0; transform: scale(0.92) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .modal-card h3{margin-top:0}
    .dashboard-table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    .dashboard-table th, .dashboard-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--muted); }
    .dashboard-table th { color: var(--sub); }

    .footer-note{font-size:12px; color:var(--sub)}
    .hidden{display:none !important}

    .notes-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; padding-right: 6px; }
    .note-item { background: rgba(255,255,255,0.04); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; cursor: pointer; } /* Sửa đổi */
    .note-content-wrapper { flex: 1; min-width: 0; }
    .note-content { white-space: pre-wrap; word-break: break-word; max-height: 60px; overflow: hidden; position: relative; transition: max-height 0.35s ease-in-out; }
    .note-content:not(.expanded)::after {
        content: ''; position: absolute; bottom: 0; right: 0; width: 100%; height: 20px; background: linear-gradient(to top, var(--panel) 20%, transparent);
    }
    .note-content.expanded { max-height: 500px; }
    .note-meta { font-size: 11px; color: var(--sub); margin-top: 4px; }
    
    .spinner { border: 2px solid var(--muted); border-top-color: var(--text); border-radius: 50%; width: 16px; height: 16px; animation: spin 1s linear infinite; } /* Sửa đổi */
    @keyframes spin { to { transform: rotate(360deg); } }

    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .panel-header h3 { margin: 0; }
    .panel-header .actions { display: flex; gap: 8px; }
    
    .aux-panel { margin-top: 24px; }
    .tab-nav { display: flex; gap: 4px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 16px; }
    .tab-btn { background: transparent; border: none; color: var(--sub); padding: 8px 16px; cursor: pointer; border-bottom: 2px solid transparent; transition: all .2s ease; font-weight: 600; }
    .tab-btn:hover { color: var(--text); }
    .tab-btn.active { color: var(--acc); border-bottom-color: var(--acc); }
    .tab-content {
      display: none;
      padding-top: 8px;
    }
    .tab-content.active {
      animation: fadeIn 0.25s ease-out;
    }
    #tasks.tab-content.active,
    #notes.tab-content.active,
    #ai.tab-content.active {
        display: block;
    }

    #settings-timer.tab-content.active,
    #settings-ui.tab-content.active,
    #settings-integrations.tab-content.active {
        display: flex;
    }

    .settings-row-toggle {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
    }
    .settings-row-toggle span {
      flex: 1;
      cursor: pointer;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle-switch .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--muted);
      transition: .3s;
      border-radius: 24px;
    }
    .toggle-switch .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    .toggle-switch input:checked + .slider {
      background-color: var(--acc-2);
    }
    .toggle-switch input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    .chat-messages { max-height: 250px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; padding: 4px; }
    .chat-msg { padding: 8px 12px; border-radius: 12px; max-width: 85%; word-break: break-word; }
    .chat-msg.user { background: var(--acc); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
    .chat-msg.model { background: var(--muted); align-self: flex-start; border-bottom-left-radius: 4px; }
    .chat-input-area { display: flex; gap: 8px; }

    .methods-list { list-style: none; padding: 0; }
    .method-item { align-items: flex-start; padding: 12px; display: flex; gap: 10px; border-radius: 8px; }
    .method-item:hover { background: rgba(0,0,0,0.03); } /* Sửa đổi */
    .method-item input[type="checkbox"] { width: 18px; height: 18px; margin-top: 2px; flex-shrink: 0;}
    .method-item label { flex: 1; }
    .method-item label.completed { text-decoration: line-through; color: var(--sub); }
    .method-item .content-wrapper { flex: 1; cursor: pointer; }
    .method-item .concept { font-size: 14px; color: var(--sub); margin-top: 8px; border-left: 2px solid var(--muted); padding-left: 12px; white-space: pre-wrap; word-break: break-word; }
    /* Highlight section titles and bold text inside method content */
    .method-content h4 {
        color: var(--acc-2);
        font-size: 1.1em;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    .method-content strong {
        color: var(--acc);
        font-weight: 600;
    }
    /* Apply the same highlight to the Guide view */
    #view-guide h4 { color: var(--acc-2); }
    #view-guide strong { color: var(--acc-2); }
    /* Show hand cursor to indicate clickability */
    .method-item, .method-item summary { cursor: pointer; }
    .subtopic-todo-list { list-style: none; padding: 0; margin: 0; max-height: 100px; overflow-y: auto; text-align: left; }
    .subtopic-todo-list li { display: flex; align-items: center; gap: 8px; padding: 4px; transition: all 0.2s ease-out; }
    .subtopic-todo-list li.removing { transform: translateX(100%); opacity: 0; }
    .subtopic-todo-list label { flex: 1; }

    #youtube-player-container { position: absolute; top: -9999px; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 10px; } /* Sửa đổi */
    ::-webkit-scrollbar-thumb { background: var(--muted); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
    ::-webkit-scrollbar-thumb:hover { background: var(--sub); background-clip: content-box; }
    
    .timer-circle-container {
        position: relative; width: clamp(250px, 40vw, 320px); height: clamp(250px, 40vw, 320px); margin: 24px auto; display: flex; align-items: center; justify-content: center;
    }
    .timer-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform: rotate(-90deg); }
    .timer-circle-bg, .timer-circle-progress { fill: none; stroke-width: 8; }
    .timer-circle-bg { stroke: var(--muted); } /* Sửa đổi */
    .timer-circle-progress { stroke: var(--acc); stroke-linecap: round; transition: stroke-dashoffset 0.3s linear, stroke 0.5s ease; }
    @keyframes flash { 0%, 100% { box-shadow: 0 0 10px 2px transparent; } 50% { box-shadow: 0 0 20px 8px currentColor; } }
    .timer-circle-container.finished { color: var(--acc-2); animation: flash 1s ease-out; }
    @keyframes breathing-effect { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    .timer-circle-container.breathing { animation: breathing-effect 3s ease-in-out infinite; }
    
    
    
    @media (max-width: 1024px) {
      .app-content { padding: 20px; }
      .panel { padding: 20px; }
      .timer-circle-container { width: clamp(220px, 50vw, 300px); height: clamp(220px, 50vw, 300px); }
    }

    @media (max-width: 768px) {
      .app { flex-direction: column; }
      .app-nav { width: 100%; height: 60px; flex-direction: row; justify-content: center; border-right: none; border-top: 1px solid rgba(255,255,255,.08); order: 2; padding: 0 16px; }
      .app-content { padding: 16px; order: 1; }
      .panel { padding: 16px; }
      .modal-card .tab-nav { overflow-x: auto; }
    }

    @media (max-width: 480px) {
      .app-nav { height: 50px; }
      .nav-btn { flex: 1; }
      header.app-header { flex-direction: column; align-items: stretch; gap: 8px; }
      .btn { padding: 8px 12px; }
      .timer-circle-container { width: clamp(180px, 80vw, 220px); height: clamp(180px, 80vw, 220px); margin: 16px auto; }
      .panel { padding: 12px; }
      .app-content { padding: 12px; }
    }

    #view-timer.no-subtopic-selected > .panel-bg:not(:first-child) { display: none; }
    #view-timer.no-subtopic-selected .timer-header > .presets { display: none; }
    #view-timer.no-subtopic-selected .timer { display: none; }

    header.app-header .actions #btnFullscreen { background: transparent; border: none; box-shadow: none; }
    header.app-header .actions #btnFullscreen:hover { background: var(--muted); filter: none; }
    header.app-header .actions #btnFullscreen:hover::before { opacity: 0; }

    input[type="text"], input[type="password"], input[type="number"], select, textarea {
        background: rgba(255,255,255,0.04) !important; /* Sửa đổi: chuyển sang nền trắng trong suốt */
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.1); /* Viền trắng mờ */
        transition: background .2s ease, border-color .2s ease;
    }
    input[type="text"]:focus, input[type="password"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
        background: rgba(255,255,255,0.06) !important; /* Tinh chỉnh: sát mẫu hơn */
        border-color: var(--acc);
    }
    /* === START: SỬA LỖI NỀN INPUT/SELECT TRÊN THEME SÁNG === */
    [data-theme='light'] input, [data-theme='light'] select, [data-theme='light'] textarea,
    [data-theme='pastel'] input, [data-theme='pastel'] select, [data-theme='pastel'] textarea {
        background: rgba(0, 0, 0, 0.05) !important; /* Dùng nền đen mờ thay vì trắng mờ */
        border-color: rgba(0, 0, 0, 0.1); /* Viền đen mờ trên theme sáng */
    }

    [data-theme='light'] input:focus, [data-theme='light'] select:focus, [data-theme='light'] textarea:focus,
    [data-theme='pastel'] input:focus, [data-theme='pastel'] select:focus, [data-theme='pastel'] textarea:focus {
        background: rgba(0, 0, 0, 0.07) !important; /* Tăng độ đậm khi focus */
    }
    /* === END: SỬA LỖI NỀN INPUT/SELECT TRÊN THEME SÁNG === */

    /* Cải thiện nền và màu chữ cho option trong select theo theme hiện tại */
    select option {
        background: var(--panel);
        color: var(--text);
    }
    
    ::placeholder { color: var(--sub); opacity: 0.7; } /* Sửa đổi */
    ::-ms-input-placeholder { color: var(--sub); }
    :-ms-input-placeholder { color: var(--sub); }

    
    
    .draggable-timer {
        position: fixed;
        bottom: 20px;
        right: 20px;
        color: var(--text);
        padding: 8px 16px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        font-size: 2em;
        font-weight: 600;
        cursor: move;
        user-select: none;
        z-index: 9998;
        opacity: 0;
        transform: scale(0.9);
        pointer-events: none;
        transition: opacity 0.35s ease, transform 0.35s ease;
    }
    body.bg-view-mode .draggable-timer {
        opacity: 1;
        transform: scale(1);
        pointer-events: auto;
    }
    .app-nav, .panel-bg, .app-header .actions > *, .app-header > .row {
        transition: opacity 0.35s ease, transform 0.35s ease, background 0.35s ease, border-color 0.35s ease, box-shadow 0.35s ease;
    }
    body.bg-view-mode .app-nav,
    body.bg-view-mode .view.active > .panel-bg {
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
    }
    body.bg-view-mode .app-header {
        background: transparent !important;
        border-color: transparent !important;
        box-shadow: none !important;
    }
    body.bg-view-mode .app-header .actions > *:not(#btnToggleBg),
    body.bg-view-mode .app-header > .row {
        opacity: 0;
        pointer-events: none;
    }
    body.bg-view-mode #btnToggleBg {
        opacity: 1;
        pointer-events: auto;
    }
    .sound-permission-bar {
      position: fixed; left: 50%; transform: translateX(-50%);
      bottom: 48px; z-index: 9999;
      border-radius: 12px; padding: 10px 14px;
      display: none; align-items: center; gap: 10px;
      box-shadow: var(--shadow);
    }
    .sound-permission-bar.show { display: flex; }
    .sound-permission-bar .msg { font-size: 14px; color: var(--text); }
    .draggable-timer { text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.9); }

    /* Giảm/loại bỏ bóng chữ cho theme sáng để tránh nhòe/lóa */
    body[data-theme='light'],
    body[data-theme='pastel'] { text-shadow: none; }
    body[data-theme='light'] .draggable-timer,
    body[data-theme='pastel'] .draggable-timer { text-shadow: none; }

    /* ============================================= */
/* ========================================================= */
/* START: THI?T L?P PANEL KI?U M?  ?C (FROSTED GLASS)        */
/* ========================================================= */

/* --- 1.  p d?ng hi?u ?ng n?n m? chung cho t?t c? c c panel --- */
.app-nav,
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    background: rgba(var(--panel-rgb), var(--panel-opacity));
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* --- 2.  ?nh nghia vi?n cho t?ng lo?i panel --- */
.app-nav {
    border-right: 1px solid rgba(255, 255, 255, 0.1);
}
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* --- 3. Tinh ch?nh vi?n cho c c theme S NG (Light/Pastel) --- */
[data-theme='light'] .app-nav,
[data-theme='light'] .panel-bg,
[data-theme='light'] .modal-card,
[data-theme='light'] .actions-menu,
[data-theme='light'] .nav-btn .tooltip,
[data-theme='light'] .draggable-timer,
[data-theme='light'] .sound-permission-bar,
[data-theme='light'] .toast,
[data-theme='light'] .topic-item,
[data-theme='light'] .stat-card,
[data-theme='light'] .hist-item,
[data-theme='light'] .method-item,
[data-theme='pastel'] .app-nav,
[data-theme='pastel'] .panel-bg,
[data-theme='pastel'] .modal-card,
[data-theme='pastel'] .actions-menu,
[data-theme='pastel'] .nav-btn .tooltip,
[data-theme='pastel'] .draggable-timer,
[data-theme='pastel'] .sound-permission-bar,
[data-theme='pastel'] .toast,
[data-theme='pastel'] .topic-item,
[data-theme='pastel'] .stat-card,
[data-theme='pastel'] .hist-item,
[data-theme='pastel'] .method-item {
    border-color: rgba(0, 0, 0, 0.1);
}

/* --- 4. S?a l?i hi?u ?ng fade-out c?a ghi ch  cho ph  h?p --- */
.note-content:not(.expanded)::after {
    background: linear-gradient(to top, rgba(var(--panel-rgb), 1) 20%, transparent);
}

/* --- C c quy t?c c n l?i gi? nguy n t? file g?c --- */
[data-theme='light'] .tab-nav,
[data-theme='pastel'] .tab-nav {
    border-bottom-color: rgba(0, 0, 0, 0.1);
}
.subtopic-btn {
    background-color: transparent;
}
.subtopic-btn:hover {
    background-color: transparent; /* Hover transparent to avoid blue background */
}
.method-item[open] summary {
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
    [data-theme='light'] .method-item[open] summary,
    [data-theme='pastel'] .method-item[open] summary {
        border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    /* Editor container (single pane, Rich Text) */
    .editor-container { height: 350px; }
    .editable-content { height: 100%; border: 1px solid var(--muted); border-radius: 10px; padding: 10px; overflow-y: auto; background: var(--bg); }
    .editable-content:focus-within { border-color: var(--acc); outline: none; }
    .editable-content h4 { color: var(--acc-2); font-size: 1.1em; margin-top: 1.5em; margin-bottom: 0.5em; }
    .editable-content strong, .editable-content b { color: var(--acc); font-weight: 600; }
    .editable-content ol, .editable-content ul { padding-left: 20px; }

    /* Editor toolbar for Methods modal */
    .editor-toolbar { display: flex; gap: 6px; margin-bottom: 6px; padding: 4px; background: var(--muted); border-radius: 8px; }
    .editor-toolbar button { font-weight: bold; width: 32px; height: 32px; padding: 0; }
    .editor-toolbar .btn.ghost:hover { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.15); }
    .editor-toolbar .btn.ghost.active { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.25); }
    .color-picker-wrapper { position: relative; }
    .color-palette { position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; padding: 6px; border-radius: 8px; border: 1px solid var(--muted); background: var(--panel); box-shadow: var(--shadow); z-index: 10; }
    .color-swatch { width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255, 255, 255, 0.5); cursor: pointer; transition: transform 0.15s ease; }
    .color-swatch:hover { transform: scale(1.15); }

    /* Method actions inline with summary and show on hover */
    .method-item summary { display: flex; align-items: center; justify-content: space-between; }
    .method-item summary > span { flex: 1; }
    .method-item summary .topic-actions { margin-left: 8px; }
    .method-title { cursor: pointer; }
    .method-item:hover .topic-actions, .method-item:focus-within .topic-actions { opacity: 1; visibility: visible; }

    </style>
</head>
<body data-theme="default"> <div class="app" id="app">
    <nav class="app-nav">
        <button class="nav-btn active" id="navBtnTimer" data-view="timer" aria-label="Đồng hồ">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span class="tooltip">Đồng hồ</span>
        </button>
        <button class="nav-btn" id="navBtnTopics" data-view="topics" aria-label="Chủ đề">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
            <span class="tooltip">Chủ đề</span>
        </button>
        <button class="nav-btn" id="navBtnStats" data-view="stats" aria-label="Thống kê">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
            <span class="tooltip">Thống kê</span>
        </button>
        <button class="nav-btn" id="navBtnMethods" data-view="methods" aria-label="Kho Tri Thức">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.042 21.672L13.684 16.6s.408-1.947 1.25-3.25c.842-1.303 2.002-2.5 3.5-3.5s3.25-1.25 3.25-1.25l5.072 1.358c.27.072.358.42.128.628l-3.35 3.35a.499.499 0 0 1-.594.052l-2.07-1.486c-.44-.314-.82-.53-1.11-.665-.29-.135-.55-.22-.78-.245s-.45.045-.63.155c-.18.11-.3.29-.36.5-.06.21.02.48.18.78.16.3.385.68.665 1.11l1.486 2.07a.499.499 0 0 1-.052.594l-3.35 3.35c-.208.23-.556.142-.628-.128z"/><path d="M12 15l-3-3 3-3 3 3-3 3z"/><path d="M9.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/><path d="M5.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/></svg>
            <span class="tooltip">Kho Tri Thức</span>
        </button>
        <button class="nav-btn" id="btnSettings" style="margin-top: auto;" aria-label="Cài đặt">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            <span class="tooltip">Cài đặt</span>
        </button>
        <button class="nav-btn" id="navBtnGuide" data-view="guide" aria-label="Hướng dẫn">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            <span class="tooltip">Hướng dẫn</span>
        </button>
    </nav>

    <main class="app-content">
      <header class="app-header panel-bg">
        <div class="row" style="gap:12px; align-items:center; flex:0 1 auto">
          <strong>📚 Pomodoro Study App</strong>
          <span class="badge" id="selectedContext">Chưa chọn Chủ đề con</span>
        </div>
        <div class="actions">
          <button class="btn ghost small" id="btnDashboard" title="Dashboard Tổng quan">📊 Tổng Quan </button>
          <a href="https://forms.gle/EfFqBJFTbFtDo5H4A" target="_blank" rel="noopener noreferrer" class="btn ghost small" title="Gửi phản hồi của bạn">💬 Phản Hồi</a>
          <button class="btn ghost small" id="btnExport" title="Xuất JSON">⬇️ Xuất File</button>
          <label class="btn ghost small" for="importFile" title="Nhập JSON">⬆️ Nhập File</label>
          <input type="file" id="importFile" accept="application/json" style="display:none" />
          <button class="btn small" id="btnToggleBg" title="Ẩn/Hiện giao diện">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
          <button class="btn small" id="btnFullscreen" title="Toàn màn hình">↗️</button>
        </div>
      </header>
      

      <div id="view-timer" class="view active">
        <section class="panel panel-bg">
          <div class="timer-header">
            <div id="welcomePanel" class="hidden panel-bg" style="text-align:center; padding: 20px; border-radius: var(--radius); width: 100%;">
                <h3>Chào mừng đến với Pomodoro Study App!</h3>
                <p>Hãy bắt đầu bằng cách chọn một <strong>Chủ đề con</strong> hoặc tạo Chủ đề/Chủ đề con mới.</p>
                <button class="btn acc" id="btnHelpCreateTopic">＋ Tạo Chủ đề Mới</button>
            </div>
            <div class="presets" role="group" aria-label="Chọn chế độ preset">
                <button id="btnPresetA" class="btn small ghost" data-preset="A"></button>
                <button id="btnPresetB" class="btn small ghost" data-preset="B"></button>
                <button id="btnPresetC" class="btn small ghost" data-preset="C">🌊 Flow</button>
            </div>
          </div>
          <hr />
          <div class="timer" aria-live="polite">
            <div class="badge" id="stateBadge">TRẠNG THÁI</div>
            
            <div class="timer-circle-container">
              <svg class="timer-svg" viewBox="0 0 100 100">
                  <circle class="timer-circle-bg" cx="50" cy="50" r="45"></circle>
                  <circle class="timer-circle-progress" cx="50" cy="50" r="45"></circle>
              </svg>
              <div id="timeDisplay" class="big-time">00:00</div>
            </div>

            <div class="tiny" id="cycleInfo"></div>

            <div class="tiny" id="breakSuggestionDisplay" style="min-height: 1.5em; font-style: italic; opacity: 0.8; transition: opacity 0.3s ease;"></div>

            <div id="windDownChecklist" class="hidden" style="text-align: left; max-width: 300px; margin: 0 auto; padding: 0 10px;">
              <h4 style="margin: 8px 0 4px; color: var(--acc); text-align: center;">Checklist Hạ nhiệt</h4>
              <ul style="list-style: '✓ '; margin: 0; padding-left: 20px; color: var(--sub);">
                <li>Lưu công việc đang làm (Save/Commit).</li>
                <li>Ghi chú nhanh "Next step".</li>
                <li>Dọn dẹp không gian làm việc.</li>
              </ul>
            </div>
            
            <div class="controls">
              <button class="btn acc" id="btnStart" aria-label="Bắt đầu (Space)">▶️ Bắt đầu</button>
              <button class="btn warn hidden" id="btnFinishFlow" aria-label="Kết thúc phiên làm việc">🧘 Bắt đầu nghỉ</button>
              <button class="btn" id="btnPause" aria-label="Tạm dừng (Space)">⏸️ Tạm dừng</button>
              <button class="btn" id="btnResume" aria-label="Tiếp tục (Space)">⏵ Tiếp tục</button>
              <button class="btn warn" id="btnSkip" aria-label="Bỏ qua (N)">⏭️ Bỏ qua</button>
              <button class="btn danger" id="btnReset">↺ Đặt lại</button>
              <button class="btn acc small hidden" id="btnBreakEarly">🧘 Nghỉ sớm</button>
            </div>
            <div class="tiny">Phím tắt: <strong>Space</strong> = Bắt đầu/Tạm dừng/Tiếp tục, <strong>N</strong> = Tiếp theo/Bỏ qua</div>
          </div>
        </section>

        <section class="panel panel-bg aux-panel">
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="tasks">Nhiệm vụ</button>
                <button class="tab-btn" data-tab="notes">Ghi chú</button>
                <button class="tab-btn" data-tab="ai">Gemini AI</button>
            </nav>
            <div id="tasks" class="tab-content active">
                <h4 style="margin: 0 0 8px; color: var(--sub);">To-do cho chủ đề con này:</h4>
                <ul id="subtopicTasksList" class="subtopic-todo-list"></ul>
                <div class="row" style="gap:8px; margin-top: 8px;">
                    <input type="text" id="newSubtopicTaskInput" placeholder="Thêm một task mới..." />
                    <button id="btnAddSubtopicTask" class="btn small" style="flex: 0 1 auto;">Thêm</button>
                </div>
            </div>
            <div id="notes" class="tab-content">
                <div id="generalNotesList" class="notes-list"></div>
                <div class="add-note-area" style="margin-top: 12px;">
                    <textarea id="newGeneralNoteText" placeholder="Thêm ghi chú mới..."></textarea>
                    <div style="text-align: right; margin-top: 8px;">
                        <button class="btn acc small" id="btnAddGeneralNote">＋ Thêm ghi chú</button>
                    </div>
                </div>
            </div>
            <div id="ai" class="tab-content">
                <div class="panel-header" style="margin-bottom: 8px; padding: 0;">
                    <h4 style="margin:0;">Gemini cho: <span id="currentSubtopicNameChat">(chưa chọn)</span></h4>
                    <div class="actions">
                        <button id="btnClearChat" class="btn small danger" title="Xóa lịch sử">🗑️</button>
                    </div>
                </div>
                <div id="chatMessages" class="chat-messages"></div>
                <div id="aiPromptSuggestions" style="display: flex; gap: 6px; margin: 8px 0; flex-wrap: wrap;">
                  <button class="btn small ghost" data-prompt="Giải thích khái niệm chính của chủ đề này">Giải thích khái niệm</button>
                  <button class="btn small ghost" data-prompt="Tạo một dàn ý chi tiết cho chủ đề này">Tạo dàn ý</button>
                  <button class="btn small ghost" data-prompt="Liệt kê 5 câu hỏi ôn tập quan trọng về chủ đề này">Tạo câu hỏi ôn tập</button>
                </div>
                <div class="chat-input-area">
                  <input type="text" id="chatInput" placeholder="Hỏi Gemini điều gì đó..." />
                  <button id="btnSendMessage" class="btn acc">Gửi</button>
                </div>
            </div>
        </section>
      </div>

      <div id="view-topics" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin: 0;">Quản lý Chủ đề</h3>
                <button class="btn small acc" id="btnAddTopic" style="margin-left: auto;">＋ Thêm Chủ đề</button>
            </div>
            <div id="topicsList"></div>
            <div class="footer-note">Nhấp mũi tên để mở/đóng danh sách chủ đề con.</div>
        </div>
      </div>
      
      <div id="view-stats" class="view">
        <section class="panel panel-bg">
            <h3 style="margin:0 0 12px 0;">Thống kê & Lịch sử — <span id="currentSubtopicName">(chưa chọn)</span></h3>
            <div class="stats-grid">
              <div class="stat-card"><h4>Tổng thời gian</h4><div class="stat-value" id="statTotal">0 phút</div></div>
              <div class="stat-card"><h4>Phiên</h4><div class="stat-value" id="statSessions">0</div></div>
              <div class="stat-card"><h4>Nhiệm vụ Hoàn thành</h4><div class="stat-value" id="statTasks">0</div></div>
            </div>
            <div style="margin-top:12px">
              <h4 style="margin:4px 0 8px; color:var(--sub)">Lịch sử (LÀM VIỆC)</h4>
              <div class="history" id="historyList"></div>
            </div>
        </section>
      </div>
      
      <div id="view-methods" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin:0;">💡 Kho Tri Thức Cá Nhân Hóa</h3>
                <button class="btn small acc" id="btnAddMethod" style="margin-left: auto;">＋ Thêm tri thức</button>
            </div>
            <p class="tiny" style="margin-top: -8px; margin-bottom: 20px;">Nhấp vào từng mục để xem chi tiết.</p>
            <div class="methods-container"></div>
        </div>
      </div>

      <div id="view-guide" class="view">
          <div class="panel panel-bg">
              <h3 style="margin-top: 0;">📖 Khám Phá Pomodoro Study App</h3>
              <p>
                  Chào mừng bạn đến với không gian học tập được thiết kế dành riêng cho sự tập trung và hiệu quả. Hãy cùng khám phá những tính năng sẽ đồng hành cùng bạn trên hành trình chinh phục tri thức.
              </p>

              <h4>🚀 Khởi Đầu Nhanh Chỉ Trong 4 Bước</h4>
              <p>Để hành trình của bạn luôn mạch lạc, mọi thứ trong ứng dụng được sắp xếp theo cấu trúc <strong>Chủ đề Lớn → Chủ đề con</strong>.</p>
              <ol>
                  <li>Mở mục <strong>📚 Chủ đề</strong> từ thanh điều hướng bên cạnh.</li>
                  <li>Nhấn <strong>＋ Thêm Chủ đề</strong> để tạo một lĩnh vực lớn (ví dụ: "Tiếng Anh Giao Tiếp").</li>
                  <li>Bên cạnh chủ đề vừa tạo, nhấn <strong>＋ Thêm</strong> để tạo một chủ đề con, chi tiết hơn (ví dụ: "Bài 1: Luyện phát âm IPA").</li>
                  <li>Chọn chủ đề con đó. Giờ đây, bạn đã sẵn sàng để bắt đầu phiên học đầu tiên của mình!</li>
              </ol>

              <hr />
              <h4>✨ Những Tính Năng Đáng Chú Ý</h4>

              <h4>Các Chế Độ Đồng Hồ Linh Hoạt ⏱️</h4>
              <p>Ứng dụng không chỉ có Pomodoro. Hãy chọn phương pháp phù hợp với công việc của bạn:</p>
              <ul>
                  <li><strong>Pomodoro Cổ Điển (Kiểu A/B):</strong> Làm việc tập trung trong các phiên định sẵn (ví dụ: 25 phút làm, 5 phút nghỉ) để xây dựng kỷ luật và nhịp độ.</li>
                  <li><strong>Chế độ Flowtime (Kiểu 🌊 Flow):</strong> Dành cho công việc cần dòng chảy sâu. Đồng hồ sẽ đếm lên, cho phép bạn làm việc đến khi tự cảm thấy cần nghỉ. Thời gian nghỉ sẽ được đề xuất dựa trên thời gian bạn đã làm việc.</li>
                  <li><strong>Đệm "Hạ nhiệt" (Wind-down):</strong> Một khoảng đệm tùy chỉnh giữa lúc làm và lúc nghỉ, giúp bạn kết thúc công việc đang dở, ghi chú lại "bước tiếp theo" và chuyển trạng thái một cách mượt mà, không bị cắt ngang đột ngột.</li>
              </ul> 
              <h4>Kho Tri Thức Theo Từng Chủ Đề Con 💡</h4>
<p>
    Mỗi một <strong>Chủ đề con</strong> giờ đây sẽ có một "Kho Tri Thức" hoàn toàn riêng biệt. Tính năng này cho phép bạn xây dựng một thư viện kiến thức chuyên sâu, chỉ liên quan đến lĩnh vực bạn đang học.
</p>
<p>
    Ví dụ, các ghi chú và phương pháp học "Tiếng Anh Giao Tiếp" sẽ chỉ xuất hiện khi bạn chọn chủ đề con đó, và sẽ không bị lẫn với các công thức trong chủ đề con "Giải tích Toán học".
</p>
<p>
    Với trình soạn thảo mạnh mẽ, bạn vẫn có thể dễ dàng định dạng tiêu đề, in đậm, tạo danh sách và làm nổi bật những thông tin quan trọng nhất cho từng môn học của mình.
</p>

              <h4>Quản Lý Chủ Đề Trực Quan</h4>
              <p>Dễ dàng sắp xếp các mục tiêu học tập của bạn. Sử dụng thao tác <strong>kéo và thả</strong> để sắp xếp lại thứ tự các Chủ đề hoặc di chuyển một Chủ đề con sang một lĩnh vực khác một cách trực quan.</p>

              <h4>Nhiệm Vụ & Ghi Chú Tích Hợp 📝</h4>
              <p>Ngay trong màn hình đồng hồ, bạn có thể tạo danh sách việc cần làm (to-do) cho từng chủ đề con hoặc ghi lại những ý tưởng chợt nảy ra mà không làm gián đoạn dòng chảy công việc.</p>

              <h4>Chế Độ Zen 🧘</h4>
              <p>Khi cần tập trung tuyệt đối, hãy nhấn vào biểu tượng con mắt (👁️). Giao diện sẽ ẩn đi, chỉ để lại hình nền và chiếc đồng hồ. Trong chế độ này, bạn có thể <strong>kéo thả đồng hồ</strong> đến bất kỳ vị trí nào trên màn hình để có một không gian làm việc gọn gàng nhất.</p>

              <h4>Thống Kê & Cột Mốc 🏆</h4>
              <p>Theo dõi hành trình của bạn qua những con số biết nói. Ứng dụng sẽ tự động ghi nhận và chúc mừng khi bạn đạt được những cột mốc quan trọng về thời gian tập trung, biến mỗi nỗ lực thành một thành tựu đáng tự hào.</p>

              <hr />
              <h4>⌨️ Phím Tắt Thông Minh</h4>
              <ul>
                  <li><kbd>Space</kbd>: Bắt đầu / Tạm dừng / Tiếp tục phiên học.</li>
                  <li><kbd>N</kbd>: Bỏ qua phiên làm việc hoặc nghỉ hiện tại.</li>
                  <li><kbd>Esc</kbd>: Đóng các cửa sổ đang mở (như Cài đặt).</li>
              </ul>

              <hr />
              <h4>🛠️ Cài Đặt Nâng Cao & Tích Hợp</h4>

              <h4>Trợ Lý Gemini AI 🧠</h4>
              <p>Biến ứng dụng thành một người bạn đồng hành thông minh. Ngoài việc hỏi đáp, bạn còn có thể:</p>
              <ul>
                  <li><strong>Tự động Định dạng Thông minh:</strong> Khi soạn thảo trong mục "Phương pháp", hãy để AI tự động phân tích và định dạng văn bản thô của bạn—tự nhận diện tiêu đề, các ý chính cần in đậm và danh sách.</li>
                  <li><strong>Thiết lập:</strong> Truy cập Google AI Studio để tạo API Key miễn phí và dán vào ô "Gemini API Key" trong Cài đặt của ứng dụng.</li>
              </ul>

              <h4>Tùy Biến Giao Diện & Âm Thanh 🎨</h4>
              <p>Biến không gian học tập thành của riêng bạn:</p>
              <ul>
                  <li><strong>Nhiều Theme & Hình nền:</strong> Lựa chọn giữa các theme có sẵn (Sáng, Tối, Pastel...) hoặc <strong>tải lên hình nền của riêng bạn</strong> để tạo cảm hứng.</li>
                  <li><strong>Âm báo Tùy chỉnh:</strong> Bạn có thể <strong>tải lên các file âm thanh (.mp3, .wav...) của riêng mình</strong> để sử dụng làm chuông báo cho các phiên làm việc và nghỉ ngơi.</li>
              </ul>

              <h4>Nhạc Nền YouTube 🎶</h4>
              <p>Tạo không gian học tập hoàn hảo bằng cách phát một video hoặc danh sách phát YouTube làm nhạc nền. Dán đường dẫn (URL) vào ô "Nhạc nền YouTube" trong Cài đặt.</p>

              <h4>An Toàn Dữ Liệu: Sao Lưu & Phục Hồi 🛡️</h4>
              <p>Ứng dụng tự động sao lưu tiến trình của bạn mỗi ngày. Bạn có thể tùy chỉnh số ngày lưu giữ bản sao lưu và phục hồi dữ liệu từ một ngày trong quá khứ nếu cần. ⚠️ <strong>Cảnh báo:</strong> Phục hồi sẽ ghi đè toàn bộ dữ liệu hiện tại.</p>
          </div>
      </div>
    </main>
  </div>

  <div class="modal" id="modalMilestone" role="dialog" aria-modal="true" aria-labelledby="milestoneTitle">
    <div class="modal-card" style="width: min(600px, 94vw);">
        <h3 id="milestoneTitle">🎉 Chúc mừng Bạn!</h3>
        <p id="milestoneMessage" style="white-space: pre-wrap; line-height: 1.6;"></p>
        <div class="row" style="justify-content:flex-end; margin-top:12px">
            <button class="btn acc" id="btnMilestoneClose">Tiếp tục hành trình!</button>
        </div>
    </div>
  </div>
  <div class="modal" id="modalSettings" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="modal-card">
          <h3 id="settingsTitle">⚙️ Cài đặt</h3>
          <nav class="tab-nav">
              <button class="tab-btn active" data-tab="settings-timer">Đồng hồ</button>
              <button class="tab-btn" data-tab="settings-ui">Giao diện & Âm thanh</button>
              <button class="tab-btn" data-tab="settings-integrations">Tích hợp</button>
          </nav>
          <div class="settings-content">
              <div id="settings-timer" class="tab-content active" style="flex-direction:column; gap:20px;">
                  <div class="row" id="timerPresetSelector" style="margin-bottom:16px;">
                      <button class="btn acc" data-preset-target="A"> Kiểu A </button>
                      <button class="btn ghost" data-preset-target="B"> Kiểu B </button>
                      <button class="btn ghost" data-preset-target="C"> Kiểu C (Flow) </button>
                  </div>
                  <div id="settings-pomodoro">
                      <h4>Thời lượng Pomodoro</h4>
                      <div class="row">
                          <label>LÀM VIỆC (phút)<input type="number" id="set_work" min="1" /></label>
                          <label>HẠ NHIỆT (phút)<input type="number" id="set_winddown" min="0" /></label>
                          <label>NGHỈ NGẮN (phút)<input type="number" id="set_short" min="1" /></label>
                          <label>NGHỈ DÀI (phút)<input type="number" id="set_long" min="1" /></label>
                      </div>
                      <div class="row">
                          <label>Chu kỳ Pomodoro<input type="number" id="set_cycles" min="1" /></label>
                          <label>Chu kỳ nghỉ dài<input type="number" id="set_interval" min="2" /></label>
                      </div>
                  </div>
                  <div id="settings-flowtime" class="hidden">
                      <h4>Flowtime</h4>
                      <div class="row">
                          <label>Tỷ lệ nghỉ (Làm việc / X)
                              <input type="number" id="set_flowRatio" min="1" max="20" />
                          </label>
                      </div>
                      <p class="tiny" style="margin-top: 4px;">Gợi ý: Thời gian nghỉ = tổng thời gian làm việc / X. Mặc định là 5.</p>
                  </div>
                  <div class="settings-row-toggle">
                          <label for="set_autoStartNext">Tự động bắt đầu phiên tiếp theo</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_autoStartNext">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableWinddown">Bật Hạ nhiệt sau phiên làm</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableWinddown">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableSessionNotes">Nhắc ghi chú sau mỗi phiên</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableSessionNotes">
                              <span class="slider"></span>
                          </label>
                      </div>
              </div>
              <div id="settings-ui" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Giao diện</h4>
                      <div class="row">
                          <label>Theme Giao Diện
                                <select id="set_theme_color">
                                    <option value="default">Mặc định (Dark Blue)</option>
                                    <option value="light">Light - Trà Sữa</option>
                                    <option value="pastel">Pastel - Dễ thương</option>
                                    <option value="lofi">Lofi Study Room</option>
                                    <option value="space">Space Station</option>
                                </select>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 12px;">
                          <label>Chế độ hiển thị nền
                              <select id="set_backgroundMode">
                                  <option value="cover">Lấp đầy (Mặc định)</option>
                                  <option value="contain">Vừa vặn (Sắc nét)</option>
                                  <option value="auto">Kích thước gốc (Lặp lại)</option>
                              </select>
                          </label>
                      </div>
                      <div class="row">
                          <label>Hình nền
                              <label class="btn small ghost" for="uploadBg">Tải ảnh mới</label>
                              <input type="file" id="uploadBg" accept="image/*" class="hidden" />
                          </label>
                          <button class="btn small danger" id="btnClearBg">Xóa nền</button>
                      </div>
                      <div class="row">
                          <label style="flex: 1;">Độ trong suốt của nền</label>
                          <input type="range" id="set_panelOpacity" min="0.1" max="1" step="0.05" style="flex: 2;">
                      </div>
                      
                      
                   </div>
                  
                   <div>
                      <h4>Âm thanh</h4>
                      <div class="row">
                          <label>Âm lượng (0–1)<input type="number" id="set_volume" step="0.05" min="0" max="1"/></label>
                          <label>Kiểu âm báo
                              <select id="set_theme">
                                  <option value="beep">Beep</option>
                                  <option value="chime">Chime</option>
                              </select>
                          </label>
                           <button class="btn" id="btnTestSound" style="flex: 0 1 auto; align-self: center;">Test</button>
                      </div>
                      <div style="text-align: right; margin-top: 12px;">
                          <button class="btn ghost small" id="btnToggleCustomSounds">Tùy chỉnh âm báo</button>
                      </div>

                      <div id="customSoundsContainer" class="hidden" style="margin-top: 8px;">
                      <div class="row" style="display: flex; gap: 8px; justify-content: flex-end;">
                          <div>
                              <small>Âm báo hết LÀM VIỆC</small>
                              <label title="Âm báo hết LÀM VIỆC" class="btn small ghost" for="uploadSoundWork">LÀM VIỆC</label>
                              <input type="file" id="uploadSoundWork" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Âm báo hết NGHỈ NGẮN</small>
                              <label title="Âm báo hết NGHỈ NGẮN" class="btn small ghost" for="uploadSoundBreak">NGHỈ NGẮN</label>
                              <input type="file" id="uploadSoundBreak" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Âm báo hết NGHỈ DÀI</small>
                              <label title="Âm báo hết NGHỈ DÀI" class="btn small ghost" for="uploadSoundLong">NGHỈ DÀI</label>
                              <input type="file" id="uploadSoundLong" accept="audio/*" class="hidden" />
                          </div>
                      </div>
                      </div>
                      
                  </div>
              </div>
              <div id="settings-integrations" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Tích hợp AI</h4>
                      <label>Gemini API Key
                          <input type="password" id="set_apiKey" placeholder="Dán API Key của bạn vào đây..." />
                      </label>
                      <div class="tiny">Cần có để sử dụng các tính năng AI. Lấy key miễn phí tại <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a>.</div>
                  </div>
                  <div>
                      <h4>🎵 Nhạc nền YouTube</h4>
                      <div class="row" style="gap:8px; align-items:center;">
                          <input type="text" id="set_youtubeUrl" placeholder="Dán link YouTube vào đây..." style="flex:1;">
                          </div>
                      <div id="ytUrlFeedback" class="tiny" style="min-height: 1.2em; padding: 4px 0;"></div>
                      <div class="row" style="margin-top: 4px;">
                          <label style="flex: 0 1 auto; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                              <input type="checkbox" id="set_ytThumbAsBg">
                              <span>Dùng ảnh bìa video làm nền</span>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 8px;">
                          <button id="btnToggleYtSound" class="btn small" style="flex:0 1 auto;" title="Dừng sẽ không tự phát lại cho đến khi bạn bấm ▶️">▶️</button>
                          <input type="range" id="ytSoundVolume" min="0" max="100" step="1" value="80" style="flex:1;">
                      </div>
                      <div class="tiny" style="text-align:center; margin-top:4px;">Âm lượng</div>
                  </div>
                  <div>
                      <h4>🛡️ Cài đặt sao lưu</h4>
                      <div class="row">
                          <label>Số ngày sao lưu cần giữ lại
                               <input type="number" id="set_backupDays" min="1" max="30" />
                          </label>
                      </div>
                  </div>
                  <div>
                      <h4>🛡️ Phục hồi dữ liệu</h4>
                      <p class="tiny">Phục hồi dữ liệu từ một bản sao lưu tự động hàng ngày. Hành động này sẽ ghi đè lên dữ liệu hiện tại của bạn.</p>
                      <div class="row">
                          <select id="backupList" style="flex: 3;"></select>
                          <button id="btnRestoreBackup" class="btn warn small" style="flex: 1;">Phục hồi</button>
                      </div>
                  </div>
              </div>
          </div>
          <div class="row" style="margin-top:16px; justify-content:flex-end">
              <button class="btn ghost" id="btnDefaults">Mặc định</button>
              <button class="btn acc" id="btnSaveSettings">Lưu</button>
              <button class="btn" id="btnCloseSettings">Đóng</button>
          </div>
      </div>
  </div>

  <div class="modal" id="modalNote" role="dialog" aria-modal="true" aria-labelledby="noteTitle">
    <div class="modal-card">
      <h3 id="noteTitle">📝 Ghi chú cho phiên vừa hoàn thành</h3>
      <div class="row"><textarea id="noteText" placeholder="Bạn học được gì? Khó khăn? Next steps?"></textarea></div>
      <div class="row" style="justify-content:flex-end; margin-top:8px; gap: 12px;">
        <button class="btn" id="btnSummarizeNote">✨ Tóm tắt & Gợi ý</button>
        <button class="btn" id="btnSkipNote">Bỏ qua</button>
        <button class="btn acc" id="btnSaveNote">Lưu ghi chú</button>
      </div>
    </div>
  </div>

  <div class="modal" id="modalGeneric" role="dialog" aria-modal="true" aria-labelledby="genericTitle">
      <div class="modal-card" style="width: min(450px, 94vw);">
          <h3 id="genericTitle">Tiêu đề</h3>
          <p id="genericMessage" class="hidden"></p>
          <input type="text" id="genericInput" class="hidden" />
          <div class="row" style="justify-content:flex-end; margin-top:12px">
              <button class="btn" id="btnGenericCancel">Hủy</button>
              <button class="btn acc" id="btnGenericOk">OK</button>
          </div>
      </div>
  </div>
  
  <div class="modal" id="modalDashboard" role="dialog" aria-modal="true" aria-labelledby="dashboardTitle">
    <div class="modal-card" style="width: min(800px, 95vw);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h3 id="dashboardTitle">📊 Tổng quan</h3>
            <button class="btn ghost small" id="btnCloseDashboard">Đóng</button>
        </div>
        <p class="tiny">Tổng hợp thời gian và số phiên đã hoàn thành trên tất cả các chủ đề.</p>
        <div id="dashboardContent" style="max-height: 60vh; overflow-y: auto;"></div>
    </div>
  </div>

  <div class="modal" id="modalMethodEditor" role="dialog" aria-modal="true">
    <div class="modal-card" style="width: min(800px, 95vw);">
      <h3 id="methodEditorTitle">Chỉnh-sửa Phương-pháp</h3>
      
      <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
        <input type="hidden" id="methodEditorId">
        <label>Tiêu-đề<input type="text" id="methodEditorTitleInput"></label>
        
        <label>Nội-dung</label>
        <div class="editor-toolbar">
          <button id="toolH4" class="btn small ghost" title="Tiêu-đề nhỏ">H</button>
          <button id="toolBold" class="btn small ghost" title="In đậm">B</button>
          <button id="toolItalic" class="btn small ghost" title="In nghiêng">I</button>
          <button id="toolList" class="btn small ghost" title="Danh-sách">1.</button>
          <button id="toolBullet" class="btn small ghost" title="Danh sách chấm tròn">•</button>

          <div class="color-picker-wrapper">
            <button id="toolColor" class="btn small ghost" title="Màu chữ">A</button>
            <div class="color-palette hidden">
              <button class="color-swatch" style="background-color: var(--text);" data-color="var(--text)" title="Màu chữ mặc định"></button>
              <button class="color-swatch" style="background-color: var(--acc);" data-color="var(--acc)" title="Màu nhấn mạnh"></button>
              <button class="color-swatch" style="background-color: var(--acc-2);" data-color="var(--acc-2)" title="Màu tích cực"></button>
              <button class="color-swatch" style="background-color: var(--warn);" data-color="var(--warn)" title="Màu cảnh báo"></button>
              <button class="color-swatch" style="background-color: var(--danger);" data-color="var(--danger)" title="Màu nguy hiểm"></button>
              <button class="color-swatch" style="background-color: var(--purple);" data-color="var(--purple)" title="Màu tím"></button>
            </div>
          </div>
        </div>

        <div class="editor-container">
            <div id="methodEditorContentInput" class="editable-content" contenteditable="true"></div>
        </div>

      </div>

      <div class="row" style="justify-content:space-between; margin-top:16px">
        <button id="btnAutoFormat" class="btn small" disabled title="Tính năng này yêu cầu Gemini API Key">✨ Tự động định dạng</button>
        <div>
          <button class="btn" id="btnCancelMethodEditor">Hủy</button>
          <button class="btn acc" id="btnSaveMethod">Lưu</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toasts" id="toasts"></div>
  <audio id="audioWorkEnd"></audio>
  <audio id="audioBreakEnd"></audio>
  <audio id="audioLongEnd"></audio>
  <div id="youtube-player-container"></div>

  <div id="draggableTimer" class="draggable-timer">00:00</div>

  <div id="soundPermissionBar" class="sound-permission-bar" role="alert" aria-live="polite">
    <span class="msg">Nhấn "Bật âm thanh" để cho phép phát nhạc nền.</span>
    <button id="btnEnableSound" class="btn small acc">Bật âm thanh</button>
  </div>
<!-- YouTube Iframe API is loaded dynamically when needed -->
<!-- === START: Inline Minimal Sortable (Offline-Safe) === -->
<script>
// Minimal Sortable shim for offline single-file usage.
// Supports: draggable selector, cross-list via same group, onEnd callback.
(function(){
  if (window.Sortable) return; // Respect existing if loaded
  const DND = { src: null, from: null, selector: null, group: null };
  function makeDraggable(container, selector){
    Array.from(container.querySelectorAll(selector)).forEach(el => {
      try { el.setAttribute('draggable','true'); } catch(_) {}
    });
  }
  function closestItem(e, selector){
    const t = e.target && e.target.closest ? e.target.closest(selector) : null;
    return t || null;
  }
  function Sortable(container, opts){
    this.el = container;
    this.options = opts || {};
    const selector = this.options.draggable || '*';
    const group = this.options.group || null;
    makeDraggable(container, selector);
    const handleDragStart = (e) => {
      const item = closestItem(e, selector);
      if (!item) return;
      DND.src = item; DND.from = container; DND.selector = selector; DND.group = group;
      e.dataTransfer.effectAllowed = 'move';
      try { e.dataTransfer.setData('text/plain', ''); } catch(_) {}
    };
    const handleDragOver = (e) => {
      if (!DND.src) return;
      // Only allow drop if same selector and group matches (or no group)
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
    };
    const handleDrop = (e) => {
      if (!DND.src) return;
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
      const from = DND.from;
      const to = container;
      const children = Array.from(from.querySelectorAll(DND.selector));
      const oldIndex = children.indexOf(DND.src);
      if (target && DND.src && target !== DND.src) {
        to.insertBefore(DND.src, target);
      }
      const newChildren = Array.from(to.querySelectorAll(DND.selector));
      const newIndex = newChildren.indexOf(DND.src);
      if (typeof this.options.onEnd === 'function') {
        try { this.options.onEnd({ oldIndex, newIndex, from, to, item: DND.src }); } catch(_) {}
      }
      DND.src = null; DND.from = null; DND.selector = null; DND.group = null;
    };
    this._listeners = { handleDragStart, handleDragOver, handleDrop };
    container.addEventListener('dragstart', handleDragStart);
    container.addEventListener('dragover', handleDragOver);
    container.addEventListener('drop', handleDrop);
    this.destroy = () => {
      container.removeEventListener('dragstart', handleDragStart);
      container.removeEventListener('dragover', handleDragOver);
      container.removeEventListener('drop', handleDrop);
    };
  }
  window.Sortable = Sortable;
})();
</script>
<!-- === END: Inline Minimal Sortable === -->
  <script>
    const _0x2d92ab=_0x50e5;(function(_0x1c1d41,_0x23a03e){const _0x4a794e=_0x50e5,_0x3b1ab0=_0x1c1d41();while(!![]){try{const _0xde8c7f=-parseInt(_0x4a794e(0x2ea))/0x1*(-parseInt(_0x4a794e(0x259))/0x2)+parseInt(_0x4a794e(0x393))/0x3+parseInt(_0x4a794e(0x2f1))/0x4+-parseInt(_0x4a794e(0x1cb))/0x5+-parseInt(_0x4a794e(0x313))/0x6*(-parseInt(_0x4a794e(0x2b1))/0x7)+parseInt(_0x4a794e(0x1ef))/0x8+-parseInt(_0x4a794e(0x356))/0x9;if(_0xde8c7f===_0x23a03e)break;else _0x3b1ab0['push'](_0x3b1ab0['shift']());}catch(_0x5c8de5){_0x3b1ab0['push'](_0x3b1ab0['shift']());}}}(_0x5325,0x702fd),window[_0x2d92ab(0x22e)]('load',()=>{try{updateFullscreenButton();}catch(_0x40dc3f){}}));const IS_FILE_PROTOCOL=window[_0x2d92ab(0x429)][_0x2d92ab(0x419)]==='file:';function startYtApiWatchdog(){const _0x26bb28=_0x2d92ab,_0x5273c6=document[_0x26bb28(0x26a)](_0x26bb28(0x405));if(!_0x5273c6)return;const _0x464f76=setTimeout(()=>{const _0x19d459=_0x26bb28;try{(!window['YT']||!window['YT'][_0x19d459(0x1f0)])&&(_0x5273c6['textContent']=_0x19d459(0x225),_0x5273c6[_0x19d459(0x34c)][_0x19d459(0x2c0)]=_0x19d459(0x452));}catch(_0x542ae1){}},0x5dc),_0x272085=setTimeout(()=>{const _0x26ef01=_0x26bb28;try{(!window['YT']||!window['YT'][_0x26ef01(0x1f0)])&&(_0x5273c6['textContent']=_0x26ef01(0x217),_0x5273c6['style']['color']='var(--danger)');}catch(_0x16f2b2){}},0x1b58);window[_0x26bb28(0x357)]={'cancel'(){clearTimeout(_0x464f76),clearTimeout(_0x272085);}};}(function(){const _0x153222=_0x2d92ab,_0x37cc12={'timer.cycleInfo':({current:current=0x0,target:target=0x0}={})=>_0x153222(0x3d6)+current+'/'+target,'timer.selectSubtopicPrompt':'Vui\x20lòng\x20chọn\x20một\x20Chủ\x20đề\x20con\x20trước\x20khi\x20thực\x20hiện\x20thao\x20tác.'};window['t']=function _0x2e0798(_0x132514,_0x1e69da){const _0x1ca1a6=_0x153222;try{const _0x24c180=_0x37cc12[_0x132514];if(typeof _0x24c180===_0x1ca1a6(0x44f))return _0x24c180(_0x1e69da||{});if(typeof _0x24c180===_0x1ca1a6(0x2ba))return _0x24c180;}catch(_0x220360){}return _0x132514;},window[_0x153222(0x39a)]=function _0x4ed2c8(_0x48e700){const _0x21c783=_0x153222;try{localStorage[_0x21c783(0x1b0)](_0x21c783(0x448),_0x48e700||'vi');}catch(_0x4eb758){}return Promise['resolve']();};}());function ensureYouTubeAPI(){const _0x110450=_0x2d92ab;if(IS_FILE_PROTOCOL)return Promise[_0x110450(0x2a8)](![]);try{if(window['YT']&&window['YT']['Player'])return Promise[_0x110450(0x2a8)](!![]);}catch(_0x48843d){}if(window[_0x110450(0x40f)])return window[_0x110450(0x40f)];return startYtApiWatchdog(),window[_0x110450(0x40f)]=new Promise((_0x2ea26e,_0x4f3f70)=>{const _0xc0cae2=_0x110450;try{const _0x3d1acc=document[_0xc0cae2(0x2e2)](_0xc0cae2(0x3fd));_0x3d1acc[_0xc0cae2(0x1eb)]='https://www.youtube.com/iframe_api',_0x3d1acc[_0xc0cae2(0x2a0)]=!![],_0x3d1acc[_0xc0cae2(0x2ae)]=!![],_0x3d1acc[_0xc0cae2(0x2e9)]=()=>_0x2ea26e(!![]),_0x3d1acc[_0xc0cae2(0x47e)]=()=>_0x4f3f70(new Error(_0xc0cae2(0x43c))),document[_0xc0cae2(0x463)][_0xc0cae2(0x499)](_0x3d1acc);}catch(_0x51693d){_0x4f3f70(_0x51693d);}}),window[_0x110450(0x40f)];}const storageManager={'DB_NAME':_0x2d92ab(0x47c),'DB_VERSION':0x1,'db':null,async 'initDB'(){return new Promise((_0x473900,_0x5ebaee)=>{const _0x227724=_0x50e5;if(this['db'])return _0x473900(this['db']);const _0xef3bf9=indexedDB[_0x227724(0x23d)](this[_0x227724(0x210)],this['DB_VERSION']);_0xef3bf9[_0x227724(0x41b)]=_0x1dc633=>{const _0x58c00c=_0x227724,_0x4f4ba2=_0x1dc633['target'][_0x58c00c(0x263)];!_0x4f4ba2[_0x58c00c(0x1c1)][_0x58c00c(0x2de)](_0x58c00c(0x3cc))&&_0x4f4ba2[_0x58c00c(0x2a6)](_0x58c00c(0x3cc));!_0x4f4ba2[_0x58c00c(0x1c1)][_0x58c00c(0x2de)](_0x58c00c(0x268))&&_0x4f4ba2[_0x58c00c(0x2a6)](_0x58c00c(0x268),{'keyPath':'id'});if(!_0x4f4ba2[_0x58c00c(0x1c1)]['contains'](_0x58c00c(0x25e))){const _0x5b8649=_0x4f4ba2[_0x58c00c(0x2a6)](_0x58c00c(0x25e),{'keyPath':'id'});_0x5b8649['createIndex'](_0x58c00c(0x294),_0x58c00c(0x3af));}!_0x4f4ba2[_0x58c00c(0x1c1)][_0x58c00c(0x2de)]('backups')&&_0x4f4ba2[_0x58c00c(0x2a6)](_0x58c00c(0x48f),{'keyPath':'date'});},_0xef3bf9[_0x227724(0x2fe)]=_0x21fe91=>{const _0x6a0223=_0x227724;this['db']=_0x21fe91['target'][_0x6a0223(0x263)],console[_0x6a0223(0x2c3)]('IndexedDB\x20initialized\x20successfully.'),_0x473900(this['db']);},_0xef3bf9[_0x227724(0x47e)]=_0x3a1c5f=>{const _0x14daba=_0x227724;console[_0x14daba(0x29a)](_0x14daba(0x187),_0x3a1c5f[_0x14daba(0x26b)]['errorCode']),_0x5ebaee(_0x3a1c5f[_0x14daba(0x26b)][_0x14daba(0x29a)]);};});},async '_getStore'(_0x2b1437,_0x155386=_0x2d92ab(0x358)){await this['initDB']();const _0x33c89f=this['db']['transaction']([_0x2b1437],_0x155386);return _0x33c89f['objectStore'](_0x2b1437);},async 'getSettings'(){const _0x177f37=_0x2d92ab,_0x305efa=await this['_getStore'](_0x177f37(0x3cc));return new Promise((_0x26f22e,_0x423d01)=>{const _0x1756c2=_0x177f37,_0x5676eb=_0x305efa[_0x1756c2(0x370)](_0x1756c2(0x40b));_0x5676eb[_0x1756c2(0x2fe)]=()=>_0x26f22e(_0x5676eb[_0x1756c2(0x263)]),_0x5676eb[_0x1756c2(0x47e)]=()=>_0x423d01(_0x5676eb[_0x1756c2(0x29a)]);});},async 'updateSettings'(_0x2ca542){const _0x2346b8=_0x2d92ab,_0xcdd4a5=await this[_0x2346b8(0x3c0)](_0x2346b8(0x3cc),_0x2346b8(0x227));return new Promise((_0xbd033d,_0x3a8a89)=>{const _0x460c71=_0x2346b8,_0x20aa99=_0xcdd4a5[_0x460c71(0x299)](_0x2ca542,_0x460c71(0x40b));_0x20aa99[_0x460c71(0x2fe)]=()=>_0xbd033d(_0x20aa99[_0x460c71(0x263)]),_0x20aa99[_0x460c71(0x47e)]=()=>_0x3a8a89(_0x20aa99[_0x460c71(0x29a)]);});},async 'getAll'(_0x1afeb6){const _0x37ff7b=_0x2d92ab,_0xe98a1d=await this[_0x37ff7b(0x3c0)](_0x1afeb6);return new Promise((_0x59f593,_0x3f2d39)=>{const _0x58d793=_0x37ff7b,_0x11b1a6=_0xe98a1d[_0x58d793(0x37d)]();_0x11b1a6['onsuccess']=()=>_0x59f593(_0x11b1a6[_0x58d793(0x263)]),_0x11b1a6['onerror']=()=>_0x3f2d39(_0x11b1a6[_0x58d793(0x29a)]);});},async 'update'(_0x53cba0,_0x548358){const _0x6711d4=await this['_getStore'](_0x53cba0,'readwrite');return new Promise((_0x51248c,_0x3763bb)=>{const _0x5d6797=_0x50e5,_0x30ac02=_0x6711d4['put'](_0x548358);_0x30ac02[_0x5d6797(0x2fe)]=()=>_0x51248c(_0x30ac02[_0x5d6797(0x263)]),_0x30ac02[_0x5d6797(0x47e)]=()=>_0x3763bb(_0x30ac02[_0x5d6797(0x29a)]);});},async 'add'(_0x27bba9,_0x1a710d){const _0x59932d=_0x2d92ab,_0x35ec6e=await this[_0x59932d(0x3c0)](_0x27bba9,_0x59932d(0x227));return new Promise((_0x438d0f,_0x35e30d)=>{const _0x28b3ab=_0x59932d,_0x12401a=_0x35ec6e[_0x28b3ab(0x31c)](_0x1a710d);_0x12401a[_0x28b3ab(0x2fe)]=()=>_0x438d0f(_0x12401a[_0x28b3ab(0x263)]),_0x12401a[_0x28b3ab(0x47e)]=()=>_0x35e30d(_0x12401a[_0x28b3ab(0x29a)]);});},async 'delete'(_0x3fa182,_0x171a31){const _0x527e42=_0x2d92ab,_0x407e66=await this[_0x527e42(0x3c0)](_0x3fa182,'readwrite');return new Promise((_0x457403,_0xc737f1)=>{const _0x1cf13a=_0x527e42,_0x32fa16=_0x407e66[_0x1cf13a(0x439)](_0x171a31);_0x32fa16['onsuccess']=()=>_0x457403(_0x32fa16[_0x1cf13a(0x263)]),_0x32fa16[_0x1cf13a(0x47e)]=()=>_0xc737f1(_0x32fa16[_0x1cf13a(0x29a)]);});},async 'save'(_0xe946e0){const _0x2add04=_0x2d92ab;return await this[_0x2add04(0x3a4)](),new Promise((_0x315e3e,_0x7d0f9a)=>{const _0x47fa13=_0x2add04,_0x112bc2=this['db']['transaction']([_0x47fa13(0x3cc),_0x47fa13(0x268),_0x47fa13(0x25e)],_0x47fa13(0x227)),_0xc4c629=_0x112bc2[_0x47fa13(0x1a4)](_0x47fa13(0x3cc)),_0x197442=_0x112bc2[_0x47fa13(0x1a4)](_0x47fa13(0x268)),_0x53a4f2=_0x112bc2[_0x47fa13(0x1a4)](_0x47fa13(0x25e));_0xc4c629[_0x47fa13(0x299)](_0xe946e0[_0x47fa13(0x3cc)],'main_settings'),_0x197442[_0x47fa13(0x2db)](),_0x53a4f2[_0x47fa13(0x2db)](),_0xe946e0[_0x47fa13(0x268)][_0x47fa13(0x467)](_0x59eb95=>{const _0x4074ce=_0x47fa13,{subtopics:_0x155217,..._0x381e91}=_0x59eb95;_0x197442['put'](_0x381e91),(_0x155217||[])['forEach'](_0x34a5fc=>_0x53a4f2[_0x4074ce(0x299)](_0x34a5fc));}),_0x112bc2[_0x47fa13(0x1e6)]=()=>_0x315e3e(),_0x112bc2[_0x47fa13(0x47e)]=_0x11ca05=>_0x7d0f9a(_0x11ca05[_0x47fa13(0x26b)][_0x47fa13(0x29a)]);});},async 'autoBackup'(_0x200d30){const _0x5125f2=_0x2d92ab;await this['initDB']();const _0x1188d=new Date()[_0x5125f2(0x350)]()[_0x5125f2(0x33c)](0x0,0xa),_0x14e2f3=localStorage[_0x5125f2(0x2e8)](_0x5125f2(0x255));if(_0x1188d!==_0x14e2f3){console[_0x5125f2(0x2c3)](_0x5125f2(0x412)+_0x1188d+_0x5125f2(0x39e));const _0x473978={'date':_0x1188d,'data':JSON[_0x5125f2(0x1f2)](JSON[_0x5125f2(0x49b)](_0x200d30))},_0x5ea44c=this['db'][_0x5125f2(0x3eb)](['backups'],'readwrite'),_0xca061e=_0x5ea44c[_0x5125f2(0x1a4)](_0x5125f2(0x48f)),_0x3badf9=_0xca061e[_0x5125f2(0x299)](_0x473978);_0x3badf9[_0x5125f2(0x2fe)]=()=>{const _0x3b3949=_0x5125f2;localStorage[_0x3b3949(0x1b0)](_0x3b3949(0x255),_0x1188d),console['log'](_0x3b3949(0x1f4)),this['cleanupOldBackups'](_0x200d30?.['settings']?.[_0x3b3949(0x395)]||0x7);},_0x3badf9[_0x5125f2(0x47e)]=_0x398282=>{const _0x274790=_0x5125f2;console[_0x274790(0x29a)]('Backup\x20failed:',_0x398282[_0x274790(0x26b)][_0x274790(0x29a)]);};}},async 'cleanupOldBackups'(_0x1f9f95){const _0x6e6408=_0x2d92ab;await this[_0x6e6408(0x3a4)]();const _0x1ff266=this['db'][_0x6e6408(0x3eb)]([_0x6e6408(0x48f)],_0x6e6408(0x227)),_0x1f6069=_0x1ff266[_0x6e6408(0x1a4)](_0x6e6408(0x48f)),_0x484bbe=_0x1f6069[_0x6e6408(0x1d1)]();_0x484bbe[_0x6e6408(0x2fe)]=()=>{const _0x53c9ad=_0x6e6408,_0x5bc9f1=_0x484bbe[_0x53c9ad(0x263)]['sort']()['reverse']();if(_0x5bc9f1[_0x53c9ad(0x1ae)]>_0x1f9f95){const _0x2189b5=_0x5bc9f1[_0x53c9ad(0x33c)](_0x1f9f95);_0x2189b5[_0x53c9ad(0x467)](_0x4eada9=>{const _0x12c77e=_0x53c9ad;_0x1f6069[_0x12c77e(0x439)](_0x4eada9),console[_0x12c77e(0x2c3)](_0x12c77e(0x208)+_0x4eada9);});}};},async 'getBackupList'(){const _0x580e77=_0x2d92ab;return await this[_0x580e77(0x3a4)](),new Promise((_0x593ac5,_0x7a78aa)=>{const _0x24ee9d=_0x580e77,_0x1b47ec=this['db'][_0x24ee9d(0x3eb)]([_0x24ee9d(0x48f)],_0x24ee9d(0x358)),_0x574e85=_0x1b47ec['objectStore'](_0x24ee9d(0x48f)),_0x2436b7=_0x574e85[_0x24ee9d(0x37d)]();_0x2436b7['onsuccess']=()=>_0x593ac5(_0x2436b7['result'][_0x24ee9d(0x459)]((_0xf5be70,_0x132ffd)=>_0x132ffd[_0x24ee9d(0x375)][_0x24ee9d(0x1fc)](_0xf5be70[_0x24ee9d(0x375)]))),_0x2436b7[_0x24ee9d(0x47e)]=_0x4367cc=>_0x7a78aa(_0x4367cc[_0x24ee9d(0x26b)][_0x24ee9d(0x29a)]);});},async 'restoreBackup'(_0x296f06){const _0x3572e0=_0x2d92ab;return await this[_0x3572e0(0x3a4)](),new Promise((_0x445aa6,_0x159135)=>{const _0x3d14d2=_0x3572e0,_0x100ae3=this['db'][_0x3d14d2(0x3eb)]([_0x3d14d2(0x48f)],_0x3d14d2(0x358)),_0x21611d=_0x100ae3[_0x3d14d2(0x1a4)](_0x3d14d2(0x48f)),_0x52ccba=_0x21611d[_0x3d14d2(0x370)](_0x296f06);_0x52ccba[_0x3d14d2(0x2fe)]=()=>{const _0x5e2fb0=_0x3d14d2;_0x52ccba[_0x5e2fb0(0x263)]&&_0x52ccba[_0x5e2fb0(0x263)]['data']?(localStorage[_0x5e2fb0(0x1b0)]('pomodoroData_v11',JSON[_0x5e2fb0(0x49b)](_0x52ccba['result'][_0x5e2fb0(0x3f8)])),_0x445aa6(_0x52ccba[_0x5e2fb0(0x263)][_0x5e2fb0(0x3f8)])):_0x159135(new Error(_0x5e2fb0(0x18d)));},_0x52ccba[_0x3d14d2(0x47e)]=_0x3c8ab8=>_0x159135(_0x3c8ab8[_0x3d14d2(0x26b)]['error']);});},'exportData'(_0x30bb69){const _0x21b11b=_0x2d92ab;let _0x50d133={};try{_0x50d133=JSON[_0x21b11b(0x1f2)](JSON[_0x21b11b(0x49b)](_0x30bb69||{}));}catch(_0x37aefd){_0x50d133=_0x30bb69;}try{if(_0x50d133&&_0x50d133[_0x21b11b(0x3cc)])_0x50d133['settings'][_0x21b11b(0x240)]='';}catch(_0x36ed54){}const _0x13dd60=new Blob([JSON[_0x21b11b(0x49b)](_0x50d133,null,0x2)],{'type':_0x21b11b(0x1de)}),_0x2d8841=document[_0x21b11b(0x2e2)]('a'),_0x280c54=new Date(),_0xb24474=_0x9f59cd=>(''+_0x9f59cd)[_0x21b11b(0x320)](0x2,'0');_0x2d8841['href']=URL[_0x21b11b(0x334)](_0x13dd60),_0x2d8841[_0x21b11b(0x296)]='pomodoro_backup_'+_0x280c54[_0x21b11b(0x264)]()+_0xb24474(_0x280c54[_0x21b11b(0x1d4)]()+0x1)+_0xb24474(_0x280c54['getDate']())+_0x21b11b(0x426),_0x2d8841[_0x21b11b(0x30e)](),URL[_0x21b11b(0x465)](_0x2d8841[_0x21b11b(0x19c)]);},async 'importData'(_0x2f01e4){const _0x2cb988=_0x2d92ab,_0x4dfc08=await _0x2f01e4['text'](),_0x2d8271=JSON[_0x2cb988(0x1f2)](_0x4dfc08);if(!_0x2d8271[_0x2cb988(0x1cf)]||!_0x2d8271[_0x2cb988(0x3cc)]||!Array[_0x2cb988(0x1ac)](_0x2d8271[_0x2cb988(0x268)]))throw new Error(_0x2cb988(0x2c8));try{const _0x48b442=window[_0x2cb988(0x3f8)]&&window[_0x2cb988(0x3f8)][_0x2cb988(0x3cc)]&&window['data']['settings'][_0x2cb988(0x240)]||'';(!(_0x2cb988(0x240)in _0x2d8271[_0x2cb988(0x3cc)])||_0x2d8271['settings'][_0x2cb988(0x240)]==='')&&(_0x2d8271[_0x2cb988(0x3cc)][_0x2cb988(0x240)]=_0x48b442);}catch(_0x420c38){}return localStorage[_0x2cb988(0x1b0)](_0x2cb988(0x29f),JSON[_0x2cb988(0x49b)](_0x2d8271)),_0x2d8271;}},$=(_0x20df7f,_0x59f7b3=document)=>_0x59f7b3[_0x2d92ab(0x35a)](_0x20df7f),breakSuggestions=[_0x2d92ab(0x1e8),_0x2d92ab(0x372),'Nhìn\x20ra\x20xa\x20qua\x20cửa\x20sổ\x20trong\x2020\x20giây.','Đi\x20dạo\x20một\x20vòng\x20ngắn\x20quanh\x20phòng.',_0x2d92ab(0x2f6),'Sắp\x20xếp\x20lại\x20không\x20gian\x20làm\x20việc\x20của\x20bạn.',_0x2d92ab(0x1a3),_0x2d92ab(0x3ec),_0x2d92ab(0x353),'Thả\x20lỏng\x20toàn\x20thân,\x20cảm\x20nhận\x20hơi\x20thở.',_0x2d92ab(0x41d),_0x2d92ab(0x23f),_0x2d92ab(0x3ac),_0x2d92ab(0x354),'Đếm\x20ngược\x20từ\x2020\x20đến\x200\x20thật\x20chậm\x20rãi.',_0x2d92ab(0x403),_0x2d92ab(0x496),_0x2d92ab(0x2b4),_0x2d92ab(0x2f5),_0x2d92ab(0x2e6),'Đếm\x20chậm\x20từng\x20nhịp\x20thở\x20đến\x20số\x2010.',_0x2d92ab(0x272),_0x2d92ab(0x2e7),_0x2d92ab(0x2b8),_0x2d92ab(0x1ee),'Chớp\x20mắt\x20liên\x20tục\x2010\x20lần\x20để\x20tránh\x20khô\x20mắt.',_0x2d92ab(0x34a),_0x2d92ab(0x44b),_0x2d92ab(0x192),_0x2d92ab(0x36e),'Kiểm\x20tra\x20nhịp\x20thở\x20–\x20nếu\x20gấp\x20gáp,\x20hãy\x20làm\x20chậm\x20lại.',_0x2d92ab(0x36c)],$$=(_0x32528d,_0x28f23b=document)=>Array[_0x2d92ab(0x43d)](_0x28f23b[_0x2d92ab(0x260)](_0x32528d));function on(_0x22c63a,_0x49f24a,_0x11369e){const _0x70317=_0x2d92ab;if(!_0x22c63a){console[_0x70317(0x3e3)](_0x70317(0x3f2),_0x49f24a);return;}_0x22c63a['addEventListener'](_0x49f24a,_0x11369e);}const formatMMSS=_0x8cc45f=>{const _0x2045f5=_0x2d92ab,_0x1724d4=Math[_0x2045f5(0x25c)](_0x8cc45f/0x3c)[_0x2045f5(0x235)]()[_0x2045f5(0x320)](0x2,'0'),_0x1551cb=Math['floor'](_0x8cc45f%0x3c)[_0x2045f5(0x235)]()[_0x2045f5(0x320)](0x2,'0');return _0x1724d4+':'+_0x1551cb;},uid=(_0x4f73dd='id')=>_0x4f73dd+'_'+Date[_0x2d92ab(0x340)]()+'_'+Math[_0x2d92ab(0x3cf)]()[_0x2d92ab(0x235)](0x24)[_0x2d92ab(0x33c)](0x2,0x9);let __releaseFocusTrap=null;function trapFocus(_0x871c88){const _0x191b54=_0x2d92ab;try{const _0x4654c3=_0x871c88[_0x191b54(0x260)](_0x191b54(0x2df));if(!_0x4654c3[_0x191b54(0x1ae)])return;const _0x249c76=_0x4654c3[0x0],_0x200352=_0x4654c3[_0x4654c3[_0x191b54(0x1ae)]-0x1],_0x30b223=_0x214e0e=>{const _0x9702b7=_0x191b54;if(_0x214e0e[_0x9702b7(0x3b5)]===_0x9702b7(0x382)){if(_0x214e0e[_0x9702b7(0x24b)]&&document['activeElement']===_0x249c76)_0x214e0e[_0x9702b7(0x359)](),_0x200352[_0x9702b7(0x2af)]();else!_0x214e0e[_0x9702b7(0x24b)]&&document[_0x9702b7(0x1b2)]===_0x200352&&(_0x214e0e[_0x9702b7(0x359)](),_0x249c76['focus']());}};_0x871c88[_0x191b54(0x22e)](_0x191b54(0x32a),_0x30b223),_0x249c76['focus'](),__releaseFocusTrap=()=>{const _0x279b76=_0x191b54;try{_0x871c88[_0x279b76(0x23c)](_0x279b76(0x32a),_0x30b223);}catch(_0x205ce4){}};}catch(_0x5e0fb2){}}function releaseFocus(){if(__releaseFocusTrap){try{__releaseFocusTrap();}catch(_0x2d68c0){}__releaseFocusTrap=null;}}const todayISO=()=>new Date()[_0x2d92ab(0x350)]();function toast(_0x20ccab,_0xd151b8=0xa28){const _0x247090=_0x2d92ab,_0x3eaf39=$(_0x247090(0x30d)),_0x5c763a=document['createElement'](_0x247090(0x206));_0x5c763a[_0x247090(0x45f)]=_0x247090(0x2b2),_0x5c763a[_0x247090(0x3ef)]=_0x20ccab,_0x3eaf39[_0x247090(0x499)](_0x5c763a),setTimeout(()=>{const _0x131104=_0x247090;_0x5c763a[_0x131104(0x34c)][_0x131104(0x3ea)]='0';},_0xd151b8-0x12c),setTimeout(()=>_0x3eaf39[_0x247090(0x47d)](_0x5c763a),_0xd151b8);}function escapeHTML(_0x5d3692){const _0x502911=_0x2d92ab;return _0x5d3692[_0x502911(0x3c4)](/[&<>"']/g,_0x5ec3c3=>({'&':_0x502911(0x1cd),'<':_0x502911(0x22f),'>':_0x502911(0x484),'\x22':_0x502911(0x213),'\x27':'&#39;'}[_0x5ec3c3]));}function formatDaysHoursMinutes(_0x43026d){const _0x386f4d=_0x2d92ab;if(!_0x43026d||_0x43026d<0x1)return _0x386f4d(0x2b3);const _0x27ff33=Math['floor'](_0x43026d/0x3c),_0x192059=_0x43026d%0x3c,_0x5ac574=_0x192059['toString']()['padStart'](0x2,'0');return _0x27ff33+_0x386f4d(0x308)+_0x5ac574+_0x386f4d(0x408);}function formatGeminiResponse(_0x251fe5){const _0x3fc105=_0x2d92ab;return _0x251fe5[_0x3fc105(0x3c4)](/(\*\*|__|\*|_|#+\s*)/g,'');}function parseSimpleMarkdown(_0x244b19){const _0x11d0dd=_0x2d92ab,_0x11072b=(_0x244b19||'')[_0x11d0dd(0x194)]('\x0a');let _0x226ad5='',_0x441504=null;const _0x37d7f0=()=>{const _0x13699a=_0x11d0dd;_0x441504&&(_0x226ad5+=_0x441504==='ol'?'</ol>':_0x13699a(0x23b),_0x441504=null);};for(let _0xea85f6 of _0x11072b){let _0x2838a3=(_0xea85f6||'')[_0x11d0dd(0x265)]();if(!_0x2838a3){_0x37d7f0();continue;}if(_0x2838a3[_0x11d0dd(0x1ce)]('####\x20'))_0x37d7f0(),_0x226ad5+='<h4>'+escapeHTML(_0x2838a3[_0x11d0dd(0x494)](0x5))+_0x11d0dd(0x349);else{if(/^\d+\.\s/[_0x11d0dd(0x425)](_0x2838a3)){_0x441504!=='ol'&&(_0x37d7f0(),_0x226ad5+=_0x11d0dd(0x184),_0x441504='ol');const _0x3ea2e3=_0x2838a3[_0x11d0dd(0x494)](_0x2838a3[_0x11d0dd(0x339)]('\x20')+0x1);_0x226ad5+=_0x11d0dd(0x2cc)+escapeHTML(_0x3ea2e3)+_0x11d0dd(0x2d8);}else _0x2838a3[_0x11d0dd(0x1ce)]('-\x20')?(_0x441504!=='ul'&&(_0x37d7f0(),_0x226ad5+=_0x11d0dd(0x38a),_0x441504='ul'),_0x226ad5+='<li>'+escapeHTML(_0x2838a3[_0x11d0dd(0x494)](0x2))+_0x11d0dd(0x2d8)):(_0x37d7f0(),_0x2838a3=escapeHTML(_0x2838a3)[_0x11d0dd(0x3c4)](/\*\*(.*?)\*\*/g,_0x11d0dd(0x33f))[_0x11d0dd(0x3c4)](/_(.*?)_/g,_0x11d0dd(0x1dd)),_0x226ad5+='<p>'+_0x2838a3+_0x11d0dd(0x291));}}return _0x37d7f0(),_0x226ad5;}function wrapTextInMarkdown(_0x6d523f,_0x18a84a,_0x136f9c=''){const _0x4ea553=_0x2d92ab;if(!_0x6d523f)return;const _0x160658=_0x6d523f[_0x4ea553(0x438)]||0x0,_0x4dac7f=_0x6d523f[_0x4ea553(0x215)]||0x0,_0x3a5fef=_0x6d523f[_0x4ea553(0x1bb)][_0x4ea553(0x494)](_0x160658,_0x4dac7f),_0x1b7105=_0x18a84a+_0x3a5fef+(_0x136f9c||_0x18a84a);_0x6d523f[_0x4ea553(0x23e)](_0x1b7105,_0x160658,_0x4dac7f,_0x4ea553(0x43a)),_0x6d523f['focus']();}function updateEditorPreview(){const _0x2288ac=_0x2d92ab,_0x29f2fa=$(_0x2288ac(0x46e)),_0x8a3311=$(_0x2288ac(0x3ad));if(!_0x29f2fa||!_0x8a3311)return;const _0x1dbf8f=_0x29f2fa[_0x2288ac(0x1bb)]||'';_0x8a3311[_0x2288ac(0x200)]=parseSimpleMarkdown(_0x1dbf8f);}function normalizeDataStructure(_0x338281){const _0x37edb7=_0x2d92ab;if(!_0x338281||typeof _0x338281!==_0x37edb7(0x1ca))return;const _0x591400=_0x338281[_0x37edb7(0x3cc)]||{},_0x4fbcbb={...defaults[_0x37edb7(0x3cc)],..._0x591400,'durations':{...defaults[_0x37edb7(0x3cc)][_0x37edb7(0x1d7)],..._0x591400[_0x37edb7(0x1d7)]||{}}};if(!Array[_0x37edb7(0x1ac)](_0x4fbcbb['achievedMilestones']))_0x4fbcbb['achievedMilestones']=[];_0x338281[_0x37edb7(0x3cc)]=_0x4fbcbb,_0x338281[_0x37edb7(0x268)]=Array[_0x37edb7(0x1ac)](_0x338281['topics'])?_0x338281[_0x37edb7(0x268)]:[],_0x338281[_0x37edb7(0x268)][_0x37edb7(0x467)](_0x2e623d=>{const _0x277798=_0x37edb7;_0x2e623d['subtopics']=Array[_0x277798(0x1ac)](_0x2e623d['subtopics'])?_0x2e623d['subtopics']:[],_0x2e623d[_0x277798(0x25e)]['forEach'](_0x5018ac=>{const _0x28a46b=_0x277798;_0x5018ac[_0x28a46b(0x3c2)]=_0x5018ac[_0x28a46b(0x3c2)]||[],_0x5018ac[_0x28a46b(0x48e)]=_0x5018ac[_0x28a46b(0x48e)]||[],_0x5018ac[_0x28a46b(0x19a)]=_0x5018ac['summaries']||[],_0x5018ac[_0x28a46b(0x321)]=_0x5018ac['chatHistory']||[],_0x5018ac[_0x28a46b(0x2ef)]=Array[_0x28a46b(0x1ac)](_0x5018ac[_0x28a46b(0x2ef)])?_0x5018ac['methods']:[],_0x5018ac[_0x28a46b(0x1b8)]=_0x5018ac[_0x28a46b(0x1b8)]||{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},_0x5018ac[_0x28a46b(0x479)]=_0x5018ac['sessions']||[],_0x5018ac[_0x28a46b(0x27b)]=_0x5018ac[_0x28a46b(0x27b)]||{'state':_0x28a46b(0x317),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0};});});}function extractYouTubeID(_0x22a7c3){const _0x197309=_0x2d92ab;if(!_0x22a7c3)return null;const _0xf8180f=/^.*(?:youtu.be\/|shorts\/|live\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([A-Za-z0-9_-]{11}).*/,_0x24bb79=_0x22a7c3[_0x197309(0x1ec)](_0xf8180f);return _0x24bb79?_0x24bb79[0x1]:null;}let sessionYoutubeUrl='';function getActiveYoutubeUrl(){const _0x23e822=_0x2d92ab;try{if(sessionYoutubeUrl)return sessionYoutubeUrl;const _0x2221d6=document[_0x23e822(0x26a)](_0x23e822(0x3a6)),_0x109cb5=(_0x2221d6&&_0x2221d6['value']?_0x2221d6[_0x23e822(0x1bb)]:'')[_0x23e822(0x265)]();return _0x109cb5;}catch(_0x5877c2){return'';}}function getActiveVideoId(){return extractYouTubeID(getActiveYoutubeUrl());}function handleYoutubeUrlInput(){const _0x36f6d1=_0x2d92ab,_0x53ca61=$(_0x36f6d1(0x2e5)),_0x24797b=$('#ytUrlFeedback'),_0x54bff2=$('#btnToggleYtSound'),_0x15b0a7=_0x53ca61['value']['trim'](),_0x838244=extractYouTubeID(_0x15b0a7);if(_0x838244){_0x24797b[_0x36f6d1(0x3ef)]=_0x36f6d1(0x306),_0x24797b[_0x36f6d1(0x34c)][_0x36f6d1(0x2c0)]=_0x36f6d1(0x30a),_0x54bff2[_0x36f6d1(0x3f0)]=![],sessionYoutubeUrl=_0x15b0a7;try{ytUserPaused=![];}catch(_0x2413f7){}try{const _0x1a41af=_0x36f6d1(0x1ff)+_0x838244+_0x36f6d1(0x35b),_0x3c528c=new Image();_0x3c528c[_0x36f6d1(0x2e9)]=async()=>{const _0xf72325=_0x36f6d1;data[_0xf72325(0x3cc)]['customBg']=_0x1a41af;try{await saveData();}catch(_0x3d226e){}applyCustomBg();},_0x3c528c[_0x36f6d1(0x47e)]=async()=>{const _0x480cf0=_0x36f6d1,_0xdf0229=_0x480cf0(0x1ff)+_0x838244+_0x480cf0(0x2f7);data[_0x480cf0(0x3cc)][_0x480cf0(0x45e)]=_0xdf0229;try{await saveData();}catch(_0x3d75d3){}applyCustomBg();},_0x3c528c[_0x36f6d1(0x1eb)]=_0x1a41af;}catch(_0x441387){}try{if(IS_FILE_PROTOCOL){const _0x5bbc92=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x838244,{'autoplay':0x1,'mute':_0x5bbc92});try{setTimeout(()=>{try{fallbackPostMessage('playVideo');}catch(_0x1d6756){}},0xfa);}catch(_0x56c447){}!_ytUnlocked&&showSoundPermission();try{setTimeout(()=>{const _0x396513=_0x36f6d1,_0x3e72bf=document[_0x396513(0x26a)](_0x396513(0x405));if(_0x3e72bf)_0x3e72bf['textContent']=_0x396513(0x1b6);},0x1f4);}catch(_0x4f6691){}}else ensureYouTubeAPI()[_0x36f6d1(0x186)](()=>{const _0x427a54=_0x36f6d1;updateYouTubePlayer();try{if(_ytUnlocked)ytFadeInPlay();else ytPlayer&&ytPlayer['mute']&&ytPlayer['playVideo']&&(ytPlayer[_0x427a54(0x3a3)](),ytPlayer[_0x427a54(0x1ea)](),_ytPrimed=!![],showSoundPermission());}catch(_0x1a4929){}})[_0x36f6d1(0x49f)](()=>{});}catch(_0x51ae1e){}}else{if(_0x15b0a7===''){_0x24797b[_0x36f6d1(0x3ef)]='',_0x54bff2['disabled']=!![];if(IS_FILE_PROTOCOL)try{fallbackStop();}catch(_0x1d9c87){}else ytPlayer&&ytPlayer[_0x36f6d1(0x1b9)]&&ytPlayer[_0x36f6d1(0x1b9)]();}else _0x24797b[_0x36f6d1(0x3ef)]=_0x36f6d1(0x3d4),_0x24797b[_0x36f6d1(0x34c)]['color']=_0x36f6d1(0x281),_0x54bff2[_0x36f6d1(0x3f0)]=!![];}}function applyTheme(_0x5a4876){const _0xb01d25=_0x2d92ab,_0x2acfe5=_0x5a4876||data[_0xb01d25(0x3cc)][_0xb01d25(0x46f)]||_0xb01d25(0x466);document['body'][_0xb01d25(0x336)][_0xb01d25(0x46f)]=_0x2acfe5;const _0x599a00=[_0xb01d25(0x245),'space'][_0xb01d25(0x3cb)](_0x2acfe5),_0x2c9a81=_0x2acfe5===_0xb01d25(0x2a1)||_0x2acfe5===_0xb01d25(0x1a7),_0x311bbb=data[_0xb01d25(0x3cc)][_0xb01d25(0x45e)],_0x2665b8=()=>{const _0x1df107=_0xb01d25;try{document[_0x1df107(0x3e7)][_0x1df107(0x34c)][_0x1df107(0x338)]='';}catch(_0x27940e){}};if(_0x311bbb&&!data[_0xb01d25(0x3cc)]['useYtThumbnailAsBg'])document['body']['style'][_0xb01d25(0x40e)](_0xb01d25(0x21e),_0xb01d25(0x3df)+_0x311bbb+')'),_0x2665b8();else{if(_0x311bbb&&data[_0xb01d25(0x3cc)][_0xb01d25(0x3c7)])document['body'][_0xb01d25(0x34c)][_0xb01d25(0x40e)]('--bg-image',_0xb01d25(0x3df)+_0x311bbb+')'),_0x2665b8();else{if(_0x599a00)document[_0xb01d25(0x3e7)][_0xb01d25(0x34c)]['removeProperty'](_0xb01d25(0x21e)),_0x2665b8();else _0x2c9a81?(document[_0xb01d25(0x3e7)]['style'][_0xb01d25(0x40e)](_0xb01d25(0x21e),_0xb01d25(0x35d)),_0x2665b8()):(document[_0xb01d25(0x3e7)][_0xb01d25(0x34c)]['setProperty'](_0xb01d25(0x21e),''),document['body'][_0xb01d25(0x34c)][_0xb01d25(0x338)]='radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)');}}}const defaults={'version':0x1,'settings':{'apiKey':'','currentView':_0x2d92ab(0x2ec),'preset':'A','autoStartNext':!![],'soundOn':!![],'volume':0.8,'soundTheme':_0x2d92ab(0x450),'theme':_0x2d92ab(0x466),'cyclesA':0x4,'longBreakIntervalA':0x4,'cyclesB':0x4,'longBreakIntervalB':0x4,'flowtimeBreakRatio':0x5,'enableWinddown':!![],'enableSessionNotes':!![],'durations':{'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},'selectedTopicId':'','selectedSubtopicId':'','collapsedTopics':{},'customBg':'','customSounds':{'work_end':'','break_end':'','long_end':''},'youtubeUrl':'','youtubeVolume':0x50,'useYtThumbnailAsBg':!![],'panelOpacity':0.85,'panelBlur':0xa,'backgroundMode':'cover','backupDaysToKeep':0x7,'achievedMilestones':[],'methods':[{'id':uid('m'),'title':_0x2d92ab(0x2a4),'content':_0x2d92ab(0x335)},{'id':uid('m'),'title':_0x2d92ab(0x1f6),'content':_0x2d92ab(0x487)},{'id':uid('m'),'title':_0x2d92ab(0x237),'content':_0x2d92ab(0x32b)},{'id':uid('m'),'title':_0x2d92ab(0x44a),'content':_0x2d92ab(0x1bd)},{'id':uid('m'),'title':_0x2d92ab(0x344),'content':_0x2d92ab(0x44d)}]},'topics':[]};let data,editingPreset='A',AUDIO_CTX=null;function ensureAudio(){const _0x41173e=_0x2d92ab;if(!AUDIO_CTX)AUDIO_CTX=new(window[(_0x41173e(0x47f))]||window[(_0x41173e(0x464))])();}function tone(_0x9614e6=0x370,_0x1bf541=0xc8,_0x41106f=0.2,_0x5cc700=_0x2d92ab(0x1df),_0x3db511=0x0){const _0x3595cd=_0x2d92ab;ensureAudio();const _0x426d02=AUDIO_CTX,_0x5eb54e=_0x426d02[_0x3595cd(0x25a)](),_0x583480=_0x426d02[_0x3595cd(0x48d)]();_0x5eb54e['type']=_0x5cc700,_0x5eb54e[_0x3595cd(0x416)]['value']=_0x9614e6,_0x5eb54e['connect'](_0x583480),_0x583480[_0x3595cd(0x1c2)](_0x426d02['destination']);const _0x41bda3=_0x426d02['currentTime']+_0x3db511;_0x583480[_0x3595cd(0x3e2)]['setValueAtTime'](0x0,_0x41bda3),_0x583480['gain'][_0x3595cd(0x453)](_0x41106f,_0x41bda3+0.01),_0x583480[_0x3595cd(0x3e2)][_0x3595cd(0x2c9)](0.0001,_0x41bda3+_0x1bf541/0x3e8),_0x5eb54e[_0x3595cd(0x406)](_0x41bda3),_0x5eb54e[_0x3595cd(0x431)](_0x41bda3+_0x1bf541/0x3e8+0.05);}function playSound(_0x4c75f3){const _0x323c00=_0x2d92ab;if(!data[_0x323c00(0x3cc)][_0x323c00(0x455)])return;const _0x3f0dc1=Math[_0x323c00(0x248)](0x0,Math[_0x323c00(0x28f)](0x1,data['settings'][_0x323c00(0x31f)]??0.8)),_0x4fd3a0=data['settings']['customSounds']?.[_0x4c75f3];let _0x4bee79;if(_0x4c75f3===_0x323c00(0x246))_0x4bee79=$('#audioWorkEnd');else{if(_0x4c75f3===_0x323c00(0x48b))_0x4bee79=$('#audioBreakEnd');else{if(_0x4c75f3===_0x323c00(0x1f3))_0x4bee79=$(_0x323c00(0x205));}}if(_0x4fd3a0&&_0x4bee79){_0x4fd3a0['startsWith'](_0x323c00(0x2dc))||_0x4fd3a0[_0x323c00(0x1ce)]('http')||_0x4fd3a0[_0x323c00(0x1ce)](_0x323c00(0x414))?(_0x4bee79[_0x323c00(0x1eb)]=_0x4fd3a0,_0x4bee79['volume']=_0x3f0dc1,_0x4bee79[_0x323c00(0x181)]()[_0x323c00(0x49f)](_0x356bf8=>console[_0x323c00(0x29a)](_0x323c00(0x2f8),_0x356bf8))):getStoredFileUrl(_0x4fd3a0)[_0x323c00(0x186)](_0x12965a=>{const _0x2477f3=_0x323c00;_0x12965a&&(_0x4bee79[_0x2477f3(0x1eb)]=_0x12965a,_0x4bee79[_0x2477f3(0x31f)]=_0x3f0dc1,_0x4bee79[_0x2477f3(0x181)]()[_0x2477f3(0x49f)](_0x3f5c7d=>console[_0x2477f3(0x29a)](_0x2477f3(0x2f8),_0x3f5c7d)));});return;}const _0x1a0dd3=data[_0x323c00(0x3cc)][_0x323c00(0x286)]||_0x323c00(0x450);if(_0x1a0dd3===_0x323c00(0x450)){if(_0x4c75f3===_0x323c00(0x246))tone(0x370,0xfa,_0x3f0dc1),tone(0x294,0xb4,_0x3f0dc1*0.8,_0x323c00(0x1df),0.22);else{if(_0x4c75f3===_0x323c00(0x48b))tone(0x294,0xdc,_0x3f0dc1*0.9);else _0x4c75f3===_0x323c00(0x1f3)&&(tone(0x208,0xc8,_0x3f0dc1),tone(0x30c,0xc8,_0x3f0dc1,_0x323c00(0x1df),0.22),tone(0x410,0xdc,_0x3f0dc1,_0x323c00(0x1df),0.44));}}else{if(_0x4c75f3===_0x323c00(0x246))tone(0x4b0,0xa0,_0x3f0dc1*0.9,_0x323c00(0x1e9)),tone(0x384,0xdc,_0x3f0dc1*0.8,_0x323c00(0x1e9),0.18);else{if(_0x4c75f3===_0x323c00(0x48b))tone(0x370,0xf0,_0x3f0dc1*0.8,_0x323c00(0x1e9));else _0x4c75f3===_0x323c00(0x1f3)&&(tone(0x258,0xdc,_0x3f0dc1*0.9,'triangle'),tone(0x3b6,0xf0,_0x3f0dc1*0.9,_0x323c00(0x1e9),0.22),tone(0x4b0,0xf0,_0x3f0dc1,_0x323c00(0x1e9),0.44));}}}async function saveData(){const _0x175e32=_0x2d92ab;try{await storageManager[_0x175e32(0x404)](data);}catch(_0x443e7e){console[_0x175e32(0x29a)](_0x175e32(0x1aa),_0x443e7e),toast(_0x175e32(0x3e6)+_0x443e7e[_0x175e32(0x27e)]);}}async function ensureValidSelection(){const _0x34c8ab=_0x2d92ab,_0x41beb9=data[_0x34c8ab(0x3cc)];if(!data[_0x34c8ab(0x268)]||data[_0x34c8ab(0x268)][_0x34c8ab(0x1ae)]===0x0){_0x41beb9[_0x34c8ab(0x1e5)]='',_0x41beb9[_0x34c8ab(0x274)]='',await saveData();return;}const _0x167c55=data['topics']['find'](_0x47d908=>_0x47d908['id']===_0x41beb9[_0x34c8ab(0x1e5)]),_0x397948=_0x167c55?.['subtopics'][_0x34c8ab(0x347)](_0x46e178=>_0x46e178['id']===_0x41beb9['selectedSubtopicId']);if(!_0x167c55||!_0x397948){const _0x7abe58=data['topics'][0x0],_0x5b970a=_0x7abe58?.[_0x34c8ab(0x25e)]?.[0x0];_0x41beb9['selectedTopicId']=_0x7abe58?.['id']||'',_0x41beb9[_0x34c8ab(0x274)]=_0x5b970a?.['id']||'',await saveData();}}function showInputModal(_0x532692,_0x240414,_0x269e2d=''){const _0x359748=_0x2d92ab;$(_0x359748(0x191))[_0x359748(0x3ef)]=_0x532692,$('#genericMessage')['classList'][_0x359748(0x31c)](_0x359748(0x31d));const _0x41897d=$(_0x359748(0x231));_0x41897d[_0x359748(0x1bb)]=_0x269e2d,_0x41897d[_0x359748(0x300)][_0x359748(0x21c)]('hidden'),$(_0x359748(0x1bc))['classList'][_0x359748(0x31c)](_0x359748(0x257));try{trapFocus($('#modalGeneric'));}catch(_0x270ac5){}_0x41897d[_0x359748(0x2af)](),_0x41897d[_0x359748(0x21f)]();const _0x46e1df=()=>{const _0x2de843=_0x359748;_0x240414(_0x41897d[_0x2de843(0x1bb)]),_0x445de3();},_0x4e0237=()=>_0x445de3(),_0x3f7bcb=_0x1d040c=>{const _0x3335ea=_0x359748;if(_0x1d040c[_0x3335ea(0x3b5)]===_0x3335ea(0x34b))_0x46e1df();if(_0x1d040c[_0x3335ea(0x3b5)]===_0x3335ea(0x3a8))_0x4e0237();};$(_0x359748(0x45b))[_0x359748(0x1be)]=_0x46e1df,$(_0x359748(0x379))['onclick']=_0x4e0237,_0x41897d['onkeydown']=_0x3f7bcb;function _0x445de3(){const _0x5a6df4=_0x359748;$(_0x5a6df4(0x1bc))[_0x5a6df4(0x300)]['remove']('show'),$('#btnGenericOk')[_0x5a6df4(0x1be)]=null,$(_0x5a6df4(0x379))[_0x5a6df4(0x1be)]=null,_0x41897d[_0x5a6df4(0x3f4)]=null;try{releaseFocus();}catch(_0x3f521a){}}}function _0x50e5(_0x500e48,_0x594050){const _0x532591=_0x5325();return _0x50e5=function(_0x50e5e0,_0x1bd12d){_0x50e5e0=_0x50e5e0-0x180;let _0xd00790=_0x532591[_0x50e5e0];return _0xd00790;},_0x50e5(_0x500e48,_0x594050);}function showConfirmModal(_0xc2ba55,_0x7ce400,_0x48e188){const _0x47f116=_0x2d92ab;$('#genericTitle')[_0x47f116(0x3ef)]=_0xc2ba55;const _0x4cae5d=$(_0x47f116(0x2b6));_0x4cae5d[_0x47f116(0x3ef)]=_0x7ce400,_0x4cae5d[_0x47f116(0x300)][_0x47f116(0x21c)]('hidden'),$(_0x47f116(0x231))[_0x47f116(0x300)][_0x47f116(0x31c)]('hidden'),$(_0x47f116(0x1bc))[_0x47f116(0x300)][_0x47f116(0x31c)](_0x47f116(0x257));try{trapFocus($(_0x47f116(0x1bc)));}catch(_0x4223d9){}const _0x215921=()=>{_0x48e188(!![]),_0x1c4353();},_0x353897=()=>{_0x48e188(![]),_0x1c4353();};$(_0x47f116(0x45b))['onclick']=_0x215921,$(_0x47f116(0x379))[_0x47f116(0x1be)]=_0x353897;function _0x1c4353(){const _0x13b3b2=_0x47f116;$(_0x13b3b2(0x1bc))[_0x13b3b2(0x300)][_0x13b3b2(0x21c)](_0x13b3b2(0x257)),$(_0x13b3b2(0x45b))[_0x13b3b2(0x1be)]=null,$(_0x13b3b2(0x379))[_0x13b3b2(0x1be)]=null;try{releaseFocus();}catch(_0x42acd1){}}}let pendingNoteSessionId=null;function openNoteModal(_0x374f49){const _0x166325=_0x2d92ab;pendingNoteSessionId=_0x374f49||null;const _0x45525f=$('#modalNote');if(!_0x45525f)return;const _0x2f5162=$(_0x166325(0x247));if(_0x2f5162)try{_0x2f5162[_0x166325(0x1bb)]='';}catch(_0x42a9a5){}_0x45525f[_0x166325(0x300)][_0x166325(0x31c)]('show');try{trapFocus(_0x45525f);}catch(_0x48bfa4){}}function closeNoteModal(){const _0x2c7567=_0x2d92ab,_0x3ffa1c=$(_0x2c7567(0x29b));if(!_0x3ffa1c)return;_0x3ffa1c[_0x2c7567(0x300)]['remove'](_0x2c7567(0x257)),pendingNoteSessionId=null;try{releaseFocus();}catch(_0x3008a8){}}async function switchView(_0x49db53){const _0x4de77a=_0x2d92ab;$$('.view')[_0x4de77a(0x467)](_0x23adf9=>_0x23adf9[_0x4de77a(0x300)][_0x4de77a(0x21c)](_0x4de77a(0x314))),$(_0x4de77a(0x2ad)+_0x49db53)[_0x4de77a(0x300)]['add'](_0x4de77a(0x314)),$$(_0x4de77a(0x1a9))['forEach'](_0x3c86fa=>_0x3c86fa['classList']['remove']('active'));const _0x304307=$(_0x4de77a(0x460)+_0x49db53+'\x22]');if(_0x304307)_0x304307[_0x4de77a(0x300)][_0x4de77a(0x31c)](_0x4de77a(0x314));data[_0x4de77a(0x3cc)][_0x4de77a(0x229)]=_0x49db53,await saveData(),_0x49db53==='stats'&&renderDashboard();}function closeAllMenus(){const _0x380a6f=_0x2d92ab;$$('.actions-menu.show')[_0x380a6f(0x467)](_0x4dffbd=>_0x4dffbd['classList'][_0x380a6f(0x21c)](_0x380a6f(0x257))),$$(_0x380a6f(0x26c))['forEach'](_0x5e52a1=>_0x5e52a1[_0x380a6f(0x300)][_0x380a6f(0x21c)](_0x380a6f(0x3bc)));}function renderTopics(){const _0x137148=_0x2d92ab,_0x53eac9=$(_0x137148(0x1ed));if(!_0x53eac9)return;_0x53eac9[_0x137148(0x200)]='';const _0x4702f6=data[_0x137148(0x3cc)][_0x137148(0x2a3)]||{};data[_0x137148(0x268)][_0x137148(0x467)](_0x3a22e6=>{const _0x45c606=_0x137148,_0x473dcb=document[_0x45c606(0x2e2)](_0x45c606(0x206));_0x473dcb[_0x45c606(0x45f)]='topic-item',_0x473dcb[_0x45c606(0x336)][_0x45c606(0x413)]=_0x3a22e6['id'];const _0x4fb634=document[_0x45c606(0x2e2)](_0x45c606(0x206));_0x4fb634[_0x45c606(0x45f)]=_0x45c606(0x2fd);const _0x3d34af=!!_0x4702f6[_0x3a22e6['id']],_0x550b0b=document[_0x45c606(0x2e2)](_0x45c606(0x34f));_0x550b0b[_0x45c606(0x45f)]='chev\x20btn\x20small\x20ghost',_0x550b0b[_0x45c606(0x319)](_0x45c606(0x2d2),String(!_0x3d34af)),_0x550b0b[_0x45c606(0x200)]='<span\x20class=\x22ico\x22>▾</span>';const _0x414e10=document['createElement'](_0x45c606(0x206));_0x414e10[_0x45c606(0x45f)]='topic-title',_0x414e10[_0x45c606(0x3ef)]=_0x3a22e6[_0x45c606(0x418)];const _0x285f8a=document[_0x45c606(0x2e2)](_0x45c606(0x206));_0x285f8a[_0x45c606(0x45f)]=_0x45c606(0x258);const _0x34c309=document[_0x45c606(0x2e2)](_0x45c606(0x34f));_0x34c309['className']='btn\x20small',_0x34c309[_0x45c606(0x200)]=_0x45c606(0x458),_0x34c309[_0x45c606(0x454)]=_0x45c606(0x397);const _0x4bb9c6=document[_0x45c606(0x2e2)](_0x45c606(0x206));_0x4bb9c6[_0x45c606(0x34c)][_0x45c606(0x427)]=_0x45c606(0x1e3);const _0x58562d=document[_0x45c606(0x2e2)]('button');_0x58562d[_0x45c606(0x45f)]='btn\x20small\x20ghost\x20actions-menu-btn',_0x58562d['innerHTML']=_0x45c606(0x39e),_0x58562d[_0x45c606(0x454)]=_0x45c606(0x497);const _0x57b636=document[_0x45c606(0x2e2)](_0x45c606(0x206));_0x57b636[_0x45c606(0x45f)]=_0x45c606(0x276);const _0x15ac66=document[_0x45c606(0x2e2)](_0x45c606(0x34f));_0x15ac66[_0x45c606(0x45f)]=_0x45c606(0x29c),_0x15ac66[_0x45c606(0x200)]='Sửa\x20tên\x20Chủ\x20đề';const _0x556c66=document[_0x45c606(0x2e2)]('button');_0x556c66['className']=_0x45c606(0x437),_0x556c66[_0x45c606(0x200)]='Xóa\x20Chủ\x20đề',_0x57b636[_0x45c606(0x2bf)](_0x15ac66,_0x556c66),_0x4bb9c6[_0x45c606(0x2bf)](_0x58562d,_0x57b636),_0x285f8a[_0x45c606(0x2bf)](_0x34c309,_0x4bb9c6),_0x4fb634['append'](_0x550b0b,_0x414e10,_0x285f8a),_0x550b0b['addEventListener'](_0x45c606(0x30e),async _0x382da1=>{const _0x12557a=_0x45c606;_0x382da1[_0x12557a(0x3e5)]();const _0x5418de=!!_0x4702f6[_0x3a22e6['id']];_0x5418de?delete _0x4702f6[_0x3a22e6['id']]:_0x4702f6[_0x3a22e6['id']]=!![],data['settings'][_0x12557a(0x2a3)]=_0x4702f6,await storageManager[_0x12557a(0x38b)](data[_0x12557a(0x3cc)]),renderTopics();});const _0x177be0=async()=>{const _0x351e6d=_0x45c606,_0x11ee3a=!!_0x4702f6[_0x3a22e6['id']];_0x11ee3a?delete _0x4702f6[_0x3a22e6['id']]:_0x4702f6[_0x3a22e6['id']]=!![],data[_0x351e6d(0x3cc)][_0x351e6d(0x2a3)]=_0x4702f6,await storageManager['updateSettings'](data[_0x351e6d(0x3cc)]),renderTopics();};_0x4fb634['addEventListener'](_0x45c606(0x30e),async _0xb0d4aa=>{const _0x46d439=_0x45c606,_0x55981a=_0xb0d4aa[_0x46d439(0x26b)];if(_0x55981a&&_0x55981a[_0x46d439(0x3f9)]){if(_0x55981a[_0x46d439(0x3f9)](_0x46d439(0x2d0))||_0x55981a[_0x46d439(0x3f9)]('.actions-menu-btn')||_0x55981a[_0x46d439(0x3f9)]('button')||_0x55981a[_0x46d439(0x3f9)](_0x46d439(0x451)))return;}_0xb0d4aa[_0x46d439(0x3e5)](),await _0x177be0();}),_0x414e10['addEventListener'](_0x45c606(0x30e),async _0x149ff7=>{_0x149ff7['stopPropagation'](),await _0x177be0();}),_0x473dcb['addEventListener'](_0x45c606(0x30e),async _0x2d4b88=>{const _0x25602a=_0x45c606,_0x2db6c4=_0x2d4b88[_0x25602a(0x26b)];if(_0x2db6c4&&_0x2db6c4['closest']){if(_0x2db6c4[_0x25602a(0x3f9)](_0x25602a(0x399)))return;if(_0x2db6c4[_0x25602a(0x3f9)](_0x25602a(0x2d0))||_0x2db6c4[_0x25602a(0x3f9)](_0x25602a(0x34e))||_0x2db6c4['closest'](_0x25602a(0x34f))||_0x2db6c4['closest'](_0x25602a(0x451)))return;}await _0x177be0();});const _0x165b16=document[_0x45c606(0x2e2)](_0x45c606(0x206));_0x165b16[_0x45c606(0x45f)]=_0x45c606(0x25e)+(_0x3d34af?_0x45c606(0x37c):''),_0x165b16[_0x45c606(0x336)][_0x45c606(0x413)]=_0x3a22e6['id'],_0x3a22e6['subtopics'][_0x45c606(0x467)](_0x48ecb8=>{const _0x49114e=_0x45c606,_0x2d2b1a=document[_0x49114e(0x2e2)](_0x49114e(0x206));_0x2d2b1a[_0x49114e(0x45f)]=_0x49114e(0x3c5),_0x2d2b1a[_0x49114e(0x336)][_0x49114e(0x2f4)]=_0x48ecb8['id'];const _0xd5054=document[_0x49114e(0x2e2)](_0x49114e(0x34f));_0xd5054['className']='btn\x20subtopic-btn',_0xd5054[_0x49114e(0x3ef)]='•\x20'+_0x48ecb8[_0x49114e(0x418)],_0xd5054[_0x49114e(0x336)][_0x49114e(0x2f4)]=_0x48ecb8['id'],_0xd5054['dataset'][_0x49114e(0x413)]=_0x3a22e6['id'];if(data[_0x49114e(0x3cc)][_0x49114e(0x274)]===_0x48ecb8['id'])_0xd5054[_0x49114e(0x300)][_0x49114e(0x31c)](_0x49114e(0x314));const _0x5bca99=document[_0x49114e(0x2e2)](_0x49114e(0x206));_0x5bca99[_0x49114e(0x45f)]=_0x49114e(0x241);const _0x2a2069=document[_0x49114e(0x2e2)](_0x49114e(0x206));_0x2a2069[_0x49114e(0x34c)][_0x49114e(0x427)]=_0x49114e(0x1e3);const _0x5dc093=document[_0x49114e(0x2e2)](_0x49114e(0x34f));_0x5dc093[_0x49114e(0x45f)]=_0x49114e(0x279),_0x5dc093['innerHTML']=_0x49114e(0x39e),_0x5dc093[_0x49114e(0x454)]=_0x49114e(0x497);const _0x36b395=document['createElement'](_0x49114e(0x206));_0x36b395[_0x49114e(0x45f)]=_0x49114e(0x276);const _0x2880c0=document[_0x49114e(0x2e2)]('button');_0x2880c0['className']='menu-item',_0x2880c0['innerHTML']=_0x49114e(0x390);const _0x3bf7a8=document['createElement']('button');_0x3bf7a8[_0x49114e(0x45f)]='menu-item\x20danger',_0x3bf7a8[_0x49114e(0x200)]='Xóa\x20Chủ\x20đề\x20con',_0x36b395[_0x49114e(0x2bf)](_0x2880c0,_0x3bf7a8),_0x2a2069[_0x49114e(0x2bf)](_0x5dc093,_0x36b395),_0x5bca99['append'](_0x2a2069),_0x2d2b1a[_0x49114e(0x2bf)](_0xd5054,_0x5bca99),_0x165b16[_0x49114e(0x499)](_0x2d2b1a),_0xd5054[_0x49114e(0x22e)](_0x49114e(0x30e),()=>selectSubtopic(_0x3a22e6['id'],_0x48ecb8['id'])),_0x5dc093['addEventListener'](_0x49114e(0x30e),_0x495246=>{const _0x542eef=_0x49114e;_0x495246[_0x542eef(0x3e5)]();const _0x27f9b3=_0x36b395[_0x542eef(0x300)]['contains'](_0x542eef(0x257));closeAllMenus(),_0x27f9b3?_0x473dcb[_0x542eef(0x300)][_0x542eef(0x21c)](_0x542eef(0x3bc)):(_0x36b395[_0x542eef(0x300)][_0x542eef(0x31c)](_0x542eef(0x257)),_0x473dcb[_0x542eef(0x300)][_0x542eef(0x31c)]('menu-active'));}),_0x2880c0[_0x49114e(0x22e)](_0x49114e(0x30e),()=>showInputModal(_0x49114e(0x1ab),async _0x366d1b=>{const _0x48dbc5=_0x49114e;if(!_0x366d1b)return;_0x48ecb8[_0x48dbc5(0x418)]=_0x366d1b,await storageManager['update'](_0x48dbc5(0x25e),_0x48ecb8),renderAll();},_0x48ecb8[_0x49114e(0x418)])),_0x3bf7a8['addEventListener'](_0x49114e(0x30e),()=>showConfirmModal(_0x49114e(0x351),_0x49114e(0x1cc)+_0x48ecb8[_0x49114e(0x418)]+'\x22?\x20Mọi\x20dữ\x20liệu\x20liên\x20quan\x20sẽ\x20bị\x20mất.',async _0x4f9ec3=>{const _0x48809d=_0x49114e;if(!_0x4f9ec3)return;_0x3a22e6[_0x48809d(0x25e)]=_0x3a22e6['subtopics'][_0x48809d(0x280)](_0xae853d=>_0xae853d['id']!==_0x48ecb8['id']);const _0x40732d=data[_0x48809d(0x3cc)];_0x40732d[_0x48809d(0x274)]===_0x48ecb8['id']&&(_0x40732d[_0x48809d(0x274)]='',_0x40732d[_0x48809d(0x1e5)]='',ensureValidSelection()),await storageManager[_0x48809d(0x439)](_0x48809d(0x25e),_0x48ecb8['id']),renderAll();}));}),_0x58562d[_0x45c606(0x22e)]('click',_0xd02293=>{const _0x577ede=_0x45c606;_0xd02293[_0x577ede(0x3e5)]();const _0x1d84e8=_0x57b636['classList'][_0x577ede(0x2de)](_0x577ede(0x257));closeAllMenus(),_0x1d84e8?_0x473dcb['classList'][_0x577ede(0x21c)](_0x577ede(0x3bc)):(_0x57b636[_0x577ede(0x300)][_0x577ede(0x31c)]('show'),_0x473dcb['classList'][_0x577ede(0x31c)](_0x577ede(0x3bc)));}),_0x34c309['addEventListener'](_0x45c606(0x30e),()=>showInputModal(_0x45c606(0x33d),async _0x5c0b40=>{const _0x3f1fe1=_0x45c606;if(!_0x5c0b40)return;const _0x1b3a40={'id':uid('s'),'topicId':_0x3a22e6['id'],'name':_0x5c0b40,'tasks':[],'generalNotes':[],'summaries':[],'chatHistory':[],'methods':[],'stats':{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},'sessions':[],'timerState':{'state':_0x3f1fe1(0x317),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0}};_0x3a22e6[_0x3f1fe1(0x25e)][_0x3f1fe1(0x369)](_0x1b3a40),await storageManager['add']('subtopics',_0x1b3a40),renderTopics();})),_0x15ac66[_0x45c606(0x22e)](_0x45c606(0x30e),()=>showInputModal(_0x45c606(0x435),async _0x516ee0=>{const _0x66e752=_0x45c606;if(!_0x516ee0)return;_0x3a22e6[_0x66e752(0x418)]=_0x516ee0,await storageManager[_0x66e752(0x1c9)]('topics',_0x3a22e6),renderTopics();},_0x3a22e6['name'])),_0x556c66[_0x45c606(0x22e)]('click',()=>showConfirmModal('Xác\x20nhận\x20xóa',_0x45c606(0x360)+_0x3a22e6['name']+'\x22?\x20Mọi\x20chủ\x20đề\x20con\x20và\x20dữ\x20liệu\x20liên\x20quan\x20sẽ\x20bị\x20mất.',async _0x5a8b68=>{const _0x4c768b=_0x45c606;if(!_0x5a8b68)return;data[_0x4c768b(0x268)]=data[_0x4c768b(0x268)][_0x4c768b(0x280)](_0x2ee939=>_0x2ee939['id']!==_0x3a22e6['id']),delete _0x4702f6[_0x3a22e6['id']];data[_0x4c768b(0x3cc)]['selectedTopicId']===_0x3a22e6['id']&&(data['settings'][_0x4c768b(0x1e5)]='',data[_0x4c768b(0x3cc)]['selectedSubtopicId']='',ensureValidSelection());await storageManager['delete']('topics',_0x3a22e6['id']);for(const _0x5bca27 of _0x3a22e6[_0x4c768b(0x25e)]){await storageManager[_0x4c768b(0x439)](_0x4c768b(0x25e),_0x5bca27['id']);}renderAll();})),_0x34c309[_0x45c606(0x22e)](_0x45c606(0x30e),_0x8e04ae=>_0x8e04ae[_0x45c606(0x3e5)]()),_0x15ac66[_0x45c606(0x22e)](_0x45c606(0x30e),_0x26522d=>_0x26522d[_0x45c606(0x3e5)]()),_0x556c66[_0x45c606(0x22e)](_0x45c606(0x30e),_0x6e42b5=>_0x6e42b5[_0x45c606(0x3e5)]()),_0x473dcb[_0x45c606(0x2bf)](_0x4fb634,_0x165b16),_0x53eac9[_0x45c606(0x499)](_0x473dcb);});if(window[_0x137148(0x3e4)]){const _0xe09afb=document[_0x137148(0x26a)](_0x137148(0x3da));if(_0xe09afb){if(_0xe09afb[_0x137148(0x40c)])try{_0xe09afb[_0x137148(0x40c)][_0x137148(0x19e)]();}catch(_0x5cbeb3){}_0xe09afb['_sortable']=new Sortable(_0xe09afb,{'animation':0x96,'draggable':_0x137148(0x24d),'onEnd':async function(_0x3179ea){const _0x1e1c74=_0x137148;if(_0x3179ea[_0x1e1c74(0x23a)]===_0x3179ea[_0x1e1c74(0x2fc)])return;const _0x3fc4e9=data['topics'][_0x1e1c74(0x490)](_0x3179ea[_0x1e1c74(0x23a)],0x1)[0x0];data[_0x1e1c74(0x268)][_0x1e1c74(0x490)](_0x3179ea['newIndex'],0x0,_0x3fc4e9),await saveData(),renderTopics();}}),_0xe09afb['querySelectorAll'](_0x137148(0x399))[_0x137148(0x467)](_0x349edf=>{const _0x455ae7=_0x137148;new Sortable(_0x349edf,{'group':'subtopics-group','animation':0x96,'draggable':_0x455ae7(0x1c8),'onEnd':async function(_0x497d83){const _0x9713ac=_0x455ae7,_0xb0a0a4=_0x497d83['from']?.[_0x9713ac(0x336)]?.['tid']||_0x497d83[_0x9713ac(0x43d)]?.[_0x9713ac(0x3f9)](_0x9713ac(0x24d))?.[_0x9713ac(0x336)]?.['tid'],_0x236337=_0x497d83['to']?.['dataset']?.[_0x9713ac(0x413)]||_0x497d83['to']?.[_0x9713ac(0x3f9)](_0x9713ac(0x24d))?.['dataset']?.[_0x9713ac(0x413)],_0x1bd8d7=data['topics'][_0x9713ac(0x347)](_0x3c2638=>_0x3c2638['id']===_0xb0a0a4),_0x327774=data[_0x9713ac(0x268)][_0x9713ac(0x347)](_0x3aecc1=>_0x3aecc1['id']===_0x236337);if(!_0x1bd8d7||!_0x327774)return;let _0x52c5a0=null;const _0x47533f=_0x497d83[_0x9713ac(0x3e9)]?.[_0x9713ac(0x336)]?.[_0x9713ac(0x2f4)]||_0x497d83['item']?.[_0x9713ac(0x35a)](_0x9713ac(0x38f))?.[_0x9713ac(0x336)]?.[_0x9713ac(0x2f4)];if(_0x47533f){const _0x448563=_0x1bd8d7[_0x9713ac(0x25e)]['findIndex'](_0x261278=>_0x261278['id']===_0x47533f);if(_0x448563>=0x0)_0x52c5a0=_0x1bd8d7[_0x9713ac(0x25e)][_0x9713ac(0x490)](_0x448563,0x1)[0x0];}!_0x52c5a0&&(_0x52c5a0=_0x1bd8d7[_0x9713ac(0x25e)][_0x9713ac(0x490)](_0x497d83['oldIndex'],0x1)[0x0]);if(!_0x52c5a0)return;_0x52c5a0[_0x9713ac(0x3af)]=_0x327774['id'],_0x327774['subtopics'][_0x9713ac(0x490)](_0x497d83['newIndex'],0x0,_0x52c5a0),data[_0x9713ac(0x3cc)][_0x9713ac(0x274)]===_0x52c5a0['id']&&(data['settings'][_0x9713ac(0x1e5)]=_0x327774['id']),await saveData(),renderTopics();}});});}}}function selectSubtopic(_0x44d9ea,_0x170ade){const _0x43e59b=_0x2d92ab,_0xa121c9=$('.app-content'),_0x47eb5c=getCurrentSubtopic();_0x47eb5c&&timer[_0x43e59b(0x18e)]!=='idle'&&(_0x47eb5c[_0x43e59b(0x27b)]={'state':timer[_0x43e59b(0x18e)],'prevState':timer[_0x43e59b(0x3f3)],'remaining':timer[_0x43e59b(0x219)],'segmentTotal':timer[_0x43e59b(0x1a8)],'cycleIndex':timer[_0x43e59b(0x1d8)]}),_0xa121c9[_0x43e59b(0x300)][_0x43e59b(0x31c)]('reloading'),setTimeout(async()=>{const _0x4da552=_0x43e59b;data[_0x4da552(0x3cc)][_0x4da552(0x1e5)]=_0x44d9ea,data[_0x4da552(0x3cc)][_0x4da552(0x274)]=_0x170ade;const _0x524df6=getCurrentSubtopic();_0x524df6[_0x4da552(0x27b)]?(timer[_0x4da552(0x18e)]=_0x524df6['timerState'][_0x4da552(0x18e)],timer[_0x4da552(0x3f3)]=_0x524df6['timerState'][_0x4da552(0x3f3)]||null,timer[_0x4da552(0x219)]=_0x524df6['timerState']['remaining'],timer[_0x4da552(0x1a8)]=_0x524df6[_0x4da552(0x27b)][_0x4da552(0x1a8)],timer[_0x4da552(0x1d8)]=_0x524df6[_0x4da552(0x27b)]['cycleIndex']):timer[_0x4da552(0x2cf)](),await saveData(),timer[_0x4da552(0x278)](),renderAll(),switchView(_0x4da552(0x2ec)),_0xa121c9[_0x4da552(0x300)][_0x4da552(0x21c)]('reloading');},0xc8);}function getCurrentSubtopic(){const _0x2a8560=_0x2d92ab,_0xfac480=data['settings'][_0x2a8560(0x1e5)],_0x3e7fcd=data[_0x2a8560(0x3cc)]['selectedSubtopicId'];if(!_0xfac480||!_0x3e7fcd)return null;const _0x3ba7ed=data[_0x2a8560(0x268)][_0x2a8560(0x347)](_0x42d048=>_0x42d048['id']===_0xfac480);if(!_0x3ba7ed)return null;return _0x3ba7ed[_0x2a8560(0x25e)][_0x2a8560(0x347)](_0x3ee48c=>_0x3ee48c['id']===_0x3e7fcd)||null;}function renderContextBadge(){const _0x324bf8=_0x2d92ab,_0x54923b=getCurrentSubtopic(),_0x1b9cd1=_0x54923b?_0x54923b[_0x324bf8(0x418)]:_0x324bf8(0x330),_0x52357a=$(_0x324bf8(0x475)),_0x478bfd=$('#currentSubtopicName'),_0x4213dc=$(_0x324bf8(0x391));if(_0x52357a)_0x52357a[_0x324bf8(0x3ef)]=_0x54923b?'Chủ\x20đề\x20con:\x20'+_0x54923b[_0x324bf8(0x418)]:_0x324bf8(0x3b9);if(_0x478bfd)_0x478bfd['textContent']=_0x1b9cd1;if(_0x4213dc)_0x4213dc[_0x324bf8(0x3ef)]=_0x1b9cd1;}function renderSubtopicTasks(){const _0x1e80be=_0x2d92ab,_0x1a9a5d=getCurrentSubtopic(),_0x36f62d=$(_0x1e80be(0x316)),_0x3b98d9=$(_0x1e80be(0x29e));if(!_0x36f62d||!_0x3b98d9)return;const _0x275e57=_0x3b98d9[_0x1e80be(0x250)];if(!_0x1a9a5d){_0x36f62d[_0x1e80be(0x200)]='<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Chọn\x20chủ\x20đề\x20con\x20để\x20xem\x20to-do\x20list.</li>',_0x275e57[_0x1e80be(0x300)][_0x1e80be(0x31c)](_0x1e80be(0x31d));return;}_0x275e57[_0x1e80be(0x300)][_0x1e80be(0x21c)](_0x1e80be(0x31d)),_0x36f62d[_0x1e80be(0x200)]='';const _0x1448ce=_0x1a9a5d[_0x1e80be(0x3c2)]?_0x1a9a5d['tasks'][_0x1e80be(0x280)](_0x4edb14=>!_0x4edb14[_0x1e80be(0x216)]):[];_0x1448ce[_0x1e80be(0x1ae)]===0x0&&(_0x36f62d[_0x1e80be(0x200)]=_0x1e80be(0x26e)),_0x1448ce[_0x1e80be(0x467)](_0x58161f=>{const _0xdac805=_0x1e80be,_0x47347e=document[_0xdac805(0x2e2)]('li');_0x47347e[_0xdac805(0x200)]='<input\x20type=\x22checkbox\x22\x20id=\x22'+_0x58161f['id']+_0xdac805(0x46c)+_0x58161f['id']+'\x22>'+escapeHTML(_0x58161f['text'])+_0xdac805(0x3aa),_0x47347e['querySelector'](_0xdac805(0x1bf))[_0xdac805(0x22e)]('change',_0xe09b5b=>toggleSubtopicTask(_0xe09b5b['target']['id'],_0x47347e)),_0x36f62d[_0xdac805(0x499)](_0x47347e);});}async function addSubtopicTask(){const _0x1c1b32=_0x2d92ab,_0x31e40f=getCurrentSubtopic();if(!_0x31e40f){toast(t('timer.selectSubtopicPrompt'));return;}const _0x5330e0=$(_0x1c1b32(0x29e)),_0xe8f701=_0x5330e0['value'][_0x1c1b32(0x265)]();if(_0xe8f701){if(!_0x31e40f[_0x1c1b32(0x3c2)])_0x31e40f[_0x1c1b32(0x3c2)]=[];_0x31e40f['tasks'][_0x1c1b32(0x369)]({'id':uid(_0x1c1b32(0x233)),'text':_0xe8f701,'isCompleted':![],'createdAt':todayISO()}),await saveData(),renderSubtopicTasks(),_0x5330e0['value']='';}_0x5330e0[_0x1c1b32(0x2af)]();}async function toggleSubtopicTask(_0x418443,_0x22dbff){const _0x220056=_0x2d92ab,_0x4915c7=getCurrentSubtopic();if(!_0x4915c7||!_0x4915c7['tasks'])return;const _0x5b88d3=_0x4915c7[_0x220056(0x3c2)][_0x220056(0x347)](_0x572010=>_0x572010['id']===_0x418443);_0x5b88d3&&(_0x5b88d3['isCompleted']=!![],_0x4915c7['stats'][_0x220056(0x180)]=(_0x4915c7['stats'][_0x220056(0x180)]||0x0)+0x1,await saveData(),_0x22dbff[_0x220056(0x300)]['add'](_0x220056(0x222)),setTimeout(()=>{renderSubtopicTasks(),renderStatsHistory();},0xc8));}const timer={'state':'idle','prevState':null,'tickHandle':null,'endAt':null,'remaining':0x0,'segmentTotal':0x0,'cyclesTarget':0x4,'cycleIndex':0x0,'mode':'A','persistInterval':0x3c*0x3e8,'lastPersist':0x0,async 'setPreset'(_0x5a71b8,{silent:silent=![]}={}){const _0x5f37b7=_0x2d92ab,_0x1a1edb=data[_0x5f37b7(0x3cc)];this[_0x5f37b7(0x442)]=_0x5a71b8,this['cyclesTarget']=_0x5a71b8==='A'?_0x1a1edb[_0x5f37b7(0x474)]:_0x5a71b8==='B'?_0x1a1edb[_0x5f37b7(0x2dd)]:0x0,_0x1a1edb[_0x5f37b7(0x1d0)]=_0x5a71b8,await saveData(),this['state']==='idle'&&this[_0x5f37b7(0x2cf)]();},'currentDurations'(){const _0x4711cc=_0x2d92ab,_0x2608f5=data[_0x4711cc(0x3cc)][_0x4711cc(0x1d7)];if(this[_0x4711cc(0x442)]==='A')return{'work':_0x2608f5[_0x4711cc(0x423)],'short':_0x2608f5['A_short'],'long':_0x2608f5[_0x4711cc(0x251)],'winddown':_0x2608f5[_0x4711cc(0x3c8)]??0x0};if(this[_0x4711cc(0x442)]==='B')return{'work':_0x2608f5[_0x4711cc(0x26f)],'short':_0x2608f5['B_short'],'long':_0x2608f5['B_long'],'winddown':_0x2608f5['B_winddown']??0x0};return{'work':0x0,'short':0x0,'long':0x0,'winddown':0x0};},'currentConfig'(){const _0x4e1169=_0x2d92ab,_0x58735a=data[_0x4e1169(0x3cc)];if(this[_0x4e1169(0x442)]==='A')return{'cycles':_0x58735a[_0x4e1169(0x474)],'interval':_0x58735a[_0x4e1169(0x310)]};if(this[_0x4e1169(0x442)]==='B')return{'cycles':_0x58735a[_0x4e1169(0x2dd)],'interval':_0x58735a[_0x4e1169(0x43b)]};return{'cycles':0x0,'interval':0x0};},'updateUI'(){const _0x3c07d6=_0x2d92ab,_0x3b9cfc=$(_0x3c07d6(0x39f)),_0x450268=$(_0x3c07d6(0x1f9)),_0x48105e=$(_0x3c07d6(0x417));if(!_0x3b9cfc||!_0x450268||!_0x48105e)return;const _0x4ffea3=this[_0x3c07d6(0x442)]==='C';$(_0x3c07d6(0x27f))[_0x3c07d6(0x300)][_0x3c07d6(0x38e)](_0x3c07d6(0x31d),this['state']!==_0x3c07d6(0x317)||_0x4ffea3&&this['state']===_0x3c07d6(0x36d)),$(_0x3c07d6(0x20d))[_0x3c07d6(0x300)][_0x3c07d6(0x38e)](_0x3c07d6(0x31d),!(_0x4ffea3&&this[_0x3c07d6(0x18e)]==='work')),$(_0x3c07d6(0x461))[_0x3c07d6(0x300)][_0x3c07d6(0x38e)](_0x3c07d6(0x31d),![_0x3c07d6(0x36d),_0x3c07d6(0x204),_0x3c07d6(0x49c)]['includes'](this[_0x3c07d6(0x18e)])),$(_0x3c07d6(0x373))[_0x3c07d6(0x300)][_0x3c07d6(0x38e)]('hidden',this['state']!==_0x3c07d6(0x433));let _0x3137be=_0x3c07d6(0x488);if(this[_0x3c07d6(0x18e)]===_0x3c07d6(0x36d))_0x3b9cfc[_0x3c07d6(0x3ef)]=_0x4ffea3?'LÀM\x20VIỆC\x20(FLOW)':_0x3c07d6(0x266),_0x3b9cfc[_0x3c07d6(0x45f)]=_0x3c07d6(0x432),_0x3137be='var(--acc)';else{if(this[_0x3c07d6(0x18e)]===_0x3c07d6(0x204))_0x3b9cfc[_0x3c07d6(0x3ef)]=_0x3c07d6(0x2a7),_0x3b9cfc['className']=_0x3c07d6(0x3c1),_0x3137be=_0x3c07d6(0x273);else{if(this['state']===_0x3c07d6(0x49c))_0x3b9cfc[_0x3c07d6(0x3ef)]=_0x3c07d6(0x22d),_0x3b9cfc[_0x3c07d6(0x45f)]=_0x3c07d6(0x244),_0x3137be='var(--danger)';else{if(this[_0x3c07d6(0x18e)]==='wind_down'){_0x3b9cfc['textContent']=_0x3c07d6(0x27d),_0x3b9cfc['className']=_0x3c07d6(0x432),_0x3137be='var(--acc-2)';try{$(_0x3c07d6(0x18a))[_0x3c07d6(0x300)][_0x3c07d6(0x21c)](_0x3c07d6(0x31d)),$('#btnBreakEarly')[_0x3c07d6(0x300)][_0x3c07d6(0x21c)]('hidden');}catch(_0x2c916e){}}else this['state']===_0x3c07d6(0x433)?(_0x3b9cfc[_0x3c07d6(0x3ef)]=_0x3c07d6(0x387),_0x3b9cfc[_0x3c07d6(0x45f)]=_0x3c07d6(0x47b)):(_0x3b9cfc[_0x3c07d6(0x3ef)]='SẴN\x20SÀNG',_0x3b9cfc['className']=_0x3c07d6(0x47b));}}}[_0x3c07d6(0x36d),_0x3c07d6(0x204),_0x3c07d6(0x49c),_0x3c07d6(0x283)][_0x3c07d6(0x3cb)](this[_0x3c07d6(0x18e)])?_0x48105e[_0x3c07d6(0x300)][_0x3c07d6(0x31c)](_0x3c07d6(0x1b1)):_0x48105e['classList']['remove'](_0x3c07d6(0x1b1));_0x450268[_0x3c07d6(0x34c)][_0x3c07d6(0x3dc)]=_0x3137be,_0x48105e[_0x3c07d6(0x300)][_0x3c07d6(0x21c)](_0x3c07d6(0x252));const _0x54c607=$(_0x3c07d6(0x44e));if(_0x54c607)_0x54c607[_0x3c07d6(0x3ef)]=formatMMSS(this[_0x3c07d6(0x219)]);const _0x3768af=_0x450268['r']['baseVal']['value'],_0x1178d1=0x2*Math['PI']*_0x3768af,_0x2da833=this[_0x3c07d6(0x1a8)]>0x0?_0x1178d1-this[_0x3c07d6(0x219)]/this[_0x3c07d6(0x1a8)]*_0x1178d1:_0x1178d1;_0x450268[_0x3c07d6(0x34c)][_0x3c07d6(0x201)]=_0x1178d1,_0x450268[_0x3c07d6(0x34c)]['strokeDashoffset']=isNaN(_0x2da833)?_0x1178d1:_0x2da833;const _0x2a56ad=$(_0x3c07d6(0x1e0));if(_0x2a56ad){const _0x2c3ea2=this[_0x3c07d6(0x28d)]();_0x2a56ad[_0x3c07d6(0x3ef)]=t(_0x3c07d6(0x32f),{'current':this['cycleIndex'],'target':_0x2c3ea2[_0x3c07d6(0x197)]}),_0x2a56ad[_0x3c07d6(0x300)][_0x3c07d6(0x38e)](_0x3c07d6(0x31d),_0x4ffea3);}const _0x4a5722=$('#breakSuggestionDisplay');_0x4a5722&&_0x4a5722[_0x3c07d6(0x300)][_0x3c07d6(0x38e)](_0x3c07d6(0x31d),_0x4ffea3&&this[_0x3c07d6(0x18e)]==='work');const _0x5f00f5=$(_0x3c07d6(0x1fd));if(_0x5f00f5)_0x5f00f5[_0x3c07d6(0x3ef)]=formatMMSS(this[_0x3c07d6(0x219)]);if(this['state']!=='wind_down')try{$('#windDownChecklist')[_0x3c07d6(0x300)][_0x3c07d6(0x31c)](_0x3c07d6(0x31d)),$(_0x3c07d6(0x25b))[_0x3c07d6(0x300)][_0x3c07d6(0x31c)](_0x3c07d6(0x31d));}catch(_0x4f5f51){}},'persistTimerState'(_0x376db9=![]){const _0x423aa1=_0x2d92ab;try{const _0x2b79be=getCurrentSubtopic();if(!_0x2b79be)return;const _0x181a0a={'state':this[_0x423aa1(0x18e)],'prevState':this[_0x423aa1(0x3f3)],'remaining':this[_0x423aa1(0x219)],'segmentTotal':this[_0x423aa1(0x1a8)],'cycleIndex':this[_0x423aa1(0x1d8)]};_0x2b79be[_0x423aa1(0x27b)]=_0x181a0a;try{localStorage['setItem'](_0x423aa1(0x31a)+_0x2b79be['id'],JSON[_0x423aa1(0x49b)](_0x181a0a));}catch(_0x188358){}this['lastPersist']=Date['now']();}catch(_0xad2af2){}},'_startTick'(){const _0x3e400c=_0x2d92ab;if(this['tickHandle'])clearInterval(this[_0x3e400c(0x41c)]);if(this[_0x3e400c(0x442)]==='C'&&this[_0x3e400c(0x18e)]===_0x3e400c(0x36d)){this[_0x3e400c(0x41c)]=setInterval(()=>{const _0x362e04=_0x3e400c;this['remaining']+=0x1,this[_0x362e04(0x278)](),this[_0x362e04(0x2d1)]();},0x3e8);return;}this[_0x3e400c(0x41c)]=setInterval(()=>{const _0x2f00b1=_0x3e400c;this[_0x2f00b1(0x219)]>0x0&&(this[_0x2f00b1(0x219)]-=0x1,this[_0x2f00b1(0x278)](),this[_0x2f00b1(0x2d1)]()),this[_0x2f00b1(0x219)]<=0x0&&(clearInterval(this['tickHandle']),this[_0x2f00b1(0x41c)]=null,this['_onFinishSegment']());},0x3e8);},'_onFinishSegment'(){const _0x39cf5f=_0x2d92ab;if(this[_0x39cf5f(0x18e)]===_0x39cf5f(0x36d)){const _0x4ef354=getCurrentSubtopic();if(_0x4ef354){const _0x1d393f=this[_0x39cf5f(0x303)]()[_0x39cf5f(0x36d)];_0x4ef354['stats'][_0x39cf5f(0x444)]=(_0x4ef354[_0x39cf5f(0x1b8)]['totalMinutes']||0x0)+_0x1d393f,_0x4ef354[_0x39cf5f(0x1b8)][_0x39cf5f(0x337)]=(_0x4ef354[_0x39cf5f(0x1b8)][_0x39cf5f(0x337)]||0x0)+0x1;const _0x99421c={'id':uid(_0x39cf5f(0x47a)),'dateISO':todayISO(),'durationMinutes':_0x1d393f,'mode':this['mode'],'note':''};if(!_0x4ef354[_0x39cf5f(0x479)])_0x4ef354[_0x39cf5f(0x479)]=[];_0x4ef354[_0x39cf5f(0x479)][_0x39cf5f(0x2eb)](_0x99421c);if(data?.[_0x39cf5f(0x3cc)]?.[_0x39cf5f(0x489)]!==![])try{openNoteModal(_0x99421c['id']);}catch(_0x51b108){}saveData(),renderStatsHistory(),checkAndShowMilestones();}this[_0x39cf5f(0x1d8)]++;}if(typeof data!==_0x39cf5f(0x493)&&data&&data['settings']&&data['settings'][_0x39cf5f(0x36a)]===![]&&this['state']==='work')playSound(_0x39cf5f(0x246));else(this[_0x39cf5f(0x18e)]==='wind_down'||this[_0x39cf5f(0x18e)]===_0x39cf5f(0x204)||this[_0x39cf5f(0x18e)]===_0x39cf5f(0x49c))&&playSound(_0x39cf5f(0x48b));const _0x415817=$(_0x39cf5f(0x417));if(_0x415817)_0x415817[_0x39cf5f(0x300)][_0x39cf5f(0x31c)](_0x39cf5f(0x252));if(data[_0x39cf5f(0x3cc)]['autoStartNext']){if(this[_0x39cf5f(0x18e)]===_0x39cf5f(0x36d))data[_0x39cf5f(0x3cc)][_0x39cf5f(0x36a)]===![]?this[_0x39cf5f(0x2da)]():this[_0x39cf5f(0x256)]();else this[_0x39cf5f(0x18e)]===_0x39cf5f(0x283)?this[_0x39cf5f(0x2da)]():this[_0x39cf5f(0x1db)]();}else this[_0x39cf5f(0x41c)]&&(clearInterval(this['tickHandle']),this[_0x39cf5f(0x41c)]=null),this[_0x39cf5f(0x18e)]=_0x39cf5f(0x317),this[_0x39cf5f(0x3f3)]=null,this[_0x39cf5f(0x278)](),toast(_0x39cf5f(0x221));},'beginWindDown'(){const _0x56565d=_0x2d92ab;if(data?.[_0x56565d(0x3cc)]?.['enableWinddown']===![]){this[_0x56565d(0x2da)]();return;}this[_0x56565d(0x3f3)]=this['state'],this[_0x56565d(0x18e)]=_0x56565d(0x283);const _0x20a119=(this[_0x56565d(0x303)]()['winddown']||0x0)*0x3c;if(_0x20a119<=0x0){this[_0x56565d(0x2da)]();return;}this[_0x56565d(0x1a8)]=_0x20a119,this[_0x56565d(0x219)]=_0x20a119;try{playSound(_0x56565d(0x48b));}catch(_0x25f0ac){}try{toast('Đến\x20giờ\x20hạ\x20nhiệt.\x20Hãy\x20kết\x20thúc\x20công\x20việc\x20và\x20chuẩn\x20bị\x20nghỉ\x20ngơi.');}catch(_0xed5d5e){}this[_0x56565d(0x2fa)](),this[_0x56565d(0x278)]();},'beginWork'(){const _0x16408a=_0x2d92ab;this[_0x16408a(0x3f3)]=this[_0x16408a(0x18e)],this[_0x16408a(0x18e)]=_0x16408a(0x36d);if(this['mode']==='C'){this['segmentTotal']=0x0;if(this[_0x16408a(0x3f3)]!==_0x16408a(0x433))this[_0x16408a(0x219)]=0x0;}else{const _0x2ed63d=this[_0x16408a(0x303)]()[_0x16408a(0x36d)]*0x3c;this[_0x16408a(0x1a8)]=_0x2ed63d;if(this[_0x16408a(0x3f3)]!=='paused')this['remaining']=_0x2ed63d;}const _0x45dca3=$(_0x16408a(0x3cd));_0x45dca3&&(_0x45dca3[_0x16408a(0x3ef)]=''),this[_0x16408a(0x2fa)](),this[_0x16408a(0x278)]();},'finishFlowSession'(){const _0x4c59a3=_0x2d92ab;if(this[_0x4c59a3(0x442)]!=='C'||this[_0x4c59a3(0x18e)]!==_0x4c59a3(0x36d))return;this[_0x4c59a3(0x41c)]&&(clearInterval(this['tickHandle']),this[_0x4c59a3(0x41c)]=null);const _0x1d01c4=Math[_0x4c59a3(0x248)](0x1,parseInt(data[_0x4c59a3(0x3cc)][_0x4c59a3(0x37e)]??0x5,0xa)),_0x57e28f=Math[_0x4c59a3(0x248)](0x0,this[_0x4c59a3(0x219)]|0x0),_0x36acd8=Math[_0x4c59a3(0x248)](0x3c,Math[_0x4c59a3(0x25c)](_0x57e28f/_0x1d01c4));try{const _0x51164d=getCurrentSubtopic();if(_0x51164d){const _0x5c697c=Math[_0x4c59a3(0x248)](0x1,Math[_0x4c59a3(0x410)](_0x57e28f/0x3c));_0x51164d[_0x4c59a3(0x1b8)][_0x4c59a3(0x444)]=(_0x51164d[_0x4c59a3(0x1b8)][_0x4c59a3(0x444)]||0x0)+_0x5c697c,_0x51164d[_0x4c59a3(0x1b8)]['sessionsCompleted']=(_0x51164d['stats'][_0x4c59a3(0x337)]||0x0)+0x1;const _0x3463c7={'id':uid(_0x4c59a3(0x47a)),'dateISO':todayISO(),'durationMinutes':_0x5c697c,'mode':this['mode'],'note':''};if(!_0x51164d[_0x4c59a3(0x479)])_0x51164d['sessions']=[];_0x51164d['sessions'][_0x4c59a3(0x2eb)](_0x3463c7),saveData(),renderStatsHistory(),data?.[_0x4c59a3(0x3cc)]?.[_0x4c59a3(0x489)]!==![]&&openNoteModal(_0x3463c7['id']);}}catch(_0x48bb6e){}this[_0x4c59a3(0x18e)]=_0x4c59a3(0x204),this['segmentTotal']=_0x36acd8,this[_0x4c59a3(0x219)]=_0x36acd8,this['_startTick'](),this[_0x4c59a3(0x278)](),this['persistTimerState'](!![]);try{toast('Nghỉ\x20'+Math[_0x4c59a3(0x410)](_0x36acd8/0x3c)+_0x4c59a3(0x3bf)+_0x1d01c4+').');}catch(_0x41dbfd){}},'beginBreak'(){const _0x9b9f7b=_0x2d92ab;this[_0x9b9f7b(0x3f3)]=this[_0x9b9f7b(0x18e)];const _0x466f3e=this['currentConfig'](),_0x2a82b3=this[_0x9b9f7b(0x303)]();if(this[_0x9b9f7b(0x1d8)]>0x0&&this['cycleIndex']%_0x466f3e[_0x9b9f7b(0x312)]===0x0){this[_0x9b9f7b(0x18e)]=_0x9b9f7b(0x49c);const _0x5edc78=_0x2a82b3['long']*0x3c;this[_0x9b9f7b(0x1a8)]=_0x5edc78;if(this[_0x9b9f7b(0x3f3)]!=='paused')this['remaining']=_0x5edc78;toast('Tuyệt\x20vời!\x20Đã\x20đến\x20lúc\x20nghỉ\x20dài.');}else{this[_0x9b9f7b(0x18e)]=_0x9b9f7b(0x204);const _0x372026=_0x2a82b3['short']*0x3c;this['segmentTotal']=_0x372026;if(this[_0x9b9f7b(0x3f3)]!==_0x9b9f7b(0x433))this['remaining']=_0x372026;}const _0x475c64=$(_0x9b9f7b(0x3cd));if(_0x475c64){const _0x3eabcf=Math[_0x9b9f7b(0x25c)](Math[_0x9b9f7b(0x3cf)]()*breakSuggestions[_0x9b9f7b(0x1ae)]);_0x475c64[_0x9b9f7b(0x3ef)]=_0x9b9f7b(0x45c)+breakSuggestions[_0x3eabcf];}this[_0x9b9f7b(0x2fa)](),this[_0x9b9f7b(0x278)]();},async 'start'(){const _0x54493a=_0x2d92ab;if(!getCurrentSubtopic()){toast('Hãy\x20chọn\x20một\x20Chủ\x20đề\x20con\x20trước\x20khi\x20bắt\x20đầu');return;}ensureAudio();if(this['mode']==='C'&&this['state']===_0x54493a(0x317))this[_0x54493a(0x18e)]=_0x54493a(0x36d),this['remaining']=0x0,this[_0x54493a(0x1a8)]=0x0,this[_0x54493a(0x1d8)]=0x0,this[_0x54493a(0x2fa)](),this[_0x54493a(0x278)]();else{if(this[_0x54493a(0x18e)]===_0x54493a(0x317))this[_0x54493a(0x1d8)]=this['cycleIndex']||0x0,this[_0x54493a(0x1db)]();else this['state']===_0x54493a(0x433)&&this[_0x54493a(0x20c)]();}await this[_0x54493a(0x2d1)](!![]);},async 'pause'(){const _0x24c618=_0x2d92ab;this['tickHandle']&&(clearInterval(this[_0x24c618(0x41c)]),this[_0x24c618(0x41c)]=null),this[_0x24c618(0x3f3)]=this[_0x24c618(0x18e)],this[_0x24c618(0x18e)]='paused',this[_0x24c618(0x278)](),await this[_0x24c618(0x2d1)](!![]);},async 'resume'(){const _0x225cc9=_0x2d92ab;if(this[_0x225cc9(0x18e)]!==_0x225cc9(0x433))return;this[_0x225cc9(0x18e)]=this[_0x225cc9(0x3f3)]||_0x225cc9(0x36d),this['_startTick'](),this[_0x225cc9(0x278)](),await this['persistTimerState'](!![]);},async 'skip'(){const _0x52036c=_0x2d92ab;if(this[_0x52036c(0x442)]==='C'&&this['state']==='work'){this[_0x52036c(0x1d9)](),await this[_0x52036c(0x2d1)](!![]);return;}this[_0x52036c(0x18e)]==='work'?(this['tickHandle']&&(clearInterval(this[_0x52036c(0x41c)]),this['tickHandle']=null),this[_0x52036c(0x219)]=0x0,this[_0x52036c(0x3db)]()):(this['remaining']=0x0,this[_0x52036c(0x41c)]&&(clearInterval(this[_0x52036c(0x41c)]),this['tickHandle']=null),this[_0x52036c(0x3db)]()),await this['persistTimerState'](!![]);},async 'reset'(){const _0x39ac53=_0x2d92ab;this[_0x39ac53(0x41c)]&&(clearInterval(this[_0x39ac53(0x41c)]),this[_0x39ac53(0x41c)]=null);this['state']=_0x39ac53(0x317),this[_0x39ac53(0x3f3)]=null,this['remaining']=0x0,this[_0x39ac53(0x1a8)]=0x0,this[_0x39ac53(0x1d8)]=0x0;const _0x5c9e51=$(_0x39ac53(0x3cd));_0x5c9e51&&(_0x5c9e51[_0x39ac53(0x3ef)]=''),this[_0x39ac53(0x278)](),await this[_0x39ac53(0x2d1)](!![]);}};async function deleteSummary(_0x3cf74c){const _0x438c20=_0x2d92ab;showConfirmModal(_0x438c20(0x351),_0x438c20(0x2bb),async _0x5ee899=>{const _0x3a2689=_0x438c20;if(!_0x5ee899)return;const _0x170a74=getCurrentSubtopic();if(!_0x170a74||!_0x170a74[_0x3a2689(0x19a)])return;const _0x2a62e1=[..._0x170a74[_0x3a2689(0x19a)]];_0x170a74[_0x3a2689(0x19a)]=_0x170a74[_0x3a2689(0x19a)][_0x3a2689(0x280)](_0xb3ffe=>_0xb3ffe['id']!==_0x3cf74c);try{await storageManager['update']('subtopics',_0x170a74),renderSummaries(),toast('Đã\x20xóa\x20tóm\x20tắt.');}catch(_0x77dfd1){console[_0x3a2689(0x29a)]('Failed\x20to\x20delete\x20summary:',_0x77dfd1),_0x170a74[_0x3a2689(0x19a)]=_0x2a62e1,toast(_0x3a2689(0x476));}});}function exportSummary(_0x55f95b){const _0xd6ddc9=_0x2d92ab,_0x4cf595=new Blob([_0x55f95b[_0xd6ddc9(0x304)]],{'type':_0xd6ddc9(0x209)}),_0x34aadb=document[_0xd6ddc9(0x2e2)]('a'),_0x279e8d=new Date(_0x55f95b[_0xd6ddc9(0x3ae)]),_0x26cb9e=_0x13415a=>(''+_0x13415a)[_0xd6ddc9(0x320)](0x2,'0');_0x34aadb[_0xd6ddc9(0x19c)]=URL[_0xd6ddc9(0x334)](_0x4cf595),_0x34aadb[_0xd6ddc9(0x296)]='summary_'+_0x279e8d[_0xd6ddc9(0x264)]()+_0x26cb9e(_0x279e8d[_0xd6ddc9(0x1d4)]()+0x1)+_0x26cb9e(_0x279e8d[_0xd6ddc9(0x3d2)]())+'.txt',_0x34aadb[_0xd6ddc9(0x30e)](),URL[_0xd6ddc9(0x465)](_0x34aadb[_0xd6ddc9(0x19c)]);}function renderStatsHistory(){const _0x6c29c2=_0x2d92ab,_0x5c4ccf=getCurrentSubtopic(),_0x4c885d=$(_0x6c29c2(0x2bd)),_0xeb9a1=$(_0x6c29c2(0x41a)),_0x879cd4=$(_0x6c29c2(0x469)),_0x5a496d=$(_0x6c29c2(0x18c));if(!_0x4c885d||!_0xeb9a1||!_0x879cd4||!_0x5a496d)return;if(!_0x5c4ccf){_0x4c885d[_0x6c29c2(0x3ef)]='0\x20phút',_0xeb9a1['textContent']='0',_0x879cd4[_0x6c29c2(0x3ef)]='0',_0x5a496d[_0x6c29c2(0x200)]=_0x6c29c2(0x243);return;}const _0x29dc29=_0x5c4ccf[_0x6c29c2(0x1b8)]&&_0x5c4ccf[_0x6c29c2(0x1b8)][_0x6c29c2(0x444)]?_0x5c4ccf['stats'][_0x6c29c2(0x444)]:0x0,_0x18a1a6=_0x5c4ccf[_0x6c29c2(0x1b8)]&&_0x5c4ccf[_0x6c29c2(0x1b8)][_0x6c29c2(0x337)]?_0x5c4ccf['stats'][_0x6c29c2(0x337)]:0x0,_0x56a9d7=_0x5c4ccf[_0x6c29c2(0x3c2)]?_0x5c4ccf['tasks'][_0x6c29c2(0x280)](_0x2dec6e=>_0x2dec6e[_0x6c29c2(0x216)])['length']:0x0;_0x4c885d[_0x6c29c2(0x3ef)]=formatDaysHoursMinutes(_0x29dc29),_0xeb9a1['textContent']=String(_0x18a1a6),_0x879cd4[_0x6c29c2(0x3ef)]=String(_0x56a9d7),_0x5a496d[_0x6c29c2(0x200)]='';const _0x1eac92=Array[_0x6c29c2(0x1ac)](_0x5c4ccf[_0x6c29c2(0x479)])?_0x5c4ccf[_0x6c29c2(0x479)]:[];if(_0x1eac92[_0x6c29c2(0x1ae)]===0x0){_0x5a496d[_0x6c29c2(0x200)]=_0x6c29c2(0x2f3);return;}_0x1eac92[_0x6c29c2(0x467)](_0x5597b6=>{const _0x19fb5a=_0x6c29c2,_0x4b1d01=document[_0x19fb5a(0x2e2)](_0x19fb5a(0x206));_0x4b1d01[_0x19fb5a(0x45f)]=_0x19fb5a(0x468);const _0x2280ae=document[_0x19fb5a(0x2e2)](_0x19fb5a(0x206)),_0x1ca507=_0x5597b6['dateISO']?new Date(_0x5597b6['dateISO']):new Date(),_0x382776=_0x5597b6[_0x19fb5a(0x22c)]!=null?_0x5597b6[_0x19fb5a(0x22c)]:_0x5597b6[_0x19fb5a(0x3d3)]||0x0,_0x3b1cd8='<div\x20class=\x22hist-meta\x22>'+_0x1ca507[_0x19fb5a(0x421)]()+'\x20·\x20'+_0x382776+'\x27\x20·\x20Mode\x20'+(_0x5597b6[_0x19fb5a(0x442)]||'')+_0x19fb5a(0x2ed);let _0x19e09c='';if(_0x5597b6['note'])_0x19e09c=_0x19fb5a(0x326)+escapeHTML(_0x5597b6[_0x19fb5a(0x495)])+_0x19fb5a(0x2ed);else data?.['settings']?.[_0x19fb5a(0x489)]!==![]&&(_0x19e09c=_0x19fb5a(0x2b0));_0x2280ae[_0x19fb5a(0x200)]=_0x3b1cd8+_0x19e09c,_0x4b1d01[_0x19fb5a(0x499)](_0x2280ae),_0x5a496d[_0x19fb5a(0x499)](_0x4b1d01);});}function renderGeneralNotes(){const _0x4c0431=_0x2d92ab,_0x2788c5=$(_0x4c0431(0x3b4));if(!_0x2788c5)return;const _0x36e970=getCurrentSubtopic();if(!_0x36e970){_0x2788c5[_0x4c0431(0x200)]=_0x4c0431(0x189);return;}_0x36e970[_0x4c0431(0x48e)]=_0x36e970['generalNotes']||[];if(_0x36e970['generalNotes'][_0x4c0431(0x1ae)]===0x0){_0x2788c5[_0x4c0431(0x200)]=_0x4c0431(0x315);return;}_0x2788c5[_0x4c0431(0x200)]='',_0x36e970['generalNotes'][_0x4c0431(0x467)](_0xa41a02=>{const _0x3c8b65=_0x4c0431,_0x239a2e=document['createElement']('div');_0x239a2e[_0x3c8b65(0x45f)]=_0x3c8b65(0x471);const _0x51c49a=document[_0x3c8b65(0x2e2)](_0x3c8b65(0x206));_0x51c49a['className']=_0x3c8b65(0x46a),_0x51c49a[_0x3c8b65(0x3ef)]=typeof _0xa41a02===_0x3c8b65(0x2ba)?_0xa41a02:_0xa41a02[_0x3c8b65(0x3d1)]||'';const _0x1e0eff=document['createElement'](_0x3c8b65(0x206));_0x1e0eff['className']=_0x3c8b65(0x1e1),_0x1e0eff[_0x3c8b65(0x3ef)]=_0xa41a02[_0x3c8b65(0x3ae)]?new Date(_0xa41a02[_0x3c8b65(0x3ae)])[_0x3c8b65(0x421)]():'';const _0x196be2=document['createElement'](_0x3c8b65(0x206)),_0x69accf=document[_0x3c8b65(0x2e2)]('button');_0x69accf['className']='btn\x20small\x20danger',_0x69accf[_0x3c8b65(0x3ef)]=_0x3c8b65(0x46d),_0x69accf['onclick']=async _0xa9404d=>{const _0xafa085=_0x3c8b65;_0xa9404d[_0xafa085(0x3e5)]();const _0x9f9673=getCurrentSubtopic();if(!_0x9f9673)return;_0x9f9673[_0xafa085(0x48e)]=(_0x9f9673[_0xafa085(0x48e)]||[])[_0xafa085(0x280)](_0x3a2a43=>(_0x3a2a43['id']||_0x3a2a43)!==(_0xa41a02['id']||_0xa41a02)),await saveData(),renderGeneralNotes();},_0x196be2[_0x3c8b65(0x499)](_0x69accf);const _0x1694e3=document[_0x3c8b65(0x2e2)](_0x3c8b65(0x206));_0x1694e3['className']='note-content-wrapper',_0x1694e3['append'](_0x51c49a,_0x1e0eff),_0x239a2e[_0x3c8b65(0x2bf)](_0x1694e3,_0x196be2),_0x2788c5[_0x3c8b65(0x499)](_0x239a2e);});}function renderMethods(){const _0x421989=_0x2d92ab,_0x534000=document[_0x421989(0x35a)]('#view-methods\x20.methods-container');if(!_0x534000)return;_0x534000[_0x421989(0x200)]='';const _0x2c9e6b=getCurrentSubtopic();if(!_0x2c9e6b){_0x534000[_0x421989(0x200)]=_0x421989(0x298);return;}const _0x1e2bd0=Array['isArray'](_0x2c9e6b[_0x421989(0x2ef)])?_0x2c9e6b[_0x421989(0x2ef)]:[];if(_0x1e2bd0[_0x421989(0x1ae)]===0x0){_0x534000[_0x421989(0x200)]=_0x421989(0x1ad);return;}_0x1e2bd0[_0x421989(0x467)](_0x268d33=>{const _0x55a0a6=_0x421989,_0x3e801c=document['createElement'](_0x55a0a6(0x401));_0x3e801c[_0x55a0a6(0x45f)]=_0x55a0a6(0x318),_0x3e801c['dataset'][_0x55a0a6(0x48c)]=_0x268d33['id'];const _0x28f2bf=document[_0x55a0a6(0x2e2)](_0x55a0a6(0x2ab)),_0x2492d6=document[_0x55a0a6(0x2e2)](_0x55a0a6(0x20e));_0x2492d6['className']=_0x55a0a6(0x21d),_0x2492d6[_0x55a0a6(0x3ef)]=_0x268d33['title']||_0x55a0a6(0x352),_0x2492d6[_0x55a0a6(0x22e)](_0x55a0a6(0x30e),_0x59036c=>{const _0x2001bb=_0x55a0a6;_0x59036c['preventDefault'](),_0x59036c[_0x2001bb(0x3e5)](),_0x3e801c['open']=!_0x3e801c['open'];});const _0x1046d3=document['createElement'](_0x55a0a6(0x206));_0x1046d3[_0x55a0a6(0x45f)]=_0x55a0a6(0x258);const _0x1435a0=document[_0x55a0a6(0x2e2)](_0x55a0a6(0x34f));_0x1435a0[_0x55a0a6(0x45f)]=_0x55a0a6(0x1a2),_0x1435a0[_0x55a0a6(0x3ef)]=_0x55a0a6(0x483),_0x1435a0[_0x55a0a6(0x336)]['id']=_0x268d33['id'];const _0x1e2b6c=document[_0x55a0a6(0x2e2)]('button');_0x1e2b6c[_0x55a0a6(0x45f)]='btn\x20small\x20danger\x20method-delete',_0x1e2b6c[_0x55a0a6(0x3ef)]=_0x55a0a6(0x46d),_0x1e2b6c['dataset']['id']=_0x268d33['id'],_0x1046d3[_0x55a0a6(0x2bf)](_0x1435a0,_0x1e2b6c),_0x28f2bf[_0x55a0a6(0x2bf)](_0x2492d6,_0x1046d3);const _0x96af7f=document[_0x55a0a6(0x2e2)](_0x55a0a6(0x206));_0x96af7f[_0x55a0a6(0x45f)]=_0x55a0a6(0x42c),_0x96af7f[_0x55a0a6(0x200)]=_0x268d33['content']||'',_0x3e801c[_0x55a0a6(0x2bf)](_0x28f2bf,_0x96af7f),_0x534000[_0x55a0a6(0x499)](_0x3e801c),_0x3e801c['addEventListener'](_0x55a0a6(0x30e),_0x54f6fb=>{const _0x1d534a=_0x55a0a6,_0x2fe2b4=_0x54f6fb[_0x1d534a(0x26b)];if(!_0x2fe2b4)return;if(_0x2fe2b4[_0x1d534a(0x3f9)](_0x1d534a(0x34f))||_0x2fe2b4['closest']('a')||_0x2fe2b4['closest'](_0x1d534a(0x2c4))||_0x2fe2b4[_0x1d534a(0x3f9)](_0x1d534a(0x323)))return;if(!_0x3e801c[_0x1d534a(0x23d)])_0x3e801c[_0x1d534a(0x23d)]=!![];});});const _0x1cf3bf=_0x534000[_0x421989(0x260)](_0x421989(0x230));_0x1cf3bf[_0x421989(0x467)](_0x25810f=>{const _0x3843d5=_0x421989;_0x25810f[_0x3843d5(0x22e)]('toggle',()=>{const _0x2247a0=_0x3843d5;_0x25810f[_0x2247a0(0x23d)]&&_0x1cf3bf[_0x2247a0(0x467)](_0x31edb4=>{const _0x559093=_0x2247a0;if(_0x31edb4!==_0x25810f)_0x31edb4[_0x559093(0x23d)]=![];});});});}function addGeneralNote(){showInputModal('Thêm\x20ghi\x20chú',async _0x9512ac=>{const _0x28db24=_0x50e5;if(!_0x9512ac)return;const _0x1f13e2=getCurrentSubtopic();if(!_0x1f13e2){toast(_0x28db24(0x363));return;}_0x1f13e2[_0x28db24(0x48e)]=_0x1f13e2['generalNotes']||[],_0x1f13e2[_0x28db24(0x48e)][_0x28db24(0x2eb)]({'id':uid('gn'),'text':_0x9512ac,'createdAt':todayISO()}),await saveData(),renderGeneralNotes();},'');}async function summarizeNotes(){const _0x18106b=_0x2d92ab,_0x25b249=getCurrentSubtopic();if(!_0x25b249){toast(_0x18106b(0x1c0));return;}const _0x5cf08c=(_0x25b249[_0x18106b(0x48e)]||[])[_0x18106b(0x394)](_0x571d4d=>typeof _0x571d4d===_0x18106b(0x2ba)?_0x571d4d:_0x571d4d['text']||'')[_0x18106b(0x280)](Boolean);if(_0x5cf08c[_0x18106b(0x1ae)]===0x0){toast(_0x18106b(0x20b));return;}const _0x1b6911=$(_0x18106b(0x36f));_0x1b6911&&(_0x1b6911[_0x18106b(0x3f0)]=!![],_0x1b6911['innerHTML']=_0x18106b(0x27a));try{const _0x2c5446=_0x18106b(0x1c3)+_0x5cf08c[_0x18106b(0x400)]('\x0a-\x20'),_0x1424f6=await callGeminiAPI(_0x2c5446);if(!_0x25b249['summaries'])_0x25b249[_0x18106b(0x19a)]=[];_0x25b249[_0x18106b(0x19a)][_0x18106b(0x2eb)]({'id':uid(_0x18106b(0x2c7)),'content':_0x1424f6||_0x18106b(0x3c3),'createdAt':todayISO()}),await saveData(),renderSummaries();}catch(_0x27bc4c){console['error'](_0x27bc4c),toast(_0x18106b(0x2fb));}finally{_0x1b6911&&(_0x1b6911[_0x18106b(0x3f0)]=![],_0x1b6911['textContent']='Tóm\x20tắt');}}function renderSummaries(){const _0x4d3077=_0x2d92ab,_0x1226c6=$(_0x4d3077(0x35c));if(!_0x1226c6)return;const _0x28946f=getCurrentSubtopic();if(!_0x28946f){_0x1226c6['innerHTML']=_0x4d3077(0x415);return;}_0x1226c6[_0x4d3077(0x200)]='';if(!_0x28946f[_0x4d3077(0x19a)]||_0x28946f[_0x4d3077(0x19a)]['length']===0x0){_0x1226c6[_0x4d3077(0x200)]=_0x4d3077(0x3b8);return;}_0x28946f['summaries'][_0x4d3077(0x467)](_0x56a5ca=>{const _0x3762b1=_0x4d3077,_0x34587b=document[_0x3762b1(0x2e2)]('div');_0x34587b[_0x3762b1(0x45f)]=_0x3762b1(0x471);const _0x1bbc72=document[_0x3762b1(0x2e2)](_0x3762b1(0x206));_0x1bbc72[_0x3762b1(0x45f)]=_0x3762b1(0x1a0);const _0x1b1959=document[_0x3762b1(0x2e2)](_0x3762b1(0x206));_0x1b1959['className']=_0x3762b1(0x46a),_0x1b1959[_0x3762b1(0x3ef)]=_0x56a5ca['content'];const _0x30f539=document['createElement'](_0x3762b1(0x206));_0x30f539[_0x3762b1(0x45f)]='note-meta',_0x30f539[_0x3762b1(0x3ef)]=new Date(_0x56a5ca[_0x3762b1(0x3ae)])[_0x3762b1(0x421)](),_0x1bbc72['append'](_0x1b1959,_0x30f539);const _0x1386a0=document[_0x3762b1(0x2e2)](_0x3762b1(0x206)),_0x297e29=document['createElement'](_0x3762b1(0x34f));_0x297e29['className']=_0x3762b1(0x411),_0x297e29[_0x3762b1(0x3ef)]=_0x3762b1(0x1d2),_0x297e29[_0x3762b1(0x1be)]=_0x1a2084=>{const _0x172c4c=_0x3762b1;_0x1a2084[_0x172c4c(0x3e5)](),exportSummary(_0x56a5ca);};const _0x4faea8=document[_0x3762b1(0x2e2)](_0x3762b1(0x34f));_0x4faea8[_0x3762b1(0x45f)]=_0x3762b1(0x362),_0x4faea8['textContent']=_0x3762b1(0x46d),_0x4faea8[_0x3762b1(0x1be)]=_0x2f8c31=>{const _0x5e5771=_0x3762b1;_0x2f8c31[_0x5e5771(0x3e5)](),deleteSummary(_0x56a5ca['id']);},_0x1386a0['append'](_0x297e29,_0x4faea8),_0x34587b[_0x3762b1(0x2bf)](_0x1bbc72,_0x1386a0),_0x34587b['addEventListener']('click',()=>_0x1b1959['classList'][_0x3762b1(0x38e)]('expanded')),_0x1226c6[_0x3762b1(0x499)](_0x34587b);});}function loadEditingPresetFields(){const _0xe26f03=_0x2d92ab,_0x3b4587=data['settings'],_0x4205fe=_0x3b4587[_0xe26f03(0x1d7)],_0x5f721a=$(_0xe26f03(0x28c)),_0x1946c9=$(_0xe26f03(0x19d));if(_0x5f721a&&_0x1946c9){const _0x49f1cb=editingPreset==='C';_0x5f721a['classList'][_0xe26f03(0x38e)](_0xe26f03(0x31d),_0x49f1cb),_0x1946c9[_0xe26f03(0x300)][_0xe26f03(0x38e)](_0xe26f03(0x31d),!_0x49f1cb);}if(editingPreset==='A'){$(_0xe26f03(0x1c6))[_0xe26f03(0x1bb)]=_0x4205fe[_0xe26f03(0x423)];if($(_0xe26f03(0x3e0)))$(_0xe26f03(0x3e0))[_0xe26f03(0x1bb)]=_0x4205fe[_0xe26f03(0x3c8)]??0x0;$(_0xe26f03(0x386))[_0xe26f03(0x1bb)]=_0x4205fe[_0xe26f03(0x19f)],$(_0xe26f03(0x402))[_0xe26f03(0x1bb)]=_0x4205fe['A_long'],$(_0xe26f03(0x2e4))[_0xe26f03(0x1bb)]=_0x3b4587[_0xe26f03(0x474)],$('#set_interval')[_0xe26f03(0x1bb)]=_0x3b4587[_0xe26f03(0x310)];}else{if(editingPreset==='B'){$(_0xe26f03(0x1c6))[_0xe26f03(0x1bb)]=_0x4205fe[_0xe26f03(0x26f)];if($(_0xe26f03(0x3e0)))$('#set_winddown')[_0xe26f03(0x1bb)]=_0x4205fe[_0xe26f03(0x269)]??0x0;$(_0xe26f03(0x386))[_0xe26f03(0x1bb)]=_0x4205fe[_0xe26f03(0x311)],$(_0xe26f03(0x402))[_0xe26f03(0x1bb)]=_0x4205fe[_0xe26f03(0x33e)],$('#set_cycles')[_0xe26f03(0x1bb)]=_0x3b4587[_0xe26f03(0x2dd)],$(_0xe26f03(0x430))[_0xe26f03(0x1bb)]=_0x3b4587['longBreakIntervalB'];}else{if(editingPreset==='C'){const _0x32f735=$(_0xe26f03(0x2c5));if(_0x32f735)_0x32f735[_0xe26f03(0x1bb)]=_0x3b4587[_0xe26f03(0x37e)]??0x5;}}}}function highlightPresetSelector(){const _0x53eb6a=_0x2d92ab;$$(_0x53eb6a(0x19b))['forEach'](_0x2e17d5=>{const _0x43e2bc=_0x53eb6a,_0xb2d4d0=_0x2e17d5['dataset']['presetTarget']===editingPreset;_0x2e17d5[_0x43e2bc(0x300)][_0x43e2bc(0x38e)]('acc',_0xb2d4d0),_0x2e17d5[_0x43e2bc(0x300)]['toggle'](_0x43e2bc(0x49a),!_0xb2d4d0);});}function openSettings(){const _0x5264e9=_0x2d92ab,_0x1fbbb7=data[_0x5264e9(0x3cc)];editingPreset=_0x1fbbb7[_0x5264e9(0x1d0)],$(_0x5264e9(0x3a9))[_0x5264e9(0x1bb)]=_0x1fbbb7[_0x5264e9(0x240)]||'',loadEditingPresetFields(),highlightPresetSelector(),$(_0x5264e9(0x301))[_0x5264e9(0x1bb)]=_0x1fbbb7[_0x5264e9(0x31f)]??0.8,$(_0x5264e9(0x2e0))[_0x5264e9(0x1bb)]=_0x1fbbb7[_0x5264e9(0x286)]||_0x5264e9(0x450),$(_0x5264e9(0x1a1))[_0x5264e9(0x1bb)]=_0x1fbbb7[_0x5264e9(0x46f)]||_0x5264e9(0x466);const _0x113b39=getActiveYoutubeUrl();$(_0x5264e9(0x2e5))['value']=_0x113b39||'';const _0x10c69c=extractYouTubeID(_0x113b39);$(_0x5264e9(0x376))[_0x5264e9(0x3f0)]=!_0x10c69c;$('#ytUrlFeedback')&&($(_0x5264e9(0x3a7))[_0x5264e9(0x3ef)]='');$(_0x5264e9(0x440))[_0x5264e9(0x1bb)]=_0x1fbbb7[_0x5264e9(0x287)]||0x50,$(_0x5264e9(0x24f))['checked']=!!_0x1fbbb7[_0x5264e9(0x3c7)],$(_0x5264e9(0x207))[_0x5264e9(0x1bb)]=_0x1fbbb7['panelOpacity']||0.85;$('#set_backgroundMode')&&($(_0x5264e9(0x345))[_0x5264e9(0x1bb)]=_0x1fbbb7['backgroundMode']||_0x5264e9(0x2cd));$('#set_autoStartNext')&&($(_0x5264e9(0x292))[_0x5264e9(0x3a5)]=!!_0x1fbbb7[_0x5264e9(0x1b3)]);$(_0x5264e9(0x20a))&&($(_0x5264e9(0x20a))[_0x5264e9(0x3a5)]=_0x1fbbb7[_0x5264e9(0x36a)]!==![]);$('#set_enableSessionNotes')&&($(_0x5264e9(0x198))[_0x5264e9(0x3a5)]=_0x1fbbb7['enableSessionNotes']!==![]);$(_0x5264e9(0x342))&&($(_0x5264e9(0x342))['value']=_0x1fbbb7[_0x5264e9(0x395)]||0x7);const _0x121c0c=$(_0x5264e9(0x226));_0x121c0c&&storageManager[_0x5264e9(0x3d5)]()[_0x5264e9(0x186)](_0x43ea91=>{const _0x3880eb=_0x5264e9;_0x121c0c[_0x3880eb(0x200)]=_0x3880eb(0x36b),_0x43ea91&&_0x43ea91[_0x3880eb(0x1ae)]>0x0?_0x43ea91[_0x3880eb(0x467)](_0x3f4094=>{const _0x306dd9=_0x3880eb,_0x10dc0f=document[_0x306dd9(0x2e2)](_0x306dd9(0x2f0));_0x10dc0f['value']=_0x3f4094[_0x306dd9(0x375)],_0x10dc0f[_0x306dd9(0x3ef)]=_0x306dd9(0x45a)+new Date(_0x3f4094[_0x306dd9(0x375)])[_0x306dd9(0x25d)]('vi-VN'),_0x121c0c[_0x306dd9(0x499)](_0x10dc0f);}):_0x121c0c[_0x3880eb(0x200)]=_0x3880eb(0x289);});$(_0x5264e9(0x470))[_0x5264e9(0x300)][_0x5264e9(0x31c)](_0x5264e9(0x257));try{trapFocus($('#modalSettings'));}catch(_0x6537ed){}}function closeSettings(){const _0x3c156f=_0x2d92ab;$('#modalSettings')['classList'][_0x3c156f(0x21c)](_0x3c156f(0x257));try{releaseFocus();}catch(_0x4bb2c1){}}async function setDefaults(){const _0x545194=_0x2d92ab;data['settings'][_0x545194(0x1d7)]={'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},data['settings'][_0x545194(0x474)]=0x4,data['settings'][_0x545194(0x310)]=0x4,data['settings']['cyclesB']=0x4,data[_0x545194(0x3cc)][_0x545194(0x43b)]=0x4,data[_0x545194(0x3cc)][_0x545194(0x37e)]=0x5,data[_0x545194(0x3cc)]['preset']='A',data[_0x545194(0x3cc)][_0x545194(0x31f)]=0.8,data[_0x545194(0x3cc)][_0x545194(0x286)]=_0x545194(0x450),await saveData(),openSettings(),toast('Đã\x20khôi\x20phục\x20mặc\x20định');}async function saveSettings(){const _0xd2ee61=_0x2d92ab,_0x18b1c9=data[_0xd2ee61(0x3cc)];_0x18b1c9[_0xd2ee61(0x240)]=$('#set_apiKey')[_0xd2ee61(0x1bb)]['trim']();const _0x159a2a=_0x18b1c9[_0xd2ee61(0x1d7)];if(editingPreset==='A')_0x159a2a[_0xd2ee61(0x423)]=clampInt($('#set_work')[_0xd2ee61(0x1bb)],0x1,0x3e7),_0x159a2a[_0xd2ee61(0x3c8)]=clampInt($(_0xd2ee61(0x3e0))[_0xd2ee61(0x1bb)],0x0,0x3e7),_0x159a2a[_0xd2ee61(0x19f)]=clampInt($('#set_short')['value'],0x1,0x3e7),_0x159a2a[_0xd2ee61(0x251)]=clampInt($(_0xd2ee61(0x402))[_0xd2ee61(0x1bb)],0x1,0x3e7),_0x18b1c9[_0xd2ee61(0x474)]=clampInt($(_0xd2ee61(0x2e4))[_0xd2ee61(0x1bb)],0x1,0xc),_0x18b1c9['longBreakIntervalA']=clampInt($('#set_interval')[_0xd2ee61(0x1bb)],0x2,0xc);else{if(editingPreset==='B')_0x159a2a[_0xd2ee61(0x26f)]=clampInt($(_0xd2ee61(0x1c6))['value'],0x1,0x3e7),_0x159a2a[_0xd2ee61(0x269)]=clampInt($('#set_winddown')[_0xd2ee61(0x1bb)],0x0,0x3e7),_0x159a2a['B_short']=clampInt($('#set_short')['value'],0x1,0x3e7),_0x159a2a[_0xd2ee61(0x33e)]=clampInt($(_0xd2ee61(0x402))[_0xd2ee61(0x1bb)],0x1,0x3e7),_0x18b1c9[_0xd2ee61(0x2dd)]=clampInt($(_0xd2ee61(0x2e4))[_0xd2ee61(0x1bb)],0x1,0xc),_0x18b1c9['longBreakIntervalB']=clampInt($('#set_interval')[_0xd2ee61(0x1bb)],0x2,0xc);else{if(editingPreset==='C'){const _0x2648c4=$(_0xd2ee61(0x2c5));if(_0x2648c4)_0x18b1c9[_0xd2ee61(0x37e)]=clampInt(_0x2648c4[_0xd2ee61(0x1bb)],0x1,0x14);}}}_0x18b1c9[_0xd2ee61(0x31f)]=clampFloat($(_0xd2ee61(0x301))[_0xd2ee61(0x1bb)],0x0,0x1,0.8),_0x18b1c9['soundTheme']=$(_0xd2ee61(0x2e0))[_0xd2ee61(0x1bb)]==='chime'?_0xd2ee61(0x3e1):'beep',_0x18b1c9['theme']=$(_0xd2ee61(0x1a1))[_0xd2ee61(0x1bb)],_0x18b1c9[_0xd2ee61(0x45d)]=parseFloat($(_0xd2ee61(0x207))[_0xd2ee61(0x1bb)])||0.85;$(_0xd2ee61(0x345))&&(_0x18b1c9['backgroundMode']=$(_0xd2ee61(0x345))[_0xd2ee61(0x1bb)]);_0x18b1c9[_0xd2ee61(0x1b3)]=!!($(_0xd2ee61(0x292))&&$(_0xd2ee61(0x292))[_0xd2ee61(0x3a5)]),_0x18b1c9['enableWinddown']=!!($('#set_enableWinddown')&&$(_0xd2ee61(0x20a))[_0xd2ee61(0x3a5)]),_0x18b1c9[_0xd2ee61(0x489)]=!!($(_0xd2ee61(0x198))&&$(_0xd2ee61(0x198))[_0xd2ee61(0x3a5)]);$('#set_backupDays')&&(_0x18b1c9[_0xd2ee61(0x395)]=clampInt($(_0xd2ee61(0x342))['value'],0x1,0x1e));_0x18b1c9[_0xd2ee61(0x46f)]===_0xd2ee61(0x2a1)||_0x18b1c9[_0xd2ee61(0x46f)]===_0xd2ee61(0x1a7)?(_0x18b1c9[_0xd2ee61(0x3c7)]=![],typeof _0x18b1c9[_0xd2ee61(0x45e)]===_0xd2ee61(0x2ba)&&_0x18b1c9[_0xd2ee61(0x45e)][_0xd2ee61(0x3cb)](_0xd2ee61(0x25f))&&(_0x18b1c9[_0xd2ee61(0x45e)]='')):_0x18b1c9[_0xd2ee61(0x3c7)]=!![];const _0x4da3cd=$(_0xd2ee61(0x2e5))[_0xd2ee61(0x1bb)][_0xd2ee61(0x265)]();_0x18b1c9['useYtThumbnailAsBg']=$('#set_ytThumbAsBg')['checked'],_0x18b1c9[_0xd2ee61(0x287)]=parseInt($(_0xd2ee61(0x440))[_0xd2ee61(0x1bb)],0xa),sessionYoutubeUrl=_0x4da3cd;try{if(!IS_FILE_PROTOCOL){if(ytPlayer&&ytPlayer['setVolume'])ytPlayer[_0xd2ee61(0x498)](_0x18b1c9['youtubeVolume']);}else try{fallbackPostMessage(_0xd2ee61(0x498),[_0x18b1c9['youtubeVolume']]);}catch(_0x13db50){}}catch(_0x19ab6c){}await saveData(),applyTheme(),applyCustomBg(),applyPanelOpacity(),updatePresetButtonsText(),timer[_0xd2ee61(0x34d)](_0x18b1c9[_0xd2ee61(0x1d0)],{'silent':!![]}),closeSettings(),toast(_0xd2ee61(0x190));}function clampInt(_0x2ec4f6,_0x37aaba,_0x1cc380){const _0x32b78c=_0x2d92ab;_0x2ec4f6=parseInt(_0x2ec4f6||0x0,0xa);if(isNaN(_0x2ec4f6))_0x2ec4f6=_0x37aaba;return Math[_0x32b78c(0x248)](_0x37aaba,Math[_0x32b78c(0x28f)](_0x1cc380,_0x2ec4f6));}function clampFloat(_0xbaa6c9,_0x244700,_0x1e0331,_0x31192b){const _0x3caeae=_0x2d92ab;_0xbaa6c9=parseFloat(_0xbaa6c9);if(Number[_0x3caeae(0x381)](_0xbaa6c9))_0xbaa6c9=_0x31192b;return Math[_0x3caeae(0x248)](_0x244700,Math[_0x3caeae(0x28f)](_0x1e0331,_0xbaa6c9));}const dbPromise=new Promise((_0x281b45,_0x35e6bc)=>{const _0x7ba8b0=_0x2d92ab,_0x20ce2a=indexedDB['open'](_0x7ba8b0(0x38c),0x1);_0x20ce2a[_0x7ba8b0(0x41b)]=_0x9bc9c=>_0x9bc9c[_0x7ba8b0(0x26b)][_0x7ba8b0(0x263)]['createObjectStore']('files'),_0x20ce2a['onsuccess']=_0x3787f0=>_0x281b45(_0x3787f0['target'][_0x7ba8b0(0x263)]),_0x20ce2a[_0x7ba8b0(0x47e)]=_0x2557ee=>_0x35e6bc(_0x2557ee);}),fileCache={};function handleFileUpload(_0x3c017f,_0x520c5e){if(!_0x3c017f)return;dbPromise['then'](_0x647a9d=>{const _0x2c4361=_0x50e5,_0x5c6c53=uid(_0x2c4361(0x2b7)),_0x18528d=_0x647a9d['transaction'](_0x2c4361(0x3b1),'readwrite');_0x18528d['objectStore'](_0x2c4361(0x3b1))[_0x2c4361(0x299)](_0x3c017f,_0x5c6c53),_0x18528d['oncomplete']=()=>_0x520c5e(_0x5c6c53),_0x18528d['onerror']=()=>toast('Lỗi\x20lưu\x20file.');});}function getStoredFileUrl(_0x232b1f){const _0x35c27e=_0x2d92ab;if(!_0x232b1f)return Promise[_0x35c27e(0x2a8)]('');if(fileCache[_0x232b1f])return Promise[_0x35c27e(0x2a8)](fileCache[_0x232b1f]);return dbPromise[_0x35c27e(0x186)](_0x26cdb2=>new Promise(_0x2053fb=>{const _0x2d134f=_0x35c27e,_0x250475=_0x26cdb2['transaction'](_0x2d134f(0x3b1),'readonly'),_0x173055=_0x250475[_0x2d134f(0x1a4)](_0x2d134f(0x3b1))[_0x2d134f(0x370)](_0x232b1f);_0x173055['onsuccess']=_0x524d63=>{const _0x1e66d0=_0x2d134f,_0x23a324=_0x524d63[_0x1e66d0(0x26b)][_0x1e66d0(0x263)];if(_0x23a324){const _0x29b2e2=URL['createObjectURL'](_0x23a324);fileCache[_0x232b1f]=_0x29b2e2,_0x2053fb(_0x29b2e2);}else _0x2053fb('');},_0x173055[_0x2d134f(0x47e)]=()=>_0x2053fb('');}));}function applyCustomBg(){const _0x506983=_0x2d92ab,_0x3727d2=data['settings'],_0x220c5f=_0x3727d2['customBg'],_0x506b87=_0x3727d2[_0x506983(0x46f)],_0xbe49ad=[_0x506983(0x245),_0x506983(0x32c)]['includes'](_0x506b87),_0xebb919=_0x506b87===_0x506983(0x2a1)||_0x506b87===_0x506983(0x1a7),_0x1896c9=_0x3727d2[_0x506983(0x1f7)]||'cover';document[_0x506983(0x3e7)][_0x506983(0x34c)][_0x506983(0x1fe)]=_0x1896c9,document[_0x506983(0x3e7)][_0x506983(0x34c)][_0x506983(0x2ee)]=_0x1896c9==='auto'?_0x506983(0x41e):'no-repeat';const _0x1b1d71=()=>{const _0x3be11d=_0x506983;try{document[_0x3be11d(0x3e7)][_0x3be11d(0x34c)][_0x3be11d(0x338)]='';}catch(_0x4738b9){}};if(_0x220c5f){const _0x1eff9c=_0x220c5f[_0x506983(0x1ce)](_0x506983(0x2dc))||_0x220c5f[_0x506983(0x1ce)](_0x506983(0x377))||_0x220c5f[_0x506983(0x1ce)](_0x506983(0x414))?Promise['resolve'](_0x220c5f):getStoredFileUrl(_0x220c5f);_0x1eff9c[_0x506983(0x186)](_0x272ec5=>{const _0xbe279a=_0x506983;_0x272ec5?document[_0xbe279a(0x3e7)][_0xbe279a(0x34c)]['setProperty']('--bg-image',_0xbe279a(0x3df)+_0x272ec5+')'):document[_0xbe279a(0x3e7)]['style'][_0xbe279a(0x40e)](_0xbe279a(0x21e),_0xebb919?'none':''),_0x1b1d71();});}else!_0xbe49ad?_0xebb919?(document[_0x506983(0x3e7)]['style'][_0x506983(0x40e)](_0x506983(0x21e),_0x506983(0x35d)),_0x1b1d71()):document[_0x506983(0x3e7)]['style'][_0x506983(0x40e)](_0x506983(0x21e),_0x506983(0x1d5)):(document[_0x506983(0x3e7)]['style']['removeProperty']('--bg-image'),_0x1b1d71());}function applyPanelOpacity(){const _0x2db5d0=_0x2d92ab;document[_0x2db5d0(0x297)][_0x2db5d0(0x34c)][_0x2db5d0(0x40e)](_0x2db5d0(0x28e),data[_0x2db5d0(0x3cc)][_0x2db5d0(0x45d)]);}function renderDashboard(){const _0x57b839=_0x2d92ab,_0x405fda=data[_0x57b839(0x268)]['flatMap'](_0x5581cc=>_0x5581cc[_0x57b839(0x25e)][_0x57b839(0x394)](_0x3ca35e=>({'topic':_0x5581cc['name'],'subtopic':_0x3ca35e[_0x57b839(0x418)],'m':_0x3ca35e[_0x57b839(0x1b8)]['totalMinutes']||0x0,'c':_0x3ca35e['stats'][_0x57b839(0x337)]||0x0,'t':_0x3ca35e['stats'][_0x57b839(0x180)]||0x0}))),_0xa3d3ad=_0x405fda[_0x57b839(0x31b)]((_0x477219,_0x42068f)=>_0x477219+_0x42068f['m'],0x0),_0x3433bc=_0x405fda[_0x57b839(0x31b)]((_0x4ba439,_0x434385)=>_0x4ba439+_0x434385['c'],0x0),_0x1ac9e5=_0x405fda[_0x57b839(0x31b)]((_0xb0925c,_0x3e351d)=>_0xb0925c+_0x3e351d['t'],0x0);let _0x2b5a2e='<p\x20class=\x22tiny\x22><strong>Tổng\x20thời\x20gian:</strong>\x20'+formatDaysHoursMinutes(_0xa3d3ad)+_0x57b839(0x48a)+_0x3433bc+_0x57b839(0x422)+_0x1ac9e5+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22dashboard-table\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead><tr><th>Chủ\x20đề</th><th>Chủ\x20đề\x20con</th><th>Thời\x20gian</th><th>Phiên</th><th>Nhiệm\x20vụ</th></tr></thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>';_0x405fda[_0x57b839(0x467)](_0x50331c=>{const _0x21492f=_0x57b839;_0x2b5a2e+=_0x21492f(0x4a0)+escapeHTML(_0x50331c[_0x21492f(0x41f)])+_0x21492f(0x485)+escapeHTML(_0x50331c['subtopic'])+_0x21492f(0x485)+formatDaysHoursMinutes(_0x50331c['m'])+_0x21492f(0x485)+_0x50331c['c']+'</td><td>'+_0x50331c['t']+_0x21492f(0x3f7);}),_0x2b5a2e+=_0x57b839(0x477);const _0x39f5a3=$(_0x57b839(0x282));if(_0x39f5a3)_0x39f5a3['innerHTML']=_0x2b5a2e;}function getMilestones(){const _0x3a71e4=_0x2d92ab;return[{'hours':0x5,'title':'Gửi\x20bạn,\x205\x20giờ\x20đầu\x20tiên\x20(Khởi\x20động)','message':_0x3a71e4(0x480)},{'hours':0x14,'title':_0x3a71e4(0x1d6),'message':_0x3a71e4(0x20f)},{'hours':0x32,'title':_0x3a71e4(0x43e),'message':_0x3a71e4(0x2a9)},{'hours':0x64,'title':_0x3a71e4(0x22a),'message':_0x3a71e4(0x202)},{'hours':0xfa,'title':'Gửi\x20bạn,\x20250\x20giờ\x20(Bền\x20bỉ)','message':_0x3a71e4(0x1fb)},{'hours':0x1f4,'title':'Gửi\x20bạn,\x20500\x20giờ\x20(Chuyên\x20tâm)','message':_0x3a71e4(0x346)},{'hours':0x3e8,'title':_0x3a71e4(0x2d9),'message':'Chào\x20mừng\x20đến\x20Câu\x20lạc\x20bộ\x201000\x20giờ.\x0a\x0aCon\x20số\x20này\x20không\x20chỉ\x20đo\x20lường\x20thời\x20gian,\x20nó\x20đại\x20diện\x20cho\x20sự\x20chuyển\x20hóa.\x20Sự\x20tập\x20trung\x20đã\x20trở\x20thành\x20một\x20phần\x20con\x20người\x20bạn,\x20một\x20\x27siêu\x20năng\x20lực\x27\x20bạn\x20có\x20thể\x20triệu\x20hồi.\x20Hành\x20trình\x20của\x20bạn\x20thực\x20sự\x20truyền\x20cảm\x20hứng.'},{'hours':0x1388,'title':'Gửi\x20bạn,\x205.000+\x20giờ\x20(Di\x20sản)','message':_0x3a71e4(0x22b)}]['sort']((_0x2708cf,_0x595fb6)=>_0x595fb6['hours']-_0x2708cf[_0x3a71e4(0x32e)]);}async function checkAndShowMilestones(){const _0x9c5888=_0x2d92ab;if(!data||!data[_0x9c5888(0x3cc)])return;if(!Array['isArray'](data[_0x9c5888(0x3cc)][_0x9c5888(0x385)]))data[_0x9c5888(0x3cc)]['achievedMilestones']=[];const _0xfd1647=data[_0x9c5888(0x268)][_0x9c5888(0x31b)]((_0x2f8a7e,_0x52b6ea)=>{const _0xc5478b=_0x9c5888;return _0x2f8a7e+_0x52b6ea[_0xc5478b(0x25e)][_0xc5478b(0x31b)]((_0xcf81f4,_0x7dac49)=>{const _0x23cdfe=_0xc5478b;return _0xcf81f4+(_0x7dac49['stats'][_0x23cdfe(0x444)]||0x0);},0x0);},0x0),_0xcfef8=_0xfd1647/0x3c,_0x3f6576=getMilestones(),_0x354d4c=Array[_0x9c5888(0x1ac)](data['settings']['achievedMilestones'])?data[_0x9c5888(0x3cc)][_0x9c5888(0x385)]:[],_0x305eed=_0x3f6576[_0x9c5888(0x280)](_0x17fed9=>_0xcfef8>=_0x17fed9[_0x9c5888(0x32e)]&&!_0x354d4c[_0x9c5888(0x3cb)](_0x17fed9['hours']));if(_0x305eed[_0x9c5888(0x1ae)]===0x0)return![];const _0x5aee70=_0x305eed[_0x9c5888(0x31b)]((_0x122558,_0x22f1bf)=>_0x122558&&_0x122558[_0x9c5888(0x32e)]>_0x22f1bf[_0x9c5888(0x32e)]?_0x122558:_0x22f1bf,null);if(!_0x5aee70)return![];$(_0x9c5888(0x2ce))['textContent']=_0x5aee70['title'],$('#milestoneMessage')[_0x9c5888(0x3ef)]=_0x5aee70[_0x9c5888(0x27e)],$(_0x9c5888(0x2b5))['classList'][_0x9c5888(0x31c)]('show');try{trapFocus($(_0x9c5888(0x2b5)));}catch(_0x42b69c){}return data[_0x9c5888(0x3cc)]['achievedMilestones'][_0x9c5888(0x369)](_0x5aee70[_0x9c5888(0x32e)]),await saveData(),!![];}async function seedAchievedMilestones(){const _0x5e78f8=_0x2d92ab;if(!data||!data[_0x5e78f8(0x3cc)])return;!Array[_0x5e78f8(0x1ac)](data[_0x5e78f8(0x3cc)][_0x5e78f8(0x385)])&&(data[_0x5e78f8(0x3cc)][_0x5e78f8(0x385)]=[],await saveData());}async function handleSendMessage(){const _0x274f14=_0x2d92ab,_0x88b928=$(_0x274f14(0x183)),_0x30ff33=$(_0x274f14(0x31e)),_0x3d6d34=_0x30ff33[_0x274f14(0x1bb)][_0x274f14(0x265)](),_0x1b2969=getCurrentSubtopic();if(!_0x3d6d34)return;if(!_0x1b2969){toast(t(_0x274f14(0x238)));return;}_0x30ff33[_0x274f14(0x1bb)]='',_0x88b928['disabled']=!![],_0x88b928[_0x274f14(0x200)]='<div\x20class=\x22spinner\x22></div>',_0x1b2969[_0x274f14(0x321)][_0x274f14(0x369)]({'role':_0x274f14(0x28b),'text':_0x3d6d34}),renderChat();const _0x12075b=await callGeminiAPI(_0x3d6d34);_0x12075b&&(_0x1b2969[_0x274f14(0x321)][_0x274f14(0x369)]({'role':_0x274f14(0x44c),'text':_0x12075b}),await saveData(),renderChat()),_0x88b928['disabled']=![],_0x88b928[_0x274f14(0x200)]=_0x274f14(0x42f);}function renderChat(){const _0x251b6b=_0x2d92ab,_0x508368=getCurrentSubtopic(),_0x45589b=$(_0x251b6b(0x288)),_0x18266a=$(_0x251b6b(0x31e)),_0x378bd8=$(_0x251b6b(0x183));if(!_0x45589b||!_0x18266a||!_0x378bd8)return;if(!_0x508368){_0x45589b[_0x251b6b(0x200)]=_0x251b6b(0x409),_0x18266a[_0x251b6b(0x3f0)]=!![],_0x378bd8[_0x251b6b(0x3f0)]=!![];return;}_0x18266a[_0x251b6b(0x3f0)]=![],_0x378bd8[_0x251b6b(0x3f0)]=![],_0x45589b['innerHTML']='';if(!_0x508368[_0x251b6b(0x321)]||_0x508368[_0x251b6b(0x321)][_0x251b6b(0x1ae)]===0x0){_0x45589b['innerHTML']='<div\x20class=\x22tiny\x22>Chưa\x20có\x20tin\x20nhắn\x20nào.</div>';return;}_0x508368[_0x251b6b(0x321)]['forEach'](_0xe8babd=>{const _0x207d0b=_0x251b6b,_0x4ef605=document[_0x207d0b(0x2e2)]('div');_0x4ef605[_0x207d0b(0x45f)]=_0x207d0b(0x491)+_0xe8babd[_0x207d0b(0x2f2)],_0x4ef605[_0x207d0b(0x3ef)]=_0xe8babd[_0x207d0b(0x3d1)],_0x45589b[_0x207d0b(0x499)](_0x4ef605);}),_0x45589b[_0x251b6b(0x3de)]=_0x45589b[_0x251b6b(0x1c4)];}async function handleSummarizeNote(){const _0x250bf2=_0x2d92ab,_0x5e06b8=$(_0x250bf2(0x457)),_0x8cedd7=$(_0x250bf2(0x247)),_0x498773=_0x8cedd7[_0x250bf2(0x1bb)][_0x250bf2(0x265)](),_0x42492f=getCurrentSubtopic();if(!_0x498773){toast(_0x250bf2(0x199));return;}const _0x4e2b4f=_0x5e06b8[_0x250bf2(0x200)];_0x5e06b8[_0x250bf2(0x200)]=_0x250bf2(0x27a),_0x5e06b8[_0x250bf2(0x3f0)]=!![];const _0x500f39=_0x250bf2(0x436)+(_0x42492f?.['name']||_0x250bf2(0x30b))+'\x22\x0a-\x20Ghi\x20chú\x20của\x20người\x20dùng\x20sau\x20một\x20phiên\x20làm\x20việc:\x20\x22'+_0x498773+'\x22\x0a\x0aHãy\x20tạo\x20một\x20bản\x20tóm\x20tắt\x20ngắn\x20gọn\x20về\x20những\x20gì\x20đã\x20làm\x20và\x20đề\x20xuất\x20một\x20bước\x20hợp\x20lý\x20tiếp\x20theo.\x20Định\x20dạng\x20câu\x20trả\x20lời\x20như\x20sau:\x0a\x0a---\x0a**✨\x20Tóm\x20tắt\x20AI:**\x0a[Tóm\x20tắt\x20ở\x20đây]\x0a\x0a**🚀\x20Gợi\x20ý\x20tiếp\x20theo:**\x0a[Gợi\x20ý\x20ở\x20đây]',_0x7edf84=await callGeminiAPI(_0x500f39);_0x7edf84&&(_0x8cedd7[_0x250bf2(0x1bb)]+='\x0a\x0a'+_0x7edf84),_0x5e06b8[_0x250bf2(0x200)]=_0x4e2b4f,_0x5e06b8[_0x250bf2(0x3f0)]=![];}function clearChat(){const _0x1b4016=_0x2d92ab,_0x39d2b7=getCurrentSubtopic();if(!_0x39d2b7){toast(t(_0x1b4016(0x238)));return;}showConfirmModal(_0x1b4016(0x351),'Bạn\x20có\x20chắc\x20muốn\x20xóa\x20toàn\x20bộ\x20lịch\x20sử\x20chat\x20của\x20chủ\x20đề\x20con\x20này?',async _0xcba94c=>{const _0x2285ba=_0x1b4016;_0xcba94c&&(_0x39d2b7[_0x2285ba(0x321)]=[],await saveData(),renderChat(),toast(_0x2285ba(0x389)));});}let ytPlayer,ytUserPaused=![],ytFallbackFrame=null,ytFallbackIsPlaying=![];function buildFallbackSrc(_0x34da53,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x186fe2=_0x2d92ab,_0x5b57c9=new URLSearchParams({'autoplay':String(autoplay),'mute':String(mute),'controls':'0','playsinline':'1','loop':'1','playlist':_0x34da53,'enablejsapi':'1','origin':_0x186fe2(0x3ff)})['toString']();return _0x186fe2(0x462)+_0x34da53+'?'+_0x5b57c9;}function ensureFallbackFrame(){const _0x27556a=_0x2d92ab,_0x1c23ef=document['getElementById'](_0x27556a(0x2ac));if(!_0x1c23ef)return null;if(ytFallbackFrame&&ytFallbackFrame[_0x27556a(0x478)])return ytFallbackFrame;const _0x4250ed=document[_0x27556a(0x2e2)]('iframe');return _0x4250ed['id']=_0x27556a(0x366),_0x4250ed[_0x27556a(0x40a)]='1',_0x4250ed[_0x27556a(0x3f6)]='1',_0x4250ed[_0x27556a(0x34c)][_0x27556a(0x427)]='absolute',_0x4250ed[_0x27556a(0x34c)][_0x27556a(0x24a)]=_0x27556a(0x365),_0x4250ed[_0x27556a(0x34c)][_0x27556a(0x441)]=_0x27556a(0x365),_0x4250ed[_0x27556a(0x332)]=_0x27556a(0x33a),_0x1c23ef[_0x27556a(0x200)]='',_0x1c23ef['appendChild'](_0x4250ed),ytFallbackFrame=_0x4250ed,_0x4250ed;}function fallbackLoadVideo(_0x6cdc0d,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x584cf1=_0x2d92ab,_0x4a92ea=document[_0x584cf1(0x26a)](_0x584cf1(0x2ac));if(!_0x4a92ea)return;_0x4a92ea[_0x584cf1(0x200)]='';const _0xbfeafb=document[_0x584cf1(0x2e2)](_0x584cf1(0x398));_0xbfeafb['id']=_0x584cf1(0x366),_0xbfeafb[_0x584cf1(0x40a)]='1',_0xbfeafb['height']='1',_0xbfeafb['style'][_0x584cf1(0x427)]=_0x584cf1(0x3f1),_0xbfeafb['style'][_0x584cf1(0x24a)]=_0x584cf1(0x365),_0xbfeafb['style'][_0x584cf1(0x441)]='-9999px',_0xbfeafb[_0x584cf1(0x332)]=_0x584cf1(0x33a),_0xbfeafb[_0x584cf1(0x1eb)]=buildFallbackSrc(_0x6cdc0d,{'autoplay':autoplay,'mute':mute}),_0x4a92ea['appendChild'](_0xbfeafb),ytFallbackFrame=_0xbfeafb,ytFallbackIsPlaying=!!autoplay;try{const _0x54e111=document['getElementById'](_0x584cf1(0x1e7));if(_0x54e111)_0x54e111[_0x584cf1(0x3ef)]=ytFallbackIsPlaying?'⏸️':'▶️';}catch(_0x1c9294){}}function fallbackPostMessage(_0x4502cb,_0x345efb=[]){const _0x5e35c7=_0x2d92ab;try{if(!ytFallbackFrame||!ytFallbackFrame[_0x5e35c7(0x262)])return;ytFallbackFrame[_0x5e35c7(0x262)][_0x5e35c7(0x1c7)](JSON['stringify']({'event':_0x5e35c7(0x2bc),'func':_0x4502cb,'args':_0x345efb}),'https://www.youtube.com');}catch(_0x2e31ac){}}function fallbackPlay(){const _0x32285a=_0x2d92ab;fallbackPostMessage(_0x32285a(0x1ea));}function fallbackStop(){const _0x3bc044=_0x2d92ab;try{ytFallbackFrame&&(ytFallbackFrame['src']=_0x3bc044(0x2c2),ytFallbackIsPlaying=![]);}catch(_0x5f3c4d){}}function fallbackPause(){fallbackStop();}function fallbackUnMute(){const _0x10862a=_0x2d92ab;fallbackPostMessage(_0x10862a(0x223));}function fallbackMute(){const _0x56516c=_0x2d92ab;fallbackPostMessage(_0x56516c(0x3a3));}window[_0x2d92ab(0x37b)]=function(){const _0x4e5d2b=_0x2d92ab;if(IS_FILE_PROTOCOL){try{window[_0x4e5d2b(0x357)]&&window['__ytApiWatchdog'][_0x4e5d2b(0x3ce)]();}catch(_0x113f9a){}return;}const _0x3e3b2c={'height':'1','width':'1','playerVars':{'autoplay':0x0,'controls':0x0,'playsinline':0x1},'events':{'onReady':onPlayerReady,'onStateChange':onPlayerStateChange},'host':_0x4e5d2b(0x3ff)};(window[_0x4e5d2b(0x429)][_0x4e5d2b(0x419)]===_0x4e5d2b(0x378)||window['location'][_0x4e5d2b(0x419)]==='https:')&&(_0x3e3b2c[_0x4e5d2b(0x447)]=window[_0x4e5d2b(0x429)][_0x4e5d2b(0x447)]);ytPlayer=new YT[(_0x4e5d2b(0x1f0))](_0x4e5d2b(0x2ac),_0x3e3b2c);try{window[_0x4e5d2b(0x357)]&&window[_0x4e5d2b(0x357)][_0x4e5d2b(0x3ce)]();const _0x5e1680=document[_0x4e5d2b(0x26a)](_0x4e5d2b(0x405));_0x5e1680&&(_0x5e1680['textContent']='');}catch(_0x4c439e){}};let _ytPrimed=![],_ytUnlocked=![];try{_ytUnlocked=localStorage['getItem'](_0x2d92ab(0x492))==='1';}catch(_0x5d34d2){}function showSoundPermission(){const _0x3ad9bb=_0x2d92ab,_0x3c6ddf=document['getElementById'](_0x3ad9bb(0x368));if(!_0x3c6ddf)return;if(_ytUnlocked){_0x3c6ddf[_0x3ad9bb(0x300)]['remove'](_0x3ad9bb(0x257));return;}_0x3c6ddf[_0x3ad9bb(0x300)][_0x3ad9bb(0x31c)](_0x3ad9bb(0x257));}function hideSoundPermission(){const _0x3c0863=_0x2d92ab,_0x6b470a=document[_0x3c0863(0x26a)]('soundPermissionBar');if(!_0x6b470a)return;_0x6b470a[_0x3c0863(0x300)]['remove'](_0x3c0863(0x257));}function unlockAudioChain(){const _0x3bad96=_0x2d92ab;try{if(AUDIO_CTX&&typeof AUDIO_CTX[_0x3bad96(0x20c)]===_0x3bad96(0x44f))AUDIO_CTX[_0x3bad96(0x20c)]();}catch(_0x356fab){}try{if(IS_FILE_PROTOCOL)fallbackUnMute(),fallbackPlay();else ytPlayer&&ytPlayer[_0x3bad96(0x223)]&&(ytPlayer[_0x3bad96(0x223)](),ytPlayer['playVideo']());}catch(_0x216a90){}_ytUnlocked=!![];try{localStorage[_0x3bad96(0x1b0)]('sound_unlocked','1');}catch(_0x18d357){}hideSoundPermission(),toast(_0x3bad96(0x396));}function onPlayerReady(_0x94bd97){const _0x951945=_0x2d92ab;try{const _0x2ec922=ytPlayer&&ytPlayer['getIframe']?ytPlayer[_0x951945(0x37f)]():null;_0x2ec922&&_0x2ec922['setAttribute']('allow',_0x951945(0x33a));}catch(_0x5a6bbb){}try{if(ytPlayer&&ytPlayer['setVolume'])ytPlayer[_0x951945(0x498)](data&&data['settings']&&data[_0x951945(0x3cc)][_0x951945(0x287)]||0x50);}catch(_0x35963b){}try{const _0x2049c2=getActiveVideoId&&getActiveVideoId();if(_0x2049c2&&ytPlayer&&ytPlayer[_0x951945(0x3a3)]&&ytPlayer[_0x951945(0x1ea)]){ytPlayer[_0x951945(0x3a3)](),ytPlayer[_0x951945(0x1ea)](),_ytPrimed=!![];const _0x273918=()=>{const _0x2be479=_0x951945;if(_ytUnlocked)return;try{unlockAudioChain();}catch(_0x4405d0){}window['removeEventListener']('pointerdown',_0x273918,!![]),window['removeEventListener'](_0x2be479(0x32a),_0x273918,!![]);};window[_0x951945(0x22e)](_0x951945(0x185),_0x273918,!![]),window[_0x951945(0x22e)]('keydown',_0x273918,!![]),showSoundPermission();}}catch(_0x361f42){}updateYouTubePlayer();}function onPlayerStateChange(_0x14b555){const _0x4d0b4e=_0x2d92ab,_0x52c7f1=$(_0x4d0b4e(0x376));_0x14b555[_0x4d0b4e(0x3f8)]==YT[_0x4d0b4e(0x380)][_0x4d0b4e(0x3fc)]?(_0x52c7f1[_0x4d0b4e(0x3ef)]='⏸️',hideSoundPermission()):_0x52c7f1[_0x4d0b4e(0x3ef)]='▶️';if(_0x14b555[_0x4d0b4e(0x3f8)]===YT[_0x4d0b4e(0x380)][_0x4d0b4e(0x434)]){if(!ytUserPaused)ytPlayer[_0x4d0b4e(0x1ea)]();}}async function ytFadeTo(_0x160c20,_0x2e1eb4=0xfa){const _0x5a2bf1=_0x2d92ab;try{if(!ytPlayer||!ytPlayer[_0x5a2bf1(0x2c6)]||!ytPlayer['setVolume'])return;ytPlayer[_0x5a2bf1(0x223)]();const _0x1d94bf=ytPlayer[_0x5a2bf1(0x2c6)](),_0x199800=_0x160c20-_0x1d94bf;if(Math[_0x5a2bf1(0x2be)](_0x199800)<0x1||_0x2e1eb4<=0x0){ytPlayer[_0x5a2bf1(0x498)](_0x160c20);return;}const _0x39926c=performance[_0x5a2bf1(0x340)]();await new Promise(_0x5507f0=>{const _0x449fa9=_0x247e25=>{const _0x7c4f4=_0x50e5,_0x296efb=Math[_0x7c4f4(0x28f)](0x1,(_0x247e25-_0x39926c)/_0x2e1eb4),_0xda9e4a=Math['round'](_0x1d94bf+_0x199800*_0x296efb);ytPlayer['setVolume'](_0xda9e4a);if(_0x296efb<0x1)requestAnimationFrame(_0x449fa9);else _0x5507f0();};requestAnimationFrame(_0x449fa9);});}catch(_0x28d07f){}}async function ytFadeInPlay(_0x4cb11f=0xdc){const _0x48a9e8=_0x2d92ab;try{const _0x2603e9=Math[_0x48a9e8(0x248)](0x0,Math[_0x48a9e8(0x28f)](0x64,data&&data[_0x48a9e8(0x3cc)]&&data[_0x48a9e8(0x3cc)][_0x48a9e8(0x287)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;ytPlayer[_0x48a9e8(0x223)](),ytPlayer[_0x48a9e8(0x1ea)]();try{ytPlayer[_0x48a9e8(0x498)](0x0);}catch(_0x1fe0f4){}await ytFadeTo(_0x2603e9,_0x4cb11f);}else{const _0x1fab55=getActiveVideoId();_0x1fab55&&fallbackLoadVideo(_0x1fab55,{'autoplay':0x1,'mute':0x0});}}catch(_0x20c18d){}}async function ytFadeOutPause(_0x1131a7=0xb4){const _0x3411d5=_0x2d92ab;try{const _0x4ac3ad=Math[_0x3411d5(0x248)](0x0,Math[_0x3411d5(0x28f)](0x64,data&&data[_0x3411d5(0x3cc)]&&data[_0x3411d5(0x3cc)][_0x3411d5(0x287)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;await ytFadeTo(0x0,_0x1131a7);try{ytPlayer[_0x3411d5(0x295)](),ytPlayer[_0x3411d5(0x498)](_0x4ac3ad);}catch(_0xc4f0cf){}}else try{fallbackPause();}catch(_0x47fc9a){}}catch(_0x1e9cc6){}}async function updateYouTubePlayer(){const _0x5d753e=_0x2d92ab,_0x227597=getActiveVideoId();if(data[_0x5d753e(0x3cc)]['useYtThumbnailAsBg']&&_0x227597){const _0x3aa45e=_0x5d753e(0x1ff)+_0x227597+'/maxresdefault.jpg',_0x5dcd15=new Image();_0x5dcd15[_0x5d753e(0x2e9)]=async()=>{const _0x257429=_0x5d753e;data['settings'][_0x257429(0x45e)]=_0x3aa45e,await saveData(),applyCustomBg();},_0x5dcd15[_0x5d753e(0x47e)]=async()=>{const _0x24919f=_0x5d753e,_0x30ba2f=_0x24919f(0x1ff)+_0x227597+_0x24919f(0x2f7);data[_0x24919f(0x3cc)]['customBg']=_0x30ba2f,await saveData(),applyCustomBg();},_0x5dcd15[_0x5d753e(0x1eb)]=_0x3aa45e;}else!_0x227597&&(data['settings'][_0x5d753e(0x45e)]='',await saveData(),applyCustomBg());if(IS_FILE_PROTOCOL){if(!_0x227597){fallbackStop(),hideSoundPermission();return;}const _0x5747ca=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x227597,{'autoplay':0x1,'mute':_0x5747ca});!_ytUnlocked&&showSoundPermission();return;}if(!ytPlayer||!ytPlayer['cueVideoById']){try{ensureYouTubeAPI();}catch(_0x262d86){}return;}if(!_0x227597){if(ytPlayer[_0x5d753e(0x1b9)])ytPlayer[_0x5d753e(0x1b9)]();hideSoundPermission();return;}ytPlayer[_0x5d753e(0x2ff)](_0x227597),ytPlayer[_0x5d753e(0x498)](data['settings']['youtubeVolume']);}function toggleYtSound(){const _0x3ec29b=_0x2d92ab;if(!_ytUnlocked){try{ensureAudio();}catch(_0x5f0b7a){}try{unlockAudioChain();}catch(_0x211f51){}return;}if(IS_FILE_PROTOCOL){const _0x534fa1=getActiveVideoId();if(!ytFallbackFrame||!ytFallbackFrame[_0x3ec29b(0x478)]){if(!_0x534fa1){toast(_0x3ec29b(0x307));return;}fallbackLoadVideo(_0x534fa1,{'autoplay':0x1,'mute':0x0}),ytFallbackIsPlaying=!![];try{const _0x5bbae2=document[_0x3ec29b(0x26a)](_0x3ec29b(0x1e7));if(_0x5bbae2)_0x5bbae2[_0x3ec29b(0x3ef)]='⏸️';}catch(_0x41fd8a){}toast(_0x3ec29b(0x472));return;}if(ytFallbackIsPlaying)fallbackPostMessage(_0x3ec29b(0x295)),ytFallbackIsPlaying=![],toast(_0x3ec29b(0x443));else{if(!_0x534fa1){toast(_0x3ec29b(0x307));return;}fallbackPostMessage(_0x3ec29b(0x1ea)),ytFallbackIsPlaying=!![],toast(_0x3ec29b(0x472));}try{const _0x57f9d9=document[_0x3ec29b(0x26a)](_0x3ec29b(0x1e7));if(_0x57f9d9)_0x57f9d9[_0x3ec29b(0x3ef)]=ytFallbackIsPlaying?'⏸️':'▶️';}catch(_0x2f991e){}return;}if(!ytPlayer||typeof ytPlayer['getPlayerState']!==_0x3ec29b(0x44f)){try{ensureYouTubeAPI();}catch(_0xf78d47){}return;}const _0x2e8187=ytPlayer[_0x3ec29b(0x242)]();_0x2e8187===YT['PlayerState']['PLAYING']||_0x2e8187===YT[_0x3ec29b(0x380)][_0x3ec29b(0x35f)]?(ytFadeOutPause(),ytUserPaused=!![],toast(_0x3ec29b(0x443))):(ytFadeInPlay(),ytUserPaused=![],toast('Đang\x20phát\x20nhạc\x20nền...'));}function bindEvents(){const _0x44f7ae=_0x2d92ab;try{const _0x1d87f2=document[_0x44f7ae(0x35a)](_0x44f7ae(0x327));_0x1d87f2&&(_0x1d87f2[_0x44f7ae(0x200)]='Hãy\x20bắt\x20đầu\x20bằng\x20cách\x20chọn\x20một\x20<strong>Chủ\x20đề\x20con</strong>\x20hoặc\x20tạo\x20Chủ\x20đề.');}catch(_0x4aef40){}on($(_0x44f7ae(0x364)),_0x44f7ae(0x30e),toggleBackgroundView),on($('#btnMilestoneClose'),_0x44f7ae(0x30e),()=>{const _0x476e9b=_0x44f7ae;$(_0x476e9b(0x2b5))[_0x476e9b(0x300)]['remove']('show');try{releaseFocus();}catch(_0xb741af){}}),on($(_0x44f7ae(0x348)),_0x44f7ae(0x30e),()=>showInputModal('Tên\x20Chủ\x20đề\x20mới?',async _0x456b7c=>{const _0x5ddb26=_0x44f7ae;if(!_0x456b7c)return;data['topics'][_0x5ddb26(0x369)]({'id':uid('t'),'name':_0x456b7c,'subtopics':[]}),await saveData(),renderTopics();})),on($('#btnExport'),_0x44f7ae(0x30e),()=>storageManager[_0x44f7ae(0x333)](data)),on($('#importFile'),_0x44f7ae(0x1b4),_0xed6ce6=>{const _0x305d0c=_0x44f7ae,_0x585851=_0xed6ce6['target'][_0x305d0c(0x3b1)][0x0];if(!_0x585851)return;storageManager[_0x305d0c(0x42d)](_0x585851)[_0x305d0c(0x186)](async _0x41629d=>{const _0x4f3200=_0x305d0c;data=_0x41629d,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),toast(_0x4f3200(0x1a6)),renderAll();})['catch'](_0x137c50=>toast(_0x305d0c(0x486)+_0x137c50[_0x305d0c(0x27e)])),_0xed6ce6[_0x305d0c(0x26b)][_0x305d0c(0x1bb)]=null;}),on($(_0x44f7ae(0x2a5)),_0x44f7ae(0x30e),()=>{const _0x189971=_0x44f7ae,_0x505bdc=$(_0x189971(0x226)),_0x8232ea=_0x505bdc?_0x505bdc[_0x189971(0x1bb)]:'';if(!_0x8232ea){toast(_0x189971(0x388));return;}showConfirmModal('Xác\x20nhận\x20phục\x20hồi',_0x189971(0x239)+new Date(_0x8232ea)[_0x189971(0x25d)]()+_0x189971(0x420),_0x5ab8cd=>{const _0x8ab681=_0x189971;_0x5ab8cd&&storageManager[_0x8ab681(0x277)](_0x8232ea)[_0x8ab681(0x186)](_0x14e1a2=>{const _0x1833a3=_0x8ab681;data=_0x14e1a2,toast(_0x1833a3(0x3ee)),setTimeout(()=>window['location'][_0x1833a3(0x196)](),0x5dc);})[_0x8ab681(0x49f)](_0x388209=>{const _0x419149=_0x8ab681;toast(_0x419149(0x473)+_0x388209[_0x419149(0x27e)]);});});}),on($('#set_theme_color'),_0x44f7ae(0x1bf),_0x926fc5=>{const _0xcfbf10=_0x44f7ae,_0x47b841=_0x926fc5[_0xcfbf10(0x26b)][_0xcfbf10(0x1bb)];applyTheme(_0x47b841);if(_0x47b841===_0xcfbf10(0x2a1)||_0x47b841==='pastel'){const _0x3c8b52=$(_0xcfbf10(0x24f));_0x3c8b52&&(_0x3c8b52[_0xcfbf10(0x3a5)]=![],toast(_0xcfbf10(0x35e),0x7d0));try{document['body'][_0xcfbf10(0x34c)][_0xcfbf10(0x40e)](_0xcfbf10(0x21e),_0xcfbf10(0x35d));}catch(_0x4c5ae){}}else{const _0x1c5ab6=$(_0xcfbf10(0x24f));_0x1c5ab6&&(_0x1c5ab6[_0xcfbf10(0x3a5)]=!![]);try{updateYouTubePlayer();}catch(_0x20d8f2){}}}),on($('#btnSettings'),_0x44f7ae(0x30e),openSettings),on($(_0x44f7ae(0x236)),_0x44f7ae(0x30e),()=>{const _0x5e5ba4=_0x44f7ae;switchView(_0x5e5ba4(0x268)),$(_0x5e5ba4(0x348))[_0x5e5ba4(0x30e)]();}),on($(_0x44f7ae(0x1f1)),'click',()=>{const _0x3bd308=_0x44f7ae;renderDashboard(),$(_0x3bd308(0x293))[_0x3bd308(0x300)][_0x3bd308(0x31c)](_0x3bd308(0x257));}),on($(_0x44f7ae(0x361)),'click',()=>{const _0x1921c0=_0x44f7ae;$(_0x1921c0(0x293))[_0x1921c0(0x300)][_0x1921c0(0x21c)](_0x1921c0(0x257));}),on($(_0x44f7ae(0x322)),_0x44f7ae(0x30e),closeSettings),on($(_0x44f7ae(0x3b6)),'click',saveSettings),on($(_0x44f7ae(0x1da)),'click',setDefaults),on($(_0x44f7ae(0x3b3)),_0x44f7ae(0x30e),()=>{ensureAudio(),playSound('work_end');}),on($('#btnToggleCustomSounds'),_0x44f7ae(0x30e),_0x2d70ec=>{const _0x1f6dc0=_0x44f7ae;_0x2d70ec['preventDefault']();const _0x52578d=$(_0x1f6dc0(0x188));if(_0x52578d)_0x52578d[_0x1f6dc0(0x300)][_0x1f6dc0(0x38e)](_0x1f6dc0(0x31d));}),on($('#btnSaveNote'),_0x44f7ae(0x30e),async()=>{const _0x492143=_0x44f7ae,_0x558ba7=getCurrentSubtopic();if(!_0x558ba7)return;const _0x44c481=pendingNoteSessionId,_0xa955f5=_0x558ba7[_0x492143(0x479)]['find'](_0x40a69e=>_0x40a69e['id']===_0x44c481);_0xa955f5&&(_0xa955f5[_0x492143(0x495)]=$(_0x492143(0x247))[_0x492143(0x1bb)][_0x492143(0x265)](),await saveData(),renderStatsHistory(),toast(_0x492143(0x3c6))),closeNoteModal();}),on($('#btnSkipNote'),'click',()=>closeNoteModal()),on($(_0x44f7ae(0x3fb)),_0x44f7ae(0x30e),addGeneralNote),on($(_0x44f7ae(0x457)),_0x44f7ae(0x30e),handleSummarizeNote),on($(_0x44f7ae(0x183)),_0x44f7ae(0x30e),handleSendMessage),on($(_0x44f7ae(0x31e)),_0x44f7ae(0x32a),_0xf53919=>{const _0x2ff21f=_0x44f7ae;if(_0xf53919[_0x2ff21f(0x3b5)]==='Enter')handleSendMessage();}),$$(_0x44f7ae(0x234))[_0x44f7ae(0x467)](_0x1d2b7b=>{const _0x37136b=_0x44f7ae;on(_0x1d2b7b,_0x37136b(0x30e),()=>{const _0x960aa4=_0x37136b,_0x3ed8dd=_0x1d2b7b[_0x960aa4(0x336)][_0x960aa4(0x3fe)];$('#chatInput')[_0x960aa4(0x1bb)]=_0x3ed8dd,$(_0x960aa4(0x31e))[_0x960aa4(0x2af)]();});}),on($(_0x44f7ae(0x40d)),_0x44f7ae(0x30e),clearChat),on($('#btnAddSubtopicTask'),_0x44f7ae(0x30e),addSubtopicTask),on($(_0x44f7ae(0x29e)),'keydown',_0x21e1a5=>{if(_0x21e1a5['key']==='Enter')addSubtopicTask();}),on($(_0x44f7ae(0x376)),'click',toggleYtSound),on($('#btnEnableSound'),_0x44f7ae(0x30e),()=>{ensureAudio(),unlockAudioChain();}),on($(_0x44f7ae(0x440)),_0x44f7ae(0x1bf),_0x59e4b2=>{const _0x3ace64=_0x44f7ae,_0x4d51f0=parseInt(_0x59e4b2[_0x3ace64(0x26b)][_0x3ace64(0x1bb)],0xa);ytPlayer&&ytPlayer[_0x3ace64(0x498)]&&ytPlayer['setVolume'](_0x4d51f0);}),on($(_0x44f7ae(0x2e5)),_0x44f7ae(0x1bf),handleYoutubeUrlInput),$$(_0x44f7ae(0x1fa))[_0x44f7ae(0x467)](_0x393e6e=>{const _0x9a1513=_0x44f7ae;_0x393e6e[_0x9a1513(0x22e)](_0x9a1513(0x30e),()=>{const _0x14a243=_0x9a1513,_0x4af52e=_0x393e6e[_0x14a243(0x336)][_0x14a243(0x254)],_0x35bb6e=data?.[_0x14a243(0x3cc)]?.['currentView']||_0x14a243(0x2ec);if(_0x35bb6e===_0x4af52e&&_0x4af52e!==_0x14a243(0x2ec))switchView('timer');else switchView(_0x4af52e);});}),$$(_0x44f7ae(0x49e))[_0x44f7ae(0x467)](_0x36c575=>{const _0x57b7cc=_0x44f7ae;_0x36c575[_0x57b7cc(0x22e)](_0x57b7cc(0x30e),()=>{const _0x32bf3d=_0x57b7cc,_0x590fa9=_0x36c575[_0x32bf3d(0x336)][_0x32bf3d(0x424)],_0x2142e6=_0x36c575[_0x32bf3d(0x3f9)](_0x32bf3d(0x32d));if(!_0x2142e6)return;_0x2142e6[_0x32bf3d(0x260)](_0x32bf3d(0x49e))['forEach'](_0x26c5a5=>_0x26c5a5['classList'][_0x32bf3d(0x21c)](_0x32bf3d(0x314))),_0x36c575[_0x32bf3d(0x300)][_0x32bf3d(0x31c)](_0x32bf3d(0x314)),_0x2142e6[_0x32bf3d(0x260)](_0x32bf3d(0x383))[_0x32bf3d(0x467)](_0x107aa0=>{const _0x3ab61f=_0x32bf3d;_0x107aa0[_0x3ab61f(0x300)]['remove'](_0x3ab61f(0x314)),_0x107aa0[_0x3ab61f(0x34c)][_0x3ab61f(0x3ab)]=_0x3ab61f(0x35d);});const _0x51ebc2=_0x2142e6['querySelector']('#'+_0x590fa9);_0x51ebc2&&(_0x51ebc2['classList'][_0x32bf3d(0x31c)]('active'),_0x51ebc2['style']['display']=_0x32bf3d(0x195),_0x2142e6[_0x32bf3d(0x3f9)](_0x32bf3d(0x470))&&(_0x51ebc2[_0x32bf3d(0x34c)][_0x32bf3d(0x3ab)]=_0x32bf3d(0x3e8)));});});const _0x13ebe3=$(_0x44f7ae(0x46e));function _0x2ab207(_0x3e04e2,_0xe30e46=null){const _0x6b2fad=_0x44f7ae;try{document[_0x6b2fad(0x2d4)](_0x6b2fad(0x428),![],!![]);}catch(_0x59fdb1){}try{document[_0x6b2fad(0x2d4)](_0x3e04e2,![],_0xe30e46);}catch(_0x571023){}if(_0x13ebe3)_0x13ebe3[_0x6b2fad(0x2af)]();}on($(_0x44f7ae(0x481)),'click',()=>_0x2ab207('bold')),on($(_0x44f7ae(0x324)),_0x44f7ae(0x30e),()=>_0x2ab207(_0x44f7ae(0x367))),on($(_0x44f7ae(0x1af)),'click',()=>_0x2ab207(_0x44f7ae(0x341),_0x44f7ae(0x2d6))),on($(_0x44f7ae(0x253)),_0x44f7ae(0x30e),()=>_0x2ab207('insertOrderedList')),on($(_0x44f7ae(0x2f9)),_0x44f7ae(0x30e),()=>_0x2ab207(_0x44f7ae(0x1ba)));const _0x5e9ef9=$('.color-picker-wrapper'),_0x4ba14f=$(_0x44f7ae(0x323));on($(_0x44f7ae(0x232)),_0x44f7ae(0x30e),_0x52053c=>{const _0x564f30=_0x44f7ae;if(!_0x4ba14f)return;_0x52053c[_0x564f30(0x3e5)](),_0x4ba14f[_0x564f30(0x300)]['toggle']('hidden');}),$$(_0x44f7ae(0x24c))[_0x44f7ae(0x467)](_0x15218d=>{on(_0x15218d,'click',_0x17f6d0=>{const _0x26f729=_0x50e5;_0x17f6d0[_0x26f729(0x359)]();const _0x283b40=_0x15218d[_0x26f729(0x336)][_0x26f729(0x2c0)]||'';let _0x41d486=_0x283b40;try{const _0x59434b=_0x283b40[_0x26f729(0x1ec)](/--[a-zA-Z0-9_-]+/);if(_0x59434b)_0x41d486=getComputedStyle(document[_0x26f729(0x3e7)])[_0x26f729(0x211)](_0x59434b[0x0])['trim']();}catch(_0x1d80f2){}_0x2ab207('foreColor',_0x41d486);if(_0x4ba14f)_0x4ba14f['classList']['add'](_0x26f729(0x31d));});}),on(document,'click',_0x42dff9=>{const _0x6200b4=_0x44f7ae;if(!_0x5e9ef9||!_0x4ba14f)return;!_0x5e9ef9[_0x6200b4(0x2de)](_0x42dff9[_0x6200b4(0x26b)])&&!_0x4ba14f[_0x6200b4(0x300)][_0x6200b4(0x2de)](_0x6200b4(0x31d))&&_0x4ba14f[_0x6200b4(0x300)]['add'](_0x6200b4(0x31d));});function _0x34fc4a(_0x35642d){const _0x4393e7=_0x44f7ae,_0x3cdb5e=getCurrentSubtopic();if(!_0x3cdb5e){toast(_0x4393e7(0x193));return;}_0x3cdb5e['methods']=Array[_0x4393e7(0x1ac)](_0x3cdb5e[_0x4393e7(0x2ef)])?_0x3cdb5e[_0x4393e7(0x2ef)]:[];const _0x1ef9a2=_0x3cdb5e[_0x4393e7(0x2ef)],_0x131041=_0x35642d?_0x1ef9a2[_0x4393e7(0x347)](_0x3565e0=>_0x3565e0['id']===_0x35642d):null;$(_0x4393e7(0x18b))[_0x4393e7(0x1bb)]=_0x131041&&_0x131041['id']||'',$('#methodEditorTitle')['textContent']=_0x131041?'Chỉnh-sửa\x20Tri\x20thức':_0x4393e7(0x1b5),$(_0x4393e7(0x1f8))[_0x4393e7(0x1bb)]=_0x131041&&_0x131041[_0x4393e7(0x454)]||'';const _0x10d1d3=$('#methodEditorContentInput');if(_0x10d1d3)_0x10d1d3['innerHTML']=_0x131041&&_0x131041['content']||'';$(_0x4393e7(0x343))[_0x4393e7(0x300)][_0x4393e7(0x31c)](_0x4393e7(0x257));try{trapFocus($('#modalMethodEditor'));}catch(_0x3853d4){}try{const _0x20a953=$(_0x4393e7(0x2ca));if(_0x20a953){const _0x1a8e1b=!!(data?.['settings']?.[_0x4393e7(0x240)]&&data[_0x4393e7(0x3cc)][_0x4393e7(0x240)]['trim']());_0x20a953[_0x4393e7(0x3f0)]=!_0x1a8e1b,_0x20a953[_0x4393e7(0x454)]=_0x1a8e1b?_0x4393e7(0x2a2):_0x4393e7(0x39d);}}catch(_0x4bcebf){}}on($(_0x44f7ae(0x3d8)),_0x44f7ae(0x30e),()=>{const _0xbac9b6=_0x44f7ae;$(_0xbac9b6(0x343))[_0xbac9b6(0x300)][_0xbac9b6(0x21c)](_0xbac9b6(0x257));try{releaseFocus();}catch(_0x47c113){}}),on($(_0x44f7ae(0x3b7)),_0x44f7ae(0x30e),async()=>{const _0x1966a4=_0x44f7ae,_0x57813f=getCurrentSubtopic();if(!_0x57813f){toast(_0x1966a4(0x193));return;}_0x57813f[_0x1966a4(0x2ef)]=Array['isArray'](_0x57813f[_0x1966a4(0x2ef)])?_0x57813f[_0x1966a4(0x2ef)]:[];const _0x19d5bd=$('#methodEditorId')[_0x1966a4(0x1bb)]||uid('m'),_0x2b239b=($(_0x1966a4(0x1f8))[_0x1966a4(0x1bb)]||'')[_0x1966a4(0x265)](),_0x4f638b=$(_0x1966a4(0x46e)),_0x3f234d=_0x4f638b?_0x4f638b['innerHTML']||'':'',_0x300585=_0x57813f['methods'][_0x1966a4(0x3dd)](_0x475c0e=>_0x475c0e['id']===_0x19d5bd),_0x21bea5={'id':_0x19d5bd,'title':_0x2b239b,'content':_0x3f234d};if(_0x300585>=0x0)_0x57813f[_0x1966a4(0x2ef)][_0x300585]=_0x21bea5;else _0x57813f[_0x1966a4(0x2ef)]['unshift'](_0x21bea5);await storageManager[_0x1966a4(0x1c9)](_0x1966a4(0x25e),_0x57813f),renderMethods(),$('#modalMethodEditor')[_0x1966a4(0x300)][_0x1966a4(0x21c)](_0x1966a4(0x257));try{releaseFocus();}catch(_0x2f8dc2){}}),on($(_0x44f7ae(0x2ca)),'click',async()=>{const _0x4be259=_0x44f7ae,_0x239593=$(_0x4be259(0x46e));if(!_0x239593)return;const _0x19d440=(_0x239593[_0x4be259(0x3ef)]||'')['trim']();if(!_0x19d440||_0x19d440[_0x4be259(0x1ae)]<0x14){toast(_0x4be259(0x42a));return;}const _0x5bf5c1=$(_0x4be259(0x2ca));_0x5bf5c1&&(_0x5bf5c1[_0x4be259(0x3f0)]=!![],_0x5bf5c1[_0x4be259(0x200)]=_0x4be259(0x27a));const _0x11c762='Phân\x20tích\x20và\x20định\x20dạng\x20lại\x20đoạn\x20văn\x20bản\x20sau\x20đây\x20thành\x20mã\x20HTML\x20sạch.\x20Sử\x20dụng\x20các\x20thẻ\x20sau:\x0a-\x20Dùng\x20<h4>\x20cho\x20các\x20tiêu\x20đề\x20chính.\x0a-\x20Dùng\x20<strong>\x20để\x20nhấn\x20mạnh\x20các\x20thuật\x20ngữ\x20hoặc\x20ý\x20tưởng\x20quan\x20trọng.\x0a-\x20Dùng\x20<i>\x20cho\x20các\x20câu\x20ghi\x20chú\x20hoặc\x20trích\x20dẫn.\x0a-\x20Dùng\x20<ol>\x20và\x20<li>\x20cho\x20các\x20danh\x20sách\x20có\x20thứ\x20tự.\x0a-\x20Dùng\x20<ul>\x20và\x20<li>\x20cho\x20các\x20danh\x20sách\x20không\x20có\x20thứ\x20tự.\x0a-\x20Bọc\x20các\x20đoạn\x20văn\x20thông\x20thường\x20trong\x20thẻ\x20<p>.\x0aVăn\x20bản\x20cần\x20định\x20dạng:\x0a\x0a\x22'+_0x19d440+'\x22',_0x84f3cf=await callGeminiAPI(_0x11c762);_0x84f3cf?(_0x239593[_0x4be259(0x200)]=_0x84f3cf,toast(_0x4be259(0x355))):toast('AI\x20không\x20thể\x20định\x20dạng\x20lúc\x20này.'),_0x5bf5c1&&(_0x5bf5c1[_0x4be259(0x3f0)]=![],_0x5bf5c1[_0x4be259(0x200)]=_0x4be259(0x220));}),on($(_0x44f7ae(0x3d9)),_0x44f7ae(0x30e),()=>{const _0x231b51=_0x44f7ae;if(!getCurrentSubtopic()){toast(_0x231b51(0x193));return;}_0x34fc4a();});const _0x4c387d=document[_0x44f7ae(0x35a)]('#view-methods');_0x4c387d&&_0x4c387d[_0x44f7ae(0x22e)]('click',_0x12b1b5=>{const _0x445238=_0x44f7ae,_0x1d165c=_0x12b1b5[_0x445238(0x26b)]['closest']&&_0x12b1b5[_0x445238(0x26b)][_0x445238(0x3f9)](_0x445238(0x18f)),_0x44889a=!_0x1d165c&&_0x12b1b5[_0x445238(0x26b)]['closest']&&_0x12b1b5[_0x445238(0x26b)][_0x445238(0x3f9)]('.method-delete');if(_0x1d165c){_0x12b1b5[_0x445238(0x359)](),_0x12b1b5['stopPropagation']();const _0x582bb1=_0x1d165c[_0x445238(0x336)]['id'];if(_0x582bb1)_0x34fc4a(_0x582bb1);return;}if(_0x44889a){_0x12b1b5[_0x445238(0x359)](),_0x12b1b5['stopPropagation']();const _0x236530=_0x44889a[_0x445238(0x336)]['id'];if(!_0x236530)return;const _0x82bd92=getCurrentSubtopic();if(!_0x82bd92)return;_0x82bd92['methods']=Array[_0x445238(0x1ac)](_0x82bd92['methods'])?_0x82bd92[_0x445238(0x2ef)]:[];const _0x22ff5e=_0x82bd92['methods'][_0x445238(0x347)](_0x26d5e1=>_0x26d5e1['id']===_0x236530);if(!_0x22ff5e)return;showConfirmModal(_0x445238(0x351),_0x445238(0x3bb)+(_0x22ff5e[_0x445238(0x454)]||'')+'\x22?',async _0x17c460=>{const _0x3cef86=_0x445238;if(!_0x17c460)return;_0x82bd92[_0x3cef86(0x2ef)]=_0x82bd92[_0x3cef86(0x2ef)]['filter'](_0x4e0bde=>_0x4e0bde['id']!==_0x236530),await storageManager[_0x3cef86(0x1c9)](_0x3cef86(0x25e),_0x82bd92),renderMethods();});}});$$(_0x44f7ae(0x19b))[_0x44f7ae(0x467)](_0x340ac9=>{const _0xab715d=_0x44f7ae;_0x340ac9['addEventListener'](_0xab715d(0x30e),()=>{const _0x182b59=_0xab715d;editingPreset=_0x340ac9[_0x182b59(0x336)][_0x182b59(0x3be)],highlightPresetSelector(),loadEditingPresetFields();});}),$$('.presets\x20button')[_0x44f7ae(0x467)](_0x543110=>{const _0x2897d9=_0x44f7ae;_0x543110[_0x2897d9(0x22e)](_0x2897d9(0x30e),_0x17477a=>{const _0x11ee2b=_0x2897d9,_0x40976b=_0x17477a[_0x11ee2b(0x26b)][_0x11ee2b(0x336)][_0x11ee2b(0x1d0)],_0x204176=data[_0x11ee2b(0x3cc)][_0x11ee2b(0x1d0)];if(_0x40976b===_0x204176)return;timer[_0x11ee2b(0x18e)]!==_0x11ee2b(0x317)?showConfirmModal('Xác\x20nhận\x20chuyển\x20đổi',_0x11ee2b(0x42b)+_0x40976b+_0x11ee2b(0x384),_0x2ce215=>{const _0x35d093=_0x11ee2b;_0x2ce215&&(timer[_0x35d093(0x2cf)](),timer[_0x35d093(0x34d)](_0x40976b),renderAll(),toast(_0x35d093(0x331)+_0x40976b+'.'));}):(timer[_0x11ee2b(0x34d)](_0x40976b),renderAll(),toast('Đã\x20chuyển\x20sang\x20Kiểu\x20'+_0x40976b+'.'));});}),on($('#btnStart'),_0x44f7ae(0x30e),()=>timer[_0x44f7ae(0x406)]()),on($(_0x44f7ae(0x20d)),_0x44f7ae(0x30e),()=>timer[_0x44f7ae(0x1d9)]()),on($(_0x44f7ae(0x461)),_0x44f7ae(0x30e),()=>timer[_0x44f7ae(0x1b7)]()),on($(_0x44f7ae(0x373)),_0x44f7ae(0x30e),()=>timer[_0x44f7ae(0x20c)]()),on($(_0x44f7ae(0x1e4)),'click',()=>timer['skip']()),on($('#btnReset'),_0x44f7ae(0x30e),()=>timer['reset']()),on($('#btnBreakEarly'),_0x44f7ae(0x30e),()=>timer[_0x44f7ae(0x2da)]()),on($(_0x44f7ae(0x37a)),'change',_0x49b0cb=>{const _0x158e5f=_0x44f7ae;handleFileUpload(_0x49b0cb[_0x158e5f(0x26b)]['files'][0x0],async _0x70c2db=>{const _0x453ecd=_0x158e5f;data[_0x453ecd(0x3cc)]['customBg']=_0x70c2db,await saveData(),applyCustomBg(),toast(_0x453ecd(0x228));}),_0x49b0cb[_0x158e5f(0x26b)][_0x158e5f(0x1bb)]=null;}),on($(_0x44f7ae(0x271)),_0x44f7ae(0x30e),async()=>{const _0x37587e=_0x44f7ae;data['settings'][_0x37587e(0x45e)]='',data[_0x37587e(0x3cc)][_0x37587e(0x3c7)]=![],await saveData(),applyCustomBg(),toast(_0x37587e(0x3bd)),$(_0x37587e(0x470))[_0x37587e(0x300)]['contains']('show')&&openSettings();}),on($(_0x44f7ae(0x27c)),_0x44f7ae(0x1b4),_0xf4952=>{const _0x250351=_0x44f7ae;handleFileUpload(_0xf4952[_0x250351(0x26b)][_0x250351(0x3b1)][0x0],async _0x4bf057=>{const _0x30696e=_0x250351;data[_0x30696e(0x3cc)][_0x30696e(0x325)][_0x30696e(0x246)]=_0x4bf057,await saveData(),toast(_0x30696e(0x26d));}),_0xf4952[_0x250351(0x26b)][_0x250351(0x1bb)]=null;}),on($('#uploadSoundBreak'),_0x44f7ae(0x1b4),_0xf0a891=>{const _0x21866e=_0x44f7ae;handleFileUpload(_0xf0a891[_0x21866e(0x26b)][_0x21866e(0x3b1)][0x0],async _0x70ec4a=>{const _0x47ab68=_0x21866e;data[_0x47ab68(0x3cc)][_0x47ab68(0x325)][_0x47ab68(0x48b)]=_0x70ec4a,await saveData(),toast('Đã\x20lưu\x20âm\x20báo\x20hết\x20NGHỈ\x20NGẮN.');}),_0xf0a891[_0x21866e(0x26b)][_0x21866e(0x1bb)]=null;}),on($('#uploadSoundLong'),'change',_0xe3f6dd=>{const _0x590673=_0x44f7ae;handleFileUpload(_0xe3f6dd[_0x590673(0x26b)]['files'][0x0],async _0x2488c0=>{const _0x251e5f=_0x590673;data[_0x251e5f(0x3cc)][_0x251e5f(0x325)][_0x251e5f(0x1f3)]=_0x2488c0,await saveData(),toast(_0x251e5f(0x445));}),_0xe3f6dd[_0x590673(0x26b)][_0x590673(0x1bb)]=null;}),on($(_0x44f7ae(0x30f)),'click',toggleFullScreen),document[_0x44f7ae(0x22e)](_0x44f7ae(0x2c1),updateFullscreenButton),window[_0x44f7ae(0x22e)]('keydown',_0x25c965=>{const _0x164c1d=_0x44f7ae,_0x133dff=_0x25c965['target'],_0xd39f5=(_0x133dff[_0x164c1d(0x42e)]||'')[_0x164c1d(0x3b2)](),_0x1a22ef=[_0x164c1d(0x1bf),_0x164c1d(0x302),_0x164c1d(0x21f)][_0x164c1d(0x3cb)](_0xd39f5)||_0x133dff['isContentEditable'];if(_0x25c965[_0x164c1d(0x449)]===_0x164c1d(0x3a0)&&!_0x1a22ef){_0x25c965[_0x164c1d(0x359)]();if(timer[_0x164c1d(0x18e)]==='idle'||timer['state']===_0x164c1d(0x433))timer[_0x164c1d(0x406)]();else timer[_0x164c1d(0x1b7)]();}(_0x25c965['key']==='n'||_0x25c965[_0x164c1d(0x3b5)]==='N')&&(!_0x1a22ef&&(_0x25c965['preventDefault'](),timer['skip']()));if(_0x25c965[_0x164c1d(0x3b5)]===_0x164c1d(0x3a8)){$$('.modal')[_0x164c1d(0x467)](_0x23604d=>_0x23604d[_0x164c1d(0x300)][_0x164c1d(0x21c)]('show'));try{releaseFocus();}catch(_0x2d21c4){}}if(_0x25c965['altKey']&&!_0x1a22ef){if(_0x25c965['key']==='ArrowUp')_0x25c965[_0x164c1d(0x359)](),_0x31796e(0x0,-0xa);else{if(_0x25c965['key']===_0x164c1d(0x39c))_0x25c965[_0x164c1d(0x359)](),_0x31796e(0x0,0xa);else{if(_0x25c965[_0x164c1d(0x3b5)]===_0x164c1d(0x38d))_0x25c965['preventDefault'](),_0x31796e(-0xa,0x0);else _0x25c965[_0x164c1d(0x3b5)]===_0x164c1d(0x49d)&&(_0x25c965[_0x164c1d(0x359)](),_0x31796e(0xa,0x0));}}}}),$$(_0x44f7ae(0x371))[_0x44f7ae(0x467)](_0x484d46=>_0x484d46[_0x44f7ae(0x22e)](_0x44f7ae(0x30e),_0x122476=>{const _0x3d91a2=_0x44f7ae;if(_0x122476&&_0x122476[_0x3d91a2(0x26b)]&&_0x122476[_0x3d91a2(0x26b)]['id']===_0x3d91a2(0x24e))return;if(_0x122476[_0x3d91a2(0x26b)]===_0x484d46){_0x484d46[_0x3d91a2(0x300)][_0x3d91a2(0x21c)](_0x3d91a2(0x257));try{releaseFocus();}catch(_0x29532d){}}})),window[_0x44f7ae(0x22e)](_0x44f7ae(0x30e),_0x5cf6d4=>{const _0x59ae9d=_0x44f7ae;!_0x5cf6d4[_0x59ae9d(0x26b)][_0x59ae9d(0x3f9)](_0x59ae9d(0x34e))&&!_0x5cf6d4[_0x59ae9d(0x26b)][_0x59ae9d(0x3f9)](_0x59ae9d(0x2d0))&&closeAllMenus();});try{const _0x4cb35e=document[_0x44f7ae(0x35a)](_0x44f7ae(0x2cb));if(_0x4cb35e)_0x4cb35e[_0x44f7ae(0x22e)]('scroll',closeAllMenus);}catch(_0x41ea1f){}try{window['addEventListener'](_0x44f7ae(0x446),closeAllMenus,!![]);}catch(_0x5f1115){}window[_0x44f7ae(0x22e)](_0x44f7ae(0x2d5),()=>timer[_0x44f7ae(0x2d1)](!![]));try{const _0x1fc416=Array[_0x44f7ae(0x43d)](document['querySelectorAll']('#view-methods\x20.method-item'));_0x1fc416[_0x44f7ae(0x1ae)]&&_0x1fc416[_0x44f7ae(0x467)](_0x1b2054=>{const _0x309891=_0x44f7ae;_0x1b2054[_0x309891(0x22e)]('toggle',()=>{_0x1b2054['open']&&_0x1fc416['forEach'](_0x1b694c=>{if(_0x1b694c!==_0x1b2054)_0x1b694c['open']=![];});});});}catch(_0x3700d4){}const _0x3d32d6=$(_0x44f7ae(0x1fd));let _0x32b233=![],_0x53530a,_0x14a8a8;_0x3d32d6&&(_0x3d32d6[_0x44f7ae(0x22e)](_0x44f7ae(0x1d3),_0x34f5c7=>{const _0x5085cf=_0x44f7ae;_0x32b233=!![];const _0x47c96d=_0x3d32d6['getBoundingClientRect']();_0x53530a=_0x34f5c7[_0x5085cf(0x374)]-_0x47c96d['left'],_0x14a8a8=_0x34f5c7[_0x5085cf(0x2d7)]-_0x47c96d['top'],_0x3d32d6[_0x5085cf(0x34c)][_0x5085cf(0x2b9)]='none';}),document['addEventListener'](_0x44f7ae(0x212),_0x108409=>{const _0x28918e=_0x44f7ae;if(!_0x32b233)return;let _0x3f1fed=_0x108409[_0x28918e(0x374)]-_0x53530a,_0x119e44=_0x108409['clientY']-_0x14a8a8;const _0x1ca3b9=window[_0x28918e(0x214)]-_0x3d32d6[_0x28918e(0x329)],_0x5bf7c0=window[_0x28918e(0x407)]-_0x3d32d6['offsetHeight'];_0x3f1fed=Math[_0x28918e(0x248)](0x0,Math['min'](_0x3f1fed,_0x1ca3b9)),_0x119e44=Math[_0x28918e(0x248)](0x0,Math[_0x28918e(0x28f)](_0x119e44,_0x5bf7c0)),_0x3d32d6[_0x28918e(0x34c)][_0x28918e(0x441)]=_0x3f1fed+'px',_0x3d32d6[_0x28918e(0x34c)][_0x28918e(0x24a)]=_0x119e44+'px',_0x3d32d6['style'][_0x28918e(0x3fa)]=_0x28918e(0x309),_0x3d32d6['style']['right']=_0x28918e(0x309);}),document[_0x44f7ae(0x22e)](_0x44f7ae(0x2e3),()=>{const _0x1d68f2=_0x44f7ae;if(!_0x32b233)return;_0x32b233=![],_0x3d32d6[_0x1d68f2(0x34c)][_0x1d68f2(0x2b9)]='';}));function _0x1c120d(_0x7546f1){const _0x58d7b8=_0x44f7ae,_0x373b57=$(_0x58d7b8(0x1fd));if(!_0x373b57)return;_0x373b57[_0x58d7b8(0x34c)][_0x58d7b8(0x427)]=_0x58d7b8(0x3ca),_0x373b57['style']['transition']='',_0x373b57[_0x58d7b8(0x34c)][_0x58d7b8(0x441)]=_0x58d7b8(0x309),_0x373b57['style'][_0x58d7b8(0x24a)]='auto',_0x373b57[_0x58d7b8(0x34c)][_0x58d7b8(0x3c9)]='auto',_0x373b57[_0x58d7b8(0x34c)][_0x58d7b8(0x3fa)]=_0x58d7b8(0x309);const _0x18964f=0x10;_0x7546f1==='tl'&&(_0x373b57[_0x58d7b8(0x34c)]['left']=_0x18964f+'px',_0x373b57[_0x58d7b8(0x34c)][_0x58d7b8(0x24a)]=_0x18964f+'px'),_0x7546f1==='tr'&&(_0x373b57[_0x58d7b8(0x34c)][_0x58d7b8(0x3c9)]=_0x18964f+'px',_0x373b57['style'][_0x58d7b8(0x24a)]=_0x18964f+'px'),_0x7546f1==='bl'&&(_0x373b57[_0x58d7b8(0x34c)][_0x58d7b8(0x441)]=_0x18964f+'px',_0x373b57['style'][_0x58d7b8(0x3fa)]=_0x18964f+'px'),_0x7546f1==='br'&&(_0x373b57[_0x58d7b8(0x34c)]['right']=_0x18964f+'px',_0x373b57['style'][_0x58d7b8(0x3fa)]=_0x18964f+'px');}function _0x31796e(_0x3de31a,_0x479900){const _0x3f1c07=_0x44f7ae,_0x3a5524=$(_0x3f1c07(0x1fd));if(!_0x3a5524)return;const _0x25b51e=_0x3a5524[_0x3f1c07(0x182)](),_0x3e7b05=Math['max'](0x0,Math[_0x3f1c07(0x28f)](_0x25b51e[_0x3f1c07(0x441)]+_0x3de31a,window[_0x3f1c07(0x214)]-_0x3a5524[_0x3f1c07(0x329)])),_0x858cfd=Math[_0x3f1c07(0x248)](0x0,Math[_0x3f1c07(0x28f)](_0x25b51e['top']+_0x479900,window['innerHeight']-_0x3a5524['offsetHeight']));_0x3a5524[_0x3f1c07(0x34c)]['left']=_0x3e7b05+'px',_0x3a5524[_0x3f1c07(0x34c)][_0x3f1c07(0x24a)]=_0x858cfd+'px',_0x3a5524[_0x3f1c07(0x34c)]['right']='auto',_0x3a5524[_0x3f1c07(0x34c)][_0x3f1c07(0x3fa)]=_0x3f1c07(0x309);}}function toggleBackgroundView(){const _0x52bb3e=_0x2d92ab,_0x135371=document[_0x52bb3e(0x3e7)];_0x135371[_0x52bb3e(0x300)][_0x52bb3e(0x38e)](_0x52bb3e(0x482));const _0x3c841e=_0x135371['classList'][_0x52bb3e(0x2de)](_0x52bb3e(0x482)),_0x325394=$('#btnToggleBg');if(!_0x325394)return;_0x3c841e?(_0x325394['title']='Hiện\x20giao\x20diện',_0x325394[_0x52bb3e(0x200)]=_0x52bb3e(0x1e2)):(_0x325394['title']=_0x52bb3e(0x203),_0x325394['innerHTML']=_0x52bb3e(0x3a1));}function updateMainViewVisibility(){const _0x11f8e1=_0x2d92ab,_0xb64891=!!getCurrentSubtopic(),_0x3e6289=$(_0x11f8e1(0x3f5)),_0x1ec377=$(_0x11f8e1(0x39b));_0x1ec377&&_0x1ec377[_0x11f8e1(0x300)][_0x11f8e1(0x38e)](_0x11f8e1(0x31d),_0xb64891),_0x3e6289&&(_0xb64891?_0x3e6289[_0x11f8e1(0x300)][_0x11f8e1(0x21c)](_0x11f8e1(0x43f)):_0x3e6289[_0x11f8e1(0x300)][_0x11f8e1(0x31c)](_0x11f8e1(0x43f)));}function updatePresetButtonsText(){const _0x3146b2=_0x2d92ab,_0x1ecedd=data[_0x3146b2(0x3cc)],_0x550b20=_0x1ecedd[_0x3146b2(0x474)],_0x251694=_0x1ecedd[_0x3146b2(0x2dd)],_0x101255=_0x1ecedd[_0x3146b2(0x1d7)][_0x3146b2(0x423)],_0x408bc6=_0x1ecedd[_0x3146b2(0x1d7)]['B_work'],_0x3a3a90=$(_0x3146b2(0x290)),_0x1e4d5e=$(_0x3146b2(0x30c)),_0x2abe27=$(_0x3146b2(0x218));_0x3a3a90&&(_0x3a3a90[_0x3146b2(0x3ef)]=_0x550b20+'×'+_0x101255+_0x3146b2(0x392)),_0x1e4d5e&&(_0x1e4d5e[_0x3146b2(0x3ef)]=_0x251694+'×'+_0x408bc6+_0x3146b2(0x249)),_0x2abe27&&(_0x2abe27[_0x3146b2(0x3ef)]='🌊\x20Flow');}function renderAll(){const _0x3b92c6=_0x2d92ab;updatePresetButtonsText();const _0x24705f=data[_0x3b92c6(0x3cc)][_0x3b92c6(0x1d0)];$$('.presets\x20button')[_0x3b92c6(0x467)](_0x420e90=>{const _0x4ee4e9=_0x3b92c6,_0x339bd9=_0x420e90[_0x4ee4e9(0x336)][_0x4ee4e9(0x1d0)]===_0x24705f;_0x420e90[_0x4ee4e9(0x300)][_0x4ee4e9(0x38e)]('acc',_0x339bd9),_0x420e90[_0x4ee4e9(0x300)][_0x4ee4e9(0x38e)](_0x4ee4e9(0x49a),!_0x339bd9),_0x420e90[_0x4ee4e9(0x319)](_0x4ee4e9(0x2d3),_0x339bd9);}),updateMainViewVisibility(),timer['setPreset'](data[_0x3b92c6(0x3cc)][_0x3b92c6(0x1d0)],{'silent':!![]}),renderTopics(),renderContextBadge(),renderStatsHistory(),renderGeneralNotes(),renderMethods(),renderChat(),applyCustomBg(),applyPanelOpacity(),renderSubtopicTasks(),updateFullscreenButton(),switchView(data[_0x3b92c6(0x3cc)][_0x3b92c6(0x229)]);}function toggleFullScreen(){const _0x1d7fcf=_0x2d92ab;!document[_0x1d7fcf(0x267)]?document[_0x1d7fcf(0x297)][_0x1d7fcf(0x1f5)]()['catch'](_0x23654b=>{toast('Lỗi:\x20Không\x20thể\x20bật\x20chế\x20độ\x20toàn\x20màn\x20hình:\x20'+_0x23654b['message']);}):document[_0x1d7fcf(0x1c5)]&&document[_0x1d7fcf(0x1c5)]();}function _0x5325(){const _0x230497=['click','#btnFullscreen','longBreakIntervalA','B_short','interval','1822272UuwWiJ','active','<div\x20class=\x22tiny\x22>Chưa\x20có\x20ghi\x20chú.</div>','#subtopicTasksList','idle','method-item','setAttribute','timerState_','reduce','add','hidden','#chatInput','volume','padStart','chatHistory','#btnCloseSettings','.color-palette','#toolItalic','customSounds','<div>','#welcomePanel\x20p','candidates','offsetWidth','keydown','<p>Để\x20không\x20bị\x20choáng\x20ngợp\x20khi\x20học\x20một\x20lĩnh\x20vực\x20mới,\x20hãy\x20tập\x20trung\x20vào\x2020%\x20kiến\x20thức\x20cốt\x20lõi\x20mang\x20lại\x2080%\x20kết\x20quả\x20(Liều\x20lượng\x20Hiệu\x20quả\x20Tối\x20thiểu).</p><h4>20%\x20cốt\x20lõi:\x20Áp\x20dụng\x20Khung\x20Phân\x20tích\x205\x20Bước\x20để\x20xác\x20định\x2020%\x20quan\x20trọng\x20nhất:</h4><ol><li><strong>Xác\x20định\x20Kết\x20quả:</strong>\x20Mục\x20tiêu\x20cuối\x20cùng\x20của\x20bạn\x20là\x20gì?\x20(ví\x20dụ:\x20xây\x20dựng\x20được\x20một\x20trang\x20web).</li><li><strong>Phân\x20tích\x20Nền\x20tảng:</strong>\x20Tìm\x203-5\x20nguyên\x20lý\x20bất\x20biến\x20của\x20ngành.</li><li><strong>Nhận\x20diện\x20Lỗi\x20sai\x20Phổ\x20biến:</strong>\x20Học\x20cách\x20tránh\x20những\x20lỗi\x20mà\x20người\x20mới\x20hay\x20mắc\x20phải.</li><li><strong>Tìm\x20\x22Yếu\x20tố\x20Nhân\x22:</strong>\x20Kỹ\x20năng\x20nào\x20sẽ\x20giúp\x20học\x20mọi\x20thứ\x20khác\x20dễ\x20dàng\x20hơn?\x20(ví\x20dụ:\x20nhạc\x20lý\x20trong\x20âm\x20nhạc).</li><li><strong>Lập\x20bản\x20đồ\x20Ứng\x20dụng\x20Thực\x20tiễn:</strong>\x20Tập\x20trung\x20vào\x2020%\x20công\x20việc\x20chiếm\x2080%\x20thời\x20gian\x20thực\x20tế\x20của\x20ngành.</li></ol>','space','.aux-panel,\x20.modal-card','hours','timer.cycleInfo','(chưa\x20chọn)','Đã\x20chuyển\x20sang\x20Kiểu\x20','allow','exportData','createObjectURL','<p>Nguyên\x20tắc\x20cốt\x20lõi\x20của\x20kỹ\x20thuật\x20này\x20dựa\x20trên\x20một\x20ý\x20tưởng\x20duy\x20nhất:\x20\x22Nếu\x20bạn\x20không\x20thể\x20giải\x20thích\x20một\x20chủ\x20đề\x20một\x20cách\x20đơn\x20giản,\x20bạn\x20chưa\x20thực\x20sự\x20hiểu\x20nó.\x22\x20Mục\x20tiêu\x20là\x20biến\x20kiến\x20thức\x20phức\x20tạp\x20thành\x20lời\x20giải\x20thích\x20đơn\x20giản\x20đến\x20mức\x20một\x20đứa\x20trẻ\x20cũng\x20có\x20thể\x20hiểu.</p><h4>Quy\x20Trình\x204\x20Bước\x20Tinh\x20Gọn</h4><ol><li><strong>Học:</strong>\x20Chọn\x20một\x20chủ\x20đề\x20và\x20viết\x20ra\x20tất\x20cả\x20những\x20gì\x20bạn\x20biết\x20về\x20nó.</li><li><strong>Dạy:</strong>\x20Giả\x20vờ\x20dạy\x20lại\x20chủ\x20đề\x20này\x20bằng\x20ngôn\x20ngữ\x20đơn\x20giản\x20nhất\x20có\x20thể.\x20Viết\x20hoặc\x20nói\x20to\x20ra.</li><li><strong>Tìm\x20&\x20Sửa\x20Lỗi:</strong>\x20Bất\x20cứ\x20khi\x20nào\x20bạn\x20bị\x20\x22kẹt\x22,\x20phải\x20dùng\x20thuật\x20ngữ\x20phức\x20tạp,\x20hoặc\x20không\x20thể\x20giải\x20thích\x20trôi\x20chảy,\x20bạn\x20đã\x20tìm\x20thấy\x20lỗ\x20hổng\x20kiến\x20thức\x20của\x20mình.\x20Hãy\x20quay\x20lại\x20tài\x20liệu\x20gốc\x20để\x20học\x20lại\x20cho\x20đến\x20khi\x20lấp\x20được\x20lỗ\x20hổng\x20đó.</li><li><strong>Đơn\x20Giản\x20Hóa:</strong>\x20Sắp\x20xếp\x20lại\x20lời\x20giải\x20thích\x20cuối\x20cùng,\x20sử\x20dụng\x20các\x20ví\x20dụ\x20hoặc\x20phép\x20ví\x20von\x20đơn\x20giản\x20để\x20nó\x20trở\x20nên\x20mạch\x20lạc\x20và\x20dễ\x20hiểu\x20nhất.</li></ol><h4>Cốt\x20Lõi</h4><p>Kỹ\x20thuật\x20Feynman\x20buộc\x20bạn\x20phải\x20chuyển\x20từ\x20việc\x20tiếp\x20thu\x20thụ\x20động\x20(đọc,\x20nghe)\x20sang\x20chủ\x20động\x20xử\x20lý\x20thông\x20tin.\x20Quá\x20trình\x20\x22bị\x20kẹt\x22\x20khi\x20giải\x20thích\x20chính\x20là\x20công\x20cụ\x20chẩn\x20đoán\x20mạnh\x20mẽ\x20nhất,\x20nó\x20chỉ\x20ra\x20chính\x20xác\x20điểm\x20bạn\x20còn\x20yếu.</p><p><i>Cách\x20nhanh\x20nhất\x20để\x20kiểm\x20tra\x20và\x20củng\x20cố\x20sự\x20hiểu\x20biết\x20của\x20bạn\x20là\x20thử\x20dạy\x20lại\x20nó\x20cho\x20người\x20khác\x20một\x20cách\x20đơn\x20giản.</i></p>','dataset','sessionsCompleted','backgroundImage','indexOf','autoplay;\x20encrypted-media;\x20picture-in-picture','Lỗi\x20HTTP:\x20','slice','Tên\x20Chủ\x20đề\x20con\x20mới?','B_long','<strong>$1</strong>','now','formatBlock','#set_backupDays','#modalMethodEditor','Lặp\x20Lại\x20Ngắt\x20Quãng\x20(Spaced\x20Repetition):\x20Học\x20Đúng\x20Thời\x20Điểm','#set_backgroundMode','Nửa\x20nghìn\x20giờ\x20tập\x20trung.\x20Bạn\x20đã\x20dành\x20một\x20khoảng\x20thời\x20gian\x20đáng\x20kể\x20để\x20theo\x20đuổi\x20điều\x20quan\x20trọng\x20với\x20mình.\x20Mức\x20độ\x20chuyên\x20tâm\x20này\x20chắc\x20chắn\x20đang\x20tạo\x20ra\x20những\x20kết\x20quả\x20sâu\x20sắc\x20và\x20khác\x20biệt.\x20Thật\x20đáng\x20ngưỡng\x20mộ.','find','#btnAddTopic','</h4>','Rửa\x20mặt\x20hoặc\x20vỗ\x20nhẹ\x20lên\x20mặt\x20để\x20tỉnh\x20táo\x20hơn.','Enter','style','setPreset','.actions-menu-btn','button','toISOString','Xác\x20nhận\x20xóa','Chưa\x20có\x20tiêu\x20đề','Lắc\x20nhẹ\x20cổ\x20tay\x20và\x20vai\x20trong\x2030\x20giây.','Xem\x20một\x20tấm\x20ảnh\x20dễ\x20thương\x20hoặc\x20làm\x20bạn\x20vui.','AI\x20đã\x20định\x20dạng\x20xong!','16129692ZZCmed','__ytApiWatchdog','readonly','preventDefault','querySelector','/maxresdefault.jpg','#summariesList','none','Đã\x20tắt\x20nền\x20YouTube\x20để\x20hợp\x20với\x20theme\x20sáng.','BUFFERING','Bạn\x20có\x20chắc\x20muốn\x20xóa\x20Chủ\x20đề\x20\x22','#btnCloseDashboard','btn\x20small\x20danger','Chọn\x20một\x20chủ\x20đề\x20con\x20trước.','#btnToggleBg','-9999px','yt-fallback','italic','soundPermissionBar','push','enableWinddown','<option\x20value=\x22\x22>--\x20Chọn\x20ngày\x20để\x20phục\x20hồi\x20--</option>','Tự\x20nhắc:\x20Nghỉ\x20ngơi\x20đúng\x20cách\x20là\x20để\x20làm\x20việc\x20tốt\x20hơn!','work','Bước\x20ra\x20ban\x20công,\x20tận\x20hưởng\x20ánh\x20sáng\x20tự\x20nhiên.','#btnSummarize','get','.modal','Uống\x20một\x20ly\x20nước\x20để\x20giữ\x20đủ\x20nước.','#btnResume','clientX','date','#btnToggleYtSound','http','http:','#btnGenericCancel','#uploadBg','onYouTubeIframeAPIReady','\x20hidden','getAll','flowtimeBreakRatio','getIframe','PlayerState','isNaN','Tab','.tab-content','?\x20Thao\x20tác\x20này\x20sẽ\x20dừng\x20và\x20đặt\x20lại\x20phiên\x20làm\x20việc\x20hiện\x20tại.','achievedMilestones','#set_short','TẠM\x20DỪNG','Vui\x20lòng\x20chọn\x20một\x20bản\x20sao\x20lưu.','Đã\x20xóa\x20lịch\x20sử\x20chat.','<ul>','updateSettings','pomodoro_files','ArrowLeft','toggle','.subtopic-btn','Sửa\x20tên\x20Chủ\x20đề\x20con','#currentSubtopicNameChat','\x20(A)','1079469wFUOoT','map','backupDaysToKeep','Âm\x20thanh\x20đã\x20được\x20bật!','Thêm\x20Chủ\x20đề\x20con','iframe','.subtopics','loadLanguage','#welcomePanel','ArrowDown','Vui\x20lòng\x20thêm\x20Gemini\x20API\x20Key\x20trong\x20Cài\x20đặt\x20để\x20sử\x20dụng\x20tính\x20năng\x20này.','...','#stateBadge','Space','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M2\x2012s3-7\x2010-7\x2010\x207\x2010\x207-3\x207-10\x207-10-7-10-7Z\x22/><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x223\x22/></svg>','Lỗi\x20khi\x20gọi\x20Gemini\x20API:','mute','initDB','checked','set_youtubeUrl','#ytUrlFeedback','Escape','#set_apiKey','</label>','display','Massage\x20nhẹ\x20hai\x20bên\x20thái\x20dương.','#editorPreview','createdAt','topicId','Toàn\x20màn\x20hình','files','toLowerCase','#btnTestSound','#generalNotesList','key','#btnSaveSettings','#btnSaveMethod','<div\x20class=\x22tiny\x22>Chưa\x20có\x20tóm\x20tắt\x20nào.</div>','Chưa\x20chọn\x20Chủ\x20đề\x20con','https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=','Xóa\x20tri\x20thức\x20\x22','menu-active','Đã\x20xóa\x20hình\x20nền\x20tùy\x20chỉnh.','presetTarget','\x20phút\x20theo\x20Flowtime\x20(','_getStore','badge\x20state\x20break','tasks','(Không\x20tạo\x20được\x20tóm\x20tắt)','replace','sub-row','Đã\x20lưu\x20ghi\x20chú','useYtThumbnailAsBg','A_winddown','right','fixed','includes','settings','#breakSuggestionDisplay','cancel','random','POST','text','getDate','workMinutes','❌\x20Link\x20không\x20hợp\x20lệ\x20hoặc\x20không\x20được\x20hỗ\x20trợ.','getBackupList','Chu\x20kỳ\x20','status','#btnCancelMethodEditor','#btnAddMethod','topicsList','_onFinishSegment','stroke','findIndex','scrollTop','url(','#set_winddown','chime','gain','warn','Sortable','stopPropagation','Lỗi\x20lưu\x20dữ\x20liệu:\x20','body','flex','item','opacity','transaction','Nhắm\x20mắt\x20và\x20thư\x20giãn\x20trong\x20một\x20phút.','Lỗi\x20từ\x20Gemini:\x20','Phục\x20hồi\x20dữ\x20liệu\x20thành\x20công!\x20Tải\x20lại\x20trang...','textContent','disabled','absolute','Missing\x20element','prevState','onkeydown','#view-timer','height','</td></tr>','data','closest','bottom','#btnAddGeneralNote','PLAYING','script','prompt','https://www.youtube.com','join','details','#set_long','Tự\x20hỏi\x20bản\x20thân:\x20“Mình\x20cảm\x20thấy\x20thế\x20nào\x20lúc\x20này?”','save','ytUrlFeedback','start','innerHeight','\x20phút','<div\x20class=\x22tiny\x22>Chọn\x20chủ\x20đề\x20con\x20để\x20bắt\x20đầu\x20chat.</div>','width','main_settings','_sortable','#btnClearChat','setProperty','__ytApiPromise','round','btn\x20small','Creating\x20backup\x20for\x20','tid','blob:','<div\x20class=\x22tiny\x22>Vui\x20lòng\x20chọn\x20một\x20chủ\x20đề\x20con\x20để\x20xem\x20tóm\x20tắt.</div>','frequency','.timer-circle-container','name','protocol','#statSessions','onupgradeneeded','tickHandle','Đặt\x20tay\x20lên\x20ngực,\x20cảm\x20nhận\x20nhịp\x20tim\x20của\x20mình.','repeat','topic','?\x20Dữ\x20liệu\x20hiện\x20tại\x20sẽ\x20bị\x20ghi\x20đè.','toLocaleString','\x20|\x20<strong>Tổng\x20nhiệm\x20vụ:</strong>\x20','A_work','tab','test','.json','position','styleWithCSS','location','Cần\x20có\x20nội\x20dung\x20để\x20AI\x20định\x20dạng.','Bạn\x20có\x20chắc\x20muốn\x20chuyển\x20sang\x20Kiểu\x20','method-content','importData','tagName','Gửi','#set_interval','stop','badge\x20state\x20work','paused','ENDED','Đổi\x20tên\x20Chủ\x20đề','Dựa\x20vào\x20thông\x20tin\x20sau:\x0a-\x20Chủ\x20đề:\x20\x22','menu-item\x20danger','selectionStart','delete','end','longBreakIntervalB','Failed\x20to\x20load\x20YouTube\x20API','from','Gửi\x20bạn,\x2050\x20giờ\x20(Động\x20lực)','no-subtopic-selected','#ytSoundVolume','left','mode','Đã\x20dừng\x20nhạc\x20nền.','totalMinutes','Đã\x20lưu\x20âm\x20báo\x20hết\x20NGHỈ\x20DÀI.','scroll','origin','lang','code','Gợi\x20Nhớ\x20Chủ\x20Động\x20(Active\x20Recall):\x20Nguyên\x20Tắc\x20Cốt\x20Lõi\x20Để\x20Học\x20Sâu','Nắn\x20nhẹ\x20các\x20khớp\x20ngón\x20tay\x20sau\x20khi\x20gõ\x20phím.','model','<p>Nếu\x20Gợi\x20nhớ\x20chủ\x20động\x20là\x20về\x20cách\x20học,\x20thì\x20Lặp\x20lại\x20ngắt\x20quãng\x20là\x20về\x20thời\x20điểm\x20học.\x20Đây\x20là\x20một\x20hệ\x20thống\x20lên\x20lịch\x20ôn\x20tập\x20để\x20đưa\x20thông\x20tin\x20vào\x20trí\x20nhớ\x20dài\x20hạn\x20một\x20cách\x20hiệu\x20quả\x20nhất.</p><h4>Nguyên\x20Tắc\x20Cốt\x20Lõi:\x20Chống\x20Lại\x20Sự\x20Lãng\x20Quên\x20🧠</h4><p>Phương\x20pháp\x20này\x20dựa\x20trên\x20\x22Đường\x20cong\x20Lãng\x20quên\x22,\x20cho\x20thấy\x20chúng\x20ta\x20quên\x20thông\x20tin\x20nhanh\x20nhất\x20ngay\x20sau\x20khi\x20học.\x20Lặp\x20lại\x20ngắt\x20quãng\x20hoạt\x20động\x20bằng\x20cách\x20yêu\x20cầu\x20bạn\x20ôn\x20tập\x20lại\x20một\x20thông\x20tin\x20ngay\x20trước\x20khi\x20bạn\x20sắp\x20quên\x20nó.</p><p>Mỗi\x20lần\x20ôn\x20tập\x20thành\x20công\x20sẽ\x20làm\x20cho\x20khoảng\x20thời\x20gian\x20bạn\x20nhớ\x20thông\x20tin\x20đó\x20dài\x20ra.\x20Lần\x20đầu\x20bạn\x20có\x20thể\x20quên\x20sau\x201\x20ngày,\x20nhưng\x20sau\x20khi\x20ôn\x20tập,\x20bạn\x20sẽ\x20nhớ\x20được\x20trong\x203\x20ngày,\x20rồi\x201\x20tuần,\x201\x20tháng,\x20và\x20cứ\x20thế\x20xa\x20dần.</p><h4>Công\x20Cụ\x20Hiệu\x20Quả\x20Nhất:\x20Phần\x20Mềm\x20SRS\x20📱</h4><p>Thay\x20vì\x20tự\x20lên\x20lịch\x20thủ\x20công,\x20cách\x20hiệu\x20quả\x20nhất\x20là\x20sử\x20dụng\x20các\x20phần\x20mềm\x20Lặp\x20lại\x20ngắt\x20quãng\x20(Spaced\x20Repetition\x20Software\x20-\x20SRS).\x20Anki\x20được\x20xem\x20là\x20tiêu\x20chuẩn\x20vàng.\x20Nó\x20tự\x20động\x20hóa\x20hoàn\x20toàn\x20việc\x20lên\x20lịch\x20ôn\x20tập\x20cho\x20hàng\x20ngàn\x20thẻ\x20ghi\x20nhớ\x20dựa\x20trên\x20độ\x20khó\x20mà\x20bạn\x20tự\x20đánh\x20giá,\x20đảm\x20bảo\x20bạn\x20luôn\x20ôn\x20tập\x20vào\x20thời\x20điểm\x20tối\x20ưu\x20nhất.</p><h4>Sai\x20Lầm\x20Lớn\x20Nhất\x20Cần\x20Tránh\x20❌</h4><p>Lý\x20do\x20số\x20một\x20khiến\x20mọi\x20người\x20thất\x20bại\x20với\x20phương\x20pháp\x20này\x20là\x20\x22Quá\x20tải\x20Lịch\x20ôn\x20tập\x22\x20(Review\x20Overload).\x20Điều\x20này\x20xảy\x20ra\x20khi\x20bạn\x20tạo\x20quá\x20nhiều\x20thẻ\x20mới\x20mỗi\x20ngày\x20hoặc\x20bỏ\x20lỡ\x20vài\x20ngày\x20ôn\x20tập,\x20dẫn\x20đến\x20một\x20lượng\x20thẻ\x20tồn\x20đọng\x20khổng\x20lồ\x20gây\x20nản\x20chí.</p><p><strong>Giải\x20pháp\x20(20%\x20hành\x20động,\x2080%\x20kết\x20quả):</strong>\x20Hãy\x20nhất\x20quán.\x20Đặt\x20ra\x20giới\x20hạn\x20thực\x20tế\x20về\x20số\x20lượng\x20thẻ\x20mới\x20mỗi\x20ngày\x20(ví\x20dụ:\x2010-20\x20thẻ)\x20và\x20duy\x20trì\x20việc\x20ôn\x20tập\x20hàng\x20ngày.\x20Thà\x20học\x20ít\x20mà\x20đều\x20còn\x20hơn\x20học\x20dồn.</p><h4>Sự\x20Kết\x20Hợp\x20Sống\x20Còn:\x20AR\x20+\x20SR</h4><p>Lặp\x20lại\x20ngắt\x20quãng\x20(SR)\x20và\x20Gợi\x20nhớ\x20chủ\x20động\x20(AR)\x20là\x20hai\x20mặt\x20của\x20cùng\x20một\x20đồng\x20xu\x20và\x20không\x20thể\x20tách\x20rời.\x20SR\x20cung\x20cấp\x20lịch\x20trình\x20KHI\x20NÀO\x20nên\x20ôn\x20tập.\x20AR\x20là\x20hành\x20động\x20bạn\x20thực\x20hiện\x20KHI\x20ôn\x20tập.\x20Sự\x20kết\x20hợp\x20này\x20đảm\x20bảo\x20nỗ\x20lực\x20gợi\x20nhớ\x20của\x20bạn\x20xảy\x20ra\x20vào\x20\x22điểm\x20ngọt\x22\x20của\x20trí\x20nhớ.\x20Sử\x20dụng\x20Anki\x20chính\x20là\x20cách\x20triển\x20khai\x20kỹ\x20thuật\x20kết\x20hợp\x20này\x20một\x20cách\x20hiệu\x20quả\x20nhất.</p>','#timeDisplay','function','beep','input,select,textarea','var(--sub)','linearRampToValueAtTime','title','soundOn','Gemini\x20API\x20Error:','#btnSummarizeNote','＋\x20Thêm','sort','Bản\x20sao\x20lưu\x20ngày:\x20','#btnGenericOk','💡\x20Gợi\x20ý:\x20','panelOpacity','customBg','className','.nav-btn[data-view=\x22','#btnPause','https://www.youtube.com/embed/','head','webkitAudioContext','revokeObjectURL','default','forEach','hist-item','#statTasks','note-content','statusText','\x22\x20title=\x22Hoàn\x20thành\x20task\x22>\x20<label\x20for=\x22','Xóa','#methodEditorContentInput','theme','#modalSettings','note-item','Đang\x20phát\x20nhạc\x20nền...','Lỗi:\x20','cyclesA','#selectedContext','Không\x20thể\x20lưu\x20thay\x20đổi.','</tbody></table>','isConnected','sessions','sess','badge','PomodoroAppDB','removeChild','onerror','AudioContext','Năm\x20giờ\x20tập\x20trung!\x20Bạn\x20đã\x20vượt\x20qua\x20rào\x20cản\x20lớn\x20nhất:\x20sự\x20trì\x20hoãn.\x20Mỗi\x20phút\x20bạn\x20dành\x20ra\x20đều\x20là\x20một\x20lời\x20khẳng\x20định\x20cho\x20mục\x20tiêu\x20của\x20mình.\x20Hãy\x20giữ\x20vững\x20ngọn\x20lửa\x20này!','#toolBold','bg-view-mode','Sửa','&gt;','</td><td>','Nhập\x20thất\x20bại:\x20','<p>Benjamin\x20Franklin\x20đã\x20tự\x20rèn\x20luyện\x20kỹ\x20năng\x20viết\x20từ\x20kém\x20cỏi\x20trở\x20nên\x20bậc\x20thầy\x20bằng\x20một\x20phương\x20pháp\x20chủ\x20động,\x20thay\x20vì\x20chỉ\x20đọc\x20một\x20cách\x20thụ\x20động.\x20Cốt\x20lõi\x20của\x20phương\x20pháp\x20này\x20là\x20phân\x20tích,\x20tái\x20tạo,\x20và\x20so\x20sánh\x20với\x20một\x20bài\x20viết\x20chất\x20lượng\x20cao.</p><p>Đây\x20là\x20một\x20ví\x20dụ\x20kinh\x20điển\x20của\x20\x22Luyện\x20tập\x20có\x20Chủ\x20đích\x22:\x20tập\x20trung\x20vào\x20điểm\x20yếu,\x20có\x20mục\x20tiêu\x20rõ\x20ràng\x20và\x20nhận\x20phản\x20hồi\x20ngay\x20lập\x20tức.</p><h4>Quy\x20Trình\x203\x20Bước\x20Cốt\x20Lõi</h4><ol><li><strong>Phân\x20Tích\x20(Deconstruct):</strong>\x20Đọc\x20một\x20bài\x20viết\x20mẫu\x20xuất\x20sắc.\x20Sau\x20đó,\x20chỉ\x20ghi\x20lại\x20những\x20ý\x20chính\x20của\x20từng\x20đoạn\x20hoặc\x20từng\x20câu\x20ra\x20một\x20tờ\x20giấy\x20riêng.</li><li><strong>Tái\x20Tạo\x20(Reconstruct):</strong>\x20Vài\x20ngày\x20sau,\x20khi\x20đã\x20quên\x20đi\x20văn\x20phong\x20của\x20bản\x20gốc,\x20hãy\x20dùng\x20những\x20ghi\x20chú\x20ý\x20chính\x20đó\x20để\x20viết\x20lại\x20toàn\x20bộ\x20bài\x20viết\x20bằng\x20ngôn\x20ngữ\x20và\x20cách\x20diễn\x20đạt\x20của\x20chính\x20bạn.</li><li><strong>So\x20Sánh\x20&\x20Sửa\x20Lỗi\x20(Compare\x20&\x20Correct):</strong>\x20Đối\x20chiếu\x20trực\x20tiếp\x20bài\x20viết\x20của\x20bạn\x20với\x20bản\x20gốc.\x20Đây\x20là\x20bước\x20quan\x20trọng\x20nhất.\x20Nó\x20giúp\x20bạn\x20phát\x20hiện\x20ngay\x20lập\x20tức\x20những\x20lỗi\x20sai\x20về\x20từ\x20vựng,\x20cấu\x20trúc\x20câu,\x20và\x20cách\x20sắp\x20xếp\x20ý\x20tưởng\x20để\x20sửa\x20chữa.</li></ol><p>Franklin\x20còn\x20thực\x20hành\x20các\x20biến\x20thể\x20nâng\x20cao\x20như\x20xáo\x20trộn\x20thứ\x20tự\x20các\x20ý\x20chính\x20để\x20rèn\x20luyện\x20tư\x20duy\x20logic,\x20hoặc\x20chuyển\x20văn\x20xuôi\x20thành\x20thơ\x20để\x20làm\x20giàu\x20vốn\x20từ.</p><h4>Nguyên\x20Tắc\x20Vàng</h4><p>Thành\x20công\x20của\x20phương\x20pháp\x20này\x20không\x20đến\x20từ\x20việc\x20lặp\x20lại\x20vô\x20thức,\x20mà\x20đến\x20từ\x20vòng\x20lặp\x20phản\x20hồi\x20trực\x20tiếp.\x20Việc\x20so\x20sánh\x20với\x20bản\x20gốc\x20buộc\x20bạn\x20phải\x20đối\x20mặt\x20và\x20sửa\x20chữa\x20những\x20điểm\x20yếu\x20cụ\x20thể\x20của\x20mình,\x20biến\x20việc\x20học\x20từ\x20một\x20quá\x20trình\x20mơ\x20hồ\x20thành\x20một\x20bài\x20tập\x20có\x20thể\x20đo\x20lường\x20được.</p><p><i>Để\x20viết\x20giỏi\x20hơn,\x20đừng\x20chỉ\x20đọc.\x20Hãy\x20chọn\x20một\x20bài\x20viết\x20hay,\x20phân\x20tích\x20nó,\x20cố\x20gắng\x20viết\x20lại,\x20và\x20so\x20sánh\x20để\x20tìm\x20ra\x20lỗi\x20sai.</i></p>','var(--muted)','enableSessionNotes','\x20|\x20<strong>Tổng\x20phiên:</strong>\x20','break_end','methodId','createGain','generalNotes','backups','splice','chat-msg\x20','sound_unlocked','undefined','substring','note','Kiểm\x20tra\x20và\x20chỉnh\x20lại\x20tư\x20thế\x20ngồi\x20cho\x20đúng.','Thêm\x20tùy\x20chọn','setVolume','appendChild','ghost','stringify','long_break','ArrowRight','.tab-btn','catch','<tr><td>','tasksCompleted','play','getBoundingClientRect','#btnSendMessage','<ol>','pointerdown','then','IndexedDB\x20error:','#customSoundsContainer','<div\x20class=\x22tiny\x22>Vui\x20lòng\x20chọn\x20một\x20chủ\x20đề\x20con.</div>','#windDownChecklist','#methodEditorId','#historyList','Không\x20tìm\x20thấy\x20bản\x20sao\x20lưu.','state','.method-edit','Đã\x20lưu\x20cài\x20đặt','#genericTitle','Nạp\x20năng\x20lượng\x20bằng\x20một\x20món\x20ăn\x20nhẹ\x20lành\x20mạnh.','Vui\x20lòng\x20chọn\x20một\x20Chủ\x20đề\x20con\x20trước.','split','block','reload','cycles','#set_enableSessionNotes','Vui\x20lòng\x20nhập\x20ghi\x20chú\x20trước\x20khi\x20tóm\x20tắt.','summaries','#timerPresetSelector\x20button','href','#settings-flowtime','destroy','A_short','note-content-wrapper','#set_theme_color','btn\x20small\x20ghost\x20method-edit','Nghe\x20một\x20bản\x20nhạc\x20yêu\x20thích.','objectStore','Thoát\x20toàn\x20màn\x20hình','Đã\x20nhập\x20dữ\x20liệu\x20thành\x20công!','pastel','segmentTotal','.nav-btn','Failed\x20to\x20save\x20data:','Đổi\x20tên\x20Chủ\x20đề\x20con','isArray','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Chưa\x20có\x20tri\x20thức\x20nào\x20trong\x20Chủ\x20đề\x20con\x20này.</p>','length','#toolH4','setItem','breathing','activeElement','autoStartNext','change','Thêm\x20Tri\x20thức\x20mới','Đang\x20phát','pause','stats','stopVideo','insertUnorderedList','value','#modalGeneric','<p>Gợi\x20nhớ\x20chủ\x20động\x20là\x20hành\x20động\x20nỗ\x20lực\x20truy\x20xuất\x20thông\x20tin\x20từ\x20não\x20bộ\x20mà\x20không\x20nhìn\x20vào\x20tài\x20liệu.\x20Đây\x20là\x20phương\x20pháp\x20học\x20hiệu\x20quả\x20vượt\x20trội\x20so\x20với\x20việc\x20đọc\x20lại,\x20highlight\x20hay\x20tóm\x20tắt\x20một\x20cách\x20thụ\x20động.</p><h4>Nguyên\x20Tắc\x2020/80</h4><p><strong>20%\x20Cốt\x20lõi:</strong>\x20Hành\x20động\x20\x22vắt\x20óc\x22\x20để\x20nhớ\x20lại\x20thông\x20tin\x20sẽ\x20củng\x20cố\x20các\x20liên\x20kết\x20thần\x20kinh,\x20giúp\x20chuyển\x20kiến\x20thức\x20vào\x20bộ\x20nhớ\x20dài\x20hạn.\x20Cảm\x20giác\x20khó\x20khăn\x20khi\x20cố\x20gắng\x20nhớ\x20chính\x20là\x20dấu\x20hiệu\x20của\x20việc\x20học\x20tập\x20hiệu\x20quả\x20đang\x20diễn\x20ra.</p><p><strong>80%\x20Kết\x20quả:</strong>\x20Bạn\x20sẽ\x20ghi\x20nhớ\x20kiến\x20thức\x20sâu\x20và\x20lâu\x20hơn,\x20đồng\x20thời\x20biết\x20chính\x20xác\x20mình\x20đang\x20yếu\x20ở\x20đâu.</p><h4>Các\x20Phương\x20Pháp\x20Quan\x20Trọng\x20Nhất</h4><ul><li><strong>Tự\x20Kiểm\x20Tra\x20(Self-testing):</strong>\x20Thay\x20vì\x20đọc\x20lại\x20ghi\x20chú,\x20hãy\x20che\x20chúng\x20đi\x20và\x20tự\x20đặt\x20câu\x20hỏi\x20cho\x20mình.\x20Ví\x20dụ:\x20Dùng\x20flashcards\x20(thẻ\x20ghi\x20nhớ)\x20và\x20luôn\x20trả\x20lời\x20trước\x20khi\x20lật\x20xem\x20đáp\x20án.</li><li><strong>Kỹ\x20thuật\x20\x22Blurting\x22:</strong>\x20Sau\x20khi\x20học\x20một\x20chủ\x20đề,\x20hãy\x20đóng\x20sách\x20lại\x20và\x20viết\x20ra\x20giấy\x20mọi\x20thứ\x20bạn\x20có\x20thể\x20nhớ.\x20Sau\x20đó,\x20so\x20sánh\x20với\x20tài\x20liệu\x20gốc\x20để\x20lấp\x20đầy\x20những\x20lỗ\x20hổng\x20kiến\x20thức.</li><li><strong>Dạy\x20lại\x20cho\x20người\x20khác:</strong>\x20Giải\x20thích\x20một\x20khái\x20niệm\x20cho\x20người\x20khác\x20buộc\x20bạn\x20phải\x20truy\x20xuất,\x20đơn\x20giản\x20hóa\x20và\x20sắp\x20xếp\x20lại\x20thông\x20tin\x20một\x20cách\x20mạch\x20lạc.</li></ul><p><i>Tóm\x20lại:\x20Đừng\x20chỉ\x20đọc\x20lại.\x20Hãy\x20dừng\x20lại,\x20che\x20tài\x20liệu\x20đi,\x20và\x20tự\x20hỏi:\x20\x22Mình\x20thực\x20sự\x20nhớ\x20được\x20gì?\x22</i></p>','onclick','input','Chọn\x20chủ\x20đề\x20con\x20trước.','objectStoreNames','connect','Tóm\x20tắt\x20các\x20ghi\x20chú\x20sau\x20theo\x20gạch\x20đầu\x20dòng,\x20ngắn\x20gọn,\x20rõ\x20ràng:\x0a\x0a','scrollHeight','exitFullscreen','#set_work','postMessage','.sub-row','update','object','657520zQNaok','Bạn\x20có\x20chắc\x20muốn\x20xóa\x20Chủ\x20đề\x20con\x20\x22','&amp;','startsWith','version','preset','getAllKeys','Xuất','mousedown','getMonth','radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)','Gửi\x20bạn,\x2020\x20giờ\x20(Nền\x20tảng)','durations','cycleIndex','finishFlowSession','#btnDefaults','beginWork','autoBackup','<i>$1</i>','application/json','sine','#cycleInfo','note-meta','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M9.88\x209.88a3\x203\x200\x201\x200\x204.24\x204.24\x22/><path\x20d=\x22M10.73\x205.08A10.43\x2010.43\x200\x200\x201\x2012\x205c7\x200\x2010\x207\x2010\x207a13.16\x2013.16\x200\x200\x201-1.67\x202.68\x22/><path\x20d=\x22M6.61\x206.61A13.526\x2013.526\x200\x200\x200\x202\x2012s3\x207\x2010\x207a9.74\x209.74\x200\x200\x200\x205.39-1.61\x22/><line\x20x1=\x222\x22\x20y1=\x222\x22\x20x2=\x2222\x22\x20y2=\x2222\x22/></svg>','relative','#btnSkip','selectedTopicId','oncomplete','btnToggleYtSound','Hãy\x20đứng\x20dậy\x20vươn\x20vai\x20và\x20duỗi\x20người.','triangle','playVideo','src','match','#topicsList','Đứng\x20lên\x20và\x20đi\x20lại\x20vài\x20bước\x20để\x20máu\x20lưu\x20thông.','5725280dMCNIg','Player','#btnDashboard','parse','long_end','Daily\x20backup\x20successful.','requestFullscreen','Phương\x20Pháp\x20Viết\x20của\x20Benjamin\x20Franklin:\x20Học\x20Viết\x20Bằng\x20Cách\x20Tái\x20Tạo','backgroundMode','#methodEditorTitleInput','.timer-circle-progress','.nav-btn[data-view]','250\x20giờ\x20là\x20minh\x20chứng\x20cho\x20sự\x20bền\x20bỉ\x20đáng\x20kinh\x20ngạc.\x20Bạn\x20đã\x20đối\x20mặt\x20với\x20những\x20ngày\x20khó\x20khăn,\x20những\x20lúc\x20mất\x20tập\x20trung,\x20nhưng\x20bạn\x20vẫn\x20quay\x20trở\x20lại.\x20Sức\x20mạnh\x20thực\x20sự\x20nằm\x20ở\x20chính\x20sự\x20kiên\x20trì\x20này.','localeCompare','#draggableTimer','backgroundSize','https://img.youtube.com/vi/','innerHTML','strokeDasharray','100\x20giờ!\x20Đây\x20không\x20còn\x20là\x20một\x20thử\x20nghiệm\x20nữa,\x20mà\x20là\x20một\x20sự\x20đầu\x20tư\x20nghiêm\x20túc\x20cho\x20mục\x20tiêu\x20của\x20bạn.\x0a\x0aHãy\x20dành\x20một\x20chút\x20thời\x20gian\x20để\x20nhìn\x20lại:\x20100\x20giờ\x20tập\x20trung\x20này\x20đã\x20giúp\x20bạn\x20tiến\x20xa\x20đến\x20đâu?\x20Năng\x20lượng\x20bạn\x20bỏ\x20ra\x20đang\x20định\x20hình\x20nên\x20kết\x20quả.','Ẩn\x20giao\x20diện','break','#audioLongEnd','div','#set_panelOpacity','Deleted\x20old\x20backup:\x20','text/plain','#set_enableWinddown','Chưa\x20có\x20ghi\x20chú\x20để\x20tóm\x20tắt.','resume','#btnFinishFlow','span','Chúc\x20mừng\x20bạn\x20đã\x20làm\x20được\x20điều\x20khó\x20nhất:\x20Bắt\x20đầu\x20và\x20duy\x20trì.\x0a\x0a20\x20giờ\x20không\x20chỉ\x20là\x20thời\x20gian,\x20đó\x20là\x2020\x20giờ\x20bạn\x20đã\x20chiến\x20thắng\x20sự\x20xao\x20nhãng.\x20Bạn\x20đang\x20xây\x20dựng\x20một\x20nền\x20tảng\x20vững\x20chắc\x20cho\x20sự\x20kỷ\x20luật.\x20Hãy\x20tự\x20hào\x20về\x20khởi\x20đầu\x20này.','DB_NAME','getPropertyValue','mousemove','&quot;','innerWidth','selectionEnd','isCompleted','Không\x20tải\x20được\x20API\x20YouTube.\x20Kiểm\x20tra\x20mạng\x20hoặc\x20tải\x20lại\x20trang.','#btnPresetC','remaining','getSettings','Lỗi:\x20Đã\x20vượt\x20quá\x20hạn\x20mức\x20yêu\x20cầu\x20tới\x20Gemini.\x20Vui\x20lòng\x20thử\x20lại\x20sau\x20ít\x20phút.','remove','method-title','--bg-image','select','✨\x20Tự\x20động\x20định\x20dạng','Phiên\x20đã\x20hoàn\x20thành!\x20Nhấn\x20Bắt\x20đầu\x20để\x20bắt\x20đầu\x20phiên\x20tiếp\x20theo.','removing','unMute','Lỗi\x20khởi\x20tạo:\x20','Đang\x20tải\x20API\x20YouTube...','#backupList','readwrite','Đã\x20cập\x20nhật\x20hình\x20nền.','currentView','Gửi\x20bạn,\x20100\x20giờ\x20cống\x20hiến\x20(Cam\x20kết)','5.000\x20giờ\x20tập\x20trung\x20có\x20chủ\x20đích.\x20Đây\x20là\x20một\x20thành\x20tựu\x20mà\x20rất\x20ít\x20người\x20đạt\x20được.\x0a\x0aTại\x20cột\x20mốc\x20này,\x20câu\x20hỏi\x20không\x20còn\x20là\x20\x27Làm\x20thế\x20nào\x20để\x20tập\x20trung?\x27,\x20mà\x20là\x20\x27Sự\x20tập\x20trung\x20này\x20sẽ\x20được\x20dùng\x20để\x20tạo\x20ra\x20giá\x20trị\x20gì?\x27.\x20Bạn\x20không\x20chỉ\x20làm\x20việc,\x20bạn\x20đang\x20tạo\x20ra\x20di\x20sản.','durationMinutes','NGHỈ\x20DÀI','addEventListener','&lt;','.method-item','#genericInput','#toolColor','task','#aiPromptSuggestions\x20button','toString','#btnHelpCreateTopic','Nguyên\x20Tắc\x2080/20\x20Để\x20Chinh\x20Phục\x20Lĩnh\x20Vực\x20Mới','timer.selectSubtopicPrompt','Bạn\x20có\x20chắc\x20muốn\x20phục\x20hồi\x20dữ\x20liệu\x20từ\x20ngày\x20','oldIndex','</ul>','removeEventListener','open','setRangeText','Mở\x20cửa\x20sổ\x20cho\x20không\x20khí\x20mới\x20vào\x20phòng.','apiKey','actions','getPlayerState','<div\x20class=\x22tiny\x22>Chưa\x20có\x20dữ\x20liệu</div>','badge\x20state\x20long','lofi','work_end','#noteText','max','\x20(B)','top','shiftKey','.color-swatch','.topic-item','modalMethodEditor','#set_ytThumbAsBg','parentElement','A_long','finished','#toolList','view','lastBackupDate','beginWindDown','show','topic-actions','2zPJBsU','createOscillator','#btnBreakEarly','floor','toLocaleDateString','subtopics','img.youtube.com/vi/','querySelectorAll','Lỗi:\x20Gemini\x20API\x20Key\x20không\x20hợp\x20lệ\x20hoặc\x20đã\x20bị\x20thay\x20đổi.\x20Vui\x20lòng\x20kiểm\x20tra\x20lại\x20trong\x20Cài\x20đặt.','contentWindow','result','getFullYear','trim','LÀM\x20VIỆC','fullscreenElement','topics','B_winddown','getElementById','target','.topic-item.menu-active','Đã\x20lưu\x20âm\x20báo\x20hết\x20LÀM\x20VIỆC.','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Tuyệt\x20vời!\x20Không\x20còn\x20task\x20nào.</li>','B_work','AutoBackup\x20error:','#btnClearBg','Làm\x20động\x20tác\x20“thở\x20dài”\x20sâu\x20một\x20lần,\x20thả\x20lỏng\x20vai.','var(--warn)','selectedSubtopicId','Lỗi\x20mạng\x20khi\x20kết\x20nối\x20đến\x20Gemini.\x20Vui\x20lòng\x20kiểm\x20tra\x20kết\x20nối\x20internet.','actions-menu','restoreBackup','updateUI','btn\x20small\x20ghost\x20actions-menu-btn','<div\x20class=\x22spinner\x22></div>','timerState','#uploadSoundWork','HẠ\x20NHIỆT','message','#btnStart','filter','var(--danger)','#dashboardContent','wind_down','values','.\x20Vui\x20lòng\x20thử\x20lại\x20với\x20nội\x20dung\x20khác.','soundTheme','youtubeVolume','#chatMessages','<option\x20value=\x22\x22>Không\x20có\x20bản\x20sao\x20lưu\x20nào</option>','promptFeedback','user','#settings-pomodoro','currentConfig','--panel-opacity','min','#btnPresetA','</p>','#set_autoStartNext','#modalDashboard','by_topic','pauseVideo','download','documentElement','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Vui\x20lòng\x20chọn\x20một\x20Chủ\x20đề\x20con\x20để\x20xem\x20Kho\x20Tri\x20Thức.</p>','put','error','#modalNote','menu-item','blockReason','#newSubtopicTaskInput','pomodoroData_v11','async','light','Dùng\x20AI\x20để\x20tự\x20động\x20định\x20dạng\x20văn\x20bản','collapsedTopics','Kỹ\x20Thuật\x20Feynman:\x20Hiểu\x20Sâu\x20Bằng\x20Cách\x20Giải\x20Thích\x20Đơn\x20Giản','#btnRestoreBackup','createObjectStore','NGHỈ\x20NGẮN','resolve','50\x20giờ\x20tập\x20trung!\x20Thói\x20quen\x20của\x20bạn\x20đang\x20tạo\x20ra\x20động\x20lực.\x20Sự\x20nhất\x20quán\x20nhỏ\x20bé\x20mỗi\x20ngày\x20đang\x20cộng\x20hưởng\x20thành\x20những\x20bước\x20tiến\x20lớn.\x20Bạn\x20đang\x20đi\x20đúng\x20hướng,\x20hãy\x20tiếp\x20tục\x20phát\x20huy.','Không\x20nhận\x20được\x20nội\x20dung\x20hợp\x20lệ\x20từ\x20AI.','summary','youtube-player-container','#view-','defer','focus','<div><span\x20class=\x22tiny\x22>(chưa\x20có\x20ghi\x20chú)</span></div>','14mWLJHV','toast','0\x20phút','Nhẹ\x20nhàng\x20nhắm\x20mắt\x20và\x20mỉm\x20cười\x20với\x20chính\x20mình.','#modalMilestone','#genericMessage','file','Nhớ\x20uống\x20một\x20ngụm\x20nước\x20nhé!','transition','string','Bạn\x20có\x20chắc\x20muốn\x20xóa\x20tóm\x20tắt\x20này?','command','#statTotal','abs','append','color','fullscreenchange','about:blank','log','.color-picker-wrapper','#set_flowRatio','getVolume','sum','Tệp\x20không\x20đúng\x20định\x20dạng','exponentialRampToValueAtTime','#btnAutoFormat','.app-content','<li>','cover','#milestoneTitle','reset','.actions-menu','persistTimerState','aria-expanded','aria-pressed','execCommand','beforeunload','<h4>','clientY','</li>','Gửi\x20bạn,\x201.000\x20giờ\x20(Chuyển\x20hóa)','beginBreak','clear','data:','cyclesB','contains','button,\x20[href],\x20input,\x20select,\x20textarea,\x20[tabindex]:not([tabindex=\x22-1\x22])','#set_theme','Initialization\x20error:','createElement','mouseup','#set_cycles','#set_youtubeUrl','Chú\x20ý\x20đến\x20cảm\x20giác\x20nhiệt\x20độ,\x20ánh\x20sáng\x20trong\x20phòng.','Lắng\x20nghe\x20hơi\x20thở\x20ra\x20vào\x20qua\x20mũi.','getItem','onload','527201TcoBXi','unshift','timer','</div>','backgroundRepeat','methods','option','692404TlgcsP','role','<div\x20class=\x22tiny\x22>Chưa\x20có\x20phiên\x20nào</div>','sid','Thả\x20lỏng\x20hai\x20chân,\x20lắc\x20nhẹ\x20cổ\x20chân\x20dưới\x20bàn.','Thực\x20hiện\x20vài\x20động\x20tác\x20hít\x20thở\x20sâu.','/hqdefault.jpg','Lỗi\x20phát\x20âm\x20thanh:','#toolBullet','_startTick','Tóm\x20tắt\x20thất\x20bại.','newIndex','topic-header','onsuccess','cueVideoById','classList','#set_volume','textarea','currentDurations','content','all','OK.\x20Link\x20hợp\x20lệ.\x20Đang\x20chuẩn\x20bị\x20phát...','Chưa\x20có\x20link\x20hợp\x20lệ.\x20Dán\x20link\x20rồi\x20bấm\x20▶️.','\x20tiếng\x20','auto','var(--acc-2)','không\x20rõ','#btnPresetB','#toasts'];_0x5325=function(){return _0x230497;};return _0x5325();}function updateFullscreenButton(){const _0x2c3b85=_0x2d92ab,_0x331a21=$(_0x2c3b85(0x30f));document[_0x2c3b85(0x267)]?(_0x331a21[_0x2c3b85(0x200)]='↙️',_0x331a21[_0x2c3b85(0x454)]=_0x2c3b85(0x1a5)):(_0x331a21[_0x2c3b85(0x200)]='↗️',_0x331a21[_0x2c3b85(0x454)]=_0x2c3b85(0x3b0));}async function initializeApp(){const _0x2f8115=_0x2d92ab;try{await storageManager[_0x2f8115(0x3a4)]();const [_0x1c02ec,_0xb71c81,_0x3b7f6b]=await Promise[_0x2f8115(0x305)]([storageManager[_0x2f8115(0x21a)](),storageManager['getAll']('topics'),storageManager[_0x2f8115(0x37d)](_0x2f8115(0x25e))]);let _0x53fb24;if(!_0x1c02ec){const _0x163477=JSON[_0x2f8115(0x1f2)](JSON[_0x2f8115(0x49b)](defaults));await storageManager[_0x2f8115(0x38b)](_0x163477['settings']);for(const _0x39c473 of _0x163477[_0x2f8115(0x268)]){const {subtopics:_0x22dd4e,..._0x4329da}=_0x39c473;await storageManager[_0x2f8115(0x31c)](_0x2f8115(0x268),_0x4329da);for(const _0x494057 of _0x22dd4e){await storageManager[_0x2f8115(0x31c)]('subtopics',{..._0x494057,'topicId':_0x39c473['id']});}}_0x53fb24=_0x163477;}else{const _0x248f81={};for(const _0x536fa5 of _0xb71c81)_0x248f81[_0x536fa5['id']]={..._0x536fa5,'subtopics':[]};for(const _0x231ba4 of _0x3b7f6b)_0x248f81[_0x231ba4[_0x2f8115(0x3af)]]?.[_0x2f8115(0x25e)][_0x2f8115(0x369)](_0x231ba4);_0x53fb24={'version':defaults[_0x2f8115(0x1cf)],'settings':_0x1c02ec,'topics':Object[_0x2f8115(0x284)](_0x248f81)};}data=window['data']=_0x53fb24,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),renderAll();try{storageManager[_0x2f8115(0x1dc)](data);}catch(_0x4f6542){console[_0x2f8115(0x3e3)](_0x2f8115(0x270),_0x4f6542);}bindEvents(),applyTheme();}catch(_0x5a2a25){console['error'](_0x2f8115(0x2e1),_0x5a2a25),toast(_0x2f8115(0x224)+_0x5a2a25[_0x2f8115(0x27e)]);}}callGeminiAPI=async function(_0x43b020,_0x25fa61=0x3,_0x2a9151=0x3e8){const _0x5bc2ea=_0x2d92ab,_0x40d784=data?.[_0x5bc2ea(0x3cc)]?.['apiKey']||'';if(!_0x40d784)return toast('Vui\x20lòng\x20nhập\x20Gemini\x20API\x20Key\x20trong\x20phần\x20Cài\x20đặt.'),null;const _0x582d29=_0x5bc2ea(0x3ba)+_0x40d784,_0x28c3ee={'contents':[{'role':_0x5bc2ea(0x28b),'parts':[{'text':_0x43b020}]}]};try{const _0x5e6db3=await fetch(_0x582d29,{'method':_0x5bc2ea(0x3d0),'headers':{'Content-Type':'application/json'},'body':JSON[_0x5bc2ea(0x49b)](_0x28c3ee)});if(!_0x5e6db3['ok']){if(_0x5e6db3[_0x5bc2ea(0x3d7)]===0x1ad&&_0x25fa61>0x0)return await new Promise(_0x595297=>setTimeout(_0x595297,_0x2a9151)),callGeminiAPI(_0x43b020,_0x25fa61-0x1,_0x2a9151*0x2);let _0x508e44=null;try{_0x508e44=await _0x5e6db3['json']();}catch(_0x2187ac){}let _0x3b224c=_0x5bc2ea(0x33b)+_0x5e6db3[_0x5bc2ea(0x3d7)];if(_0x5e6db3[_0x5bc2ea(0x3d7)]===0x190)_0x3b224c=_0x5bc2ea(0x261);else{if(_0x5e6db3['status']===0x1ad)_0x3b224c=_0x5bc2ea(0x21b);else _0x508e44?.[_0x5bc2ea(0x29a)]?.[_0x5bc2ea(0x27e)]&&(_0x3b224c=_0x5bc2ea(0x3ed)+_0x508e44['error'][_0x5bc2ea(0x27e)]);}return toast(_0x3b224c,0xfa0),console[_0x5bc2ea(0x29a)](_0x5bc2ea(0x456),_0x508e44||_0x5e6db3[_0x5bc2ea(0x46b)]),null;}const _0x5562f2=await _0x5e6db3['json']();if(_0x5562f2[_0x5bc2ea(0x328)]&&_0x5562f2[_0x5bc2ea(0x328)][0x0]?.['content']?.['parts']?.[0x0]?.[_0x5bc2ea(0x3d1)])return formatGeminiResponse(_0x5562f2[_0x5bc2ea(0x328)][0x0][_0x5bc2ea(0x304)]['parts'][0x0][_0x5bc2ea(0x3d1)]);else{console[_0x5bc2ea(0x29a)]('API\x20response\x20structure\x20is\x20unexpected:',_0x5562f2);if(_0x5562f2[_0x5bc2ea(0x28a)]?.['blockReason'])return'Nội\x20dung\x20bị\x20chặn\x20vì:\x20'+_0x5562f2[_0x5bc2ea(0x28a)][_0x5bc2ea(0x29d)]+_0x5bc2ea(0x285);return _0x5bc2ea(0x2aa);}}catch(_0x324b40){return console[_0x5bc2ea(0x29a)](_0x5bc2ea(0x3a2),_0x324b40),toast(_0x5bc2ea(0x275),0xfa0),null;}},loadLanguage(localStorage[_0x2d92ab(0x2e8)]('lang')||'vi')[_0x2d92ab(0x186)](initializeApp);
    </script>
</body>
</html>

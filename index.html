<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Ứng dụng Pomodoro hỗ trợ học tập với tích hợp Gemini AI và giao diện hiện đại." />
    <title>Pomodoro Study App — Tích hợp Gemini AI (Giao diện mới)</title>
    <style>
    /*
    =============================================
    POMODORO STUDY APP — PHIÊN BẢN GIAO DIỆN TẬP TRUNG (v1.0)
    =============================================
    */

    :root {
      /* Theme Dark (Mặc định) - Cập nhật từ file 2 */
      --bg: #0f1222;
      --panel: #171a2e;
      --panel-rgb: 23, 26, 46; /* Thêm biến RGB cho panel */
      --muted: #212646;
      --text: #f4f6ff;
      --sub: #b7c1ff;
      --acc: #6c8cff;
      --acc-rgb: 108, 140, 255;
      --acc-2: #27d3a2;
      --purple: #a78bfa;
      --warn: #ffb020;
      --danger: #ff5c7a;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.054), 0px 4.3px 5.3px rgba(0, 0, 0, 0.077), 0px 8.1px 10px rgba(0, 0, 0, 0.095), 0px 14.5px 17.9px rgba(0, 0, 0, 0.113), 0px 27.2px 33.4px rgba(0, 0, 0, 0.136), 0px 65px 80px rgba(0, 0, 0, 0.19);
      --radius: 16px;
      --panel-opacity: 0.85;
      --gradient-border: linear-gradient(135deg, var(--acc), var(--acc-2));
    }
    
    /* === START: THÊM CÁC THEME MỚI === */
    [data-theme='light'] {
      --bg: #f5f0e8; --panel: #ffffff; --panel-rgb: 255, 255, 255; --muted: #eaddcf; --text: #4a4a4a; --sub: #8a817c; --acc: #d4a373; --acc-rgb: 212, 163, 115; --acc-2: #a3b18a; --warn: #e76f51; --danger: #d00000;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.024), 0px 4.3px 5.3px rgba(0, 0, 0, 0.037), 0px 8.1px 10px rgba(0, 0, 0, 0.045), 0px 14.5px 17.9px rgba(0, 0, 0, 0.053), 0px 27.2px 33.4px rgba(0, 0, 0, 0.066), 0px 65px 80px rgba(0, 0, 0, 0.09);
      --panel-opacity: 0.9;
      /* Ngăn nền tối mặc định khi không có ảnh */
      --bg-image: none;
    }

    [data-theme='pastel'] {
      --bg: #fde2e4; --panel: #fff1f2; --panel-rgb: 255, 241, 242; --muted: #fad2e1; --text: #595260; --sub: #8c7a8a; --acc: #c78283; --acc-rgb: 199, 130, 131; --acc-2: #7ec4cf; --warn: #f9bf45; --danger: #d7263d;
      --shadow: 0 5px 20px rgba(200,150,150,0.2);
      --panel-opacity: 0.9;
      /* Ngăn nền tối mặc định khi không có ảnh */
      --bg-image: none;
    }
    
    [data-theme='lofi'] {
      --bg: #2a2a3e; --panel: #3c3c52; --panel-rgb: 60, 60, 82; --muted: #4d4d66; --text: #e0e0ff; --sub: #a0a0c0; --acc: #ff8c69; --acc-rgb: 255, 140, 105; --acc-2: #69c6ff; --warn: #ffd700; --danger: #ff6961;
      /* === Replaced external GIF with inline data URI (offline-safe) === */
      --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9J2cnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAlJyBzdG9wLWNvbG9yPScjMmEyYTNlJy8+PHN0b3Agb2Zmc2V0PScxMDAlJyBzdG9wLWNvbG9yPScjM2MzYzUyJy8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9JzEwMCUnIGhlaWdodD0nMTAwJScgZmlsbD0ndXJsKCNnKScvPjwvc3ZnPg==');
      --panel-opacity: 0.8;
    }
    
    [data-theme='space'] {
        --bg: #000000; --panel: #1a1a2e; --panel-rgb: 26, 26, 46; --muted: #2a2a4e; --text: #e0e0ff; --sub: #b0b0e0; --acc: #00aaff; --acc-rgb: 0, 170, 255; --acc-2: #aaff00; --warn: #ffaa00; --danger: #ff0055;
        /* === Replaced external GIF with inline data URI (offline-safe) === */
        --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9J2cnIGN4PSc1MCUnIGN5PSc0MCUnIHI9JzcwJSc+PHN0b3Agb2Zmc2V0PScwJScgc3RvcC1jb2xvcj0nIzBiMGIxYScvPjxzdG9wIG9mZnNldD0nMTAwJScgc3RvcC1jb2xvcj0nIzAwMDAwMCcvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZpbGw9J3VybCgjZyknLz48L3N2Zz4=');
        --panel-opacity: 0.75;
    }
    /* === END: THÊM CÁC THEME MỚI === */

    *:focus-visible {
      outline: 2px solid var(--acc); outline-offset: 2px; border-radius: 4px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin:0; 
      font-family: system-ui, -apple-system, 'Segoe UI Variable', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Inter', sans-serif; 
      
      background-color: var(--bg);
      background-image: var(--bg-image, radial-gradient(1200px 800px at 10% -10%, #20285b 0%, #0f1222 50%, #0b0e1a 100%));
      
      background-size: cover; 
      background-position: center; 
      color:var(--text); 
      transition: background 0.5s ease, color 0.5s ease, filter 0.5s ease;
      text-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    a{color:var(--acc)}

    .app{display:flex; min-height:100vh}
    
    .app-nav {
        width: 60px;
        padding: 16px 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
        z-index: 100;
    }
    .nav-btn {
        background: transparent;
        border: none;
        color: var(--sub);
        width: 44px;
        height: 44px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all .2s ease;
        position: relative;
    }
    .nav-btn:hover { background: var(--muted); color: var(--text); }
    .nav-btn.active { background: var(--acc); color: white; }
    .nav-btn svg { width: 24px; height: 24px; }
    .nav-btn .tooltip {
        position: absolute;
        left: 110%;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        box-shadow: var(--shadow);
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        pointer-events: none;
        z-index: 200;
    }
    .nav-btn:hover .tooltip { opacity: 1; visibility: visible; }

    .app-content {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        max-height: 100vh;
    }

    .view { display: none; }
    .view.active { display: grid; gap: 24px; animation: fadeIn .3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .main.reloading { opacity: 0; transition: opacity 0.2s ease-out; }

    .panel-bg{
        background: rgba(23, 26, 46, var(--panel-opacity));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border:1px solid rgba(255,255,255,.08);
    }
    /* Thêm các quy tắc border cho theme light/pastel */
    [data-theme='light'] .panel-bg, [data-theme='pastel'] .panel-bg { border:1px solid rgba(0,0,0,0.05); }
    [data-theme='lofi'] .panel-bg { border:1px solid rgba(255,255,255,0.1); }
    [data-theme='space'] .panel-bg { border:1px solid rgba(255,255,255,0.12); }


header.app-header{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-radius:var(--radius); box-shadow:var(--shadow); margin-bottom: 24px; position: relative; z-index: 2000;}
    header .actions{display:flex; gap:8px; align-items:center}
    
    .btn {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text);
      border: none; /* Sửa đổi: bỏ border mặc định */
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,0.08);
      font-weight: 600;
      transition: all .15s ease;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        border: 2px solid transparent; border-radius: 12px; background: var(--gradient-border) border-box;
        -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: destination-out; mask-composite: exclude; opacity: 0; transition: opacity 0.3s ease;
    }
    .btn:hover::before { opacity: 1; }
    .btn:hover { background: rgba(255, 255, 255, 0.12); }
    .btn:active { transform: translateY(1px) scale(0.98); filter: brightness(1); }
    .btn:disabled { cursor: not-allowed; filter: brightness(0.8) saturate(0.5); }
    .btn.ghost { background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); }
    .btn.ghost:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); }
    .btn.acc { background: var(--acc); color: white; }
    .btn.warn { background: var(--warn); color: white; }
    .btn.danger { background: var(--danger); color: white; }
    .btn.small { padding: 6px 10px; font-size: 14px; border-radius: 9px; }
    .btn.small::before { border-radius: 9px; }
    .btn > svg { width: 16px; height: 16px; stroke-width: 2.5px; }

    /* === START: CẬP NHẬT GIAO DIỆN QUẢN LÝ CHỦ ĐỀ === */
    #view-topics { grid-template-columns: 1fr; }
    .topic-item { background:rgba(255,255,255,.04); border:1px solid var(--muted); border-radius:12px; padding:8px; margin-bottom:8px; } /* Sửa đổi */
    .topic-header, .sub-row { display:flex; align-items:center; gap:8px; position: relative; }
    .topic-header { cursor: pointer; }
    .topic-header .topic-actions { cursor: default; }
    .topic-header .topic-actions * { cursor: pointer; }
    .topic-item { cursor: pointer; }
    .topic-item .topic-actions { cursor: default; }
    .topic-item .topic-actions * { cursor: pointer; }
    .topic-title { flex:1; font-weight:600; cursor: pointer; }
    .chev { width:28px; height:28px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; flex-shrink: 0; cursor: pointer; }
    .chev .ico { display:inline-block; transition: transform .18s ease; }
    .chev[aria-expanded="false"] .ico { transform: rotate(-90deg); }
    .subtopics { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .subtopics.hidden { display:none; }
    
    .topic-actions, .sub-row .actions {
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        display: flex;
        gap: 6px;
        align-items: center;
    }
    .topic-item:hover .topic-actions, .topic-item:focus-within .topic-actions,
    .sub-row:hover .actions, .sub-row:focus-within .actions {
      opacity: 1;
      visibility: visible;
    }
    .actions-menu-btn {
        padding: 0;
        width: 28px;
        height: 28px;
        font-size: 1.2em;
        line-height: 1;
    }
    .actions-menu {
        position: absolute;
        top: 100%;
        right: 0;
        border-radius: 8px;
        padding: 6px;
        box-shadow: var(--shadow);
        z-index: 10;
        min-width: 150px;
        display: none;
        flex-direction: column;
        gap: 4px;
    }
    /* Nâng khối đang mở menu lên trên các khối khác */
    .topic-item.menu-active { position: relative; z-index: 20; }
    
    .actions-menu.show { display: flex; }
    .menu-item {
        background: transparent; border: none; color: var(--text);
        padding: 8px 10px; border-radius: 6px; text-align: left;
        width: 100%; cursor: pointer; transition: background .2s ease;
        display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500;
    }
    .menu-item:hover { background: var(--acc); color: white; }
    .menu-item.danger:hover { background: var(--danger); }
    /* === END: CẬP NHẬT GIAO DIỆN QUẢN LÝ CHỦ ĐỀ === */

    .subtopic-btn{
        flex:1; 
        text-align:left;
        background-color: rgba(0,0,0,0.02); /* Sửa đổi */
    }
    .subtopic-btn:hover {
        background-color: transparent; /* Hover transparent to avoid blue background */
    }
    .subtopic-btn.active{
        outline:2px solid var(--acc); 
    }
    .subtopic-btn.active:hover {
        background: transparent; /* Giữ nền trong suốt khi di chuột qua */
    }
    
    .panel{border-radius:var(--radius); padding:24px; box-shadow:var(--shadow)}

    .timer-header { display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; }
    .timer{display:grid; gap:16px; grid-template-columns: 1fr; align-items:center; text-align:center}
    .big-time{font-size: clamp(60px, 12vw, 96px); letter-spacing:1px; font-weight:700; color: var(--text)}
    .state{font-weight:700; letter-spacing:.6px}
    .state.work{color:var(--acc-2)} /* Sửa đổi màu */
    .state.break{color:var(--warn)}
    .state.long{color:var(--danger)} /* Sửa đổi màu */
    .controls{display:flex; flex-wrap:wrap; gap:12px; justify-content:center}    
    #btnStart { padding: 14px 28px; font-size: 1.2em; }
    #btnPause, #btnResume { padding: 12px 24px; font-size: 1.1em; }

    /* === START: TÙY CHỈNH DẢI PHÂN CÁCH MỀM MẠI HƠN === */
    #view-timer .panel-bg hr {
        border: none; /* Bỏ đường viền mặc định */
        height: 1px;  /* Đặt chiều cao cho đường kẻ */
        background-color: var(--muted); /* Sử dụng màu phụ của theme */
        opacity: 0.3; /* Làm cho nó mờ đi, hòa vào nền */
        margin-top: 0; /* Điều chỉnh lại khoảng cách */
    }
    /* === END: TÙY CHỈNH DẢI PHÂN CÁCH MỀM MẠI HƠN === */

    .stats-grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px}
    .stat-card{background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:14px; padding:12px; text-align:center} /* Sửa đổi */
    .stat-card h4{margin:4px 0 8px; color:var(--sub); font-weight:600; font-size: 14px;}
    .stat-value{font-size: 20px; font-weight: 600;}
    .tiny{font-size:12px; color:var(--sub)}
    .history{display:grid; gap:8px; max-height:300px; overflow:auto; padding-right:6px}
    .hist-item{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:start; background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:10px; padding:10px} /* Sửa đổi */

    .row{display:flex; gap:8px; align-items:center}
    .row > * {flex:1}
    input[type="text"], input[type="password"], input[type="number"], select, textarea{width:100%; background:rgba(255,255,255,0.04); color:var(--text); border:1px solid var(--muted); border-radius:10px; padding:10px; outline:none}
    textarea{min-height:80px; resize: vertical;}

    .toasts{position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:9999}
    .toast{
        background: var(--panel); /* Sửa đổi */
        border:1px solid var(--muted);
        color:var(--text);
        padding:10px 12px; border-radius:12px; box-shadow:var(--shadow);
        animation: toast-in .3s ease; transform-origin: bottom right;
    }
    @keyframes toast-in { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,var(--panel-opacity)); z-index:10000; backdrop-filter: blur(5px);} /* Nâng z-index để nằm trên header */
    .modal.show{display:flex}
    .modal-card{
        position: relative;
        z-index: 10001;
        width:min(720px, 94vw);
        border-radius:16px;
        padding:16px;
        box-shadow:var(--shadow);
        animation: modal-in .25s ease-out;
        max-height: 90vh;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }
    body.modal-open { overflow: hidden; }
    @keyframes modal-in { from { opacity: 0; transform: scale(0.92) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .modal-card h3{margin-top:0}
    .dashboard-table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    .dashboard-table th, .dashboard-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--muted); }
    .dashboard-table th { color: var(--sub); }

    .footer-note{font-size:12px; color:var(--sub)}
    .hidden{display:none !important}

    .notes-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; padding-right: 6px; }
    .note-item { background: rgba(255,255,255,0.04); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; cursor: pointer; } /* Sửa đổi */
    .note-content-wrapper { flex: 1; min-width: 0; }
    .note-content { white-space: pre-wrap; word-break: break-word; max-height: 60px; overflow: hidden; position: relative; transition: max-height 0.35s ease-in-out; }
    .note-content:not(.expanded)::after {
        content: ''; position: absolute; bottom: 0; right: 0; width: 100%; height: 20px; background: linear-gradient(to top, var(--panel) 20%, transparent);
    }
    .note-content.expanded { max-height: 500px; }
    .note-meta { font-size: 11px; color: var(--sub); margin-top: 4px; }
    
    .spinner { border: 2px solid var(--muted); border-top-color: var(--text); border-radius: 50%; width: 16px; height: 16px; animation: spin 1s linear infinite; } /* Sửa đổi */
    @keyframes spin { to { transform: rotate(360deg); } }

    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .panel-header h3 { margin: 0; }
    .panel-header .actions { display: flex; gap: 8px; }
    
    .aux-panel { margin-top: 24px; }
    .tab-nav { display: flex; gap: 4px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 16px; }
    .tab-btn { background: transparent; border: none; color: var(--sub); padding: 8px 16px; cursor: pointer; border-bottom: 2px solid transparent; transition: all .2s ease; font-weight: 600; }
    .tab-btn:hover { color: var(--text); }
    .tab-btn.active { color: var(--acc); border-bottom-color: var(--acc); }
    .tab-content {
      display: none;
      padding-top: 8px;
    }
    .tab-content.active {
      animation: fadeIn 0.25s ease-out;
    }
    #tasks.tab-content.active,
    #notes.tab-content.active,
    #ai.tab-content.active {
        display: block;
    }

    #settings-timer.tab-content.active,
    #settings-ui.tab-content.active,
    #settings-integrations.tab-content.active {
        display: flex;
    }

    .settings-row-toggle {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
    }
    .settings-row-toggle span {
      flex: 1;
      cursor: pointer;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle-switch .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--muted);
      transition: .3s;
      border-radius: 24px;
    }
    .toggle-switch .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    .toggle-switch input:checked + .slider {
      background-color: var(--acc-2);
    }
    .toggle-switch input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    .chat-messages { max-height: 250px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; padding: 4px; }
    .chat-msg { padding: 8px 12px; border-radius: 12px; max-width: 85%; word-break: break-word; }
    .chat-msg.user { background: var(--acc); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
    .chat-msg.model { background: var(--muted); align-self: flex-start; border-bottom-left-radius: 4px; }
    .chat-input-area { display: flex; gap: 8px; }

    .methods-list { list-style: none; padding: 0; }
    .method-item { align-items: flex-start; padding: 12px; display: flex; gap: 10px; border-radius: 8px; }
    .method-item:hover { background: rgba(0,0,0,0.03); } /* Sửa đổi */
    .method-item input[type="checkbox"] { width: 18px; height: 18px; margin-top: 2px; flex-shrink: 0;}
    .method-item label { flex: 1; }
    .method-item label.completed { text-decoration: line-through; color: var(--sub); }
    .method-item .content-wrapper { flex: 1; cursor: pointer; }
    .method-item .concept { font-size: 14px; color: var(--sub); margin-top: 8px; border-left: 2px solid var(--muted); padding-left: 12px; white-space: pre-wrap; word-break: break-word; }
    /* Highlight section titles and bold text inside method content */
    .method-content h4 {
        color: var(--acc-2);
        font-size: 1.1em;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    .method-content strong {
        color: var(--acc);
        font-weight: 600;
    }
    /* Apply the same highlight to the Guide view */
    #view-guide h4 { color: var(--acc-2); }
    #view-guide strong { color: var(--acc-2); }
    /* Show hand cursor to indicate clickability */
    .method-item, .method-item summary { cursor: pointer; }
    .subtopic-todo-list { list-style: none; padding: 0; margin: 0; max-height: 100px; overflow-y: auto; text-align: left; }
    .subtopic-todo-list li { display: flex; align-items: center; gap: 8px; padding: 4px; transition: all 0.2s ease-out; }
    .subtopic-todo-list li.removing { transform: translateX(100%); opacity: 0; }
    .subtopic-todo-list label { flex: 1; }

    #youtube-player-container { position: absolute; top: -9999px; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 10px; } /* Sửa đổi */
    ::-webkit-scrollbar-thumb { background: var(--muted); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
    ::-webkit-scrollbar-thumb:hover { background: var(--sub); background-clip: content-box; }
    
    .timer-circle-container {
        position: relative; width: clamp(250px, 40vw, 320px); height: clamp(250px, 40vw, 320px); margin: 24px auto; display: flex; align-items: center; justify-content: center;
    }
    .timer-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform: rotate(-90deg); }
    .timer-circle-bg, .timer-circle-progress { fill: none; stroke-width: 8; }
    .timer-circle-bg { stroke: var(--muted); } /* Sửa đổi */
    .timer-circle-progress { stroke: var(--acc); stroke-linecap: round; transition: stroke-dashoffset 0.3s linear, stroke 0.5s ease; }
    @keyframes flash { 0%, 100% { box-shadow: 0 0 10px 2px transparent; } 50% { box-shadow: 0 0 20px 8px currentColor; } }
    .timer-circle-container.finished { color: var(--acc-2); animation: flash 1s ease-out; }
    @keyframes breathing-effect { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    .timer-circle-container.breathing { animation: breathing-effect 3s ease-in-out infinite; }
    
    
    
    @media (max-width: 1024px) {
      .app-content { padding: 20px; }
      .panel { padding: 20px; }
      .timer-circle-container { width: clamp(220px, 50vw, 300px); height: clamp(220px, 50vw, 300px); }
    }

    @media (max-width: 768px) {
      .app { flex-direction: column; }
      .app-nav { width: 100%; height: 60px; flex-direction: row; justify-content: center; border-right: none; border-top: 1px solid rgba(255,255,255,.08); order: 2; padding: 0 16px; }
      .app-content { padding: 16px; order: 1; }
      .panel { padding: 16px; }
      .modal-card .tab-nav { overflow-x: auto; }
    }

    @media (max-width: 480px) {
      .app-nav { height: 50px; }
      .nav-btn { flex: 1; }
      header.app-header { flex-direction: column; align-items: stretch; gap: 8px; }
      .btn { padding: 8px 12px; }
      .timer-circle-container { width: clamp(180px, 80vw, 220px); height: clamp(180px, 80vw, 220px); margin: 16px auto; }
      .panel { padding: 12px; }
      .app-content { padding: 12px; }
    }

    #view-timer.no-subtopic-selected > .panel-bg:not(:first-child) { display: none; }
    #view-timer.no-subtopic-selected .timer-header > .presets { display: none; }
    #view-timer.no-subtopic-selected .timer { display: none; }

    header.app-header .actions #btnFullscreen { background: transparent; border: none; box-shadow: none; }
    header.app-header .actions #btnFullscreen:hover { background: var(--muted); filter: none; }
    header.app-header .actions #btnFullscreen:hover::before { opacity: 0; }

    input[type="text"], input[type="password"], input[type="number"], select, textarea {
        background: rgba(255,255,255,0.04) !important; /* Sửa đổi: chuyển sang nền trắng trong suốt */
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.1); /* Viền trắng mờ */
        transition: background .2s ease, border-color .2s ease;
    }
    input[type="text"]:focus, input[type="password"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
        background: rgba(255,255,255,0.06) !important; /* Tinh chỉnh: sát mẫu hơn */
        border-color: var(--acc);
    }
    /* === START: SỬA LỖI NỀN INPUT/SELECT TRÊN THEME SÁNG === */
    [data-theme='light'] input, [data-theme='light'] select, [data-theme='light'] textarea,
    [data-theme='pastel'] input, [data-theme='pastel'] select, [data-theme='pastel'] textarea {
        background: rgba(0, 0, 0, 0.05) !important; /* Dùng nền đen mờ thay vì trắng mờ */
        border-color: rgba(0, 0, 0, 0.1); /* Viền đen mờ trên theme sáng */
    }

    [data-theme='light'] input:focus, [data-theme='light'] select:focus, [data-theme='light'] textarea:focus,
    [data-theme='pastel'] input:focus, [data-theme='pastel'] select:focus, [data-theme='pastel'] textarea:focus {
        background: rgba(0, 0, 0, 0.07) !important; /* Tăng độ đậm khi focus */
    }
    /* === END: SỬA LỖI NỀN INPUT/SELECT TRÊN THEME SÁNG === */

    /* Cải thiện nền và màu chữ cho option trong select theo theme hiện tại */
    select option {
        background: var(--panel);
        color: var(--text);
    }
    
    ::placeholder { color: var(--sub); opacity: 0.7; } /* Sửa đổi */
    ::-ms-input-placeholder { color: var(--sub); }
    :-ms-input-placeholder { color: var(--sub); }

    
    
    .draggable-timer {
        position: fixed;
        bottom: 20px;
        right: 20px;
        color: var(--text);
        padding: 8px 16px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        font-size: 2em;
        font-weight: 600;
        cursor: move;
        user-select: none;
        z-index: 9998;
        opacity: 0;
        transform: scale(0.9);
        pointer-events: none;
        transition: opacity 0.35s ease, transform 0.35s ease;
    }
    body.bg-view-mode .draggable-timer {
        opacity: 1;
        transform: scale(1);
        pointer-events: auto;
    }
    .app-nav, .panel-bg, .app-header .actions > *, .app-header > .row {
        transition: opacity 0.35s ease, transform 0.35s ease, background 0.35s ease, border-color 0.35s ease, box-shadow 0.35s ease;
    }
    body.bg-view-mode .app-nav,
    body.bg-view-mode .view.active > .panel-bg {
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
    }
    body.bg-view-mode .app-header {
        background: transparent !important;
        border-color: transparent !important;
        box-shadow: none !important;
    }
    body.bg-view-mode .app-header .actions > *:not(#btnToggleBg),
    body.bg-view-mode .app-header > .row {
        opacity: 0;
        pointer-events: none;
    }
    body.bg-view-mode #btnToggleBg {
        opacity: 1;
        pointer-events: auto;
    }
    .sound-permission-bar {
      position: fixed; left: 50%; transform: translateX(-50%);
      bottom: 48px; z-index: 9999;
      border-radius: 12px; padding: 10px 14px;
      display: none; align-items: center; gap: 10px;
      box-shadow: var(--shadow);
    }
    .sound-permission-bar.show { display: flex; }
    .sound-permission-bar .msg { font-size: 14px; color: var(--text); }
    .draggable-timer { text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.9); }

    /* Giảm/loại bỏ bóng chữ cho theme sáng để tránh nhòe/lóa */
    body[data-theme='light'],
    body[data-theme='pastel'] { text-shadow: none; }
    body[data-theme='light'] .draggable-timer,
    body[data-theme='pastel'] .draggable-timer { text-shadow: none; }

    /* ============================================= */
/* ========================================================= */
/* START: THI?T L?P PANEL KI?U M?  ?C (FROSTED GLASS)        */
/* ========================================================= */

/* --- 1.  p d?ng hi?u ?ng n?n m? chung cho t?t c? c c panel --- */
.app-nav,
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    background: rgba(var(--panel-rgb), var(--panel-opacity));
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* --- 2.  ?nh nghia vi?n cho t?ng lo?i panel --- */
.app-nav {
    border-right: 1px solid rgba(255, 255, 255, 0.1);
}
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* --- 3. Tinh ch?nh vi?n cho c c theme S NG (Light/Pastel) --- */
[data-theme='light'] .app-nav,
[data-theme='light'] .panel-bg,
[data-theme='light'] .modal-card,
[data-theme='light'] .actions-menu,
[data-theme='light'] .nav-btn .tooltip,
[data-theme='light'] .draggable-timer,
[data-theme='light'] .sound-permission-bar,
[data-theme='light'] .toast,
[data-theme='light'] .topic-item,
[data-theme='light'] .stat-card,
[data-theme='light'] .hist-item,
[data-theme='light'] .method-item,
[data-theme='pastel'] .app-nav,
[data-theme='pastel'] .panel-bg,
[data-theme='pastel'] .modal-card,
[data-theme='pastel'] .actions-menu,
[data-theme='pastel'] .nav-btn .tooltip,
[data-theme='pastel'] .draggable-timer,
[data-theme='pastel'] .sound-permission-bar,
[data-theme='pastel'] .toast,
[data-theme='pastel'] .topic-item,
[data-theme='pastel'] .stat-card,
[data-theme='pastel'] .hist-item,
[data-theme='pastel'] .method-item {
    border-color: rgba(0, 0, 0, 0.1);
}

/* --- 4. S?a l?i hi?u ?ng fade-out c?a ghi ch  cho ph  h?p --- */
.note-content:not(.expanded)::after {
    background: linear-gradient(to top, rgba(var(--panel-rgb), 1) 20%, transparent);
}

/* --- C c quy t?c c n l?i gi? nguy n t? file g?c --- */
[data-theme='light'] .tab-nav,
[data-theme='pastel'] .tab-nav {
    border-bottom-color: rgba(0, 0, 0, 0.1);
}
.subtopic-btn {
    background-color: transparent;
}
.subtopic-btn:hover {
    background-color: transparent; /* Hover transparent to avoid blue background */
}
.method-item[open] summary {
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
    [data-theme='light'] .method-item[open] summary,
    [data-theme='pastel'] .method-item[open] summary {
        border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    /* Editor container (single pane, Rich Text) */
    .editor-container { height: 350px; }
    .editable-content { height: 100%; border: 1px solid var(--muted); border-radius: 10px; padding: 10px; overflow-y: auto; background: var(--bg); }
    .editable-content:focus-within { border-color: var(--acc); outline: none; }
    .editable-content h4 { color: var(--acc-2); font-size: 1.1em; margin-top: 1.5em; margin-bottom: 0.5em; }
    .editable-content strong, .editable-content b { color: var(--acc); font-weight: 600; }
    .editable-content ol, .editable-content ul { padding-left: 20px; }

    /* Editor toolbar for Methods modal */
    .editor-toolbar { display: flex; gap: 6px; margin-bottom: 6px; padding: 4px; background: var(--muted); border-radius: 8px; }
    .editor-toolbar button { font-weight: bold; width: 32px; height: 32px; padding: 0; }
    .editor-toolbar .btn.ghost:hover { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.15); }
    .editor-toolbar .btn.ghost.active { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.25); }
    .color-picker-wrapper { position: relative; }
    .color-palette { position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; padding: 6px; border-radius: 8px; border: 1px solid var(--muted); background: var(--panel); box-shadow: var(--shadow); z-index: 10; }
    .color-swatch { width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255, 255, 255, 0.5); cursor: pointer; transition: transform 0.15s ease; }
    .color-swatch:hover { transform: scale(1.15); }

    /* Method actions inline with summary and show on hover */
    .method-item summary { display: flex; align-items: center; justify-content: space-between; }
    .method-item summary > span { flex: 1; }
    .method-item summary .topic-actions { margin-left: 8px; }
    .method-title { cursor: pointer; }
    .method-item:hover .topic-actions, .method-item:focus-within .topic-actions { opacity: 1; visibility: visible; }

    </style>
</head>
<body data-theme="default"> <div class="app" id="app">
    <nav class="app-nav">
        <button class="nav-btn active" id="navBtnTimer" data-view="timer" aria-label="Đồng hồ">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span class="tooltip">Đồng hồ</span>
        </button>
        <button class="nav-btn" id="navBtnTopics" data-view="topics" aria-label="Chủ đề">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
            <span class="tooltip">Chủ đề</span>
        </button>
        <button class="nav-btn" id="navBtnStats" data-view="stats" aria-label="Thống kê">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
            <span class="tooltip">Thống kê</span>
        </button>
        <button class="nav-btn" id="navBtnMethods" data-view="methods" aria-label="Kho Tri Thức">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.042 21.672L13.684 16.6s.408-1.947 1.25-3.25c.842-1.303 2.002-2.5 3.5-3.5s3.25-1.25 3.25-1.25l5.072 1.358c.27.072.358.42.128.628l-3.35 3.35a.499.499 0 0 1-.594.052l-2.07-1.486c-.44-.314-.82-.53-1.11-.665-.29-.135-.55-.22-.78-.245s-.45.045-.63.155c-.18.11-.3.29-.36.5-.06.21.02.48.18.78.16.3.385.68.665 1.11l1.486 2.07a.499.499 0 0 1-.052.594l-3.35 3.35c-.208.23-.556.142-.628-.128z"/><path d="M12 15l-3-3 3-3 3 3-3 3z"/><path d="M9.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/><path d="M5.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/></svg>
            <span class="tooltip">Kho Tri Thức</span>
        </button>
        <button class="nav-btn" id="btnSettings" style="margin-top: auto;" aria-label="Cài đặt">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            <span class="tooltip">Cài đặt</span>
        </button>
        <button class="nav-btn" id="navBtnGuide" data-view="guide" aria-label="Hướng dẫn">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            <span class="tooltip">Hướng dẫn</span>
        </button>
    </nav>

    <main class="app-content">
      <header class="app-header panel-bg">
        <div class="row" style="gap:12px; align-items:center; flex:0 1 auto">
          <strong>📚 Pomodoro Study App</strong>
          <span class="badge" id="selectedContext">Chưa chọn Chủ đề con</span>
        </div>
        <div class="actions">
          <button class="btn ghost small" id="btnDashboard" title="Dashboard Tổng quan">📊 Tổng Quan </button>
          <a href="https://forms.gle/EfFqBJFTbFtDo5H4A" target="_blank" rel="noopener noreferrer" class="btn ghost small" title="Gửi phản hồi của bạn">💬 Phản Hồi</a>
          <button class="btn ghost small" id="btnExport" title="Xuất JSON">⬇️ Xuất File</button>
          <label class="btn ghost small" for="importFile" title="Nhập JSON">⬆️ Nhập File</label>
          <input type="file" id="importFile" accept="application/json" style="display:none" />
          <button class="btn small" id="btnToggleBg" title="Ẩn/Hiện giao diện">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
          <button class="btn small" id="btnFullscreen" title="Toàn màn hình">↗️</button>
        </div>
      </header>
      

      <div id="view-timer" class="view active">
        <section class="panel panel-bg">
          <div class="timer-header">
            <div id="welcomePanel" class="hidden panel-bg" style="text-align:center; padding: 20px; border-radius: var(--radius); width: 100%;">
                <h3>Chào mừng đến với Pomodoro Study App!</h3>
                <p>Hãy bắt đầu bằng cách chọn một <strong>Chủ đề con</strong> hoặc tạo Chủ đề/Chủ đề con mới.</p>
                <button class="btn acc" id="btnHelpCreateTopic">＋ Tạo Chủ đề Mới</button>
            </div>
            <div class="presets" role="group" aria-label="Chọn chế độ preset">
                <button id="btnPresetA" class="btn small ghost" data-preset="A"></button>
                <button id="btnPresetB" class="btn small ghost" data-preset="B"></button>
                <button id="btnPresetC" class="btn small ghost" data-preset="C">🌊 Flow</button>
            </div>
          </div>
          <hr />
          <div class="timer" aria-live="polite">
            <div class="badge" id="stateBadge">TRẠNG THÁI</div>
            
            <div class="timer-circle-container">
              <svg class="timer-svg" viewBox="0 0 100 100">
                  <circle class="timer-circle-bg" cx="50" cy="50" r="45"></circle>
                  <circle class="timer-circle-progress" cx="50" cy="50" r="45"></circle>
              </svg>
              <div id="timeDisplay" class="big-time">00:00</div>
            </div>

            <div class="tiny" id="cycleInfo"></div>

            <div class="tiny" id="breakSuggestionDisplay" style="min-height: 1.5em; font-style: italic; opacity: 0.8; transition: opacity 0.3s ease;"></div>

            <div id="windDownChecklist" class="hidden" style="text-align: left; max-width: 300px; margin: 0 auto; padding: 0 10px;">
              <h4 style="margin: 8px 0 4px; color: var(--acc); text-align: center;">Checklist Hạ nhiệt</h4>
              <ul style="list-style: '✓ '; margin: 0; padding-left: 20px; color: var(--sub);">
                <li>Lưu công việc đang làm (Save/Commit).</li>
                <li>Ghi chú nhanh "Next step".</li>
                <li>Dọn dẹp không gian làm việc.</li>
              </ul>
            </div>
            
            <div class="controls">
              <button class="btn acc" id="btnStart" aria-label="Bắt đầu (Space)">▶️ Bắt đầu</button>
              <button class="btn warn hidden" id="btnFinishFlow" aria-label="Kết thúc phiên làm việc">🧘 Bắt đầu nghỉ</button>
              <button class="btn" id="btnPause" aria-label="Tạm dừng (Space)">⏸️ Tạm dừng</button>
              <button class="btn" id="btnResume" aria-label="Tiếp tục (Space)">⏵ Tiếp tục</button>
              <button class="btn warn" id="btnSkip" aria-label="Bỏ qua (N)">⏭️ Bỏ qua</button>
              <button class="btn danger" id="btnReset">↺ Đặt lại</button>
              <button class="btn acc small hidden" id="btnBreakEarly">🧘 Nghỉ sớm</button>
            </div>
            <div class="tiny">Phím tắt: <strong>Space</strong> = Bắt đầu/Tạm dừng/Tiếp tục, <strong>N</strong> = Tiếp theo/Bỏ qua</div>
          </div>
        </section>

        <section class="panel panel-bg aux-panel">
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="tasks">Nhiệm vụ</button>
                <button class="tab-btn" data-tab="notes">Ghi chú</button>
                <button class="tab-btn" data-tab="ai">Gemini AI</button>
            </nav>
            <div id="tasks" class="tab-content active">
                <h4 style="margin: 0 0 8px; color: var(--sub);">To-do cho chủ đề con này:</h4>
                <ul id="subtopicTasksList" class="subtopic-todo-list"></ul>
                <div class="row" style="gap:8px; margin-top: 8px;">
                    <input type="text" id="newSubtopicTaskInput" placeholder="Thêm một task mới..." />
                    <button id="btnAddSubtopicTask" class="btn small" style="flex: 0 1 auto;">Thêm</button>
                </div>
            </div>
            <div id="notes" class="tab-content">
                <div id="generalNotesList" class="notes-list"></div>
                <div class="add-note-area" style="margin-top: 12px;">
                    <textarea id="newGeneralNoteText" placeholder="Thêm ghi chú mới..."></textarea>
                    <div style="text-align: right; margin-top: 8px;">
                        <button class="btn acc small" id="btnAddGeneralNote">＋ Thêm ghi chú</button>
                    </div>
                </div>
            </div>
            <div id="ai" class="tab-content">
                <div class="panel-header" style="margin-bottom: 8px; padding: 0;">
                    <h4 style="margin:0;">Gemini cho: <span id="currentSubtopicNameChat">(chưa chọn)</span></h4>
                    <div class="actions">
                        <button id="btnClearChat" class="btn small danger" title="Xóa lịch sử">🗑️</button>
                    </div>
                </div>
                <div id="chatMessages" class="chat-messages"></div>
                <div id="aiPromptSuggestions" style="display: flex; gap: 6px; margin: 8px 0; flex-wrap: wrap;">
                  <button class="btn small ghost" data-prompt="Giải thích khái niệm chính của chủ đề này">Giải thích khái niệm</button>
                  <button class="btn small ghost" data-prompt="Tạo một dàn ý chi tiết cho chủ đề này">Tạo dàn ý</button>
                  <button class="btn small ghost" data-prompt="Liệt kê 5 câu hỏi ôn tập quan trọng về chủ đề này">Tạo câu hỏi ôn tập</button>
                </div>
                <div class="chat-input-area">
                  <input type="text" id="chatInput" placeholder="Hỏi Gemini điều gì đó..." />
                  <button id="btnSendMessage" class="btn acc">Gửi</button>
                </div>
            </div>
        </section>
      </div>

      <div id="view-topics" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin: 0;">Quản lý Chủ đề</h3>
                <button class="btn small acc" id="btnAddTopic" style="margin-left: auto;">＋ Thêm Chủ đề</button>
            </div>
            <div id="topicsList"></div>
            <div class="footer-note">Nhấp mũi tên để mở/đóng danh sách chủ đề con.</div>
        </div>
      </div>
      
      <div id="view-stats" class="view">
        <section class="panel panel-bg">
            <h3 style="margin:0 0 12px 0;">Thống kê & Lịch sử — <span id="currentSubtopicName">(chưa chọn)</span></h3>
            <div class="stats-grid">
              <div class="stat-card"><h4>Tổng thời gian</h4><div class="stat-value" id="statTotal">0 phút</div></div>
              <div class="stat-card"><h4>Phiên</h4><div class="stat-value" id="statSessions">0</div></div>
              <div class="stat-card"><h4>Nhiệm vụ Hoàn thành</h4><div class="stat-value" id="statTasks">0</div></div>
            </div>
            <div style="margin-top:12px">
              <h4 style="margin:4px 0 8px; color:var(--sub)">Lịch sử (LÀM VIỆC)</h4>
              <div class="history" id="historyList"></div>
            </div>
        </section>
      </div>
      
      <div id="view-methods" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin:0;">💡 Kho Tri Thức Cá Nhân Hóa</h3>
                <button class="btn small acc" id="btnAddMethod" style="margin-left: auto;">＋ Thêm tri thức</button>
            </div>
            <p class="tiny" style="margin-top: -8px; margin-bottom: 20px;">Nhấp vào từng mục để xem chi tiết.</p>
            <div class="methods-container"></div>
        </div>
      </div>

      <div id="view-guide" class="view">
          <div class="panel panel-bg">
              <h3 style="margin-top: 0;">📖 Khám Phá Pomodoro Study App</h3>
              <p>
                  Chào mừng bạn đến với không gian học tập được thiết kế dành riêng cho sự tập trung và hiệu quả. Hãy cùng khám phá những tính năng sẽ đồng hành cùng bạn trên hành trình chinh phục tri thức.
              </p>

              <h4>🚀 Khởi Đầu Nhanh Chỉ Trong 4 Bước</h4>
              <p>Để hành trình của bạn luôn mạch lạc, mọi thứ trong ứng dụng được sắp xếp theo cấu trúc <strong>Chủ đề Lớn → Chủ đề con</strong>.</p>
              <ol>
                  <li>Mở mục <strong>📚 Chủ đề</strong> từ thanh điều hướng bên cạnh.</li>
                  <li>Nhấn <strong>＋ Thêm Chủ đề</strong> để tạo một lĩnh vực lớn (ví dụ: "Tiếng Anh Giao Tiếp").</li>
                  <li>Bên cạnh chủ đề vừa tạo, nhấn <strong>＋ Thêm</strong> để tạo một chủ đề con, chi tiết hơn (ví dụ: "Bài 1: Luyện phát âm IPA").</li>
                  <li>Chọn chủ đề con đó. Giờ đây, bạn đã sẵn sàng để bắt đầu phiên học đầu tiên của mình!</li>
              </ol>

              <hr />
              <h4>✨ Những Tính Năng Đáng Chú Ý</h4>

              <h4>Các Chế Độ Đồng Hồ Linh Hoạt ⏱️</h4>
              <p>Ứng dụng không chỉ có Pomodoro. Hãy chọn phương pháp phù hợp với công việc của bạn:</p>
              <ul>
                  <li><strong>Pomodoro Cổ Điển (Kiểu A/B):</strong> Làm việc tập trung trong các phiên định sẵn (ví dụ: 25 phút làm, 5 phút nghỉ) để xây dựng kỷ luật và nhịp độ.</li>
                  <li><strong>Chế độ Flowtime (Kiểu 🌊 Flow):</strong> Dành cho công việc cần dòng chảy sâu. Đồng hồ sẽ đếm lên, cho phép bạn làm việc đến khi tự cảm thấy cần nghỉ. Thời gian nghỉ sẽ được đề xuất dựa trên thời gian bạn đã làm việc.</li>
                  <li><strong>Đệm "Hạ nhiệt" (Wind-down):</strong> Một khoảng đệm tùy chỉnh giữa lúc làm và lúc nghỉ, giúp bạn kết thúc công việc đang dở, ghi chú lại "bước tiếp theo" và chuyển trạng thái một cách mượt mà, không bị cắt ngang đột ngột.</li>
              </ul> 
              <h4>Kho Tri Thức Theo Từng Chủ Đề Con 💡</h4>
<p>
    Mỗi một <strong>Chủ đề con</strong> giờ đây sẽ có một "Kho Tri Thức" hoàn toàn riêng biệt. Tính năng này cho phép bạn xây dựng một thư viện kiến thức chuyên sâu, chỉ liên quan đến lĩnh vực bạn đang học.
</p>
<p>
    Ví dụ, các ghi chú và phương pháp học "Tiếng Anh Giao Tiếp" sẽ chỉ xuất hiện khi bạn chọn chủ đề con đó, và sẽ không bị lẫn với các công thức trong chủ đề con "Giải tích Toán học".
</p>
<p>
    Với trình soạn thảo mạnh mẽ, bạn vẫn có thể dễ dàng định dạng tiêu đề, in đậm, tạo danh sách và làm nổi bật những thông tin quan trọng nhất cho từng môn học của mình.
</p>

              <h4>Quản Lý Chủ Đề Trực Quan</h4>
              <p>Dễ dàng sắp xếp các mục tiêu học tập của bạn. Sử dụng thao tác <strong>kéo và thả</strong> để sắp xếp lại thứ tự các Chủ đề hoặc di chuyển một Chủ đề con sang một lĩnh vực khác một cách trực quan.</p>

              <h4>Nhiệm Vụ & Ghi Chú Tích Hợp 📝</h4>
              <p>Ngay trong màn hình đồng hồ, bạn có thể tạo danh sách việc cần làm (to-do) cho từng chủ đề con hoặc ghi lại những ý tưởng chợt nảy ra mà không làm gián đoạn dòng chảy công việc.</p>

              <h4>Chế Độ Zen 🧘</h4>
              <p>Khi cần tập trung tuyệt đối, hãy nhấn vào biểu tượng con mắt (👁️). Giao diện sẽ ẩn đi, chỉ để lại hình nền và chiếc đồng hồ. Trong chế độ này, bạn có thể <strong>kéo thả đồng hồ</strong> đến bất kỳ vị trí nào trên màn hình để có một không gian làm việc gọn gàng nhất.</p>

              <h4>Thống Kê & Cột Mốc 🏆</h4>
              <p>Theo dõi hành trình của bạn qua những con số biết nói. Ứng dụng sẽ tự động ghi nhận và chúc mừng khi bạn đạt được những cột mốc quan trọng về thời gian tập trung, biến mỗi nỗ lực thành một thành tựu đáng tự hào.</p>

              <hr />
              <h4>⌨️ Phím Tắt Thông Minh</h4>
              <ul>
                  <li><kbd>Space</kbd>: Bắt đầu / Tạm dừng / Tiếp tục phiên học.</li>
                  <li><kbd>N</kbd>: Bỏ qua phiên làm việc hoặc nghỉ hiện tại.</li>
                  <li><kbd>Esc</kbd>: Đóng các cửa sổ đang mở (như Cài đặt).</li>
              </ul>

              <hr />
              <h4>🛠️ Cài Đặt Nâng Cao & Tích Hợp</h4>

              <h4>Trợ Lý Gemini AI 🧠</h4>
              <p>Biến ứng dụng thành một người bạn đồng hành thông minh. Ngoài việc hỏi đáp, bạn còn có thể:</p>
              <ul>
                  <li><strong>Tự động Định dạng Thông minh:</strong> Khi soạn thảo trong mục "Phương pháp", hãy để AI tự động phân tích và định dạng văn bản thô của bạn—tự nhận diện tiêu đề, các ý chính cần in đậm và danh sách.</li>
                  <li><strong>Thiết lập:</strong> Truy cập Google AI Studio để tạo API Key miễn phí và dán vào ô "Gemini API Key" trong Cài đặt của ứng dụng.</li>
              </ul>

              <h4>Tùy Biến Giao Diện & Âm Thanh 🎨</h4>
              <p>Biến không gian học tập thành của riêng bạn:</p>
              <ul>
                  <li><strong>Nhiều Theme & Hình nền:</strong> Lựa chọn giữa các theme có sẵn (Sáng, Tối, Pastel...) hoặc <strong>tải lên hình nền của riêng bạn</strong> để tạo cảm hứng.</li>
                  <li><strong>Âm báo Tùy chỉnh:</strong> Bạn có thể <strong>tải lên các file âm thanh (.mp3, .wav...) của riêng mình</strong> để sử dụng làm chuông báo cho các phiên làm việc và nghỉ ngơi.</li>
              </ul>

              <h4>Nhạc Nền YouTube 🎶</h4>
              <p>Tạo không gian học tập hoàn hảo bằng cách phát một video hoặc danh sách phát YouTube làm nhạc nền. Dán đường dẫn (URL) vào ô "Nhạc nền YouTube" trong Cài đặt.</p>

              <h4>An Toàn Dữ Liệu: Sao Lưu & Phục Hồi 🛡️</h4>
              <p>Ứng dụng tự động sao lưu tiến trình của bạn mỗi ngày. Bạn có thể tùy chỉnh số ngày lưu giữ bản sao lưu và phục hồi dữ liệu từ một ngày trong quá khứ nếu cần. ⚠️ <strong>Cảnh báo:</strong> Phục hồi sẽ ghi đè toàn bộ dữ liệu hiện tại.</p>
          </div>
      </div>
    </main>
  </div>

  <div class="modal" id="modalMilestone" role="dialog" aria-modal="true" aria-labelledby="milestoneTitle">
    <div class="modal-card" style="width: min(600px, 94vw);">
        <h3 id="milestoneTitle">🎉 Chúc mừng Bạn!</h3>
        <p id="milestoneMessage" style="white-space: pre-wrap; line-height: 1.6;"></p>
        <div class="row" style="justify-content:flex-end; margin-top:12px">
            <button class="btn acc" id="btnMilestoneClose">Tiếp tục hành trình!</button>
        </div>
    </div>
  </div>
  <div class="modal" id="modalSettings" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="modal-card">
          <h3 id="settingsTitle">⚙️ Cài đặt</h3>
          <nav class="tab-nav">
              <button class="tab-btn active" data-tab="settings-timer">Đồng hồ</button>
              <button class="tab-btn" data-tab="settings-ui">Giao diện & Âm thanh</button>
              <button class="tab-btn" data-tab="settings-integrations">Tích hợp</button>
          </nav>
          <div class="settings-content">
              <div id="settings-timer" class="tab-content active" style="flex-direction:column; gap:20px;">
                  <div class="row" id="timerPresetSelector" style="margin-bottom:16px;">
                      <button class="btn acc" data-preset-target="A"> Kiểu A </button>
                      <button class="btn ghost" data-preset-target="B"> Kiểu B </button>
                      <button class="btn ghost" data-preset-target="C"> Kiểu C (Flow) </button>
                  </div>
                  <div id="settings-pomodoro">
                      <h4>Thời lượng Pomodoro</h4>
                      <div class="row">
                          <label>LÀM VIỆC (phút)<input type="number" id="set_work" min="1" /></label>
                          <label>HẠ NHIỆT (phút)<input type="number" id="set_winddown" min="0" /></label>
                          <label>NGHỈ NGẮN (phút)<input type="number" id="set_short" min="1" /></label>
                          <label>NGHỈ DÀI (phút)<input type="number" id="set_long" min="1" /></label>
                      </div>
                      <div class="row">
                          <label>Chu kỳ Pomodoro<input type="number" id="set_cycles" min="1" /></label>
                          <label>Chu kỳ nghỉ dài<input type="number" id="set_interval" min="2" /></label>
                      </div>
                  </div>
                  <div id="settings-flowtime" class="hidden">
                      <h4>Flowtime</h4>
                      <div class="row">
                          <label>Tỷ lệ nghỉ (Làm việc / X)
                              <input type="number" id="set_flowRatio" min="1" max="20" />
                          </label>
                      </div>
                      <p class="tiny" style="margin-top: 4px;">Gợi ý: Thời gian nghỉ = tổng thời gian làm việc / X. Mặc định là 5.</p>
                  </div>
                  <div class="settings-row-toggle">
                          <label for="set_autoStartNext">Tự động bắt đầu phiên tiếp theo</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_autoStartNext">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableWinddown">Bật Hạ nhiệt sau phiên làm</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableWinddown">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableSessionNotes">Nhắc ghi chú sau mỗi phiên</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableSessionNotes">
                              <span class="slider"></span>
                          </label>
                      </div>
              </div>
              <div id="settings-ui" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Giao diện</h4>
                      <div class="row">
                          <label>Theme Giao Diện
                                <select id="set_theme_color">
                                    <option value="default">Mặc định (Dark Blue)</option>
                                    <option value="light">Light - Trà Sữa</option>
                                    <option value="pastel">Pastel - Dễ thương</option>
                                    <option value="lofi">Lofi Study Room</option>
                                    <option value="space">Space Station</option>
                                </select>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 12px;">
                          <label>Chế độ hiển thị nền
                              <select id="set_backgroundMode">
                                  <option value="cover">Lấp đầy (Mặc định)</option>
                                  <option value="contain">Vừa vặn (Sắc nét)</option>
                                  <option value="auto">Kích thước gốc (Lặp lại)</option>
                              </select>
                          </label>
                      </div>
                      <div class="row">
                          <label>Hình nền
                              <label class="btn small ghost" for="uploadBg">Tải ảnh mới</label>
                              <input type="file" id="uploadBg" accept="image/*" class="hidden" />
                          </label>
                          <button class="btn small danger" id="btnClearBg">Xóa nền</button>
                      </div>
                      <div class="row">
                          <label style="flex: 1;">Độ trong suốt của nền</label>
                          <input type="range" id="set_panelOpacity" min="0.1" max="1" step="0.05" style="flex: 2;">
                      </div>
                      
                      
                   </div>
                  
                   <div>
                      <h4>Âm thanh</h4>
                      <div class="row">
                          <label>Âm lượng (0–1)<input type="number" id="set_volume" step="0.05" min="0" max="1"/></label>
                          <label>Kiểu âm báo
                              <select id="set_theme">
                                  <option value="beep">Beep</option>
                                  <option value="chime">Chime</option>
                              </select>
                          </label>
                           <button class="btn" id="btnTestSound" style="flex: 0 1 auto; align-self: center;">Test</button>
                      </div>
                      <div style="text-align: right; margin-top: 12px;">
                          <button class="btn ghost small" id="btnToggleCustomSounds">Tùy chỉnh âm báo</button>
                      </div>

                      <div id="customSoundsContainer" class="hidden" style="margin-top: 8px;">
                      <div class="row" style="display: flex; gap: 8px; justify-content: flex-end;">
                          <div>
                              <small>Âm báo hết LÀM VIỆC</small>
                              <label title="Âm báo hết LÀM VIỆC" class="btn small ghost" for="uploadSoundWork">LÀM VIỆC</label>
                              <input type="file" id="uploadSoundWork" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Âm báo hết NGHỈ NGẮN</small>
                              <label title="Âm báo hết NGHỈ NGẮN" class="btn small ghost" for="uploadSoundBreak">NGHỈ NGẮN</label>
                              <input type="file" id="uploadSoundBreak" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Âm báo hết NGHỈ DÀI</small>
                              <label title="Âm báo hết NGHỈ DÀI" class="btn small ghost" for="uploadSoundLong">NGHỈ DÀI</label>
                              <input type="file" id="uploadSoundLong" accept="audio/*" class="hidden" />
                          </div>
                      </div>
                      </div>
                      
                  </div>
              </div>
              <div id="settings-integrations" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Tích hợp AI</h4>
                      <label>Gemini API Key
                          <input type="password" id="set_apiKey" placeholder="Dán API Key của bạn vào đây..." />
                      </label>
                      <div class="tiny">Cần có để sử dụng các tính năng AI. Lấy key miễn phí tại <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a>.</div>
                  </div>
                  <div>
                      <h4>🎵 Nhạc nền YouTube</h4>
                      <div class="row" style="gap:8px; align-items:center;">
                          <input type="text" id="set_youtubeUrl" placeholder="Dán link YouTube vào đây..." style="flex:1;">
                          </div>
                      <div id="ytUrlFeedback" class="tiny" style="min-height: 1.2em; padding: 4px 0;"></div>
                      <div class="row" style="margin-top: 4px;">
                          <label style="flex: 0 1 auto; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                              <input type="checkbox" id="set_ytThumbAsBg">
                              <span>Dùng ảnh bìa video làm nền</span>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 8px;">
                          <button id="btnToggleYtSound" class="btn small" style="flex:0 1 auto;" title="Dừng sẽ không tự phát lại cho đến khi bạn bấm ▶️">▶️</button>
                          <input type="range" id="ytSoundVolume" min="0" max="100" step="1" value="80" style="flex:1;">
                      </div>
                      <div class="tiny" style="text-align:center; margin-top:4px;">Âm lượng</div>
                  </div>
                  <div>
                      <h4>🛡️ Cài đặt sao lưu</h4>
                      <div class="row">
                          <label>Số ngày sao lưu cần giữ lại
                               <input type="number" id="set_backupDays" min="1" max="30" />
                          </label>
                      </div>
                  </div>
                  <div>
                      <h4>🛡️ Phục hồi dữ liệu</h4>
                      <p class="tiny">Phục hồi dữ liệu từ một bản sao lưu tự động hàng ngày. Hành động này sẽ ghi đè lên dữ liệu hiện tại của bạn.</p>
                      <div class="row">
                          <select id="backupList" style="flex: 3;"></select>
                          <button id="btnRestoreBackup" class="btn warn small" style="flex: 1;">Phục hồi</button>
                      </div>
                  </div>
              </div>
          </div>
          <div class="row" style="margin-top:16px; justify-content:flex-end">
              <button class="btn ghost" id="btnDefaults">Mặc định</button>
              <button class="btn acc" id="btnSaveSettings">Lưu</button>
              <button class="btn" id="btnCloseSettings">Đóng</button>
          </div>
      </div>
  </div>

  <div class="modal" id="modalNote" role="dialog" aria-modal="true" aria-labelledby="noteTitle">
    <div class="modal-card">
      <h3 id="noteTitle">📝 Ghi chú cho phiên vừa hoàn thành</h3>
      <div class="row"><textarea id="noteText" placeholder="Bạn học được gì? Khó khăn? Next steps?"></textarea></div>
      <div class="row" style="justify-content:flex-end; margin-top:8px; gap: 12px;">
        <button class="btn" id="btnSummarizeNote">✨ Tóm tắt & Gợi ý</button>
        <button class="btn" id="btnSkipNote">Bỏ qua</button>
        <button class="btn acc" id="btnSaveNote">Lưu ghi chú</button>
      </div>
    </div>
  </div>

  <div class="modal" id="modalGeneric" role="dialog" aria-modal="true" aria-labelledby="genericTitle">
      <div class="modal-card" style="width: min(450px, 94vw);">
          <h3 id="genericTitle">Tiêu đề</h3>
          <p id="genericMessage" class="hidden"></p>
          <input type="text" id="genericInput" class="hidden" />
          <div class="row" style="justify-content:flex-end; margin-top:12px">
              <button class="btn" id="btnGenericCancel">Hủy</button>
              <button class="btn acc" id="btnGenericOk">OK</button>
          </div>
      </div>
  </div>
  
  <div class="modal" id="modalDashboard" role="dialog" aria-modal="true" aria-labelledby="dashboardTitle">
    <div class="modal-card" style="width: min(800px, 95vw);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h3 id="dashboardTitle">📊 Tổng quan</h3>
            <button class="btn ghost small" id="btnCloseDashboard">Đóng</button>
        </div>
        <p class="tiny">Tổng hợp thời gian và số phiên đã hoàn thành trên tất cả các chủ đề.</p>
        <div id="dashboardContent" style="max-height: 60vh; overflow-y: auto;"></div>
    </div>
  </div>

  <div class="modal" id="modalMethodEditor" role="dialog" aria-modal="true">
    <div class="modal-card" style="width: min(800px, 95vw);">
      <h3 id="methodEditorTitle">Chỉnh-sửa Phương-pháp</h3>
      
      <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
        <input type="hidden" id="methodEditorId">
        <label>Tiêu-đề<input type="text" id="methodEditorTitleInput"></label>
        
        <label>Nội-dung</label>
        <div class="editor-toolbar">
          <button id="toolH4" class="btn small ghost" title="Tiêu-đề nhỏ">H</button>
          <button id="toolBold" class="btn small ghost" title="In đậm">B</button>
          <button id="toolItalic" class="btn small ghost" title="In nghiêng">I</button>
          <button id="toolList" class="btn small ghost" title="Danh-sách">1.</button>
          <button id="toolBullet" class="btn small ghost" title="Danh sách chấm tròn">•</button>

          <div class="color-picker-wrapper">
            <button id="toolColor" class="btn small ghost" title="Màu chữ">A</button>
            <div class="color-palette hidden">
              <button class="color-swatch" style="background-color: var(--text);" data-color="var(--text)" title="Màu chữ mặc định"></button>
              <button class="color-swatch" style="background-color: var(--acc);" data-color="var(--acc)" title="Màu nhấn mạnh"></button>
              <button class="color-swatch" style="background-color: var(--acc-2);" data-color="var(--acc-2)" title="Màu tích cực"></button>
              <button class="color-swatch" style="background-color: var(--warn);" data-color="var(--warn)" title="Màu cảnh báo"></button>
              <button class="color-swatch" style="background-color: var(--danger);" data-color="var(--danger)" title="Màu nguy hiểm"></button>
              <button class="color-swatch" style="background-color: var(--purple);" data-color="var(--purple)" title="Màu tím"></button>
            </div>
          </div>
        </div>

        <div class="editor-container">
            <div id="methodEditorContentInput" class="editable-content" contenteditable="true"></div>
        </div>

      </div>

      <div class="row" style="justify-content:space-between; margin-top:16px">
        <button id="btnAutoFormat" class="btn small" disabled title="Tính năng này yêu cầu Gemini API Key">✨ Tự động định dạng</button>
        <div>
          <button class="btn" id="btnCancelMethodEditor">Hủy</button>
          <button class="btn acc" id="btnSaveMethod">Lưu</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toasts" id="toasts"></div>
  <audio id="audioWorkEnd"></audio>
  <audio id="audioBreakEnd"></audio>
  <audio id="audioLongEnd"></audio>
  <div id="youtube-player-container"></div>

  <div id="draggableTimer" class="draggable-timer">00:00</div>

  <div id="soundPermissionBar" class="sound-permission-bar" role="alert" aria-live="polite">
    <span class="msg">Nhấn "Bật âm thanh" để cho phép phát nhạc nền.</span>
    <button id="btnEnableSound" class="btn small acc">Bật âm thanh</button>
  </div>
<!-- YouTube Iframe API is loaded dynamically when needed -->
<!-- === START: Inline Minimal Sortable (Offline-Safe) === -->
<script>
// Minimal Sortable shim for offline single-file usage.
// Supports: draggable selector, cross-list via same group, onEnd callback.
(function(){
  if (window.Sortable) return; // Respect existing if loaded
  const DND = { src: null, from: null, selector: null, group: null };
  function makeDraggable(container, selector){
    Array.from(container.querySelectorAll(selector)).forEach(el => {
      try { el.setAttribute('draggable','true'); } catch(_) {}
    });
  }
  function closestItem(e, selector){
    const t = e.target && e.target.closest ? e.target.closest(selector) : null;
    return t || null;
  }
  function Sortable(container, opts){
    this.el = container;
    this.options = opts || {};
    const selector = this.options.draggable || '*';
    const group = this.options.group || null;
    makeDraggable(container, selector);
    const handleDragStart = (e) => {
      const item = closestItem(e, selector);
      if (!item) return;
      DND.src = item; DND.from = container; DND.selector = selector; DND.group = group;
      e.dataTransfer.effectAllowed = 'move';
      try { e.dataTransfer.setData('text/plain', ''); } catch(_) {}
    };
    const handleDragOver = (e) => {
      if (!DND.src) return;
      // Only allow drop if same selector and group matches (or no group)
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
    };
    const handleDrop = (e) => {
      if (!DND.src) return;
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
      const from = DND.from;
      const to = container;
      const children = Array.from(from.querySelectorAll(DND.selector));
      const oldIndex = children.indexOf(DND.src);
      if (target && DND.src && target !== DND.src) {
        to.insertBefore(DND.src, target);
      }
      const newChildren = Array.from(to.querySelectorAll(DND.selector));
      const newIndex = newChildren.indexOf(DND.src);
      if (typeof this.options.onEnd === 'function') {
        try { this.options.onEnd({ oldIndex, newIndex, from, to, item: DND.src }); } catch(_) {}
      }
      DND.src = null; DND.from = null; DND.selector = null; DND.group = null;
    };
    this._listeners = { handleDragStart, handleDragOver, handleDrop };
    container.addEventListener('dragstart', handleDragStart);
    container.addEventListener('dragover', handleDragOver);
    container.addEventListener('drop', handleDrop);
    this.destroy = () => {
      container.removeEventListener('dragstart', handleDragStart);
      container.removeEventListener('dragover', handleDragOver);
      container.removeEventListener('drop', handleDrop);
    };
  }
  window.Sortable = Sortable;
})();
</script>
<!-- === END: Inline Minimal Sortable === -->
  <script>
    const _0x2d0238=_0x1056;(function(_0x15eab9,_0xde38ae){const _0x14e864=_0x1056,_0x67922e=_0x15eab9();while(!![]){try{const _0xee1690=-parseInt(_0x14e864(0x21a))/0x1*(parseInt(_0x14e864(0x3b5))/0x2)+-parseInt(_0x14e864(0x302))/0x3+parseInt(_0x14e864(0x4e4))/0x4+-parseInt(_0x14e864(0x272))/0x5*(parseInt(_0x14e864(0x2e3))/0x6)+parseInt(_0x14e864(0x2e1))/0x7+parseInt(_0x14e864(0x44f))/0x8*(-parseInt(_0x14e864(0x47d))/0x9)+parseInt(_0x14e864(0x3bf))/0xa*(parseInt(_0x14e864(0x2b6))/0xb);if(_0xee1690===_0xde38ae)break;else _0x67922e['push'](_0x67922e['shift']());}catch(_0x2beb45){_0x67922e['push'](_0x67922e['shift']());}}}(_0x56f2,0x2134d),window[_0x2d0238(0x2cf)](_0x2d0238(0x3e6),()=>{try{updateFullscreenButton();}catch(_0x231db5){}}));const IS_FILE_PROTOCOL=window['location'][_0x2d0238(0x282)]===_0x2d0238(0x4a4);function startYtApiWatchdog(){const _0x17df43=_0x2d0238,_0x22d1bf=document[_0x17df43(0x215)](_0x17df43(0x335));if(!_0x22d1bf)return;const _0x5bfbf8=setTimeout(()=>{const _0x3d23bd=_0x17df43;try{(!window['YT']||!window['YT'][_0x3d23bd(0x44a)])&&(_0x22d1bf[_0x3d23bd(0x27c)]='Đang\x20tải\x20API\x20YouTube...',_0x22d1bf[_0x3d23bd(0x3e8)][_0x3d23bd(0x31c)]=_0x3d23bd(0x478));}catch(_0x2d465c){}},0x5dc),_0x3ae2bc=setTimeout(()=>{const _0x23bb54=_0x17df43;try{(!window['YT']||!window['YT']['Player'])&&(_0x22d1bf[_0x23bb54(0x27c)]=_0x23bb54(0x220),_0x22d1bf[_0x23bb54(0x3e8)][_0x23bb54(0x31c)]='var(--danger)');}catch(_0x1cc68e){}},0x1b58);window['__ytApiWatchdog']={'cancel'(){clearTimeout(_0x5bfbf8),clearTimeout(_0x3ae2bc);}};}(function(){const _0x4eb48b=_0x2d0238,_0x250f0c={'timer.cycleInfo':({current:current=0x0,target:target=0x0}={})=>_0x4eb48b(0x20f)+current+'/'+target,'timer.selectSubtopicPrompt':'Vui\x20lòng\x20chọn\x20một\x20Chủ\x20đề\x20con\x20trước\x20khi\x20thực\x20hiện\x20thao\x20tác.'};window['t']=function _0x964d7a(_0x267396,_0x295096){try{const _0x3a1ae0=_0x250f0c[_0x267396];if(typeof _0x3a1ae0==='function')return _0x3a1ae0(_0x295096||{});if(typeof _0x3a1ae0==='string')return _0x3a1ae0;}catch(_0x2340c9){}return _0x267396;},window['loadLanguage']=function _0x46582d(_0x587d5b){const _0x5d5117=_0x4eb48b;try{localStorage[_0x5d5117(0x4d0)]('lang',_0x587d5b||'vi');}catch(_0x4649e5){}return Promise['resolve']();};}());function ensureYouTubeAPI(){const _0x22e710=_0x2d0238;if(IS_FILE_PROTOCOL)return Promise[_0x22e710(0x238)](![]);try{if(window['YT']&&window['YT'][_0x22e710(0x44a)])return Promise[_0x22e710(0x238)](!![]);}catch(_0x837b95){}if(window[_0x22e710(0x26a)])return window[_0x22e710(0x26a)];return startYtApiWatchdog(),window[_0x22e710(0x26a)]=new Promise((_0x39b7d3,_0x4a4bec)=>{const _0x357544=_0x22e710;try{const _0x1a1e65=document['createElement'](_0x357544(0x1e5));_0x1a1e65[_0x357544(0x342)]=_0x357544(0x396),_0x1a1e65[_0x357544(0x2c6)]=!![],_0x1a1e65[_0x357544(0x24d)]=!![],_0x1a1e65[_0x357544(0x4cc)]=()=>_0x39b7d3(!![]),_0x1a1e65[_0x357544(0x420)]=()=>_0x4a4bec(new Error('Failed\x20to\x20load\x20YouTube\x20API')),document[_0x357544(0x259)][_0x357544(0x2f2)](_0x1a1e65);}catch(_0x5a0668){_0x4a4bec(_0x5a0668);}}),window[_0x22e710(0x26a)];}const storageManager={'DB_NAME':_0x2d0238(0x4a6),'DB_VERSION':0x1,'db':null,async 'initDB'(){return new Promise((_0x531b39,_0x5d0bee)=>{const _0x5ba197=_0x1056;if(this['db'])return _0x531b39(this['db']);const _0x3bd5e2=indexedDB[_0x5ba197(0x34c)](this[_0x5ba197(0x4e3)],this['DB_VERSION']);_0x3bd5e2[_0x5ba197(0x209)]=_0x1f8c3f=>{const _0x2189ec=_0x5ba197,_0x325ef9=_0x1f8c3f['target'][_0x2189ec(0x479)];!_0x325ef9[_0x2189ec(0x4c1)]['contains']('settings')&&_0x325ef9[_0x2189ec(0x4c8)](_0x2189ec(0x3aa));!_0x325ef9[_0x2189ec(0x4c1)]['contains'](_0x2189ec(0x2ad))&&_0x325ef9[_0x2189ec(0x4c8)]('topics',{'keyPath':'id'});if(!_0x325ef9['objectStoreNames'][_0x2189ec(0x433)]('subtopics')){const _0x30d37e=_0x325ef9['createObjectStore'](_0x2189ec(0x2bf),{'keyPath':'id'});_0x30d37e[_0x2189ec(0x2ce)](_0x2189ec(0x26f),_0x2189ec(0x3b7));}!_0x325ef9['objectStoreNames'][_0x2189ec(0x433)](_0x2189ec(0x3cd))&&_0x325ef9[_0x2189ec(0x4c8)](_0x2189ec(0x3cd),{'keyPath':_0x2189ec(0x43a)});},_0x3bd5e2[_0x5ba197(0x30d)]=_0x26cd60=>{const _0x4083ac=_0x5ba197;this['db']=_0x26cd60[_0x4083ac(0x4ff)][_0x4083ac(0x479)],console[_0x4083ac(0x2ac)](_0x4083ac(0x3f0)),_0x531b39(this['db']);},_0x3bd5e2[_0x5ba197(0x420)]=_0x5961e2=>{const _0x1ed006=_0x5ba197;console[_0x1ed006(0x39b)]('IndexedDB\x20error:',_0x5961e2[_0x1ed006(0x4ff)][_0x1ed006(0x41d)]),_0x5d0bee(_0x5961e2[_0x1ed006(0x4ff)][_0x1ed006(0x39b)]);};});},async '_getStore'(_0x342b42,_0x257fff=_0x2d0238(0x320)){const _0x15be3=_0x2d0238;await this[_0x15be3(0x22e)]();const _0x5adf5a=this['db'][_0x15be3(0x3ba)]([_0x342b42],_0x257fff);return _0x5adf5a[_0x15be3(0x38b)](_0x342b42);},async 'getSettings'(){const _0x2bc705=_0x2d0238,_0x2ea4d7=await this[_0x2bc705(0x46e)]('settings');return new Promise((_0x211cab,_0x174fa1)=>{const _0x581488=_0x2bc705,_0x4a4718=_0x2ea4d7['get']('main_settings');_0x4a4718['onsuccess']=()=>_0x211cab(_0x4a4718['result']),_0x4a4718[_0x581488(0x420)]=()=>_0x174fa1(_0x4a4718[_0x581488(0x39b)]);});},async 'updateSettings'(_0x2b8549){const _0x53c9c4=_0x2d0238,_0x1d0466=await this[_0x53c9c4(0x46e)](_0x53c9c4(0x3aa),_0x53c9c4(0x4f7));return new Promise((_0x50552c,_0x38da6b)=>{const _0x2988d9=_0x53c9c4,_0x59251d=_0x1d0466['put'](_0x2b8549,'main_settings');_0x59251d[_0x2988d9(0x30d)]=()=>_0x50552c(_0x59251d[_0x2988d9(0x479)]),_0x59251d[_0x2988d9(0x420)]=()=>_0x38da6b(_0x59251d['error']);});},async 'getAll'(_0x3e7523){const _0x29052e=_0x2d0238,_0x161a47=await this[_0x29052e(0x46e)](_0x3e7523);return new Promise((_0x4abc7b,_0x26d9f9)=>{const _0x23c190=_0x29052e,_0x870206=_0x161a47[_0x23c190(0x231)]();_0x870206['onsuccess']=()=>_0x4abc7b(_0x870206[_0x23c190(0x479)]),_0x870206['onerror']=()=>_0x26d9f9(_0x870206[_0x23c190(0x39b)]);});},async 'update'(_0x1d0498,_0x35052b){const _0x544a4b=_0x2d0238,_0x4503c9=await this[_0x544a4b(0x46e)](_0x1d0498,_0x544a4b(0x4f7));return new Promise((_0x3ed903,_0x34fccf)=>{const _0x5d6f8b=_0x544a4b,_0x5e2d70=_0x4503c9[_0x5d6f8b(0x30c)](_0x35052b);_0x5e2d70[_0x5d6f8b(0x30d)]=()=>_0x3ed903(_0x5e2d70[_0x5d6f8b(0x479)]),_0x5e2d70[_0x5d6f8b(0x420)]=()=>_0x34fccf(_0x5e2d70['error']);});},async 'add'(_0x44626c,_0x17d3e0){const _0x3234db=_0x2d0238,_0x4964b8=await this[_0x3234db(0x46e)](_0x44626c,_0x3234db(0x4f7));return new Promise((_0x21fdf2,_0x69b171)=>{const _0x4aff81=_0x3234db,_0x26a046=_0x4964b8['add'](_0x17d3e0);_0x26a046['onsuccess']=()=>_0x21fdf2(_0x26a046[_0x4aff81(0x479)]),_0x26a046[_0x4aff81(0x420)]=()=>_0x69b171(_0x26a046[_0x4aff81(0x39b)]);});},async 'delete'(_0x394e9e,_0x4acff5){const _0x2e059f=await this['_getStore'](_0x394e9e,'readwrite');return new Promise((_0x549ca2,_0x24f42b)=>{const _0x4d7f2f=_0x1056,_0x35b8a7=_0x2e059f['delete'](_0x4acff5);_0x35b8a7[_0x4d7f2f(0x30d)]=()=>_0x549ca2(_0x35b8a7[_0x4d7f2f(0x479)]),_0x35b8a7[_0x4d7f2f(0x420)]=()=>_0x24f42b(_0x35b8a7[_0x4d7f2f(0x39b)]);});},async 'save'(_0x37e994){return await this['initDB'](),new Promise((_0x2492c4,_0x25b083)=>{const _0xfec411=_0x1056,_0xd6a44=this['db'][_0xfec411(0x3ba)]([_0xfec411(0x3aa),_0xfec411(0x2ad),_0xfec411(0x2bf)],'readwrite'),_0x376f2a=_0xd6a44[_0xfec411(0x38b)](_0xfec411(0x3aa)),_0x200c4c=_0xd6a44[_0xfec411(0x38b)](_0xfec411(0x2ad)),_0x7a714a=_0xd6a44[_0xfec411(0x38b)](_0xfec411(0x2bf));_0x376f2a['put'](_0x37e994[_0xfec411(0x3aa)],'main_settings'),_0x200c4c[_0xfec411(0x2b4)](),_0x7a714a[_0xfec411(0x2b4)](),_0x37e994[_0xfec411(0x2ad)]['forEach'](_0x5b3ba3=>{const _0x48b587=_0xfec411,{subtopics:_0x17a875,..._0x2d6c3f}=_0x5b3ba3;_0x200c4c[_0x48b587(0x30c)](_0x2d6c3f),(_0x17a875||[])[_0x48b587(0x481)](_0xef5055=>_0x7a714a[_0x48b587(0x30c)](_0xef5055));}),_0xd6a44[_0xfec411(0x3a8)]=()=>_0x2492c4(),_0xd6a44[_0xfec411(0x420)]=_0x48e975=>_0x25b083(_0x48e975[_0xfec411(0x4ff)][_0xfec411(0x39b)]);});},async 'autoBackup'(_0x49bd19){const _0x84585a=_0x2d0238;await this[_0x84585a(0x22e)]();const _0x40b366=new Date()['toISOString']()[_0x84585a(0x213)](0x0,0xa),_0x3bbafc=localStorage[_0x84585a(0x459)](_0x84585a(0x357));if(_0x40b366!==_0x3bbafc){console['log'](_0x84585a(0x376)+_0x40b366+_0x84585a(0x48a));const _0x5ca22d={'date':_0x40b366,'data':JSON['parse'](JSON[_0x84585a(0x399)](_0x49bd19))},_0x4f4cde=this['db']['transaction'](['backups'],_0x84585a(0x4f7)),_0x155bb6=_0x4f4cde[_0x84585a(0x38b)](_0x84585a(0x3cd)),_0x182b8e=_0x155bb6[_0x84585a(0x30c)](_0x5ca22d);_0x182b8e[_0x84585a(0x30d)]=()=>{const _0x48bf54=_0x84585a;localStorage[_0x48bf54(0x4d0)](_0x48bf54(0x357),_0x40b366),console[_0x48bf54(0x2ac)](_0x48bf54(0x21b)),this[_0x48bf54(0x232)](_0x49bd19?.[_0x48bf54(0x3aa)]?.['backupDaysToKeep']||0x7);},_0x182b8e['onerror']=_0x1d40ae=>{const _0x54ceb3=_0x84585a;console[_0x54ceb3(0x39b)](_0x54ceb3(0x3f1),_0x1d40ae[_0x54ceb3(0x4ff)]['error']);};}},async 'cleanupOldBackups'(_0x49b6b5){const _0x22427f=_0x2d0238;await this[_0x22427f(0x22e)]();const _0x5aaf9d=this['db'][_0x22427f(0x3ba)](['backups'],_0x22427f(0x4f7)),_0x733a12=_0x5aaf9d[_0x22427f(0x38b)](_0x22427f(0x3cd)),_0x4acb61=_0x733a12[_0x22427f(0x2dd)]();_0x4acb61[_0x22427f(0x30d)]=()=>{const _0x4e329b=_0x22427f,_0x5280c5=_0x4acb61[_0x4e329b(0x479)]['sort']()[_0x4e329b(0x366)]();if(_0x5280c5[_0x4e329b(0x21c)]>_0x49b6b5){const _0x567968=_0x5280c5[_0x4e329b(0x213)](_0x49b6b5);_0x567968['forEach'](_0x27ea90=>{const _0x1580ea=_0x4e329b;_0x733a12[_0x1580ea(0x212)](_0x27ea90),console[_0x1580ea(0x2ac)](_0x1580ea(0x2b9)+_0x27ea90);});}};},async 'getBackupList'(){const _0x1ab64d=_0x2d0238;return await this[_0x1ab64d(0x22e)](),new Promise((_0x3f90a3,_0x58d041)=>{const _0x2e6b89=_0x1ab64d,_0x33562c=this['db'][_0x2e6b89(0x3ba)]([_0x2e6b89(0x3cd)],_0x2e6b89(0x320)),_0x85106b=_0x33562c[_0x2e6b89(0x38b)]('backups'),_0x1d769d=_0x85106b['getAll']();_0x1d769d[_0x2e6b89(0x30d)]=()=>_0x3f90a3(_0x1d769d[_0x2e6b89(0x479)][_0x2e6b89(0x201)]((_0xab8fc4,_0x2e4d71)=>_0x2e4d71['date'][_0x2e6b89(0x2e9)](_0xab8fc4['date']))),_0x1d769d['onerror']=_0x2028f9=>_0x58d041(_0x2028f9[_0x2e6b89(0x4ff)][_0x2e6b89(0x39b)]);});},async 'restoreBackup'(_0x519c65){const _0x4df4a3=_0x2d0238;return await this[_0x4df4a3(0x22e)](),new Promise((_0x18c829,_0x13e748)=>{const _0x2f8c33=_0x4df4a3,_0x442334=this['db'][_0x2f8c33(0x3ba)]([_0x2f8c33(0x3cd)],_0x2f8c33(0x320)),_0x3f877d=_0x442334[_0x2f8c33(0x38b)](_0x2f8c33(0x3cd)),_0x156b85=_0x3f877d[_0x2f8c33(0x2cd)](_0x519c65);_0x156b85[_0x2f8c33(0x30d)]=()=>{const _0x302fcb=_0x2f8c33;_0x156b85[_0x302fcb(0x479)]&&_0x156b85[_0x302fcb(0x479)][_0x302fcb(0x430)]?(localStorage['setItem'](_0x302fcb(0x314),JSON[_0x302fcb(0x399)](_0x156b85[_0x302fcb(0x479)]['data'])),_0x18c829(_0x156b85['result']['data'])):_0x13e748(new Error(_0x302fcb(0x47f)));},_0x156b85[_0x2f8c33(0x420)]=_0x2ebb74=>_0x13e748(_0x2ebb74[_0x2f8c33(0x4ff)][_0x2f8c33(0x39b)]);});},'exportData'(_0xba7cf0){const _0x150fc5=_0x2d0238;let _0x505ec4={};try{_0x505ec4=JSON[_0x150fc5(0x205)](JSON[_0x150fc5(0x399)](_0xba7cf0||{}));}catch(_0x51a7a8){_0x505ec4=_0xba7cf0;}try{if(_0x505ec4&&_0x505ec4['settings'])_0x505ec4[_0x150fc5(0x3aa)][_0x150fc5(0x445)]='';}catch(_0x16453a){}const _0x329bcc=new Blob([JSON['stringify'](_0x505ec4,null,0x2)],{'type':_0x150fc5(0x3c9)}),_0x4124f2=document[_0x150fc5(0x255)]('a'),_0x276510=new Date(),_0x3d55d3=_0x1d1c8a=>(''+_0x1d1c8a)[_0x150fc5(0x2a9)](0x2,'0');_0x4124f2['href']=URL[_0x150fc5(0x306)](_0x329bcc),_0x4124f2[_0x150fc5(0x4af)]=_0x150fc5(0x4cf)+_0x276510[_0x150fc5(0x365)]()+_0x3d55d3(_0x276510[_0x150fc5(0x35b)]()+0x1)+_0x3d55d3(_0x276510['getDate']())+_0x150fc5(0x33f),_0x4124f2[_0x150fc5(0x4da)](),URL[_0x150fc5(0x440)](_0x4124f2[_0x150fc5(0x301)]);},async 'importData'(_0x56aa09){const _0x1a2cad=_0x2d0238,_0x2110f8=await _0x56aa09[_0x1a2cad(0x28e)](),_0x7aefb4=JSON[_0x1a2cad(0x205)](_0x2110f8);if(!_0x7aefb4['version']||!_0x7aefb4['settings']||!Array[_0x1a2cad(0x2d9)](_0x7aefb4[_0x1a2cad(0x2ad)]))throw new Error('Tệp\x20không\x20đúng\x20định\x20dạng');try{const _0x13026a=window[_0x1a2cad(0x430)]&&window[_0x1a2cad(0x430)][_0x1a2cad(0x3aa)]&&window['data'][_0x1a2cad(0x3aa)][_0x1a2cad(0x445)]||'';(!('apiKey'in _0x7aefb4['settings'])||_0x7aefb4[_0x1a2cad(0x3aa)][_0x1a2cad(0x445)]==='')&&(_0x7aefb4[_0x1a2cad(0x3aa)][_0x1a2cad(0x445)]=_0x13026a);}catch(_0x55c0f3){}return localStorage[_0x1a2cad(0x4d0)](_0x1a2cad(0x314),JSON[_0x1a2cad(0x399)](_0x7aefb4)),_0x7aefb4;}},$=(_0x143924,_0x34d69d=document)=>_0x34d69d['querySelector'](_0x143924),breakSuggestions=[_0x2d0238(0x417),'Uống\x20một\x20ly\x20nước\x20để\x20giữ\x20đủ\x20nước.',_0x2d0238(0x369),_0x2d0238(0x466),_0x2d0238(0x2fb),_0x2d0238(0x41e),_0x2d0238(0x2ef),_0x2d0238(0x223),_0x2d0238(0x2e2),_0x2d0238(0x2b2),'Đặt\x20tay\x20lên\x20ngực,\x20cảm\x20nhận\x20nhịp\x20tim\x20của\x20mình.',_0x2d0238(0x4fa),'Massage\x20nhẹ\x20hai\x20bên\x20thái\x20dương.',_0x2d0238(0x2b7),_0x2d0238(0x4de),_0x2d0238(0x3f2),_0x2d0238(0x48f),_0x2d0238(0x45f),_0x2d0238(0x330),'Chú\x20ý\x20đến\x20cảm\x20giác\x20nhiệt\x20độ,\x20ánh\x20sáng\x20trong\x20phòng.',_0x2d0238(0x235),'Làm\x20động\x20tác\x20“thở\x20dài”\x20sâu\x20một\x20lần,\x20thả\x20lỏng\x20vai.','Lắng\x20nghe\x20hơi\x20thở\x20ra\x20vào\x20qua\x20mũi.',_0x2d0238(0x30e),'Đứng\x20lên\x20và\x20đi\x20lại\x20vài\x20bước\x20để\x20máu\x20lưu\x20thông.',_0x2d0238(0x34a),_0x2d0238(0x1f5),_0x2d0238(0x1f2),_0x2d0238(0x244),'Bước\x20ra\x20ban\x20công,\x20tận\x20hưởng\x20ánh\x20sáng\x20tự\x20nhiên.',_0x2d0238(0x418),_0x2d0238(0x4f6)],$$=(_0x1adaa7,_0x240096=document)=>Array['from'](_0x240096[_0x2d0238(0x4c6)](_0x1adaa7));function on(_0x252e47,_0x18943e,_0x2b1d72){const _0x3f8014=_0x2d0238;if(!_0x252e47){console[_0x3f8014(0x4e1)]('Missing\x20element',_0x18943e);return;}_0x252e47['addEventListener'](_0x18943e,_0x2b1d72);}const formatMMSS=_0x51a1f2=>{const _0xadea32=_0x2d0238,_0x207f16=Math['floor'](_0x51a1f2/0x3c)[_0xadea32(0x35e)]()['padStart'](0x2,'0'),_0x20e6a0=Math[_0xadea32(0x2b1)](_0x51a1f2%0x3c)['toString']()[_0xadea32(0x2a9)](0x2,'0');return _0x207f16+':'+_0x20e6a0;},uid=(_0x3ec26d='id')=>_0x3ec26d+'_'+Date[_0x2d0238(0x456)]()+'_'+Math[_0x2d0238(0x38c)]()['toString'](0x24)[_0x2d0238(0x213)](0x2,0x9);let __releaseFocusTrap=null;function trapFocus(_0x47e5ca){const _0x482a3b=_0x2d0238;try{const _0x207be0=_0x47e5ca[_0x482a3b(0x4c6)]('button,\x20[href],\x20input,\x20select,\x20textarea,\x20[tabindex]:not([tabindex=\x22-1\x22])');if(!_0x207be0['length'])return;const _0x797bd7=_0x207be0[0x0],_0x24a4a0=_0x207be0[_0x207be0[_0x482a3b(0x21c)]-0x1],_0x4b2e29=_0x5056a9=>{const _0x56be2a=_0x482a3b;if(_0x5056a9['key']===_0x56be2a(0x265)){if(_0x5056a9[_0x56be2a(0x39d)]&&document[_0x56be2a(0x260)]===_0x797bd7)_0x5056a9[_0x56be2a(0x45e)](),_0x24a4a0['focus']();else!_0x5056a9[_0x56be2a(0x39d)]&&document[_0x56be2a(0x260)]===_0x24a4a0&&(_0x5056a9[_0x56be2a(0x45e)](),_0x797bd7[_0x56be2a(0x28d)]());}};_0x47e5ca[_0x482a3b(0x2cf)](_0x482a3b(0x428),_0x4b2e29),_0x797bd7[_0x482a3b(0x28d)](),__releaseFocusTrap=()=>{const _0xfd0b8e=_0x482a3b;try{_0x47e5ca[_0xfd0b8e(0x3b1)](_0xfd0b8e(0x428),_0x4b2e29);}catch(_0x165306){}};}catch(_0x35adeb){}}function releaseFocus(){if(__releaseFocusTrap){try{__releaseFocusTrap();}catch(_0x350d49){}__releaseFocusTrap=null;}}const todayISO=()=>new Date()[_0x2d0238(0x3a1)]();function toast(_0x209c8b,_0x466563=0xa28){const _0x6bce7c=_0x2d0238,_0x312008=$(_0x6bce7c(0x495)),_0x1d929b=document[_0x6bce7c(0x255)](_0x6bce7c(0x3a5));_0x1d929b[_0x6bce7c(0x488)]='toast',_0x1d929b[_0x6bce7c(0x27c)]=_0x209c8b,_0x312008[_0x6bce7c(0x2f2)](_0x1d929b),setTimeout(()=>{const _0x1351a1=_0x6bce7c;_0x1d929b[_0x1351a1(0x3e8)][_0x1351a1(0x43d)]='0';},_0x466563-0x12c),setTimeout(()=>_0x312008[_0x6bce7c(0x2f1)](_0x1d929b),_0x466563);}function escapeHTML(_0x2bc1d1){const _0x2b1656=_0x2d0238;return _0x2bc1d1[_0x2b1656(0x4a3)](/[&<>"']/g,_0x172fd4=>({'&':_0x2b1656(0x3e3),'<':'&lt;','>':_0x2b1656(0x30f),'\x22':_0x2b1656(0x374),'\x27':'&#39;'}[_0x172fd4]));}function formatDaysHoursMinutes(_0x583430){const _0x59e2a7=_0x2d0238;if(!_0x583430||_0x583430<0x1)return _0x59e2a7(0x3dd);const _0x4585e1=Math['floor'](_0x583430/0x3c),_0x1cd8d9=_0x583430%0x3c,_0x457882=_0x1cd8d9[_0x59e2a7(0x35e)]()[_0x59e2a7(0x2a9)](0x2,'0');return _0x4585e1+_0x59e2a7(0x1ed)+_0x457882+_0x59e2a7(0x27f);}function formatGeminiResponse(_0x13e8b6){return _0x13e8b6['replace'](/(\*\*|__|\*|_|#+\s*)/g,'');}function parseSimpleMarkdown(_0x37c42a){const _0x2d1440=_0x2d0238,_0x1eafcf=(_0x37c42a||'')['split']('\x0a');let _0x3be15c='',_0x18aca1=null;const _0x1d6d31=()=>{const _0x5aef77=_0x1056;_0x18aca1&&(_0x3be15c+=_0x18aca1==='ol'?_0x5aef77(0x447):_0x5aef77(0x1eb),_0x18aca1=null);};for(let _0x47db5e of _0x1eafcf){let _0x3e7ba9=(_0x47db5e||'')[_0x2d1440(0x452)]();if(!_0x3e7ba9){_0x1d6d31();continue;}if(_0x3e7ba9['startsWith'](_0x2d1440(0x250)))_0x1d6d31(),_0x3be15c+='<h4>'+escapeHTML(_0x3e7ba9[_0x2d1440(0x1ee)](0x5))+_0x2d1440(0x39a);else{if(/^\d+\.\s/[_0x2d1440(0x3d6)](_0x3e7ba9)){_0x18aca1!=='ol'&&(_0x1d6d31(),_0x3be15c+='<ol>',_0x18aca1='ol');const _0x2d0569=_0x3e7ba9[_0x2d1440(0x1ee)](_0x3e7ba9[_0x2d1440(0x441)]('\x20')+0x1);_0x3be15c+='<li>'+escapeHTML(_0x2d0569)+_0x2d1440(0x3f5);}else _0x3e7ba9[_0x2d1440(0x49f)]('-\x20')?(_0x18aca1!=='ul'&&(_0x1d6d31(),_0x3be15c+='<ul>',_0x18aca1='ul'),_0x3be15c+=_0x2d1440(0x3fe)+escapeHTML(_0x3e7ba9['substring'](0x2))+_0x2d1440(0x3f5)):(_0x1d6d31(),_0x3e7ba9=escapeHTML(_0x3e7ba9)[_0x2d1440(0x4a3)](/\*\*(.*?)\*\*/g,_0x2d1440(0x230))[_0x2d1440(0x4a3)](/_(.*?)_/g,_0x2d1440(0x4e2)),_0x3be15c+=_0x2d1440(0x36b)+_0x3e7ba9+_0x2d1440(0x1f3));}}return _0x1d6d31(),_0x3be15c;}function wrapTextInMarkdown(_0xf2f776,_0x852ca9,_0x1280c1=''){const _0x56132b=_0x2d0238;if(!_0xf2f776)return;const _0x4e8394=_0xf2f776[_0x56132b(0x3fa)]||0x0,_0x419de4=_0xf2f776[_0x56132b(0x3d2)]||0x0,_0x45b05f=_0xf2f776['value']['substring'](_0x4e8394,_0x419de4),_0xbb1f4f=_0x852ca9+_0x45b05f+(_0x1280c1||_0x852ca9);_0xf2f776['setRangeText'](_0xbb1f4f,_0x4e8394,_0x419de4,'end'),_0xf2f776[_0x56132b(0x28d)]();}function updateEditorPreview(){const _0x189813=_0x2d0238,_0x7e9f08=$('#methodEditorContentInput'),_0x546104=$('#editorPreview');if(!_0x7e9f08||!_0x546104)return;const _0x39e0e6=_0x7e9f08['value']||'';_0x546104[_0x189813(0x4b3)]=parseSimpleMarkdown(_0x39e0e6);}function normalizeDataStructure(_0x4b5a5d){const _0x3d026b=_0x2d0238;if(!_0x4b5a5d||typeof _0x4b5a5d!=='object')return;const _0x3c4350=_0x4b5a5d[_0x3d026b(0x3aa)]||{},_0x336356={...defaults[_0x3d026b(0x3aa)],..._0x3c4350,'durations':{...defaults['settings'][_0x3d026b(0x286)],..._0x3c4350[_0x3d026b(0x286)]||{}}};if(!Array['isArray'](_0x336356[_0x3d026b(0x4df)]))_0x336356[_0x3d026b(0x4df)]=[];_0x4b5a5d[_0x3d026b(0x3aa)]=_0x336356,_0x4b5a5d['topics']=Array[_0x3d026b(0x2d9)](_0x4b5a5d['topics'])?_0x4b5a5d['topics']:[],_0x4b5a5d[_0x3d026b(0x2ad)][_0x3d026b(0x481)](_0x2a66d9=>{const _0x284ef9=_0x3d026b;_0x2a66d9[_0x284ef9(0x2bf)]=Array[_0x284ef9(0x2d9)](_0x2a66d9[_0x284ef9(0x2bf)])?_0x2a66d9[_0x284ef9(0x2bf)]:[],_0x2a66d9[_0x284ef9(0x2bf)][_0x284ef9(0x481)](_0x2ae159=>{const _0x6a35ad=_0x284ef9;_0x2ae159['tasks']=_0x2ae159[_0x6a35ad(0x3c0)]||[],_0x2ae159[_0x6a35ad(0x284)]=_0x2ae159[_0x6a35ad(0x284)]||[],_0x2ae159['summaries']=_0x2ae159[_0x6a35ad(0x44b)]||[],_0x2ae159[_0x6a35ad(0x1fe)]=_0x2ae159[_0x6a35ad(0x1fe)]||[],_0x2ae159['methods']=Array[_0x6a35ad(0x2d9)](_0x2ae159['methods'])?_0x2ae159[_0x6a35ad(0x377)]:[],_0x2ae159[_0x6a35ad(0x221)]=_0x2ae159[_0x6a35ad(0x221)]||{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},_0x2ae159['sessions']=_0x2ae159[_0x6a35ad(0x3a2)]||[],_0x2ae159[_0x6a35ad(0x273)]=_0x2ae159['timerState']||{'state':_0x6a35ad(0x40f),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0};});});}function extractYouTubeID(_0x5ccddf){if(!_0x5ccddf)return null;const _0x9f7015=/^.*(?:youtu.be\/|shorts\/|live\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([A-Za-z0-9_-]{11}).*/,_0x5c7ab9=_0x5ccddf['match'](_0x9f7015);return _0x5c7ab9?_0x5c7ab9[0x1]:null;}let sessionYoutubeUrl='';function getActiveYoutubeUrl(){const _0x176869=_0x2d0238;try{if(sessionYoutubeUrl)return sessionYoutubeUrl;const _0x58d6e1=document[_0x176869(0x215)]('set_youtubeUrl'),_0x2b828b=(_0x58d6e1&&_0x58d6e1[_0x176869(0x258)]?_0x58d6e1['value']:'')[_0x176869(0x452)]();return _0x2b828b;}catch(_0x2d914b){return'';}}function getActiveVideoId(){return extractYouTubeID(getActiveYoutubeUrl());}function handleYoutubeUrlInput(){const _0x117794=_0x2d0238,_0x42622d=$(_0x117794(0x464)),_0x3f1a10=$(_0x117794(0x4d2)),_0x1ab9d6=$(_0x117794(0x2d8)),_0x1f7e7a=_0x42622d['value'][_0x117794(0x452)](),_0x1a553b=extractYouTubeID(_0x1f7e7a);if(_0x1a553b){_0x3f1a10[_0x117794(0x27c)]=_0x117794(0x416),_0x3f1a10[_0x117794(0x3e8)]['color']=_0x117794(0x247),_0x1ab9d6[_0x117794(0x211)]=![],sessionYoutubeUrl=_0x1f7e7a;try{ytUserPaused=![];}catch(_0x3434aa){}try{const _0x2b3998=_0x117794(0x313)+_0x1a553b+_0x117794(0x28a),_0x10cf68=new Image();_0x10cf68[_0x117794(0x4cc)]=async()=>{const _0x4e4cb2=_0x117794;data['settings'][_0x4e4cb2(0x3f7)]=_0x2b3998;try{await saveData();}catch(_0x5ba5d8){}applyCustomBg();},_0x10cf68[_0x117794(0x420)]=async()=>{const _0x3cc105=_0x117794,_0x16ae2f=_0x3cc105(0x313)+_0x1a553b+_0x3cc105(0x2ab);data[_0x3cc105(0x3aa)][_0x3cc105(0x3f7)]=_0x16ae2f;try{await saveData();}catch(_0x4b7915){}applyCustomBg();},_0x10cf68[_0x117794(0x342)]=_0x2b3998;}catch(_0x10c66a){}try{if(IS_FILE_PROTOCOL){const _0x4f36d7=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x1a553b,{'autoplay':0x1,'mute':_0x4f36d7});try{setTimeout(()=>{const _0x14678c=_0x117794;try{fallbackPostMessage(_0x14678c(0x3f4));}catch(_0x39eb9f){}},0xfa);}catch(_0x452f88){}!_ytUnlocked&&showSoundPermission();try{setTimeout(()=>{const _0x4df513=_0x117794,_0x4edc04=document[_0x4df513(0x215)](_0x4df513(0x335));if(_0x4edc04)_0x4edc04['textContent']=_0x4df513(0x2cc);},0x1f4);}catch(_0x226de0){}}else ensureYouTubeAPI()[_0x117794(0x256)](()=>{const _0x3aac8a=_0x117794;updateYouTubePlayer();try{if(_ytUnlocked)ytFadeInPlay();else ytPlayer&&ytPlayer[_0x3aac8a(0x504)]&&ytPlayer[_0x3aac8a(0x3f4)]&&(ytPlayer[_0x3aac8a(0x504)](),ytPlayer[_0x3aac8a(0x3f4)](),_ytPrimed=!![],showSoundPermission());}catch(_0x498712){}})['catch'](()=>{});}catch(_0xb1385){}}else{if(_0x1f7e7a===''){_0x3f1a10[_0x117794(0x27c)]='',_0x1ab9d6[_0x117794(0x211)]=!![];if(IS_FILE_PROTOCOL)try{fallbackStop();}catch(_0x2d54b5){}else ytPlayer&&ytPlayer[_0x117794(0x234)]&&ytPlayer[_0x117794(0x234)]();}else _0x3f1a10[_0x117794(0x27c)]=_0x117794(0x446),_0x3f1a10['style']['color']=_0x117794(0x3de),_0x1ab9d6[_0x117794(0x211)]=!![];}}function applyTheme(_0x34062a){const _0x23b389=_0x2d0238,_0x5a1a3f=_0x34062a||data[_0x23b389(0x3aa)][_0x23b389(0x31f)]||_0x23b389(0x3c1);document[_0x23b389(0x26d)]['dataset'][_0x23b389(0x31f)]=_0x5a1a3f;const _0x458667=['lofi','space'][_0x23b389(0x326)](_0x5a1a3f),_0xdf776c=_0x5a1a3f==='light'||_0x5a1a3f===_0x23b389(0x4fe),_0x4a9ea1=data[_0x23b389(0x3aa)]['customBg'],_0x50da99=()=>{try{document['body']['style']['backgroundImage']='';}catch(_0x19db05){}};if(_0x4a9ea1&&!data[_0x23b389(0x3aa)][_0x23b389(0x421)])document[_0x23b389(0x26d)][_0x23b389(0x3e8)][_0x23b389(0x49a)](_0x23b389(0x412),_0x23b389(0x241)+_0x4a9ea1+')'),_0x50da99();else{if(_0x4a9ea1&&data[_0x23b389(0x3aa)]['useYtThumbnailAsBg'])document[_0x23b389(0x26d)][_0x23b389(0x3e8)][_0x23b389(0x49a)](_0x23b389(0x412),'url('+_0x4a9ea1+')'),_0x50da99();else{if(_0x458667)document['body'][_0x23b389(0x3e8)][_0x23b389(0x4dd)](_0x23b389(0x412)),_0x50da99();else _0xdf776c?(document[_0x23b389(0x26d)][_0x23b389(0x3e8)][_0x23b389(0x49a)](_0x23b389(0x412),_0x23b389(0x4d3)),_0x50da99()):(document['body'][_0x23b389(0x3e8)][_0x23b389(0x49a)](_0x23b389(0x412),''),document[_0x23b389(0x26d)][_0x23b389(0x3e8)][_0x23b389(0x36a)]='radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)');}}}const defaults={'version':0x1,'settings':{'apiKey':'','currentView':_0x2d0238(0x1f6),'preset':'A','autoStartNext':!![],'soundOn':!![],'volume':0.8,'soundTheme':'beep','theme':_0x2d0238(0x3c1),'cyclesA':0x4,'longBreakIntervalA':0x4,'cyclesB':0x4,'longBreakIntervalB':0x4,'flowtimeBreakRatio':0x5,'enableWinddown':!![],'enableSessionNotes':!![],'durations':{'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},'selectedTopicId':'','selectedSubtopicId':'','collapsedTopics':{},'customBg':'','customSounds':{'work_end':'','break_end':'','long_end':''},'youtubeUrl':'','youtubeVolume':0x50,'useYtThumbnailAsBg':!![],'panelOpacity':0.85,'panelBlur':0xa,'backgroundMode':'cover','backupDaysToKeep':0x7,'achievedMilestones':[],'methods':[{'id':uid('m'),'title':_0x2d0238(0x47b),'content':_0x2d0238(0x29a)},{'id':uid('m'),'title':'Phương\x20Pháp\x20Viết\x20của\x20Benjamin\x20Franklin:\x20Học\x20Viết\x20Bằng\x20Cách\x20Tái\x20Tạo','content':_0x2d0238(0x292)},{'id':uid('m'),'title':_0x2d0238(0x22c),'content':_0x2d0238(0x293)},{'id':uid('m'),'title':_0x2d0238(0x251),'content':'<p>Gợi\x20nhớ\x20chủ\x20động\x20là\x20hành\x20động\x20nỗ\x20lực\x20truy\x20xuất\x20thông\x20tin\x20từ\x20não\x20bộ\x20mà\x20không\x20nhìn\x20vào\x20tài\x20liệu.\x20Đây\x20là\x20phương\x20pháp\x20học\x20hiệu\x20quả\x20vượt\x20trội\x20so\x20với\x20việc\x20đọc\x20lại,\x20highlight\x20hay\x20tóm\x20tắt\x20một\x20cách\x20thụ\x20động.</p><h4>Nguyên\x20Tắc\x2020/80</h4><p><strong>20%\x20Cốt\x20lõi:</strong>\x20Hành\x20động\x20\x22vắt\x20óc\x22\x20để\x20nhớ\x20lại\x20thông\x20tin\x20sẽ\x20củng\x20cố\x20các\x20liên\x20kết\x20thần\x20kinh,\x20giúp\x20chuyển\x20kiến\x20thức\x20vào\x20bộ\x20nhớ\x20dài\x20hạn.\x20Cảm\x20giác\x20khó\x20khăn\x20khi\x20cố\x20gắng\x20nhớ\x20chính\x20là\x20dấu\x20hiệu\x20của\x20việc\x20học\x20tập\x20hiệu\x20quả\x20đang\x20diễn\x20ra.</p><p><strong>80%\x20Kết\x20quả:</strong>\x20Bạn\x20sẽ\x20ghi\x20nhớ\x20kiến\x20thức\x20sâu\x20và\x20lâu\x20hơn,\x20đồng\x20thời\x20biết\x20chính\x20xác\x20mình\x20đang\x20yếu\x20ở\x20đâu.</p><h4>Các\x20Phương\x20Pháp\x20Quan\x20Trọng\x20Nhất</h4><ul><li><strong>Tự\x20Kiểm\x20Tra\x20(Self-testing):</strong>\x20Thay\x20vì\x20đọc\x20lại\x20ghi\x20chú,\x20hãy\x20che\x20chúng\x20đi\x20và\x20tự\x20đặt\x20câu\x20hỏi\x20cho\x20mình.\x20Ví\x20dụ:\x20Dùng\x20flashcards\x20(thẻ\x20ghi\x20nhớ)\x20và\x20luôn\x20trả\x20lời\x20trước\x20khi\x20lật\x20xem\x20đáp\x20án.</li><li><strong>Kỹ\x20thuật\x20\x22Blurting\x22:</strong>\x20Sau\x20khi\x20học\x20một\x20chủ\x20đề,\x20hãy\x20đóng\x20sách\x20lại\x20và\x20viết\x20ra\x20giấy\x20mọi\x20thứ\x20bạn\x20có\x20thể\x20nhớ.\x20Sau\x20đó,\x20so\x20sánh\x20với\x20tài\x20liệu\x20gốc\x20để\x20lấp\x20đầy\x20những\x20lỗ\x20hổng\x20kiến\x20thức.</li><li><strong>Dạy\x20lại\x20cho\x20người\x20khác:</strong>\x20Giải\x20thích\x20một\x20khái\x20niệm\x20cho\x20người\x20khác\x20buộc\x20bạn\x20phải\x20truy\x20xuất,\x20đơn\x20giản\x20hóa\x20và\x20sắp\x20xếp\x20lại\x20thông\x20tin\x20một\x20cách\x20mạch\x20lạc.</li></ul><p><i>Tóm\x20lại:\x20Đừng\x20chỉ\x20đọc\x20lại.\x20Hãy\x20dừng\x20lại,\x20che\x20tài\x20liệu\x20đi,\x20và\x20tự\x20hỏi:\x20\x22Mình\x20thực\x20sự\x20nhớ\x20được\x20gì?\x22</i></p>'},{'id':uid('m'),'title':_0x2d0238(0x2be),'content':'<p>Nếu\x20Gợi\x20nhớ\x20chủ\x20động\x20là\x20về\x20cách\x20học,\x20thì\x20Lặp\x20lại\x20ngắt\x20quãng\x20là\x20về\x20thời\x20điểm\x20học.\x20Đây\x20là\x20một\x20hệ\x20thống\x20lên\x20lịch\x20ôn\x20tập\x20để\x20đưa\x20thông\x20tin\x20vào\x20trí\x20nhớ\x20dài\x20hạn\x20một\x20cách\x20hiệu\x20quả\x20nhất.</p><h4>Nguyên\x20Tắc\x20Cốt\x20Lõi:\x20Chống\x20Lại\x20Sự\x20Lãng\x20Quên\x20🧠</h4><p>Phương\x20pháp\x20này\x20dựa\x20trên\x20\x22Đường\x20cong\x20Lãng\x20quên\x22,\x20cho\x20thấy\x20chúng\x20ta\x20quên\x20thông\x20tin\x20nhanh\x20nhất\x20ngay\x20sau\x20khi\x20học.\x20Lặp\x20lại\x20ngắt\x20quãng\x20hoạt\x20động\x20bằng\x20cách\x20yêu\x20cầu\x20bạn\x20ôn\x20tập\x20lại\x20một\x20thông\x20tin\x20ngay\x20trước\x20khi\x20bạn\x20sắp\x20quên\x20nó.</p><p>Mỗi\x20lần\x20ôn\x20tập\x20thành\x20công\x20sẽ\x20làm\x20cho\x20khoảng\x20thời\x20gian\x20bạn\x20nhớ\x20thông\x20tin\x20đó\x20dài\x20ra.\x20Lần\x20đầu\x20bạn\x20có\x20thể\x20quên\x20sau\x201\x20ngày,\x20nhưng\x20sau\x20khi\x20ôn\x20tập,\x20bạn\x20sẽ\x20nhớ\x20được\x20trong\x203\x20ngày,\x20rồi\x201\x20tuần,\x201\x20tháng,\x20và\x20cứ\x20thế\x20xa\x20dần.</p><h4>Công\x20Cụ\x20Hiệu\x20Quả\x20Nhất:\x20Phần\x20Mềm\x20SRS\x20📱</h4><p>Thay\x20vì\x20tự\x20lên\x20lịch\x20thủ\x20công,\x20cách\x20hiệu\x20quả\x20nhất\x20là\x20sử\x20dụng\x20các\x20phần\x20mềm\x20Lặp\x20lại\x20ngắt\x20quãng\x20(Spaced\x20Repetition\x20Software\x20-\x20SRS).\x20Anki\x20được\x20xem\x20là\x20tiêu\x20chuẩn\x20vàng.\x20Nó\x20tự\x20động\x20hóa\x20hoàn\x20toàn\x20việc\x20lên\x20lịch\x20ôn\x20tập\x20cho\x20hàng\x20ngàn\x20thẻ\x20ghi\x20nhớ\x20dựa\x20trên\x20độ\x20khó\x20mà\x20bạn\x20tự\x20đánh\x20giá,\x20đảm\x20bảo\x20bạn\x20luôn\x20ôn\x20tập\x20vào\x20thời\x20điểm\x20tối\x20ưu\x20nhất.</p><h4>Sai\x20Lầm\x20Lớn\x20Nhất\x20Cần\x20Tránh\x20❌</h4><p>Lý\x20do\x20số\x20một\x20khiến\x20mọi\x20người\x20thất\x20bại\x20với\x20phương\x20pháp\x20này\x20là\x20\x22Quá\x20tải\x20Lịch\x20ôn\x20tập\x22\x20(Review\x20Overload).\x20Điều\x20này\x20xảy\x20ra\x20khi\x20bạn\x20tạo\x20quá\x20nhiều\x20thẻ\x20mới\x20mỗi\x20ngày\x20hoặc\x20bỏ\x20lỡ\x20vài\x20ngày\x20ôn\x20tập,\x20dẫn\x20đến\x20một\x20lượng\x20thẻ\x20tồn\x20đọng\x20khổng\x20lồ\x20gây\x20nản\x20chí.</p><p><strong>Giải\x20pháp\x20(20%\x20hành\x20động,\x2080%\x20kết\x20quả):</strong>\x20Hãy\x20nhất\x20quán.\x20Đặt\x20ra\x20giới\x20hạn\x20thực\x20tế\x20về\x20số\x20lượng\x20thẻ\x20mới\x20mỗi\x20ngày\x20(ví\x20dụ:\x2010-20\x20thẻ)\x20và\x20duy\x20trì\x20việc\x20ôn\x20tập\x20hàng\x20ngày.\x20Thà\x20học\x20ít\x20mà\x20đều\x20còn\x20hơn\x20học\x20dồn.</p><h4>Sự\x20Kết\x20Hợp\x20Sống\x20Còn:\x20AR\x20+\x20SR</h4><p>Lặp\x20lại\x20ngắt\x20quãng\x20(SR)\x20và\x20Gợi\x20nhớ\x20chủ\x20động\x20(AR)\x20là\x20hai\x20mặt\x20của\x20cùng\x20một\x20đồng\x20xu\x20và\x20không\x20thể\x20tách\x20rời.\x20SR\x20cung\x20cấp\x20lịch\x20trình\x20KHI\x20NÀO\x20nên\x20ôn\x20tập.\x20AR\x20là\x20hành\x20động\x20bạn\x20thực\x20hiện\x20KHI\x20ôn\x20tập.\x20Sự\x20kết\x20hợp\x20này\x20đảm\x20bảo\x20nỗ\x20lực\x20gợi\x20nhớ\x20của\x20bạn\x20xảy\x20ra\x20vào\x20\x22điểm\x20ngọt\x22\x20của\x20trí\x20nhớ.\x20Sử\x20dụng\x20Anki\x20chính\x20là\x20cách\x20triển\x20khai\x20kỹ\x20thuật\x20kết\x20hợp\x20này\x20một\x20cách\x20hiệu\x20quả\x20nhất.</p>'}]},'topics':[]};let data,editingPreset='A',AUDIO_CTX=null;function ensureAudio(){const _0x1e31a0=_0x2d0238;if(!AUDIO_CTX)AUDIO_CTX=new(window[(_0x1e31a0(0x3df))]||window[(_0x1e31a0(0x22d))])();}function tone(_0x59f8a8=0x370,_0x1fbe34=0xc8,_0x7a16a1=0.2,_0x3c0517=_0x2d0238(0x1f7),_0x15c209=0x0){const _0x1d015=_0x2d0238;ensureAudio();const _0x522944=AUDIO_CTX,_0x21609d=_0x522944['createOscillator'](),_0xa93e2=_0x522944[_0x1d015(0x43f)]();_0x21609d[_0x1d015(0x2a8)]=_0x3c0517,_0x21609d[_0x1d015(0x25d)][_0x1d015(0x258)]=_0x59f8a8,_0x21609d[_0x1d015(0x246)](_0xa93e2),_0xa93e2[_0x1d015(0x246)](_0x522944[_0x1d015(0x442)]);const _0x8d386c=_0x522944['currentTime']+_0x15c209;_0xa93e2[_0x1d015(0x413)][_0x1d015(0x362)](0x0,_0x8d386c),_0xa93e2['gain']['linearRampToValueAtTime'](_0x7a16a1,_0x8d386c+0.01),_0xa93e2[_0x1d015(0x413)][_0x1d015(0x46d)](0.0001,_0x8d386c+_0x1fbe34/0x3e8),_0x21609d[_0x1d015(0x402)](_0x8d386c),_0x21609d[_0x1d015(0x263)](_0x8d386c+_0x1fbe34/0x3e8+0.05);}function playSound(_0x3f964e){const _0x456691=_0x2d0238;if(!data[_0x456691(0x3aa)][_0x456691(0x2df)])return;const _0x493582=Math[_0x456691(0x324)](0x0,Math[_0x456691(0x4db)](0x1,data[_0x456691(0x3aa)][_0x456691(0x23b)]??0.8)),_0x38fe58=data['settings'][_0x456691(0x25f)]?.[_0x3f964e];let _0x3c55cf;if(_0x3f964e==='work_end')_0x3c55cf=$('#audioWorkEnd');else{if(_0x3f964e===_0x456691(0x393))_0x3c55cf=$(_0x456691(0x226));else{if(_0x3f964e===_0x456691(0x287))_0x3c55cf=$(_0x456691(0x2af));}}if(_0x38fe58&&_0x3c55cf){_0x38fe58['startsWith'](_0x456691(0x4d6))||_0x38fe58[_0x456691(0x49f)]('http')||_0x38fe58[_0x456691(0x49f)](_0x456691(0x1f4))?(_0x3c55cf[_0x456691(0x342)]=_0x38fe58,_0x3c55cf[_0x456691(0x23b)]=_0x493582,_0x3c55cf['play']()[_0x456691(0x24b)](_0x5127a7=>console['error'](_0x456691(0x490),_0x5127a7))):getStoredFileUrl(_0x38fe58)['then'](_0x457c80=>{const _0x1fce26=_0x456691;_0x457c80&&(_0x3c55cf[_0x1fce26(0x342)]=_0x457c80,_0x3c55cf[_0x1fce26(0x23b)]=_0x493582,_0x3c55cf[_0x1fce26(0x40c)]()['catch'](_0x93c0dc=>console[_0x1fce26(0x39b)]('Lỗi\x20phát\x20âm\x20thanh:',_0x93c0dc)));});return;}const _0x34596c=data[_0x456691(0x3aa)][_0x456691(0x23c)]||'beep';if(_0x34596c===_0x456691(0x1fb)){if(_0x3f964e==='work_end')tone(0x370,0xfa,_0x493582),tone(0x294,0xb4,_0x493582*0.8,_0x456691(0x1f7),0.22);else{if(_0x3f964e===_0x456691(0x393))tone(0x294,0xdc,_0x493582*0.9);else _0x3f964e==='long_end'&&(tone(0x208,0xc8,_0x493582),tone(0x30c,0xc8,_0x493582,_0x456691(0x1f7),0.22),tone(0x410,0xdc,_0x493582,'sine',0.44));}}else{if(_0x3f964e===_0x456691(0x48c))tone(0x4b0,0xa0,_0x493582*0.9,_0x456691(0x48e)),tone(0x384,0xdc,_0x493582*0.8,'triangle',0.18);else{if(_0x3f964e===_0x456691(0x393))tone(0x370,0xf0,_0x493582*0.8,'triangle');else _0x3f964e==='long_end'&&(tone(0x258,0xdc,_0x493582*0.9,_0x456691(0x48e)),tone(0x3b6,0xf0,_0x493582*0.9,_0x456691(0x48e),0.22),tone(0x4b0,0xf0,_0x493582,_0x456691(0x48e),0.44));}}}async function saveData(){const _0x3f164f=_0x2d0238;try{await storageManager['save'](data);}catch(_0x3d3296){console['error'](_0x3f164f(0x384),_0x3d3296),toast(_0x3f164f(0x240)+_0x3d3296[_0x3f164f(0x3a4)]);}}async function ensureValidSelection(){const _0x22fa9f=_0x2d0238,_0x3998d8=data['settings'];if(!data[_0x22fa9f(0x2ad)]||data[_0x22fa9f(0x2ad)][_0x22fa9f(0x21c)]===0x0){_0x3998d8[_0x22fa9f(0x370)]='',_0x3998d8[_0x22fa9f(0x375)]='',await saveData();return;}const _0x355ceb=data[_0x22fa9f(0x2ad)][_0x22fa9f(0x242)](_0x2967ce=>_0x2967ce['id']===_0x3998d8[_0x22fa9f(0x370)]),_0x20d8ad=_0x355ceb?.[_0x22fa9f(0x2bf)]['find'](_0x3b3829=>_0x3b3829['id']===_0x3998d8[_0x22fa9f(0x375)]);if(!_0x355ceb||!_0x20d8ad){const _0x50f420=data[_0x22fa9f(0x2ad)][0x0],_0x598f3b=_0x50f420?.[_0x22fa9f(0x2bf)]?.[0x0];_0x3998d8[_0x22fa9f(0x370)]=_0x50f420?.['id']||'',_0x3998d8[_0x22fa9f(0x375)]=_0x598f3b?.['id']||'',await saveData();}}function showInputModal(_0x2a1ce3,_0x45f58f,_0x42c59e=''){const _0x9cfdef=_0x2d0238;$(_0x9cfdef(0x477))[_0x9cfdef(0x27c)]=_0x2a1ce3,$(_0x9cfdef(0x3af))[_0x9cfdef(0x43c)]['add']('hidden');const _0x1a8e88=$(_0x9cfdef(0x32b));_0x1a8e88[_0x9cfdef(0x258)]=_0x42c59e,_0x1a8e88[_0x9cfdef(0x43c)][_0x9cfdef(0x2d2)](_0x9cfdef(0x2f4)),$(_0x9cfdef(0x30a))[_0x9cfdef(0x43c)]['add'](_0x9cfdef(0x4f2));try{trapFocus($(_0x9cfdef(0x30a)));}catch(_0x615b7f){}_0x1a8e88[_0x9cfdef(0x28d)](),_0x1a8e88[_0x9cfdef(0x40b)]();const _0x4886ae=()=>{const _0x5de384=_0x9cfdef;_0x45f58f(_0x1a8e88[_0x5de384(0x258)]),_0x1c9b26();},_0x2e91e6=()=>_0x1c9b26(),_0x381514=_0x23080d=>{const _0x1d7e1c=_0x9cfdef;if(_0x23080d[_0x1d7e1c(0x2a0)]==='Enter')_0x4886ae();if(_0x23080d['key']===_0x1d7e1c(0x41a))_0x2e91e6();};$('#btnGenericOk')[_0x9cfdef(0x274)]=_0x4886ae,$(_0x9cfdef(0x37a))[_0x9cfdef(0x274)]=_0x2e91e6,_0x1a8e88[_0x9cfdef(0x224)]=_0x381514;function _0x1c9b26(){const _0x1a1161=_0x9cfdef;$(_0x1a1161(0x30a))['classList'][_0x1a1161(0x2d2)](_0x1a1161(0x4f2)),$(_0x1a1161(0x4b5))[_0x1a1161(0x274)]=null,$('#btnGenericCancel')[_0x1a1161(0x274)]=null,_0x1a8e88[_0x1a1161(0x224)]=null;try{releaseFocus();}catch(_0x2b73df){}}}function showConfirmModal(_0x3c46e1,_0x123c73,_0xb15ed){const _0x554f69=_0x2d0238;$(_0x554f69(0x477))['textContent']=_0x3c46e1;const _0x5e80e1=$(_0x554f69(0x3af));_0x5e80e1[_0x554f69(0x27c)]=_0x123c73,_0x5e80e1[_0x554f69(0x43c)][_0x554f69(0x2d2)](_0x554f69(0x2f4)),$(_0x554f69(0x32b))[_0x554f69(0x43c)][_0x554f69(0x439)](_0x554f69(0x2f4)),$(_0x554f69(0x30a))[_0x554f69(0x43c)][_0x554f69(0x439)](_0x554f69(0x4f2));try{trapFocus($('#modalGeneric'));}catch(_0x46885b){}const _0x1e5567=()=>{_0xb15ed(!![]),_0xec0faa();},_0x3f097c=()=>{_0xb15ed(![]),_0xec0faa();};$(_0x554f69(0x4b5))['onclick']=_0x1e5567,$(_0x554f69(0x37a))['onclick']=_0x3f097c;function _0xec0faa(){const _0x5adf89=_0x554f69;$('#modalGeneric')[_0x5adf89(0x43c)][_0x5adf89(0x2d2)](_0x5adf89(0x4f2)),$(_0x5adf89(0x4b5))[_0x5adf89(0x274)]=null,$(_0x5adf89(0x37a))[_0x5adf89(0x274)]=null;try{releaseFocus();}catch(_0x5373d4){}}}let pendingNoteSessionId=null;function openNoteModal(_0x372e24){const _0x2269f5=_0x2d0238;pendingNoteSessionId=_0x372e24||null;const _0x58a2dc=$(_0x2269f5(0x28c));if(!_0x58a2dc)return;const _0x2b8942=$(_0x2269f5(0x1f8));if(_0x2b8942)try{_0x2b8942[_0x2269f5(0x258)]='';}catch(_0x979131){}_0x58a2dc['classList'][_0x2269f5(0x439)](_0x2269f5(0x4f2));try{trapFocus(_0x58a2dc);}catch(_0x476ea0){}}function closeNoteModal(){const _0x4cd872=_0x2d0238,_0x1b87f8=$(_0x4cd872(0x28c));if(!_0x1b87f8)return;_0x1b87f8[_0x4cd872(0x43c)][_0x4cd872(0x2d2)](_0x4cd872(0x4f2)),pendingNoteSessionId=null;try{releaseFocus();}catch(_0x5e9916){}}async function switchView(_0x1f2f02){const _0x484b05=_0x2d0238;$$(_0x484b05(0x424))[_0x484b05(0x481)](_0x168a46=>_0x168a46[_0x484b05(0x43c)][_0x484b05(0x2d2)](_0x484b05(0x4ec))),$(_0x484b05(0x3cf)+_0x1f2f02)[_0x484b05(0x43c)][_0x484b05(0x439)]('active'),$$(_0x484b05(0x4d1))[_0x484b05(0x481)](_0x511b08=>_0x511b08[_0x484b05(0x43c)][_0x484b05(0x2d2)](_0x484b05(0x4ec)));const _0x19c07a=$(_0x484b05(0x36f)+_0x1f2f02+'\x22]');if(_0x19c07a)_0x19c07a[_0x484b05(0x43c)][_0x484b05(0x439)](_0x484b05(0x4ec));data[_0x484b05(0x3aa)][_0x484b05(0x2d1)]=_0x1f2f02,await saveData(),_0x1f2f02===_0x484b05(0x221)&&renderDashboard();}function closeAllMenus(){const _0xcae2f4=_0x2d0238;$$(_0xcae2f4(0x3eb))['forEach'](_0x413f6f=>_0x413f6f[_0xcae2f4(0x43c)]['remove'](_0xcae2f4(0x4f2))),$$('.topic-item.menu-active')['forEach'](_0x35c8e9=>_0x35c8e9['classList'][_0xcae2f4(0x2d2)](_0xcae2f4(0x41c)));}function renderTopics(){const _0x57e2bc=_0x2d0238,_0x2da43d=$(_0x57e2bc(0x22b));if(!_0x2da43d)return;_0x2da43d[_0x57e2bc(0x4b3)]='';const _0x486934=data[_0x57e2bc(0x3aa)][_0x57e2bc(0x31e)]||{};data[_0x57e2bc(0x2ad)][_0x57e2bc(0x481)](_0x19f446=>{const _0x5ee08d=_0x57e2bc,_0x4cf0d2=document[_0x5ee08d(0x255)](_0x5ee08d(0x3a5));_0x4cf0d2[_0x5ee08d(0x488)]='topic-item',_0x4cf0d2[_0x5ee08d(0x20e)][_0x5ee08d(0x2a7)]=_0x19f446['id'];const _0x266898=document[_0x5ee08d(0x255)]('div');_0x266898[_0x5ee08d(0x488)]=_0x5ee08d(0x470);const _0x49c587=!!_0x486934[_0x19f446['id']],_0x2e7461=document[_0x5ee08d(0x255)](_0x5ee08d(0x360));_0x2e7461['className']=_0x5ee08d(0x36c),_0x2e7461[_0x5ee08d(0x34e)](_0x5ee08d(0x25c),String(!_0x49c587)),_0x2e7461[_0x5ee08d(0x4b3)]='<span\x20class=\x22ico\x22>▾</span>';const _0x26a89e=document[_0x5ee08d(0x255)](_0x5ee08d(0x3a5));_0x26a89e['className']=_0x5ee08d(0x502),_0x26a89e[_0x5ee08d(0x27c)]=_0x19f446[_0x5ee08d(0x354)];const _0x486b2e=document[_0x5ee08d(0x255)]('div');_0x486b2e[_0x5ee08d(0x488)]=_0x5ee08d(0x48b);const _0x16d3ba=document[_0x5ee08d(0x255)](_0x5ee08d(0x360));_0x16d3ba[_0x5ee08d(0x488)]=_0x5ee08d(0x40e),_0x16d3ba['innerHTML']=_0x5ee08d(0x38e),_0x16d3ba['title']='Thêm\x20Chủ\x20đề\x20con';const _0x184569=document[_0x5ee08d(0x255)](_0x5ee08d(0x3a5));_0x184569[_0x5ee08d(0x3e8)][_0x5ee08d(0x267)]=_0x5ee08d(0x2d7);const _0x2cd0dd=document[_0x5ee08d(0x255)](_0x5ee08d(0x360));_0x2cd0dd['className']=_0x5ee08d(0x2bb),_0x2cd0dd[_0x5ee08d(0x4b3)]=_0x5ee08d(0x48a),_0x2cd0dd[_0x5ee08d(0x4d7)]='Thêm\x20tùy\x20chọn';const _0x2d0a11=document[_0x5ee08d(0x255)](_0x5ee08d(0x3a5));_0x2d0a11['className']=_0x5ee08d(0x44e);const _0x4a261e=document[_0x5ee08d(0x255)](_0x5ee08d(0x360));_0x4a261e[_0x5ee08d(0x488)]=_0x5ee08d(0x3e4),_0x4a261e['innerHTML']=_0x5ee08d(0x2b5);const _0x183377=document[_0x5ee08d(0x255)](_0x5ee08d(0x360));_0x183377[_0x5ee08d(0x488)]=_0x5ee08d(0x44d),_0x183377[_0x5ee08d(0x4b3)]=_0x5ee08d(0x382),_0x2d0a11[_0x5ee08d(0x237)](_0x4a261e,_0x183377),_0x184569[_0x5ee08d(0x237)](_0x2cd0dd,_0x2d0a11),_0x486b2e['append'](_0x16d3ba,_0x184569),_0x266898[_0x5ee08d(0x237)](_0x2e7461,_0x26a89e,_0x486b2e),_0x2e7461[_0x5ee08d(0x2cf)](_0x5ee08d(0x4da),async _0x40f0fe=>{const _0x475e2b=_0x5ee08d;_0x40f0fe[_0x475e2b(0x32a)]();const _0x5dab97=!!_0x486934[_0x19f446['id']];_0x5dab97?delete _0x486934[_0x19f446['id']]:_0x486934[_0x19f446['id']]=!![],data[_0x475e2b(0x3aa)][_0x475e2b(0x31e)]=_0x486934,await storageManager[_0x475e2b(0x315)](data[_0x475e2b(0x3aa)]),renderTopics();});const _0x1fccb8=async()=>{const _0x16c3fa=_0x5ee08d,_0x5750d9=!!_0x486934[_0x19f446['id']];_0x5750d9?delete _0x486934[_0x19f446['id']]:_0x486934[_0x19f446['id']]=!![],data[_0x16c3fa(0x3aa)][_0x16c3fa(0x31e)]=_0x486934,await storageManager[_0x16c3fa(0x315)](data[_0x16c3fa(0x3aa)]),renderTopics();};_0x266898[_0x5ee08d(0x2cf)](_0x5ee08d(0x4da),async _0x30af6b=>{const _0x855cd8=_0x5ee08d,_0x18cd97=_0x30af6b[_0x855cd8(0x4ff)];if(_0x18cd97&&_0x18cd97['closest']){if(_0x18cd97[_0x855cd8(0x42e)]('.actions-menu')||_0x18cd97[_0x855cd8(0x42e)](_0x855cd8(0x204))||_0x18cd97[_0x855cd8(0x42e)](_0x855cd8(0x360))||_0x18cd97[_0x855cd8(0x42e)]('input,select,textarea'))return;}_0x30af6b[_0x855cd8(0x32a)](),await _0x1fccb8();}),_0x26a89e['addEventListener'](_0x5ee08d(0x4da),async _0x5c4884=>{const _0x2633a5=_0x5ee08d;_0x5c4884[_0x2633a5(0x32a)](),await _0x1fccb8();}),_0x4cf0d2[_0x5ee08d(0x2cf)](_0x5ee08d(0x4da),async _0x4cb5c3=>{const _0x523ddc=_0x5ee08d,_0x2e91db=_0x4cb5c3[_0x523ddc(0x4ff)];if(_0x2e91db&&_0x2e91db['closest']){if(_0x2e91db[_0x523ddc(0x42e)](_0x523ddc(0x2dc)))return;if(_0x2e91db[_0x523ddc(0x42e)](_0x523ddc(0x3a6))||_0x2e91db[_0x523ddc(0x42e)](_0x523ddc(0x204))||_0x2e91db[_0x523ddc(0x42e)]('button')||_0x2e91db[_0x523ddc(0x42e)](_0x523ddc(0x389)))return;}await _0x1fccb8();});const _0x5acb8f=document[_0x5ee08d(0x255)](_0x5ee08d(0x3a5));_0x5acb8f[_0x5ee08d(0x488)]=_0x5ee08d(0x2bf)+(_0x49c587?_0x5ee08d(0x3f9):''),_0x5acb8f[_0x5ee08d(0x20e)][_0x5ee08d(0x2a7)]=_0x19f446['id'],_0x19f446['subtopics']['forEach'](_0x5c514f=>{const _0x281d0f=_0x5ee08d,_0x3bd3af=document[_0x281d0f(0x255)](_0x281d0f(0x3a5));_0x3bd3af[_0x281d0f(0x488)]='sub-row',_0x3bd3af[_0x281d0f(0x20e)][_0x281d0f(0x309)]=_0x5c514f['id'];const _0x2a59ad=document[_0x281d0f(0x255)](_0x281d0f(0x360));_0x2a59ad[_0x281d0f(0x488)]='btn\x20subtopic-btn',_0x2a59ad[_0x281d0f(0x27c)]='•\x20'+_0x5c514f[_0x281d0f(0x354)],_0x2a59ad[_0x281d0f(0x20e)]['sid']=_0x5c514f['id'],_0x2a59ad['dataset'][_0x281d0f(0x2a7)]=_0x19f446['id'];if(data['settings']['selectedSubtopicId']===_0x5c514f['id'])_0x2a59ad[_0x281d0f(0x43c)][_0x281d0f(0x439)](_0x281d0f(0x4ec));const _0x43fc87=document[_0x281d0f(0x255)](_0x281d0f(0x3a5));_0x43fc87[_0x281d0f(0x488)]='actions';const _0x112b2c=document[_0x281d0f(0x255)]('div');_0x112b2c[_0x281d0f(0x3e8)][_0x281d0f(0x267)]='relative';const _0x5b530f=document[_0x281d0f(0x255)](_0x281d0f(0x360));_0x5b530f[_0x281d0f(0x488)]=_0x281d0f(0x2bb),_0x5b530f[_0x281d0f(0x4b3)]='...',_0x5b530f['title']=_0x281d0f(0x491);const _0x3c1e3a=document[_0x281d0f(0x255)](_0x281d0f(0x3a5));_0x3c1e3a[_0x281d0f(0x488)]=_0x281d0f(0x44e);const _0x21e216=document[_0x281d0f(0x255)](_0x281d0f(0x360));_0x21e216[_0x281d0f(0x488)]=_0x281d0f(0x3e4),_0x21e216[_0x281d0f(0x4b3)]=_0x281d0f(0x4c2);const _0x409f13=document[_0x281d0f(0x255)]('button');_0x409f13[_0x281d0f(0x488)]=_0x281d0f(0x44d),_0x409f13[_0x281d0f(0x4b3)]=_0x281d0f(0x336),_0x3c1e3a['append'](_0x21e216,_0x409f13),_0x112b2c['append'](_0x5b530f,_0x3c1e3a),_0x43fc87['append'](_0x112b2c),_0x3bd3af[_0x281d0f(0x237)](_0x2a59ad,_0x43fc87),_0x5acb8f[_0x281d0f(0x2f2)](_0x3bd3af),_0x2a59ad[_0x281d0f(0x2cf)](_0x281d0f(0x4da),()=>selectSubtopic(_0x19f446['id'],_0x5c514f['id'])),_0x5b530f[_0x281d0f(0x2cf)]('click',_0x4e6fc7=>{const _0x56ce5f=_0x281d0f;_0x4e6fc7[_0x56ce5f(0x32a)]();const _0x1f4965=_0x3c1e3a[_0x56ce5f(0x43c)][_0x56ce5f(0x433)](_0x56ce5f(0x4f2));closeAllMenus(),_0x1f4965?_0x4cf0d2['classList']['remove'](_0x56ce5f(0x41c)):(_0x3c1e3a[_0x56ce5f(0x43c)][_0x56ce5f(0x439)](_0x56ce5f(0x4f2)),_0x4cf0d2[_0x56ce5f(0x43c)]['add'](_0x56ce5f(0x41c)));}),_0x21e216['addEventListener'](_0x281d0f(0x4da),()=>showInputModal(_0x281d0f(0x460),async _0x22e52c=>{const _0x3f223a=_0x281d0f;if(!_0x22e52c)return;_0x5c514f[_0x3f223a(0x354)]=_0x22e52c,await storageManager[_0x3f223a(0x38a)](_0x3f223a(0x2bf),_0x5c514f),renderAll();},_0x5c514f[_0x281d0f(0x354)])),_0x409f13[_0x281d0f(0x2cf)](_0x281d0f(0x4da),()=>showConfirmModal(_0x281d0f(0x4b2),_0x281d0f(0x448)+_0x5c514f['name']+_0x281d0f(0x337),async _0x419160=>{const _0x1e12d1=_0x281d0f;if(!_0x419160)return;_0x19f446['subtopics']=_0x19f446[_0x1e12d1(0x2bf)][_0x1e12d1(0x1f9)](_0x1d50c6=>_0x1d50c6['id']!==_0x5c514f['id']);const _0x42df2d=data[_0x1e12d1(0x3aa)];_0x42df2d[_0x1e12d1(0x375)]===_0x5c514f['id']&&(_0x42df2d[_0x1e12d1(0x375)]='',_0x42df2d[_0x1e12d1(0x370)]='',ensureValidSelection()),await storageManager[_0x1e12d1(0x212)](_0x1e12d1(0x2bf),_0x5c514f['id']),renderAll();}));}),_0x2cd0dd[_0x5ee08d(0x2cf)]('click',_0x28b326=>{const _0x351a97=_0x5ee08d;_0x28b326['stopPropagation']();const _0x296066=_0x2d0a11['classList'][_0x351a97(0x433)](_0x351a97(0x4f2));closeAllMenus(),_0x296066?_0x4cf0d2['classList'][_0x351a97(0x2d2)](_0x351a97(0x41c)):(_0x2d0a11[_0x351a97(0x43c)][_0x351a97(0x439)](_0x351a97(0x4f2)),_0x4cf0d2[_0x351a97(0x43c)][_0x351a97(0x439)](_0x351a97(0x41c)));}),_0x16d3ba['addEventListener'](_0x5ee08d(0x4da),()=>showInputModal(_0x5ee08d(0x4fd),async _0x5642ed=>{const _0x5578ad=_0x5ee08d;if(!_0x5642ed)return;const _0x11a6a0={'id':uid('s'),'topicId':_0x19f446['id'],'name':_0x5642ed,'tasks':[],'generalNotes':[],'summaries':[],'chatHistory':[],'methods':[],'stats':{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},'sessions':[],'timerState':{'state':_0x5578ad(0x40f),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0}};_0x19f446['subtopics'][_0x5578ad(0x4f9)](_0x11a6a0),await storageManager[_0x5578ad(0x439)](_0x5578ad(0x2bf),_0x11a6a0),renderTopics();})),_0x4a261e[_0x5ee08d(0x2cf)](_0x5ee08d(0x4da),()=>showInputModal(_0x5ee08d(0x351),async _0x525923=>{const _0x3e3983=_0x5ee08d;if(!_0x525923)return;_0x19f446[_0x3e3983(0x354)]=_0x525923,await storageManager[_0x3e3983(0x38a)]('topics',_0x19f446),renderTopics();},_0x19f446[_0x5ee08d(0x354)])),_0x183377[_0x5ee08d(0x2cf)](_0x5ee08d(0x4da),()=>showConfirmModal(_0x5ee08d(0x4b2),'Bạn\x20có\x20chắc\x20muốn\x20xóa\x20Chủ\x20đề\x20\x22'+_0x19f446[_0x5ee08d(0x354)]+_0x5ee08d(0x47e),async _0x84a062=>{const _0x52d09a=_0x5ee08d;if(!_0x84a062)return;data[_0x52d09a(0x2ad)]=data[_0x52d09a(0x2ad)][_0x52d09a(0x1f9)](_0x26c1f6=>_0x26c1f6['id']!==_0x19f446['id']),delete _0x486934[_0x19f446['id']];data['settings']['selectedTopicId']===_0x19f446['id']&&(data[_0x52d09a(0x3aa)][_0x52d09a(0x370)]='',data[_0x52d09a(0x3aa)][_0x52d09a(0x375)]='',ensureValidSelection());await storageManager['delete']('topics',_0x19f446['id']);for(const _0x24f1c2 of _0x19f446[_0x52d09a(0x2bf)]){await storageManager[_0x52d09a(0x212)](_0x52d09a(0x2bf),_0x24f1c2['id']);}renderAll();})),_0x16d3ba['addEventListener'](_0x5ee08d(0x4da),_0x1b20b3=>_0x1b20b3['stopPropagation']()),_0x4a261e[_0x5ee08d(0x2cf)](_0x5ee08d(0x4da),_0x97b457=>_0x97b457['stopPropagation']()),_0x183377['addEventListener']('click',_0x3a8402=>_0x3a8402[_0x5ee08d(0x32a)]()),_0x4cf0d2['append'](_0x266898,_0x5acb8f),_0x2da43d['appendChild'](_0x4cf0d2);});if(window[_0x57e2bc(0x4d5)]){const _0x246bf0=document['getElementById'](_0x57e2bc(0x275));if(_0x246bf0){if(_0x246bf0[_0x57e2bc(0x381)])try{_0x246bf0[_0x57e2bc(0x381)][_0x57e2bc(0x2a4)]();}catch(_0x12b2c7){}_0x246bf0[_0x57e2bc(0x381)]=new Sortable(_0x246bf0,{'animation':0x96,'draggable':_0x57e2bc(0x233),'onEnd':async function(_0x55235b){const _0x24f611=_0x57e2bc;if(_0x55235b[_0x24f611(0x458)]===_0x55235b[_0x24f611(0x206)])return;const _0x15fd1a=data[_0x24f611(0x2ad)][_0x24f611(0x266)](_0x55235b[_0x24f611(0x458)],0x1)[0x0];data[_0x24f611(0x2ad)][_0x24f611(0x266)](_0x55235b['newIndex'],0x0,_0x15fd1a),await saveData(),renderTopics();}}),_0x246bf0[_0x57e2bc(0x4c6)](_0x57e2bc(0x2dc))[_0x57e2bc(0x481)](_0x1ac19c=>{const _0x590376=_0x57e2bc;new Sortable(_0x1ac19c,{'group':_0x590376(0x348),'animation':0x96,'draggable':_0x590376(0x3da),'onEnd':async function(_0x4857de){const _0x5059e6=_0x590376,_0x34d1bd=_0x4857de['from']?.[_0x5059e6(0x20e)]?.[_0x5059e6(0x2a7)]||_0x4857de[_0x5059e6(0x346)]?.[_0x5059e6(0x42e)]('.topic-item')?.['dataset']?.[_0x5059e6(0x2a7)],_0x1d120d=_0x4857de['to']?.[_0x5059e6(0x20e)]?.[_0x5059e6(0x2a7)]||_0x4857de['to']?.[_0x5059e6(0x42e)]('.topic-item')?.[_0x5059e6(0x20e)]?.['tid'],_0x4f5fb0=data[_0x5059e6(0x2ad)]['find'](_0x19d8a0=>_0x19d8a0['id']===_0x34d1bd),_0x893c1e=data[_0x5059e6(0x2ad)][_0x5059e6(0x242)](_0xcac85=>_0xcac85['id']===_0x1d120d);if(!_0x4f5fb0||!_0x893c1e)return;let _0x91b38f=null;const _0x2379da=_0x4857de[_0x5059e6(0x368)]?.['dataset']?.[_0x5059e6(0x309)]||_0x4857de[_0x5059e6(0x368)]?.[_0x5059e6(0x276)](_0x5059e6(0x427))?.[_0x5059e6(0x20e)]?.[_0x5059e6(0x309)];if(_0x2379da){const _0x26b203=_0x4f5fb0[_0x5059e6(0x2bf)][_0x5059e6(0x468)](_0x398e81=>_0x398e81['id']===_0x2379da);if(_0x26b203>=0x0)_0x91b38f=_0x4f5fb0[_0x5059e6(0x2bf)][_0x5059e6(0x266)](_0x26b203,0x1)[0x0];}!_0x91b38f&&(_0x91b38f=_0x4f5fb0[_0x5059e6(0x2bf)][_0x5059e6(0x266)](_0x4857de['oldIndex'],0x1)[0x0]);if(!_0x91b38f)return;_0x91b38f[_0x5059e6(0x3b7)]=_0x893c1e['id'],_0x893c1e[_0x5059e6(0x2bf)][_0x5059e6(0x266)](_0x4857de[_0x5059e6(0x206)],0x0,_0x91b38f),data[_0x5059e6(0x3aa)]['selectedSubtopicId']===_0x91b38f['id']&&(data['settings'][_0x5059e6(0x370)]=_0x893c1e['id']),await saveData(),renderTopics();}});});}}}function selectSubtopic(_0x589ca,_0x151872){const _0xc68247=_0x2d0238,_0xe77d6f=$(_0xc68247(0x269)),_0x41ca21=getCurrentSubtopic();_0x41ca21&&timer[_0xc68247(0x271)]!==_0xc68247(0x40f)&&(_0x41ca21[_0xc68247(0x273)]={'state':timer[_0xc68247(0x271)],'prevState':timer[_0xc68247(0x304)],'remaining':timer[_0xc68247(0x296)],'segmentTotal':timer['segmentTotal'],'cycleIndex':timer[_0xc68247(0x449)]}),_0xe77d6f[_0xc68247(0x43c)]['add'](_0xc68247(0x371)),setTimeout(async()=>{const _0x5f1d4c=_0xc68247;data[_0x5f1d4c(0x3aa)][_0x5f1d4c(0x370)]=_0x589ca,data[_0x5f1d4c(0x3aa)][_0x5f1d4c(0x375)]=_0x151872;const _0xe73fb=getCurrentSubtopic();_0xe73fb[_0x5f1d4c(0x273)]?(timer[_0x5f1d4c(0x271)]=_0xe73fb[_0x5f1d4c(0x273)][_0x5f1d4c(0x271)],timer[_0x5f1d4c(0x304)]=_0xe73fb[_0x5f1d4c(0x273)][_0x5f1d4c(0x304)]||null,timer[_0x5f1d4c(0x296)]=_0xe73fb[_0x5f1d4c(0x273)][_0x5f1d4c(0x296)],timer['segmentTotal']=_0xe73fb[_0x5f1d4c(0x273)][_0x5f1d4c(0x3ef)],timer[_0x5f1d4c(0x449)]=_0xe73fb[_0x5f1d4c(0x273)][_0x5f1d4c(0x449)]):timer[_0x5f1d4c(0x473)](),await saveData(),timer['updateUI'](),renderAll(),switchView(_0x5f1d4c(0x1f6)),_0xe77d6f[_0x5f1d4c(0x43c)]['remove'](_0x5f1d4c(0x371));},0xc8);}function getCurrentSubtopic(){const _0x368bc3=_0x2d0238,_0x459edf=data[_0x368bc3(0x3aa)][_0x368bc3(0x370)],_0x617298=data['settings'][_0x368bc3(0x375)];if(!_0x459edf||!_0x617298)return null;const _0x2104e6=data[_0x368bc3(0x2ad)][_0x368bc3(0x242)](_0x2d6564=>_0x2d6564['id']===_0x459edf);if(!_0x2104e6)return null;return _0x2104e6[_0x368bc3(0x2bf)][_0x368bc3(0x242)](_0xff777a=>_0xff777a['id']===_0x617298)||null;}function renderContextBadge(){const _0x33af71=_0x2d0238,_0xffb3e7=getCurrentSubtopic(),_0x334a46=_0xffb3e7?_0xffb3e7['name']:_0x33af71(0x469),_0x53d49a=$(_0x33af71(0x3e5)),_0x2c45e6=$('#currentSubtopicName'),_0x1dda0d=$(_0x33af71(0x300));if(_0x53d49a)_0x53d49a[_0x33af71(0x27c)]=_0xffb3e7?'Chủ\x20đề\x20con:\x20'+_0xffb3e7['name']:_0x33af71(0x480);if(_0x2c45e6)_0x2c45e6['textContent']=_0x334a46;if(_0x1dda0d)_0x1dda0d[_0x33af71(0x27c)]=_0x334a46;}function renderSubtopicTasks(){const _0x41b450=_0x2d0238,_0x319342=getCurrentSubtopic(),_0x7095ae=$(_0x41b450(0x476)),_0x3d2471=$(_0x41b450(0x28f));if(!_0x7095ae||!_0x3d2471)return;const _0x104550=_0x3d2471[_0x41b450(0x37e)];if(!_0x319342){_0x7095ae['innerHTML']=_0x41b450(0x35f),_0x104550[_0x41b450(0x43c)][_0x41b450(0x439)]('hidden');return;}_0x104550[_0x41b450(0x43c)][_0x41b450(0x2d2)](_0x41b450(0x2f4)),_0x7095ae[_0x41b450(0x4b3)]='';const _0x3a4492=_0x319342[_0x41b450(0x3c0)]?_0x319342[_0x41b450(0x3c0)][_0x41b450(0x1f9)](_0x5dee36=>!_0x5dee36[_0x41b450(0x2a3)]):[];_0x3a4492[_0x41b450(0x21c)]===0x0&&(_0x7095ae[_0x41b450(0x4b3)]=_0x41b450(0x4ba)),_0x3a4492['forEach'](_0x11d771=>{const _0x2564a7=_0x41b450,_0x3f7692=document[_0x2564a7(0x255)]('li');_0x3f7692[_0x2564a7(0x4b3)]=_0x2564a7(0x4a5)+_0x11d771['id']+_0x2564a7(0x359)+_0x11d771['id']+'\x22>'+escapeHTML(_0x11d771[_0x2564a7(0x28e)])+_0x2564a7(0x4a0),_0x3f7692['querySelector']('input')[_0x2564a7(0x2cf)](_0x2564a7(0x4f0),_0x1ef87f=>toggleSubtopicTask(_0x1ef87f['target']['id'],_0x3f7692)),_0x7095ae[_0x2564a7(0x2f2)](_0x3f7692);});}async function addSubtopicTask(){const _0x5989e0=_0x2d0238,_0x541375=getCurrentSubtopic();if(!_0x541375){toast(t(_0x5989e0(0x24e)));return;}const _0x1c0061=$(_0x5989e0(0x28f)),_0x35476c=_0x1c0061[_0x5989e0(0x258)]['trim']();if(_0x35476c){if(!_0x541375[_0x5989e0(0x3c0)])_0x541375[_0x5989e0(0x3c0)]=[];_0x541375[_0x5989e0(0x3c0)]['push']({'id':uid(_0x5989e0(0x2f6)),'text':_0x35476c,'isCompleted':![],'createdAt':todayISO()}),await saveData(),renderSubtopicTasks(),_0x1c0061['value']='';}_0x1c0061[_0x5989e0(0x28d)]();}async function toggleSubtopicTask(_0x370685,_0x7465c8){const _0x78fbc8=_0x2d0238,_0x99893b=getCurrentSubtopic();if(!_0x99893b||!_0x99893b[_0x78fbc8(0x3c0)])return;const _0x2dbdc0=_0x99893b[_0x78fbc8(0x3c0)][_0x78fbc8(0x242)](_0x2b896a=>_0x2b896a['id']===_0x370685);_0x2dbdc0&&(_0x2dbdc0[_0x78fbc8(0x2a3)]=!![],_0x99893b[_0x78fbc8(0x221)][_0x78fbc8(0x329)]=(_0x99893b[_0x78fbc8(0x221)][_0x78fbc8(0x329)]||0x0)+0x1,await saveData(),_0x7465c8[_0x78fbc8(0x43c)][_0x78fbc8(0x439)](_0x78fbc8(0x45a)),setTimeout(()=>{renderSubtopicTasks(),renderStatsHistory();},0xc8));}const timer={'state':'idle','prevState':null,'tickHandle':null,'endAt':null,'remaining':0x0,'segmentTotal':0x0,'cyclesTarget':0x4,'cycleIndex':0x0,'mode':'A','persistInterval':0x3c*0x3e8,'lastPersist':0x0,async 'setPreset'(_0x2be755,{silent:silent=![]}={}){const _0x2eb9c4=_0x2d0238,_0x519b61=data[_0x2eb9c4(0x3aa)];this[_0x2eb9c4(0x388)]=_0x2be755,this['cyclesTarget']=_0x2be755==='A'?_0x519b61[_0x2eb9c4(0x2ed)]:_0x2be755==='B'?_0x519b61[_0x2eb9c4(0x39f)]:0x0,_0x519b61[_0x2eb9c4(0x4fb)]=_0x2be755,await saveData(),this[_0x2eb9c4(0x271)]==='idle'&&this[_0x2eb9c4(0x473)]();},'currentDurations'(){const _0xb72a88=_0x2d0238,_0x4bbf69=data[_0xb72a88(0x3aa)][_0xb72a88(0x286)];if(this[_0xb72a88(0x388)]==='A')return{'work':_0x4bbf69[_0xb72a88(0x431)],'short':_0x4bbf69[_0xb72a88(0x411)],'long':_0x4bbf69[_0xb72a88(0x398)],'winddown':_0x4bbf69['A_winddown']??0x0};if(this[_0xb72a88(0x388)]==='B')return{'work':_0x4bbf69[_0xb72a88(0x467)],'short':_0x4bbf69['B_short'],'long':_0x4bbf69['B_long'],'winddown':_0x4bbf69[_0xb72a88(0x2c5)]??0x0};return{'work':0x0,'short':0x0,'long':0x0,'winddown':0x0};},'currentConfig'(){const _0x196fdc=_0x2d0238,_0x37e07d=data[_0x196fdc(0x3aa)];if(this['mode']==='A')return{'cycles':_0x37e07d[_0x196fdc(0x2ed)],'interval':_0x37e07d[_0x196fdc(0x37f)]};if(this[_0x196fdc(0x388)]==='B')return{'cycles':_0x37e07d[_0x196fdc(0x39f)],'interval':_0x37e07d[_0x196fdc(0x2f3)]};return{'cycles':0x0,'interval':0x0};},'updateUI'(){const _0x535a9f=_0x2d0238,_0x38099e=$(_0x535a9f(0x4bb)),_0x13823d=$(_0x535a9f(0x321)),_0x3c5ffc=$('.timer-circle-container');if(!_0x38099e||!_0x13823d||!_0x3c5ffc)return;const _0x50981a=this['mode']==='C';$(_0x535a9f(0x24a))[_0x535a9f(0x43c)][_0x535a9f(0x3e2)](_0x535a9f(0x2f4),this['state']!==_0x535a9f(0x40f)||_0x50981a&&this[_0x535a9f(0x271)]===_0x535a9f(0x496)),$(_0x535a9f(0x25a))[_0x535a9f(0x43c)][_0x535a9f(0x3e2)](_0x535a9f(0x2f4),!(_0x50981a&&this['state']===_0x535a9f(0x496))),$(_0x535a9f(0x219))[_0x535a9f(0x43c)]['toggle'](_0x535a9f(0x2f4),!['work',_0x535a9f(0x4bc),_0x535a9f(0x3c3)][_0x535a9f(0x326)](this['state'])),$(_0x535a9f(0x463))[_0x535a9f(0x43c)][_0x535a9f(0x3e2)](_0x535a9f(0x2f4),this['state']!==_0x535a9f(0x2d0));let _0x1b3529='var(--muted)';if(this[_0x535a9f(0x271)]===_0x535a9f(0x496))_0x38099e['textContent']=_0x50981a?_0x535a9f(0x3e7):_0x535a9f(0x4a2),_0x38099e['className']='badge\x20state\x20work',_0x1b3529=_0x535a9f(0x245);else{if(this[_0x535a9f(0x271)]==='break')_0x38099e[_0x535a9f(0x27c)]=_0x535a9f(0x438),_0x38099e[_0x535a9f(0x488)]='badge\x20state\x20break',_0x1b3529=_0x535a9f(0x49c);else{if(this['state']===_0x535a9f(0x3c3))_0x38099e[_0x535a9f(0x27c)]=_0x535a9f(0x489),_0x38099e[_0x535a9f(0x488)]='badge\x20state\x20long',_0x1b3529=_0x535a9f(0x3de);else{if(this[_0x535a9f(0x271)]===_0x535a9f(0x2b3)){_0x38099e[_0x535a9f(0x27c)]=_0x535a9f(0x3ab),_0x38099e[_0x535a9f(0x488)]=_0x535a9f(0x4c7),_0x1b3529=_0x535a9f(0x247);try{$('#windDownChecklist')[_0x535a9f(0x43c)][_0x535a9f(0x2d2)](_0x535a9f(0x2f4)),$(_0x535a9f(0x4b1))[_0x535a9f(0x43c)][_0x535a9f(0x2d2)](_0x535a9f(0x2f4));}catch(_0x46ec22){}}else this[_0x535a9f(0x271)]==='paused'?(_0x38099e[_0x535a9f(0x27c)]='TẠM\x20DỪNG',_0x38099e[_0x535a9f(0x488)]=_0x535a9f(0x23e)):(_0x38099e['textContent']=_0x535a9f(0x46b),_0x38099e['className']=_0x535a9f(0x23e));}}}[_0x535a9f(0x496),_0x535a9f(0x4bc),_0x535a9f(0x3c3),_0x535a9f(0x2b3)]['includes'](this[_0x535a9f(0x271)])?_0x3c5ffc[_0x535a9f(0x43c)][_0x535a9f(0x439)](_0x535a9f(0x397)):_0x3c5ffc[_0x535a9f(0x43c)][_0x535a9f(0x2d2)](_0x535a9f(0x397));_0x13823d[_0x535a9f(0x3e8)][_0x535a9f(0x4ad)]=_0x1b3529,_0x3c5ffc[_0x535a9f(0x43c)][_0x535a9f(0x2d2)]('finished');const _0x3b23cc=$(_0x535a9f(0x406));if(_0x3b23cc)_0x3b23cc[_0x535a9f(0x27c)]=formatMMSS(this[_0x535a9f(0x296)]);const _0x51433f=_0x13823d['r'][_0x535a9f(0x2f8)][_0x535a9f(0x258)],_0x181cbc=0x2*Math['PI']*_0x51433f,_0x37b015=this[_0x535a9f(0x3ef)]>0x0?_0x181cbc-this[_0x535a9f(0x296)]/this[_0x535a9f(0x3ef)]*_0x181cbc:_0x181cbc;_0x13823d['style'][_0x535a9f(0x294)]=_0x181cbc,_0x13823d[_0x535a9f(0x3e8)]['strokeDashoffset']=isNaN(_0x37b015)?_0x181cbc:_0x37b015;const _0x4b371b=$('#cycleInfo');if(_0x4b371b){const _0x53ff41=this[_0x535a9f(0x436)]();_0x4b371b[_0x535a9f(0x27c)]=t('timer.cycleInfo',{'current':this[_0x535a9f(0x449)],'target':_0x53ff41[_0x535a9f(0x243)]}),_0x4b371b['classList']['toggle']('hidden',_0x50981a);}const _0x32f88c=$('#breakSuggestionDisplay');_0x32f88c&&_0x32f88c[_0x535a9f(0x43c)][_0x535a9f(0x3e2)](_0x535a9f(0x2f4),_0x50981a&&this[_0x535a9f(0x271)]==='work');const _0x22d69e=$(_0x535a9f(0x3bb));if(_0x22d69e)_0x22d69e[_0x535a9f(0x27c)]=formatMMSS(this[_0x535a9f(0x296)]);if(this[_0x535a9f(0x271)]!=='wind_down')try{$(_0x535a9f(0x37c))[_0x535a9f(0x43c)][_0x535a9f(0x439)]('hidden'),$(_0x535a9f(0x4b1))['classList']['add'](_0x535a9f(0x2f4));}catch(_0x3aeb61){}},'persistTimerState'(_0x1c87f3=![]){const _0x1522dd=_0x2d0238;try{const _0x55ef23=getCurrentSubtopic();if(!_0x55ef23)return;const _0x4f068d={'state':this[_0x1522dd(0x271)],'prevState':this[_0x1522dd(0x304)],'remaining':this[_0x1522dd(0x296)],'segmentTotal':this[_0x1522dd(0x3ef)],'cycleIndex':this[_0x1522dd(0x449)]};_0x55ef23[_0x1522dd(0x273)]=_0x4f068d;try{localStorage['setItem']('timerState_'+_0x55ef23['id'],JSON[_0x1522dd(0x399)](_0x4f068d));}catch(_0x45c139){}this[_0x1522dd(0x419)]=Date['now']();}catch(_0x490812){}},'_startTick'(){const _0xbae489=_0x2d0238;if(this['tickHandle'])clearInterval(this['tickHandle']);if(this[_0xbae489(0x388)]==='C'&&this[_0xbae489(0x271)]===_0xbae489(0x496)){this[_0xbae489(0x461)]=setInterval(()=>{const _0x42eace=_0xbae489;this[_0x42eace(0x296)]+=0x1,this[_0x42eace(0x249)](),this[_0x42eace(0x2c3)]();},0x3e8);return;}this[_0xbae489(0x461)]=setInterval(()=>{const _0x14b9d9=_0xbae489;this[_0x14b9d9(0x296)]>0x0&&(this['remaining']-=0x1,this['updateUI'](),this[_0x14b9d9(0x2c3)]()),this[_0x14b9d9(0x296)]<=0x0&&(clearInterval(this['tickHandle']),this[_0x14b9d9(0x461)]=null,this[_0x14b9d9(0x4f4)]());},0x3e8);},'_onFinishSegment'(){const _0x6bd574=_0x2d0238;if(this[_0x6bd574(0x271)]==='work'){const _0x58efa1=getCurrentSubtopic();if(_0x58efa1){const _0x5b9bdb=this[_0x6bd574(0x3e0)]()[_0x6bd574(0x496)];_0x58efa1[_0x6bd574(0x221)][_0x6bd574(0x24f)]=(_0x58efa1[_0x6bd574(0x221)]['totalMinutes']||0x0)+_0x5b9bdb,_0x58efa1['stats'][_0x6bd574(0x487)]=(_0x58efa1[_0x6bd574(0x221)][_0x6bd574(0x487)]||0x0)+0x1;const _0xa48ca8={'id':uid(_0x6bd574(0x217)),'dateISO':todayISO(),'durationMinutes':_0x5b9bdb,'mode':this[_0x6bd574(0x388)],'note':''};if(!_0x58efa1['sessions'])_0x58efa1[_0x6bd574(0x3a2)]=[];_0x58efa1[_0x6bd574(0x3a2)][_0x6bd574(0x3d4)](_0xa48ca8);if(data?.[_0x6bd574(0x3aa)]?.[_0x6bd574(0x2c1)]!==![])try{openNoteModal(_0xa48ca8['id']);}catch(_0x3382ce){}saveData(),renderStatsHistory(),checkAndShowMilestones();}this[_0x6bd574(0x449)]++;}if(typeof data!==_0x6bd574(0x33c)&&data&&data[_0x6bd574(0x3aa)]&&data[_0x6bd574(0x3aa)][_0x6bd574(0x3b6)]===![]&&this[_0x6bd574(0x271)]===_0x6bd574(0x496))playSound('work_end');else(this[_0x6bd574(0x271)]===_0x6bd574(0x2b3)||this[_0x6bd574(0x271)]===_0x6bd574(0x4bc)||this['state']===_0x6bd574(0x3c3))&&playSound(_0x6bd574(0x393));const _0x25e515=$('.timer-circle-container');if(_0x25e515)_0x25e515[_0x6bd574(0x43c)][_0x6bd574(0x439)](_0x6bd574(0x4eb));if(data[_0x6bd574(0x3aa)][_0x6bd574(0x409)]){if(this[_0x6bd574(0x271)]===_0x6bd574(0x496))data['settings'][_0x6bd574(0x3b6)]===![]?this[_0x6bd574(0x26c)]():this[_0x6bd574(0x4c5)]();else this[_0x6bd574(0x271)]==='wind_down'?this['beginBreak']():this['beginWork']();}else this[_0x6bd574(0x461)]&&(clearInterval(this['tickHandle']),this['tickHandle']=null),this['state']=_0x6bd574(0x40f),this['prevState']=null,this[_0x6bd574(0x249)](),toast('Phiên\x20đã\x20hoàn\x20thành!\x20Nhấn\x20Bắt\x20đầu\x20để\x20bắt\x20đầu\x20phiên\x20tiếp\x20theo.');},'beginWindDown'(){const _0x4169ca=_0x2d0238;if(data?.[_0x4169ca(0x3aa)]?.[_0x4169ca(0x3b6)]===![]){this[_0x4169ca(0x26c)]();return;}this['prevState']=this[_0x4169ca(0x271)],this['state']='wind_down';const _0x46258c=(this[_0x4169ca(0x3e0)]()['winddown']||0x0)*0x3c;if(_0x46258c<=0x0){this[_0x4169ca(0x26c)]();return;}this['segmentTotal']=_0x46258c,this['remaining']=_0x46258c;try{playSound(_0x4169ca(0x393));}catch(_0x390da2){}try{toast(_0x4169ca(0x505));}catch(_0x2c7584){}this['_startTick'](),this[_0x4169ca(0x249)]();},'beginWork'(){const _0x401369=_0x2d0238;this[_0x401369(0x304)]=this[_0x401369(0x271)],this[_0x401369(0x271)]=_0x401369(0x496);if(this[_0x401369(0x388)]==='C'){this[_0x401369(0x3ef)]=0x0;if(this['prevState']!==_0x401369(0x2d0))this[_0x401369(0x296)]=0x0;}else{const _0x421427=this[_0x401369(0x3e0)]()[_0x401369(0x496)]*0x3c;this[_0x401369(0x3ef)]=_0x421427;if(this[_0x401369(0x304)]!==_0x401369(0x2d0))this[_0x401369(0x296)]=_0x421427;}const _0x21594d=$(_0x401369(0x400));_0x21594d&&(_0x21594d[_0x401369(0x27c)]=''),this[_0x401369(0x327)](),this[_0x401369(0x249)]();},'finishFlowSession'(){const _0xf37ce1=_0x2d0238;if(this[_0xf37ce1(0x388)]!=='C'||this[_0xf37ce1(0x271)]!==_0xf37ce1(0x496))return;this[_0xf37ce1(0x461)]&&(clearInterval(this[_0xf37ce1(0x461)]),this[_0xf37ce1(0x461)]=null);const _0x2c260a=Math[_0xf37ce1(0x324)](0x1,parseInt(data['settings'][_0xf37ce1(0x40a)]??0x5,0xa)),_0x35a070=Math[_0xf37ce1(0x324)](0x0,this[_0xf37ce1(0x296)]|0x0),_0x4a3f6f=Math[_0xf37ce1(0x324)](0x3c,Math[_0xf37ce1(0x2b1)](_0x35a070/_0x2c260a));try{const _0x98d366=getCurrentSubtopic();if(_0x98d366){const _0x52114c=Math[_0xf37ce1(0x324)](0x1,Math[_0xf37ce1(0x475)](_0x35a070/0x3c));_0x98d366[_0xf37ce1(0x221)][_0xf37ce1(0x24f)]=(_0x98d366[_0xf37ce1(0x221)][_0xf37ce1(0x24f)]||0x0)+_0x52114c,_0x98d366[_0xf37ce1(0x221)][_0xf37ce1(0x487)]=(_0x98d366[_0xf37ce1(0x221)][_0xf37ce1(0x487)]||0x0)+0x1;const _0x58e2a3={'id':uid(_0xf37ce1(0x217)),'dateISO':todayISO(),'durationMinutes':_0x52114c,'mode':this[_0xf37ce1(0x388)],'note':''};if(!_0x98d366['sessions'])_0x98d366[_0xf37ce1(0x3a2)]=[];_0x98d366[_0xf37ce1(0x3a2)][_0xf37ce1(0x3d4)](_0x58e2a3),saveData(),renderStatsHistory(),data?.[_0xf37ce1(0x3aa)]?.[_0xf37ce1(0x2c1)]!==![]&&openNoteModal(_0x58e2a3['id']);}}catch(_0xbaa9d1){}this['state']=_0xf37ce1(0x4bc),this['segmentTotal']=_0x4a3f6f,this[_0xf37ce1(0x296)]=_0x4a3f6f,this[_0xf37ce1(0x327)](),this[_0xf37ce1(0x249)](),this[_0xf37ce1(0x2c3)](!![]);try{toast(_0xf37ce1(0x3d0)+Math[_0xf37ce1(0x475)](_0x4a3f6f/0x3c)+'\x20phút\x20theo\x20Flowtime\x20('+_0x2c260a+').');}catch(_0x3c3586){}},'beginBreak'(){const _0x43fd3e=_0x2d0238;this[_0x43fd3e(0x304)]=this[_0x43fd3e(0x271)];const _0x413f44=this[_0x43fd3e(0x436)](),_0x55cdf8=this[_0x43fd3e(0x3e0)]();if(this[_0x43fd3e(0x449)]>0x0&&this[_0x43fd3e(0x449)]%_0x413f44[_0x43fd3e(0x435)]===0x0){this['state']=_0x43fd3e(0x3c3);const _0x57adf6=_0x55cdf8[_0x43fd3e(0x423)]*0x3c;this[_0x43fd3e(0x3ef)]=_0x57adf6;if(this[_0x43fd3e(0x304)]!==_0x43fd3e(0x2d0))this[_0x43fd3e(0x296)]=_0x57adf6;toast(_0x43fd3e(0x4a7));}else{this[_0x43fd3e(0x271)]='break';const _0x2514b6=_0x55cdf8[_0x43fd3e(0x367)]*0x3c;this[_0x43fd3e(0x3ef)]=_0x2514b6;if(this[_0x43fd3e(0x304)]!==_0x43fd3e(0x2d0))this[_0x43fd3e(0x296)]=_0x2514b6;}const _0x3fe28d=$(_0x43fd3e(0x400));if(_0x3fe28d){const _0x2d8354=Math[_0x43fd3e(0x2b1)](Math[_0x43fd3e(0x38c)]()*breakSuggestions[_0x43fd3e(0x21c)]);_0x3fe28d[_0x43fd3e(0x27c)]=_0x43fd3e(0x4ca)+breakSuggestions[_0x2d8354];}this[_0x43fd3e(0x327)](),this[_0x43fd3e(0x249)]();},async 'start'(){const _0x43bbb5=_0x2d0238;if(!getCurrentSubtopic()){toast(_0x43bbb5(0x298));return;}ensureAudio();if(this[_0x43bbb5(0x388)]==='C'&&this[_0x43bbb5(0x271)]===_0x43bbb5(0x40f))this[_0x43bbb5(0x271)]=_0x43bbb5(0x496),this[_0x43bbb5(0x296)]=0x0,this['segmentTotal']=0x0,this[_0x43bbb5(0x449)]=0x0,this[_0x43bbb5(0x327)](),this['updateUI']();else{if(this[_0x43bbb5(0x271)]===_0x43bbb5(0x40f))this[_0x43bbb5(0x449)]=this[_0x43bbb5(0x449)]||0x0,this[_0x43bbb5(0x239)]();else this[_0x43bbb5(0x271)]===_0x43bbb5(0x2d0)&&this[_0x43bbb5(0x3ac)]();}await this[_0x43bbb5(0x2c3)](!![]);},async 'pause'(){const _0x671be1=_0x2d0238;this[_0x671be1(0x461)]&&(clearInterval(this[_0x671be1(0x461)]),this[_0x671be1(0x461)]=null),this['prevState']=this[_0x671be1(0x271)],this[_0x671be1(0x271)]=_0x671be1(0x2d0),this[_0x671be1(0x249)](),await this['persistTimerState'](!![]);},async 'resume'(){const _0x32cea2=_0x2d0238;if(this['state']!==_0x32cea2(0x2d0))return;this[_0x32cea2(0x271)]=this[_0x32cea2(0x304)]||_0x32cea2(0x496),this['_startTick'](),this[_0x32cea2(0x249)](),await this['persistTimerState'](!![]);},async 'skip'(){const _0x51962f=_0x2d0238;if(this['mode']==='C'&&this[_0x51962f(0x271)]===_0x51962f(0x496)){this[_0x51962f(0x484)](),await this[_0x51962f(0x2c3)](!![]);return;}this['state']===_0x51962f(0x496)?(this[_0x51962f(0x461)]&&(clearInterval(this[_0x51962f(0x461)]),this['tickHandle']=null),this['remaining']=0x0,this['_onFinishSegment']()):(this[_0x51962f(0x296)]=0x0,this[_0x51962f(0x461)]&&(clearInterval(this[_0x51962f(0x461)]),this['tickHandle']=null),this['_onFinishSegment']()),await this['persistTimerState'](!![]);},async 'reset'(){const _0xedfd2=_0x2d0238;this[_0xedfd2(0x461)]&&(clearInterval(this['tickHandle']),this['tickHandle']=null);this[_0xedfd2(0x271)]=_0xedfd2(0x40f),this[_0xedfd2(0x304)]=null,this['remaining']=0x0,this[_0xedfd2(0x3ef)]=0x0,this['cycleIndex']=0x0;const _0x3976f2=$(_0xedfd2(0x400));_0x3976f2&&(_0x3976f2[_0xedfd2(0x27c)]=''),this['updateUI'](),await this['persistTimerState'](!![]);}};async function deleteSummary(_0xda525d){const _0x1b95c8=_0x2d0238;showConfirmModal(_0x1b95c8(0x4b2),_0x1b95c8(0x425),async _0x28a94e=>{const _0x22dc34=_0x1b95c8;if(!_0x28a94e)return;const _0x365532=getCurrentSubtopic();if(!_0x365532||!_0x365532[_0x22dc34(0x44b)])return;const _0x296c32=[..._0x365532[_0x22dc34(0x44b)]];_0x365532[_0x22dc34(0x44b)]=_0x365532[_0x22dc34(0x44b)]['filter'](_0x18d38c=>_0x18d38c['id']!==_0xda525d);try{await storageManager[_0x22dc34(0x38a)]('subtopics',_0x365532),renderSummaries(),toast(_0x22dc34(0x33a));}catch(_0x3436dd){console[_0x22dc34(0x39b)](_0x22dc34(0x299),_0x3436dd),_0x365532[_0x22dc34(0x44b)]=_0x296c32,toast(_0x22dc34(0x37b));}});}function exportSummary(_0x44874d){const _0x59d0e2=_0x2d0238,_0x119381=new Blob([_0x44874d[_0x59d0e2(0x2ee)]],{'type':_0x59d0e2(0x2b8)}),_0x2e9e34=document[_0x59d0e2(0x255)]('a'),_0x5b714e=new Date(_0x44874d[_0x59d0e2(0x2c0)]),_0x5ee8d8=_0x3deac9=>(''+_0x3deac9)['padStart'](0x2,'0');_0x2e9e34['href']=URL[_0x59d0e2(0x306)](_0x119381),_0x2e9e34['download']=_0x59d0e2(0x307)+_0x5b714e[_0x59d0e2(0x365)]()+_0x5ee8d8(_0x5b714e[_0x59d0e2(0x35b)]()+0x1)+_0x5ee8d8(_0x5b714e['getDate']())+_0x59d0e2(0x3cb),_0x2e9e34['click'](),URL[_0x59d0e2(0x440)](_0x2e9e34[_0x59d0e2(0x301)]);}function renderStatsHistory(){const _0x3a10ba=_0x2d0238,_0x5d0ee9=getCurrentSubtopic(),_0x3881de=$('#statTotal'),_0x179c3c=$('#statSessions'),_0x5af44a=$('#statTasks'),_0x26dcb4=$(_0x3a10ba(0x49e));if(!_0x3881de||!_0x179c3c||!_0x5af44a||!_0x26dcb4)return;if(!_0x5d0ee9){_0x3881de['textContent']=_0x3a10ba(0x3dd),_0x179c3c[_0x3a10ba(0x27c)]='0',_0x5af44a[_0x3a10ba(0x27c)]='0',_0x26dcb4[_0x3a10ba(0x4b3)]=_0x3a10ba(0x279);return;}const _0x48d273=_0x5d0ee9['stats']&&_0x5d0ee9[_0x3a10ba(0x221)][_0x3a10ba(0x24f)]?_0x5d0ee9[_0x3a10ba(0x221)][_0x3a10ba(0x24f)]:0x0,_0x55d961=_0x5d0ee9[_0x3a10ba(0x221)]&&_0x5d0ee9[_0x3a10ba(0x221)]['sessionsCompleted']?_0x5d0ee9[_0x3a10ba(0x221)][_0x3a10ba(0x487)]:0x0,_0x571b20=_0x5d0ee9[_0x3a10ba(0x3c0)]?_0x5d0ee9['tasks'][_0x3a10ba(0x1f9)](_0x10da81=>_0x10da81[_0x3a10ba(0x2a3)])[_0x3a10ba(0x21c)]:0x0;_0x3881de[_0x3a10ba(0x27c)]=formatDaysHoursMinutes(_0x48d273),_0x179c3c[_0x3a10ba(0x27c)]=String(_0x55d961),_0x5af44a[_0x3a10ba(0x27c)]=String(_0x571b20),_0x26dcb4[_0x3a10ba(0x4b3)]='';const _0x53cab9=Array[_0x3a10ba(0x2d9)](_0x5d0ee9[_0x3a10ba(0x3a2)])?_0x5d0ee9[_0x3a10ba(0x3a2)]:[];if(_0x53cab9[_0x3a10ba(0x21c)]===0x0){_0x26dcb4[_0x3a10ba(0x4b3)]=_0x3a10ba(0x2f5);return;}_0x53cab9['forEach'](_0x20cb4e=>{const _0x4f70d6=_0x3a10ba,_0x417deb=document[_0x4f70d6(0x255)](_0x4f70d6(0x3a5));_0x417deb['className']=_0x4f70d6(0x4ee);const _0x1b2cfc=document[_0x4f70d6(0x255)]('div'),_0x438420=_0x20cb4e[_0x4f70d6(0x42c)]?new Date(_0x20cb4e[_0x4f70d6(0x42c)]):new Date(),_0x2e30b9=_0x20cb4e[_0x4f70d6(0x474)]!=null?_0x20cb4e[_0x4f70d6(0x474)]:_0x20cb4e['workMinutes']||0x0,_0x3858cc=_0x4f70d6(0x2d4)+_0x438420[_0x4f70d6(0x3d8)]()+_0x4f70d6(0x429)+_0x2e30b9+'\x27\x20·\x20Mode\x20'+(_0x20cb4e[_0x4f70d6(0x388)]||'')+_0x4f70d6(0x26b);let _0x5dfbae='';if(_0x20cb4e[_0x4f70d6(0x2c9)])_0x5dfbae=_0x4f70d6(0x482)+escapeHTML(_0x20cb4e[_0x4f70d6(0x2c9)])+_0x4f70d6(0x26b);else data?.[_0x4f70d6(0x3aa)]?.[_0x4f70d6(0x2c1)]!==![]&&(_0x5dfbae=_0x4f70d6(0x27a));_0x1b2cfc[_0x4f70d6(0x4b3)]=_0x3858cc+_0x5dfbae,_0x417deb[_0x4f70d6(0x2f2)](_0x1b2cfc),_0x26dcb4[_0x4f70d6(0x2f2)](_0x417deb);});}function renderGeneralNotes(){const _0x407672=_0x2d0238,_0x7a77ed=$('#generalNotesList');if(!_0x7a77ed)return;const _0x2dd57b=getCurrentSubtopic();if(!_0x2dd57b){_0x7a77ed[_0x407672(0x4b3)]=_0x407672(0x30b);return;}_0x2dd57b[_0x407672(0x284)]=_0x2dd57b[_0x407672(0x284)]||[];if(_0x2dd57b[_0x407672(0x284)][_0x407672(0x21c)]===0x0){_0x7a77ed[_0x407672(0x4b3)]=_0x407672(0x4e6);return;}_0x7a77ed['innerHTML']='',_0x2dd57b[_0x407672(0x284)][_0x407672(0x481)](_0x44b990=>{const _0x2cbcfb=_0x407672,_0x3e39a7=document[_0x2cbcfb(0x255)](_0x2cbcfb(0x3a5));_0x3e39a7['className']=_0x2cbcfb(0x4ac);const _0x29bb71=document[_0x2cbcfb(0x255)](_0x2cbcfb(0x3a5));_0x29bb71['className']=_0x2cbcfb(0x3b2),_0x29bb71[_0x2cbcfb(0x27c)]=typeof _0x44b990===_0x2cbcfb(0x38f)?_0x44b990:_0x44b990[_0x2cbcfb(0x28e)]||'';const _0x46f49f=document[_0x2cbcfb(0x255)](_0x2cbcfb(0x3a5));_0x46f49f[_0x2cbcfb(0x488)]='note-meta',_0x46f49f[_0x2cbcfb(0x27c)]=_0x44b990['createdAt']?new Date(_0x44b990[_0x2cbcfb(0x2c0)])[_0x2cbcfb(0x3d8)]():'';const _0x29478f=document[_0x2cbcfb(0x255)](_0x2cbcfb(0x3a5)),_0x50eca4=document[_0x2cbcfb(0x255)](_0x2cbcfb(0x360));_0x50eca4[_0x2cbcfb(0x488)]='btn\x20small\x20danger',_0x50eca4[_0x2cbcfb(0x27c)]='Xóa',_0x50eca4[_0x2cbcfb(0x274)]=async _0x5dcdd9=>{const _0xbab950=_0x2cbcfb;_0x5dcdd9[_0xbab950(0x32a)]();const _0x9ac60=getCurrentSubtopic();if(!_0x9ac60)return;_0x9ac60[_0xbab950(0x284)]=(_0x9ac60[_0xbab950(0x284)]||[])['filter'](_0x645ed5=>(_0x645ed5['id']||_0x645ed5)!==(_0x44b990['id']||_0x44b990)),await saveData(),renderGeneralNotes();},_0x29478f['appendChild'](_0x50eca4);const _0x3f3c11=document[_0x2cbcfb(0x255)]('div');_0x3f3c11['className']=_0x2cbcfb(0x4aa),_0x3f3c11[_0x2cbcfb(0x237)](_0x29bb71,_0x46f49f),_0x3e39a7[_0x2cbcfb(0x237)](_0x3f3c11,_0x29478f),_0x7a77ed[_0x2cbcfb(0x2f2)](_0x3e39a7);});}function renderMethods(){const _0x593cb6=_0x2d0238,_0xd40965=document[_0x593cb6(0x276)](_0x593cb6(0x2d6));if(!_0xd40965)return;_0xd40965[_0x593cb6(0x4b3)]='';const _0xf31661=getCurrentSubtopic();if(!_0xf31661){_0xd40965['innerHTML']=_0x593cb6(0x3a9);return;}const _0x474a51=Array[_0x593cb6(0x2d9)](_0xf31661[_0x593cb6(0x377)])?_0xf31661[_0x593cb6(0x377)]:[];if(_0x474a51['length']===0x0){_0xd40965[_0x593cb6(0x4b3)]=_0x593cb6(0x390);return;}_0x474a51[_0x593cb6(0x481)](_0x6c3fbd=>{const _0x26169c=_0x593cb6,_0xc258dc=document[_0x26169c(0x255)]('details');_0xc258dc['className']=_0x26169c(0x4c9),_0xc258dc['dataset'][_0x26169c(0x352)]=_0x6c3fbd['id'];const _0xfe8255=document[_0x26169c(0x255)](_0x26169c(0x3cc)),_0x43de22=document[_0x26169c(0x255)]('span');_0x43de22[_0x26169c(0x488)]=_0x26169c(0x462),_0x43de22[_0x26169c(0x27c)]=_0x6c3fbd[_0x26169c(0x4d7)]||_0x26169c(0x268),_0x43de22['addEventListener']('click',_0x5a6cd2=>{const _0x1934e=_0x26169c;_0x5a6cd2['preventDefault'](),_0x5a6cd2[_0x1934e(0x32a)](),_0xc258dc[_0x1934e(0x34c)]=!_0xc258dc['open'];});const _0x1eb2a6=document[_0x26169c(0x255)]('div');_0x1eb2a6['className']='topic-actions';const _0x491c58=document[_0x26169c(0x255)](_0x26169c(0x360));_0x491c58[_0x26169c(0x488)]=_0x26169c(0x2bd),_0x491c58[_0x26169c(0x27c)]=_0x26169c(0x4b4),_0x491c58['dataset']['id']=_0x6c3fbd['id'];const _0x38745f=document[_0x26169c(0x255)]('button');_0x38745f[_0x26169c(0x488)]=_0x26169c(0x32c),_0x38745f[_0x26169c(0x27c)]=_0x26169c(0x378),_0x38745f[_0x26169c(0x20e)]['id']=_0x6c3fbd['id'],_0x1eb2a6[_0x26169c(0x237)](_0x491c58,_0x38745f),_0xfe8255[_0x26169c(0x237)](_0x43de22,_0x1eb2a6);const _0x227858=document[_0x26169c(0x255)](_0x26169c(0x3a5));_0x227858[_0x26169c(0x488)]=_0x26169c(0x23d),_0x227858['innerHTML']=_0x6c3fbd['content']||'',_0xc258dc['append'](_0xfe8255,_0x227858),_0xd40965['appendChild'](_0xc258dc),_0xc258dc[_0x26169c(0x2cf)](_0x26169c(0x4da),_0x5e3229=>{const _0xa678c=_0x26169c,_0xc87ff8=_0x5e3229['target'];if(!_0xc87ff8)return;if(_0xc87ff8['closest']('button')||_0xc87ff8['closest']('a')||_0xc87ff8[_0xa678c(0x42e)](_0xa678c(0x325))||_0xc87ff8['closest']('.color-palette'))return;if(!_0xc258dc['open'])_0xc258dc['open']=!![];});});const _0x411aa8=_0xd40965['querySelectorAll']('.method-item');_0x411aa8[_0x593cb6(0x481)](_0x3be047=>{const _0x477a48=_0x593cb6;_0x3be047[_0x477a48(0x2cf)](_0x477a48(0x3e2),()=>{const _0x2a5ed1=_0x477a48;_0x3be047[_0x2a5ed1(0x34c)]&&_0x411aa8[_0x2a5ed1(0x481)](_0x509c9e=>{const _0x8c926f=_0x2a5ed1;if(_0x509c9e!==_0x3be047)_0x509c9e[_0x8c926f(0x34c)]=![];});});});}function addGeneralNote(){showInputModal('Thêm\x20ghi\x20chú',async _0x26b42a=>{const _0x1dc9a7=_0x1056;if(!_0x26b42a)return;const _0x35cad4=getCurrentSubtopic();if(!_0x35cad4){toast('Chọn\x20một\x20chủ\x20đề\x20con\x20trước.');return;}_0x35cad4[_0x1dc9a7(0x284)]=_0x35cad4[_0x1dc9a7(0x284)]||[],_0x35cad4[_0x1dc9a7(0x284)][_0x1dc9a7(0x3d4)]({'id':uid('gn'),'text':_0x26b42a,'createdAt':todayISO()}),await saveData(),renderGeneralNotes();},'');}async function summarizeNotes(){const _0x30f07b=_0x2d0238,_0x52a633=getCurrentSubtopic();if(!_0x52a633){toast('Chọn\x20chủ\x20đề\x20con\x20trước.');return;}const _0x27b46c=(_0x52a633[_0x30f07b(0x284)]||[])[_0x30f07b(0x2a1)](_0x29270b=>typeof _0x29270b==='string'?_0x29270b:_0x29270b['text']||'')[_0x30f07b(0x1f9)](Boolean);if(_0x27b46c[_0x30f07b(0x21c)]===0x0){toast(_0x30f07b(0x4d4));return;}const _0x11bb68=$(_0x30f07b(0x3c6));_0x11bb68&&(_0x11bb68['disabled']=!![],_0x11bb68[_0x30f07b(0x4b3)]='<div\x20class=\x22spinner\x22></div>');try{const _0x5ae3de=_0x30f07b(0x207)+_0x27b46c[_0x30f07b(0x380)](_0x30f07b(0x3dc)),_0x2a9c29=await callGeminiAPI(_0x5ae3de);if(!_0x52a633[_0x30f07b(0x44b)])_0x52a633[_0x30f07b(0x44b)]=[];_0x52a633['summaries'][_0x30f07b(0x3d4)]({'id':uid(_0x30f07b(0x295)),'content':_0x2a9c29||_0x30f07b(0x364),'createdAt':todayISO()}),await saveData(),renderSummaries();}catch(_0x109697){console[_0x30f07b(0x39b)](_0x109697),toast(_0x30f07b(0x4cb));}finally{_0x11bb68&&(_0x11bb68['disabled']=![],_0x11bb68[_0x30f07b(0x27c)]=_0x30f07b(0x46a));}}function renderSummaries(){const _0x4d2a58=_0x2d0238,_0x177124=$('#summariesList');if(!_0x177124)return;const _0xbb0418=getCurrentSubtopic();if(!_0xbb0418){_0x177124[_0x4d2a58(0x4b3)]=_0x4d2a58(0x46f);return;}_0x177124['innerHTML']='';if(!_0xbb0418['summaries']||_0xbb0418['summaries'][_0x4d2a58(0x21c)]===0x0){_0x177124[_0x4d2a58(0x4b3)]=_0x4d2a58(0x361);return;}_0xbb0418['summaries'][_0x4d2a58(0x481)](_0x10dfb4=>{const _0x504758=_0x4d2a58,_0x269d2c=document[_0x504758(0x255)]('div');_0x269d2c[_0x504758(0x488)]='note-item';const _0x5b7513=document[_0x504758(0x255)](_0x504758(0x3a5));_0x5b7513[_0x504758(0x488)]=_0x504758(0x4aa);const _0x64e68=document[_0x504758(0x255)]('div');_0x64e68['className']=_0x504758(0x3b2),_0x64e68['textContent']=_0x10dfb4['content'];const _0xf970ed=document[_0x504758(0x255)](_0x504758(0x3a5));_0xf970ed[_0x504758(0x488)]=_0x504758(0x28b),_0xf970ed['textContent']=new Date(_0x10dfb4[_0x504758(0x2c0)])['toLocaleString'](),_0x5b7513[_0x504758(0x237)](_0x64e68,_0xf970ed);const _0xe2f57b=document[_0x504758(0x255)](_0x504758(0x3a5)),_0x387a47=document['createElement'](_0x504758(0x360));_0x387a47[_0x504758(0x488)]=_0x504758(0x40e),_0x387a47[_0x504758(0x27c)]='Xuất',_0x387a47[_0x504758(0x274)]=_0x5b67af=>{const _0x417453=_0x504758;_0x5b67af[_0x417453(0x32a)](),exportSummary(_0x10dfb4);};const _0x4172b3=document['createElement'](_0x504758(0x360));_0x4172b3[_0x504758(0x488)]=_0x504758(0x3b4),_0x4172b3[_0x504758(0x27c)]=_0x504758(0x378),_0x4172b3[_0x504758(0x274)]=_0x2a7211=>{const _0x4b127d=_0x504758;_0x2a7211[_0x4b127d(0x32a)](),deleteSummary(_0x10dfb4['id']);},_0xe2f57b['append'](_0x387a47,_0x4172b3),_0x269d2c[_0x504758(0x237)](_0x5b7513,_0xe2f57b),_0x269d2c[_0x504758(0x2cf)](_0x504758(0x4da),()=>_0x64e68[_0x504758(0x43c)]['toggle'](_0x504758(0x3fd))),_0x177124['appendChild'](_0x269d2c);});}function loadEditingPresetFields(){const _0x2817c7=_0x2d0238,_0x420ec0=data[_0x2817c7(0x3aa)],_0x3145a6=_0x420ec0[_0x2817c7(0x286)],_0x16d423=$(_0x2817c7(0x3ff)),_0x501f66=$('#settings-flowtime');if(_0x16d423&&_0x501f66){const _0x450a49=editingPreset==='C';_0x16d423[_0x2817c7(0x43c)][_0x2817c7(0x3e2)](_0x2817c7(0x2f4),_0x450a49),_0x501f66[_0x2817c7(0x43c)][_0x2817c7(0x3e2)](_0x2817c7(0x2f4),!_0x450a49);}if(editingPreset==='A'){$(_0x2817c7(0x432))[_0x2817c7(0x258)]=_0x3145a6[_0x2817c7(0x431)];if($('#set_winddown'))$(_0x2817c7(0x3c2))[_0x2817c7(0x258)]=_0x3145a6['A_winddown']??0x0;$('#set_short')[_0x2817c7(0x258)]=_0x3145a6[_0x2817c7(0x411)],$(_0x2817c7(0x39c))[_0x2817c7(0x258)]=_0x3145a6[_0x2817c7(0x398)],$('#set_cycles')[_0x2817c7(0x258)]=_0x420ec0['cyclesA'],$(_0x2817c7(0x31d))[_0x2817c7(0x258)]=_0x420ec0[_0x2817c7(0x37f)];}else{if(editingPreset==='B'){$('#set_work')[_0x2817c7(0x258)]=_0x3145a6['B_work'];if($(_0x2817c7(0x3c2)))$(_0x2817c7(0x3c2))[_0x2817c7(0x258)]=_0x3145a6[_0x2817c7(0x2c5)]??0x0;$('#set_short')['value']=_0x3145a6[_0x2817c7(0x4e9)],$(_0x2817c7(0x39c))[_0x2817c7(0x258)]=_0x3145a6['B_long'],$(_0x2817c7(0x1fd))[_0x2817c7(0x258)]=_0x420ec0['cyclesB'],$(_0x2817c7(0x31d))['value']=_0x420ec0[_0x2817c7(0x2f3)];}else{if(editingPreset==='C'){const _0x48384e=$(_0x2817c7(0x23a));if(_0x48384e)_0x48384e[_0x2817c7(0x258)]=_0x420ec0[_0x2817c7(0x40a)]??0x5;}}}}function highlightPresetSelector(){$$('#timerPresetSelector\x20button')['forEach'](_0x24874a=>{const _0x1f364d=_0x1056,_0x4ec563=_0x24874a[_0x1f364d(0x20e)]['presetTarget']===editingPreset;_0x24874a[_0x1f364d(0x43c)][_0x1f364d(0x3e2)](_0x1f364d(0x494),_0x4ec563),_0x24874a[_0x1f364d(0x43c)]['toggle']('ghost',!_0x4ec563);});}function openSettings(){const _0x4714d0=_0x2d0238,_0x13694=data[_0x4714d0(0x3aa)];editingPreset=_0x13694['preset'],$(_0x4714d0(0x379))[_0x4714d0(0x258)]=_0x13694[_0x4714d0(0x445)]||'',loadEditingPresetFields(),highlightPresetSelector(),$('#set_volume')[_0x4714d0(0x258)]=_0x13694[_0x4714d0(0x23b)]??0.8,$(_0x4714d0(0x506))[_0x4714d0(0x258)]=_0x13694['soundTheme']||_0x4714d0(0x1fb),$(_0x4714d0(0x308))[_0x4714d0(0x258)]=_0x13694['theme']||_0x4714d0(0x3c1);const _0x49d0b4=getActiveYoutubeUrl();$(_0x4714d0(0x464))['value']=_0x49d0b4||'';const _0x53a1ce=extractYouTubeID(_0x49d0b4);$('#btnToggleYtSound')[_0x4714d0(0x211)]=!_0x53a1ce;$('#ytUrlFeedback')&&($(_0x4714d0(0x4d2))['textContent']='');$('#ytSoundVolume')[_0x4714d0(0x258)]=_0x13694[_0x4714d0(0x216)]||0x50,$('#set_ytThumbAsBg')[_0x4714d0(0x485)]=!!_0x13694['useYtThumbnailAsBg'],$(_0x4714d0(0x465))[_0x4714d0(0x258)]=_0x13694['panelOpacity']||0.85;$(_0x4714d0(0x2db))&&($('#set_backgroundMode')[_0x4714d0(0x258)]=_0x13694[_0x4714d0(0x1ea)]||'cover');$(_0x4714d0(0x405))&&($(_0x4714d0(0x405))[_0x4714d0(0x485)]=!!_0x13694[_0x4714d0(0x409)]);$(_0x4714d0(0x343))&&($(_0x4714d0(0x343))[_0x4714d0(0x485)]=_0x13694[_0x4714d0(0x3b6)]!==![]);$(_0x4714d0(0x3ad))&&($(_0x4714d0(0x3ad))[_0x4714d0(0x485)]=_0x13694[_0x4714d0(0x2c1)]!==![]);$('#set_backupDays')&&($(_0x4714d0(0x501))[_0x4714d0(0x258)]=_0x13694['backupDaysToKeep']||0x7);const _0x3a7f4a=$('#backupList');_0x3a7f4a&&storageManager['getBackupList']()[_0x4714d0(0x256)](_0x7d4013=>{const _0x597db4=_0x4714d0;_0x3a7f4a[_0x597db4(0x4b3)]=_0x597db4(0x208),_0x7d4013&&_0x7d4013[_0x597db4(0x21c)]>0x0?_0x7d4013[_0x597db4(0x481)](_0xcc3693=>{const _0xe9f87e=_0x597db4,_0x371e7d=document[_0xe9f87e(0x255)](_0xe9f87e(0x35d));_0x371e7d[_0xe9f87e(0x258)]=_0xcc3693[_0xe9f87e(0x43a)],_0x371e7d['textContent']=_0xe9f87e(0x2ba)+new Date(_0xcc3693[_0xe9f87e(0x43a)])[_0xe9f87e(0x264)](_0xe9f87e(0x332)),_0x3a7f4a[_0xe9f87e(0x2f2)](_0x371e7d);}):_0x3a7f4a[_0x597db4(0x4b3)]=_0x597db4(0x391);});$('#modalSettings')[_0x4714d0(0x43c)][_0x4714d0(0x439)]('show');try{trapFocus($('#modalSettings'));}catch(_0x2bb766){}}function closeSettings(){const _0x334048=_0x2d0238;$(_0x334048(0x2fe))[_0x334048(0x43c)][_0x334048(0x2d2)](_0x334048(0x4f2));try{releaseFocus();}catch(_0x2ee7a1){}}async function setDefaults(){const _0x53e024=_0x2d0238;data['settings'][_0x53e024(0x286)]={'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},data[_0x53e024(0x3aa)][_0x53e024(0x2ed)]=0x4,data['settings'][_0x53e024(0x37f)]=0x4,data[_0x53e024(0x3aa)]['cyclesB']=0x4,data[_0x53e024(0x3aa)][_0x53e024(0x2f3)]=0x4,data[_0x53e024(0x3aa)][_0x53e024(0x40a)]=0x5,data[_0x53e024(0x3aa)][_0x53e024(0x4fb)]='A',data[_0x53e024(0x3aa)]['volume']=0.8,data['settings'][_0x53e024(0x23c)]='beep',await saveData(),openSettings(),toast('Đã\x20khôi\x20phục\x20mặc\x20định');}async function saveSettings(){const _0x141f36=_0x2d0238,_0x1fd2fe=data['settings'];_0x1fd2fe[_0x141f36(0x445)]=$('#set_apiKey')[_0x141f36(0x258)]['trim']();const _0x5a7a4c=_0x1fd2fe['durations'];if(editingPreset==='A')_0x5a7a4c[_0x141f36(0x431)]=clampInt($('#set_work')[_0x141f36(0x258)],0x1,0x3e7),_0x5a7a4c['A_winddown']=clampInt($('#set_winddown')[_0x141f36(0x258)],0x0,0x3e7),_0x5a7a4c[_0x141f36(0x411)]=clampInt($(_0x141f36(0x3ed))[_0x141f36(0x258)],0x1,0x3e7),_0x5a7a4c[_0x141f36(0x398)]=clampInt($('#set_long')[_0x141f36(0x258)],0x1,0x3e7),_0x1fd2fe[_0x141f36(0x2ed)]=clampInt($(_0x141f36(0x1fd))[_0x141f36(0x258)],0x1,0xc),_0x1fd2fe[_0x141f36(0x37f)]=clampInt($('#set_interval')[_0x141f36(0x258)],0x2,0xc);else{if(editingPreset==='B')_0x5a7a4c['B_work']=clampInt($(_0x141f36(0x432))[_0x141f36(0x258)],0x1,0x3e7),_0x5a7a4c[_0x141f36(0x2c5)]=clampInt($(_0x141f36(0x3c2))[_0x141f36(0x258)],0x0,0x3e7),_0x5a7a4c['B_short']=clampInt($(_0x141f36(0x3ed))[_0x141f36(0x258)],0x1,0x3e7),_0x5a7a4c['B_long']=clampInt($(_0x141f36(0x39c))[_0x141f36(0x258)],0x1,0x3e7),_0x1fd2fe[_0x141f36(0x39f)]=clampInt($('#set_cycles')[_0x141f36(0x258)],0x1,0xc),_0x1fd2fe[_0x141f36(0x2f3)]=clampInt($(_0x141f36(0x31d))[_0x141f36(0x258)],0x2,0xc);else{if(editingPreset==='C'){const _0x342932=$(_0x141f36(0x23a));if(_0x342932)_0x1fd2fe[_0x141f36(0x40a)]=clampInt(_0x342932[_0x141f36(0x258)],0x1,0x14);}}}_0x1fd2fe[_0x141f36(0x23b)]=clampFloat($(_0x141f36(0x3ca))['value'],0x0,0x1,0.8),_0x1fd2fe[_0x141f36(0x23c)]=$(_0x141f36(0x506))[_0x141f36(0x258)]===_0x141f36(0x1e8)?'chime':_0x141f36(0x1fb),_0x1fd2fe['theme']=$('#set_theme_color')['value'],_0x1fd2fe[_0x141f36(0x483)]=parseFloat($(_0x141f36(0x465))[_0x141f36(0x258)])||0.85;$('#set_backgroundMode')&&(_0x1fd2fe[_0x141f36(0x1ea)]=$(_0x141f36(0x2db))[_0x141f36(0x258)]);_0x1fd2fe[_0x141f36(0x409)]=!!($(_0x141f36(0x405))&&$(_0x141f36(0x405))['checked']),_0x1fd2fe[_0x141f36(0x3b6)]=!!($(_0x141f36(0x343))&&$(_0x141f36(0x343))[_0x141f36(0x485)]),_0x1fd2fe[_0x141f36(0x2c1)]=!!($('#set_enableSessionNotes')&&$(_0x141f36(0x3ad))[_0x141f36(0x485)]);$(_0x141f36(0x501))&&(_0x1fd2fe[_0x141f36(0x3d3)]=clampInt($(_0x141f36(0x501))[_0x141f36(0x258)],0x1,0x1e));_0x1fd2fe[_0x141f36(0x31f)]==='light'||_0x1fd2fe['theme']===_0x141f36(0x4fe)?(_0x1fd2fe['useYtThumbnailAsBg']=![],typeof _0x1fd2fe[_0x141f36(0x3f7)]===_0x141f36(0x38f)&&_0x1fd2fe['customBg'][_0x141f36(0x326)](_0x141f36(0x3fc))&&(_0x1fd2fe[_0x141f36(0x3f7)]='')):_0x1fd2fe[_0x141f36(0x421)]=!![];const _0x4fb528=$(_0x141f36(0x464))['value'][_0x141f36(0x452)]();_0x1fd2fe[_0x141f36(0x421)]=$(_0x141f36(0x2fa))[_0x141f36(0x485)],_0x1fd2fe['youtubeVolume']=parseInt($(_0x141f36(0x3fb))[_0x141f36(0x258)],0xa),sessionYoutubeUrl=_0x4fb528;try{if(!IS_FILE_PROTOCOL){if(ytPlayer&&ytPlayer[_0x141f36(0x31b)])ytPlayer['setVolume'](_0x1fd2fe[_0x141f36(0x216)]);}else try{fallbackPostMessage(_0x141f36(0x31b),[_0x1fd2fe[_0x141f36(0x216)]]);}catch(_0x13c389){}}catch(_0x311215){}await saveData(),applyTheme(),applyCustomBg(),applyPanelOpacity(),updatePresetButtonsText(),timer[_0x141f36(0x4b0)](_0x1fd2fe[_0x141f36(0x4fb)],{'silent':!![]}),closeSettings(),toast('Đã\x20lưu\x20cài\x20đặt');}function clampInt(_0x4f4e8d,_0x374414,_0x2fbd28){const _0x2f55a2=_0x2d0238;_0x4f4e8d=parseInt(_0x4f4e8d||0x0,0xa);if(isNaN(_0x4f4e8d))_0x4f4e8d=_0x374414;return Math[_0x2f55a2(0x324)](_0x374414,Math[_0x2f55a2(0x4db)](_0x2fbd28,_0x4f4e8d));}function _0x56f2(){const _0x1463a5=['data','A_work','#set_work','contains','absolute','interval','currentConfig','#aiPromptSuggestions\x20button','NGHỈ\x20NGẮN','add','date','Đã\x20lưu\x20âm\x20báo\x20hết\x20NGHỈ\x20NGẮN.','classList','opacity','#btnAddSubtopicTask','createGain','revokeObjectURL','indexOf','destination','#btnSettings','<p\x20class=\x22tiny\x22><strong>Tổng\x20thời\x20gian:</strong>\x20','apiKey','❌\x20Link\x20không\x20hợp\x20lệ\x20hoặc\x20không\x20được\x20hỗ\x20trợ.','</ol>','Bạn\x20có\x20chắc\x20muốn\x20xóa\x20Chủ\x20đề\x20con\x20\x22','cycleIndex','Player','summaries','.color-palette','menu-item\x20danger','actions-menu','1218280yNTaSI','user','candidates','trim','fixed','innerWidth','bottom','now','Lỗi\x20khởi\x20tạo:\x20','oldIndex','getItem','removing','view','light','pointerdown','preventDefault','Nhẹ\x20nhàng\x20nhắm\x20mắt\x20và\x20mỉm\x20cười\x20với\x20chính\x20mình.','Đổi\x20tên\x20Chủ\x20đề\x20con','tickHandle','method-title','#btnResume','#set_youtubeUrl','#set_panelOpacity','Đi\x20dạo\x20một\x20vòng\x20ngắn\x20quanh\x20phòng.','B_work','findIndex','(chưa\x20chọn)','Tóm\x20tắt','SẴN\x20SÀNG','scroll','exponentialRampToValueAtTime','_getStore','<div\x20class=\x22tiny\x22>Vui\x20lòng\x20chọn\x20một\x20chủ\x20đề\x20con\x20để\x20xem\x20tóm\x20tắt.</div>','topic-header','Phân\x20tích\x20và\x20định\x20dạng\x20lại\x20đoạn\x20văn\x20bản\x20sau\x20đây\x20thành\x20mã\x20HTML\x20sạch.\x20Sử\x20dụng\x20các\x20thẻ\x20sau:\x0a-\x20Dùng\x20<h4>\x20cho\x20các\x20tiêu\x20đề\x20chính.\x0a-\x20Dùng\x20<strong>\x20để\x20nhấn\x20mạnh\x20các\x20thuật\x20ngữ\x20hoặc\x20ý\x20tưởng\x20quan\x20trọng.\x0a-\x20Dùng\x20<i>\x20cho\x20các\x20câu\x20ghi\x20chú\x20hoặc\x20trích\x20dẫn.\x0a-\x20Dùng\x20<ol>\x20và\x20<li>\x20cho\x20các\x20danh\x20sách\x20có\x20thứ\x20tự.\x0a-\x20Dùng\x20<ul>\x20và\x20<li>\x20cho\x20các\x20danh\x20sách\x20không\x20có\x20thứ\x20tự.\x0a-\x20Bọc\x20các\x20đoạn\x20văn\x20thông\x20thường\x20trong\x20thẻ\x20<p>.\x0aVăn\x20bản\x20cần\x20định\x20dạng:\x0a\x0a\x22','foreColor','reset','durationMinutes','round','#subtopicTasksList','#genericTitle','var(--sub)','result','Phục\x20hồi\x20dữ\x20liệu\x20thành\x20công!\x20Tải\x20lại\x20trang...','Kỹ\x20Thuật\x20Feynman:\x20Hiểu\x20Sâu\x20Bằng\x20Cách\x20Giải\x20Thích\x20Đơn\x20Giản','#btnAddMethod','9zZVRFi','\x22?\x20Mọi\x20chủ\x20đề\x20con\x20và\x20dữ\x20liệu\x20liên\x20quan\x20sẽ\x20bị\x20mất.','Không\x20tìm\x20thấy\x20bản\x20sao\x20lưu.','Chưa\x20chọn\x20Chủ\x20đề\x20con','forEach','<div>','panelOpacity','finishFlowSession','checked','yt-fallback','sessionsCompleted','className','NGHỈ\x20DÀI','...','topic-actions','work_end','toLowerCase','triangle','Kiểm\x20tra\x20và\x20chỉnh\x20lại\x20tư\x20thế\x20ngồi\x20cho\x20đúng.','Lỗi\x20phát\x20âm\x20thanh:','Thêm\x20tùy\x20chọn','\x20|\x20<strong>Tổng\x20nhiệm\x20vụ:</strong>\x20','<div\x20class=\x22spinner\x22></div>','acc','#toasts','work','Xác\x20nhận\x20chuyển\x20đổi','offsetHeight','#view-timer','setProperty','abs','var(--warn)','</tbody></table>','#historyList','startsWith','</label>','http:','LÀM\x20VIỆC','replace','file:','<input\x20type=\x22checkbox\x22\x20id=\x22','PomodoroAppDB','Tuyệt\x20vời!\x20Đã\x20đến\x20lúc\x20nghỉ\x20dài.','insertOrderedList','#btnCloseSettings','note-content-wrapper','function','note-item','stroke','onYouTubeIframeAPIReady','download','setPreset','#btnBreakEarly','Xác\x20nhận\x20xóa','innerHTML','Sửa','#btnGenericOk','postMessage','Gửi\x20bạn,\x20500\x20giờ\x20(Chuyên\x20tâm)','#btnTestSound','presetTarget','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Tuyệt\x20vời!\x20Không\x20còn\x20task\x20nào.</li>','#stateBadge','break','getPlayerState','AI\x20không\x20thể\x20định\x20dạng\x20lúc\x20này.','lofi','#btnCancelMethodEditor','objectStoreNames','Sửa\x20tên\x20Chủ\x20đề\x20con','mousemove','promptFeedback','beginWindDown','querySelectorAll','badge\x20state\x20work','createObjectStore','method-item','💡\x20Gợi\x20ý:\x20','Tóm\x20tắt\x20thất\x20bại.','onload','model','left','pomodoro_backup_','setItem','.nav-btn','#ytUrlFeedback','none','Chưa\x20có\x20ghi\x20chú\x20để\x20tóm\x20tắt.','Sortable','data:','title','display','ArrowRight','click','min','aria-pressed','removeProperty','Đếm\x20ngược\x20từ\x2020\x20đến\x200\x20thật\x20chậm\x20rãi.','achievedMilestones','#btnAddGeneralNote','warn','<i>$1</i>','DB_NAME','292912qWgxUh','isConnected','<div\x20class=\x22tiny\x22>Chưa\x20có\x20ghi\x20chú.</div>','restoreBackup','Gửi\x20bạn,\x20250\x20giờ\x20(Bền\x20bỉ)','B_short','Nội\x20dung\x20bị\x20chặn\x20vì:\x20','finished','active','ArrowUp','hist-item','https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=','change','Vui\x20lòng\x20chọn\x20một\x20Chủ\x20đề\x20con\x20trước.','show','cueVideoById','_onFinishSegment','Vui\x20lòng\x20thêm\x20Gemini\x20API\x20Key\x20trong\x20Cài\x20đặt\x20để\x20sử\x20dụng\x20tính\x20năng\x20này.','Tự\x20nhắc:\x20Nghỉ\x20ngơi\x20đúng\x20cách\x20là\x20để\x20làm\x20việc\x20tốt\x20hơn!','readwrite','\x20|\x20<strong>Tổng\x20phiên:</strong>\x20','push','Mở\x20cửa\x20sổ\x20cho\x20không\x20khí\x20mới\x20vào\x20phòng.','preset','#btnPresetB','Tên\x20Chủ\x20đề\x20con\x20mới?','pastel','target','#btnAddTopic','#set_backupDays','topic-title','Gửi\x20bạn,\x2020\x20giờ\x20(Nền\x20tảng)','mute','Đến\x20giờ\x20hạ\x20nhiệt.\x20Hãy\x20kết\x20thúc\x20công\x20việc\x20và\x20chuẩn\x20bị\x20nghỉ\x20ngơi.','#set_theme','script','https://www.youtube.com','Vui\x20lòng\x20nhập\x20ghi\x20chú\x20trước\x20khi\x20tóm\x20tắt.','chime','backgroundRepeat','backgroundMode','</ul>','input','\x20tiếng\x20','substring','\x22\x0a-\x20Ghi\x20chú\x20của\x20người\x20dùng\x20sau\x20một\x20phiên\x20làm\x20việc:\x20\x22','hours','#toolBold','Nắn\x20nhẹ\x20các\x20khớp\x20ngón\x20tay\x20sau\x20khi\x20gõ\x20phím.','</p>','blob:','Rửa\x20mặt\x20hoặc\x20vỗ\x20nhẹ\x20lên\x20mặt\x20để\x20tỉnh\x20táo\x20hơn.','timer','sine','#noteText','filter','#modalMethodEditor','beep','modalMethodEditor','#set_cycles','chatHistory','pauseVideo','importData','sort','fullscreenchange','bg-view-mode','.actions-menu-btn','parse','newIndex','Tóm\x20tắt\x20các\x20ghi\x20chú\x20sau\x20theo\x20gạch\x20đầu\x20dòng,\x20ngắn\x20gọn,\x20rõ\x20ràng:\x0a\x0a','<option\x20value=\x22\x22>--\x20Chọn\x20ngày\x20để\x20phục\x20hồi\x20--</option>','onupgradeneeded','offsetWidth','Đã\x20xóa\x20lịch\x20sử\x20chat.','#toolItalic','#timerPresetSelector\x20button','dataset','Chu\x20kỳ\x20','Xóa\x20tri\x20thức\x20\x22','disabled','delete','slice','Đã\x20tắt\x20nền\x20YouTube\x20để\x20hợp\x20với\x20theme\x20sáng.','getElementById','youtubeVolume','sess','exportData','#btnPause','27597OXZQIY','Daily\x20backup\x20successful.','length','AI\x20đã\x20định\x20dạng\x20xong!','#backupList','Đã\x20chuyển\x20sang\x20Kiểu\x20','Không\x20tải\x20được\x20API\x20YouTube.\x20Kiểm\x20tra\x20mạng\x20hoặc\x20tải\x20lại\x20trang.','stats','values','Nhắm\x20mắt\x20và\x20thư\x20giãn\x20trong\x20một\x20phút.','onkeydown','cover','#audioBreakEnd','#btnCloseDashboard','top','Lỗi:\x20Đã\x20vượt\x20quá\x20hạn\x20mức\x20yêu\x20cầu\x20tới\x20Gemini.\x20Vui\x20lòng\x20thử\x20lại\x20sau\x20ít\x20phút.','\x22\x0a\x0aHãy\x20tạo\x20một\x20bản\x20tóm\x20tắt\x20ngắn\x20gọn\x20về\x20những\x20gì\x20đã\x20làm\x20và\x20đề\x20xuất\x20một\x20bước\x20hợp\x20lý\x20tiếp\x20theo.\x20Định\x20dạng\x20câu\x20trả\x20lời\x20như\x20sau:\x0a\x0a---\x0a**✨\x20Tóm\x20tắt\x20AI:**\x0a[Tóm\x20tắt\x20ở\x20đây]\x0a\x0a**🚀\x20Gợi\x20ý\x20tiếp\x20theo:**\x0a[Gợi\x20ý\x20ở\x20đây]','#topicsList','Nguyên\x20Tắc\x2080/20\x20Để\x20Chinh\x20Phục\x20Lĩnh\x20Vực\x20Mới','webkitAudioContext','initDB','#toolBullet','<strong>$1</strong>','getAll','cleanupOldBackups','.topic-item','stopVideo','Đếm\x20chậm\x20từng\x20nhịp\x20thở\x20đến\x20số\x2010.','Đã\x20xóa\x20hình\x20nền\x20tùy\x20chỉnh.','append','resolve','beginWork','#set_flowRatio','volume','soundTheme','method-content','badge','files','Lỗi\x20lưu\x20dữ\x20liệu:\x20','url(','find','cycles','Nạp\x20năng\x20lượng\x20bằng\x20một\x20món\x20ăn\x20nhẹ\x20lành\x20mạnh.','var(--acc)','connect','var(--acc-2)','#btnExport','updateUI','#btnStart','catch','Đã\x20cập\x20nhật\x20hình\x20nền.','defer','timer.selectSubtopicPrompt','totalMinutes','####\x20','Gợi\x20Nhớ\x20Chủ\x20Động\x20(Active\x20Recall):\x20Nguyên\x20Tắc\x20Cốt\x20Lõi\x20Để\x20Học\x20Sâu','tab','ENDED','auto','createElement','then','Vui\x20lòng\x20chọn\x20một\x20bản\x20sao\x20lưu.','value','head','#btnFinishFlow','exitFullscreen','aria-expanded','frequency','no-subtopic-selected','customSounds','activeElement','#btnToggleBg','pause','stop','toLocaleDateString','Tab','splice','position','Chưa\x20có\x20tiêu\x20đề','.app-content','__ytApiPromise','</div>','beginBreak','body','reduce','by_topic','scrollHeight','state','669335JFEIUv','timerState','onclick','topicsList','querySelector','Gửi','match','<div\x20class=\x22tiny\x22>Chưa\x20có\x20dữ\x20liệu</div>','<div><span\x20class=\x22tiny\x22>(chưa\x20có\x20ghi\x20chú)</span></div>','soundPermissionBar','textContent','subtopic','Vui\x20lòng\x20nhập\x20Gemini\x20API\x20Key\x20trong\x20phần\x20Cài\x20đặt.','\x20phút','Space','command','protocol','clientY','generalNotes','Lỗi\x20lưu\x20file.','durations','long_end','Không\x20nhận\x20được\x20nội\x20dung\x20hợp\x20lệ\x20từ\x20AI.','POST','/maxresdefault.jpg','note-meta','#modalNote','focus','text','#newSubtopicTaskInput','.method-delete','#btnPresetC','<p>Benjamin\x20Franklin\x20đã\x20tự\x20rèn\x20luyện\x20kỹ\x20năng\x20viết\x20từ\x20kém\x20cỏi\x20trở\x20nên\x20bậc\x20thầy\x20bằng\x20một\x20phương\x20pháp\x20chủ\x20động,\x20thay\x20vì\x20chỉ\x20đọc\x20một\x20cách\x20thụ\x20động.\x20Cốt\x20lõi\x20của\x20phương\x20pháp\x20này\x20là\x20phân\x20tích,\x20tái\x20tạo,\x20và\x20so\x20sánh\x20với\x20một\x20bài\x20viết\x20chất\x20lượng\x20cao.</p><p>Đây\x20là\x20một\x20ví\x20dụ\x20kinh\x20điển\x20của\x20\x22Luyện\x20tập\x20có\x20Chủ\x20đích\x22:\x20tập\x20trung\x20vào\x20điểm\x20yếu,\x20có\x20mục\x20tiêu\x20rõ\x20ràng\x20và\x20nhận\x20phản\x20hồi\x20ngay\x20lập\x20tức.</p><h4>Quy\x20Trình\x203\x20Bước\x20Cốt\x20Lõi</h4><ol><li><strong>Phân\x20Tích\x20(Deconstruct):</strong>\x20Đọc\x20một\x20bài\x20viết\x20mẫu\x20xuất\x20sắc.\x20Sau\x20đó,\x20chỉ\x20ghi\x20lại\x20những\x20ý\x20chính\x20của\x20từng\x20đoạn\x20hoặc\x20từng\x20câu\x20ra\x20một\x20tờ\x20giấy\x20riêng.</li><li><strong>Tái\x20Tạo\x20(Reconstruct):</strong>\x20Vài\x20ngày\x20sau,\x20khi\x20đã\x20quên\x20đi\x20văn\x20phong\x20của\x20bản\x20gốc,\x20hãy\x20dùng\x20những\x20ghi\x20chú\x20ý\x20chính\x20đó\x20để\x20viết\x20lại\x20toàn\x20bộ\x20bài\x20viết\x20bằng\x20ngôn\x20ngữ\x20và\x20cách\x20diễn\x20đạt\x20của\x20chính\x20bạn.</li><li><strong>So\x20Sánh\x20&\x20Sửa\x20Lỗi\x20(Compare\x20&\x20Correct):</strong>\x20Đối\x20chiếu\x20trực\x20tiếp\x20bài\x20viết\x20của\x20bạn\x20với\x20bản\x20gốc.\x20Đây\x20là\x20bước\x20quan\x20trọng\x20nhất.\x20Nó\x20giúp\x20bạn\x20phát\x20hiện\x20ngay\x20lập\x20tức\x20những\x20lỗi\x20sai\x20về\x20từ\x20vựng,\x20cấu\x20trúc\x20câu,\x20và\x20cách\x20sắp\x20xếp\x20ý\x20tưởng\x20để\x20sửa\x20chữa.</li></ol><p>Franklin\x20còn\x20thực\x20hành\x20các\x20biến\x20thể\x20nâng\x20cao\x20như\x20xáo\x20trộn\x20thứ\x20tự\x20các\x20ý\x20chính\x20để\x20rèn\x20luyện\x20tư\x20duy\x20logic,\x20hoặc\x20chuyển\x20văn\x20xuôi\x20thành\x20thơ\x20để\x20làm\x20giàu\x20vốn\x20từ.</p><h4>Nguyên\x20Tắc\x20Vàng</h4><p>Thành\x20công\x20của\x20phương\x20pháp\x20này\x20không\x20đến\x20từ\x20việc\x20lặp\x20lại\x20vô\x20thức,\x20mà\x20đến\x20từ\x20vòng\x20lặp\x20phản\x20hồi\x20trực\x20tiếp.\x20Việc\x20so\x20sánh\x20với\x20bản\x20gốc\x20buộc\x20bạn\x20phải\x20đối\x20mặt\x20và\x20sửa\x20chữa\x20những\x20điểm\x20yếu\x20cụ\x20thể\x20của\x20mình,\x20biến\x20việc\x20học\x20từ\x20một\x20quá\x20trình\x20mơ\x20hồ\x20thành\x20một\x20bài\x20tập\x20có\x20thể\x20đo\x20lường\x20được.</p><p><i>Để\x20viết\x20giỏi\x20hơn,\x20đừng\x20chỉ\x20đọc.\x20Hãy\x20chọn\x20một\x20bài\x20viết\x20hay,\x20phân\x20tích\x20nó,\x20cố\x20gắng\x20viết\x20lại,\x20và\x20so\x20sánh\x20để\x20tìm\x20ra\x20lỗi\x20sai.</i></p>','<p>Để\x20không\x20bị\x20choáng\x20ngợp\x20khi\x20học\x20một\x20lĩnh\x20vực\x20mới,\x20hãy\x20tập\x20trung\x20vào\x2020%\x20kiến\x20thức\x20cốt\x20lõi\x20mang\x20lại\x2080%\x20kết\x20quả\x20(Liều\x20lượng\x20Hiệu\x20quả\x20Tối\x20thiểu).</p><h4>20%\x20cốt\x20lõi:\x20Áp\x20dụng\x20Khung\x20Phân\x20tích\x205\x20Bước\x20để\x20xác\x20định\x2020%\x20quan\x20trọng\x20nhất:</h4><ol><li><strong>Xác\x20định\x20Kết\x20quả:</strong>\x20Mục\x20tiêu\x20cuối\x20cùng\x20của\x20bạn\x20là\x20gì?\x20(ví\x20dụ:\x20xây\x20dựng\x20được\x20một\x20trang\x20web).</li><li><strong>Phân\x20tích\x20Nền\x20tảng:</strong>\x20Tìm\x203-5\x20nguyên\x20lý\x20bất\x20biến\x20của\x20ngành.</li><li><strong>Nhận\x20diện\x20Lỗi\x20sai\x20Phổ\x20biến:</strong>\x20Học\x20cách\x20tránh\x20những\x20lỗi\x20mà\x20người\x20mới\x20hay\x20mắc\x20phải.</li><li><strong>Tìm\x20\x22Yếu\x20tố\x20Nhân\x22:</strong>\x20Kỹ\x20năng\x20nào\x20sẽ\x20giúp\x20học\x20mọi\x20thứ\x20khác\x20dễ\x20dàng\x20hơn?\x20(ví\x20dụ:\x20nhạc\x20lý\x20trong\x20âm\x20nhạc).</li><li><strong>Lập\x20bản\x20đồ\x20Ứng\x20dụng\x20Thực\x20tiễn:</strong>\x20Tập\x20trung\x20vào\x2020%\x20công\x20việc\x20chiếm\x2080%\x20thời\x20gian\x20thực\x20tế\x20của\x20ngành.</li></ol>','strokeDasharray','sum','remaining','transition','Hãy\x20chọn\x20một\x20Chủ\x20đề\x20con\x20trước\x20khi\x20bắt\x20đầu','Failed\x20to\x20delete\x20summary:','<p>Nguyên\x20tắc\x20cốt\x20lõi\x20của\x20kỹ\x20thuật\x20này\x20dựa\x20trên\x20một\x20ý\x20tưởng\x20duy\x20nhất:\x20\x22Nếu\x20bạn\x20không\x20thể\x20giải\x20thích\x20một\x20chủ\x20đề\x20một\x20cách\x20đơn\x20giản,\x20bạn\x20chưa\x20thực\x20sự\x20hiểu\x20nó.\x22\x20Mục\x20tiêu\x20là\x20biến\x20kiến\x20thức\x20phức\x20tạp\x20thành\x20lời\x20giải\x20thích\x20đơn\x20giản\x20đến\x20mức\x20một\x20đứa\x20trẻ\x20cũng\x20có\x20thể\x20hiểu.</p><h4>Quy\x20Trình\x204\x20Bước\x20Tinh\x20Gọn</h4><ol><li><strong>Học:</strong>\x20Chọn\x20một\x20chủ\x20đề\x20và\x20viết\x20ra\x20tất\x20cả\x20những\x20gì\x20bạn\x20biết\x20về\x20nó.</li><li><strong>Dạy:</strong>\x20Giả\x20vờ\x20dạy\x20lại\x20chủ\x20đề\x20này\x20bằng\x20ngôn\x20ngữ\x20đơn\x20giản\x20nhất\x20có\x20thể.\x20Viết\x20hoặc\x20nói\x20to\x20ra.</li><li><strong>Tìm\x20&\x20Sửa\x20Lỗi:</strong>\x20Bất\x20cứ\x20khi\x20nào\x20bạn\x20bị\x20\x22kẹt\x22,\x20phải\x20dùng\x20thuật\x20ngữ\x20phức\x20tạp,\x20hoặc\x20không\x20thể\x20giải\x20thích\x20trôi\x20chảy,\x20bạn\x20đã\x20tìm\x20thấy\x20lỗ\x20hổng\x20kiến\x20thức\x20của\x20mình.\x20Hãy\x20quay\x20lại\x20tài\x20liệu\x20gốc\x20để\x20học\x20lại\x20cho\x20đến\x20khi\x20lấp\x20được\x20lỗ\x20hổng\x20đó.</li><li><strong>Đơn\x20Giản\x20Hóa:</strong>\x20Sắp\x20xếp\x20lại\x20lời\x20giải\x20thích\x20cuối\x20cùng,\x20sử\x20dụng\x20các\x20ví\x20dụ\x20hoặc\x20phép\x20ví\x20von\x20đơn\x20giản\x20để\x20nó\x20trở\x20nên\x20mạch\x20lạc\x20và\x20dễ\x20hiểu\x20nhất.</li></ol><h4>Cốt\x20Lõi</h4><p>Kỹ\x20thuật\x20Feynman\x20buộc\x20bạn\x20phải\x20chuyển\x20từ\x20việc\x20tiếp\x20thu\x20thụ\x20động\x20(đọc,\x20nghe)\x20sang\x20chủ\x20động\x20xử\x20lý\x20thông\x20tin.\x20Quá\x20trình\x20\x22bị\x20kẹt\x22\x20khi\x20giải\x20thích\x20chính\x20là\x20công\x20cụ\x20chẩn\x20đoán\x20mạnh\x20mẽ\x20nhất,\x20nó\x20chỉ\x20ra\x20chính\x20xác\x20điểm\x20bạn\x20còn\x20yếu.</p><p><i>Cách\x20nhanh\x20nhất\x20để\x20kiểm\x20tra\x20và\x20củng\x20cố\x20sự\x20hiểu\x20biết\x20của\x20bạn\x20là\x20thử\x20dạy\x20lại\x20nó\x20cho\x20người\x20khác\x20một\x20cách\x20đơn\x20giản.</i></p>','block','?\x20Dữ\x20liệu\x20hiện\x20tại\x20sẽ\x20bị\x20ghi\x20đè.','flex','statusText','mouseup','key','map','#btnEnableSound','isCompleted','destroy','clientX','execCommand','tid','type','padStart','innerHeight','/hqdefault.jpg','log','topics','Đã\x20nhập\x20dữ\x20liệu\x20thành\x20công!','#audioLongEnd','✨\x20Tự\x20động\x20định\x20dạng','floor','Thả\x20lỏng\x20toàn\x20thân,\x20cảm\x20nhận\x20hơi\x20thở.','wind_down','clear','Sửa\x20tên\x20Chủ\x20đề','22ufrSbQ','Xem\x20một\x20tấm\x20ảnh\x20dễ\x20thương\x20hoặc\x20làm\x20bạn\x20vui.','text/plain','Deleted\x20old\x20backup:\x20','Bản\x20sao\x20lưu\x20ngày:\x20','btn\x20small\x20ghost\x20actions-menu-btn','fullscreenElement','btn\x20small\x20ghost\x20method-edit','Lặp\x20Lại\x20Ngắt\x20Quãng\x20(Spaced\x20Repetition):\x20Học\x20Đúng\x20Thời\x20Điểm','subtopics','createdAt','enableSessionNotes','skip','persistTimerState','styleWithCSS','B_winddown','async','ghost','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22dashboard-table\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead><tr><th>Chủ\x20đề</th><th>Chủ\x20đề\x20con</th><th>Thời\x20gian</th><th>Phiên</th><th>Nhiệm\x20vụ</th></tr></thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','note','code','http','Đang\x20phát','get','createIndex','addEventListener','paused','currentView','remove','#btnSkip','<div\x20class=\x22hist-meta\x22>','#btnReset','#view-methods\x20.methods-container','relative','#btnToggleYtSound','isArray','.tab-btn','#set_backgroundMode','.subtopics','getAllKeys','Đang\x20phát\x20nhạc\x20nền...','soundOn','#toolColor','105882kGramp','Lắc\x20nhẹ\x20cổ\x20tay\x20và\x20vai\x20trong\x2030\x20giây.','6EDmZSI','#toolList','parts','#btnSaveSettings','PlayerState','Bạn\x20có\x20chắc\x20muốn\x20xóa\x20toàn\x20bộ\x20lịch\x20sử\x20chat\x20của\x20chủ\x20đề\x20con\x20này?','localeCompare','\x20(A)','.\x20Vui\x20lòng\x20thử\x20lại\x20với\x20nội\x20dung\x20khác.','#btnMilestoneClose','cyclesA','content','Nghe\x20một\x20bản\x20nhạc\x20yêu\x20thích.','status','removeChild','appendChild','longBreakIntervalB','hidden','<div\x20class=\x22tiny\x22>Chưa\x20có\x20phiên\x20nào</div>','task','#btnSendMessage','baseVal','#btnSkipNote','#set_ytThumbAsBg','Thực\x20hiện\x20vài\x20động\x20tác\x20hít\x20thở\x20sâu.','#uploadSoundLong','#btnFullscreen','#modalSettings','#uploadSoundWork','#currentSubtopicNameChat','href','672348vBpNDo','Gửi\x20bạn,\x205\x20giờ\x20đầu\x20tiên\x20(Khởi\x20động)','prevState','reload','createObjectURL','summary_','#set_theme_color','sid','#modalGeneric','<div\x20class=\x22tiny\x22>Vui\x20lòng\x20chọn\x20một\x20chủ\x20đề\x20con.</div>','put','onsuccess','Nhớ\x20uống\x20một\x20ngụm\x20nước\x20nhé!','&gt;','getVolume','#chatInput','getIframe','https://img.youtube.com/vi/','pomodoroData_v11','updateSettings','sound_unlocked','Gửi\x20bạn,\x205.000+\x20giờ\x20(Di\x20sản)','#btnDefaults','space','version','setVolume','color','#set_interval','collapsedTopics','theme','readonly','.timer-circle-progress','Initialization\x20error:','formatBlock','max','.color-picker-wrapper','includes','_startTick','#customSoundsContainer','tasksCompleted','stopPropagation','#genericInput','btn\x20small\x20danger\x20method-delete','contentWindow','flatMap','isNaN','Thả\x20lỏng\x20hai\x20chân,\x20lắc\x20nhẹ\x20cổ\x20chân\x20dưới\x20bàn.','Lỗi\x20khi\x20gọi\x20Gemini\x20API:','vi-VN','\x20(B)','#toolH4','ytUrlFeedback','Xóa\x20Chủ\x20đề\x20con','\x22?\x20Mọi\x20dữ\x20liệu\x20liên\x20quan\x20sẽ\x20bị\x20mất.','ArrowDown','Gửi\x20bạn,\x20100\x20giờ\x20cống\x20hiến\x20(Cam\x20kết)','Đã\x20xóa\x20tóm\x20tắt.','Enter','undefined','<div\x20class=\x22tiny\x22>Chưa\x20có\x20tin\x20nhắn\x20nào.</div>','Nhập\x20thất\x20bại:\x20','.json','#uploadBg','.presets\x20button','src','#set_enableWinddown','#welcomePanel','width','from','#btnToggleCustomSounds','subtopics-group','getBoundingClientRect','Chớp\x20mắt\x20liên\x20tục\x2010\x20lần\x20để\x20tránh\x20khô\x20mắt.','about:blank','open','#modalMilestone','setAttribute','.method-edit','iframe','Đổi\x20tên\x20Chủ\x20đề','methodId','tagName','name','<tr><td>','#btnSaveNote','lastBackupDate','repeat','\x22\x20title=\x22Hoàn\x20thành\x20task\x22>\x20<label\x20for=\x22','json','getMonth','.nav-btn[data-view]','option','toString','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Chọn\x20chủ\x20đề\x20con\x20để\x20xem\x20to-do\x20list.</li>','button','<div\x20class=\x22tiny\x22>Chưa\x20có\x20tóm\x20tắt\x20nào.</div>','setValueAtTime','getSettings','(Không\x20tạo\x20được\x20tóm\x20tắt)','getFullYear','reverse','short','item','Nhìn\x20ra\x20xa\x20qua\x20cửa\x20sổ\x20trong\x2020\x20giây.','backgroundImage','<p>','chev\x20btn\x20small\x20ghost','#btnAutoFormat','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M2\x2012s3-7\x2010-7\x2010\x207\x2010\x207-3\x207-10\x207-10-7-10-7Z\x22/><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x223\x22/></svg>','.nav-btn[data-view=\x22','selectedTopicId','reloading','unMute','#welcomePanel\x20p','&quot;','selectedSubtopicId','Creating\x20backup\x20for\x20','methods','Xóa','#set_apiKey','#btnGenericCancel','Không\x20thể\x20lưu\x20thay\x20đổi.','#windDownChecklist','origin','parentElement','longBreakIntervalA','join','_sortable','Xóa\x20Chủ\x20đề','Chưa\x20có\x20link\x20hợp\x20lệ.\x20Dán\x20link\x20rồi\x20bấm\x20▶️.','Failed\x20to\x20save\x20data:','right','Toàn\x20màn\x20hình','location','mode','input,select,textarea','update','objectStore','random','Gửi\x20bạn,\x201.000\x20giờ\x20(Chuyển\x20hóa)','＋\x20Thêm','string','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Chưa\x20có\x20tri\x20thức\x20nào\x20trong\x20Chủ\x20đề\x20con\x20này.</p>','<option\x20value=\x22\x22>Không\x20có\x20bản\x20sao\x20lưu\x20nào</option>','</td><td>','break_end','Gửi\x20bạn,\x2050\x20giờ\x20(Động\x20lực)','blockReason','https://www.youtube.com/iframe_api','breathing','A_long','stringify','</h4>','error','#set_long','shiftKey','Gemini\x20API\x20Error:','cyclesB','Năm\x20giờ\x20tập\x20trung!\x20Bạn\x20đã\x20vượt\x20qua\x20rào\x20cản\x20lớn\x20nhất:\x20sự\x20trì\x20hoãn.\x20Mỗi\x20phút\x20bạn\x20dành\x20ra\x20đều\x20là\x20một\x20lời\x20khẳng\x20định\x20cho\x20mục\x20tiêu\x20của\x20mình.\x20Hãy\x20giữ\x20vững\x20ngọn\x20lửa\x20này!','toISOString','sessions','50\x20giờ\x20tập\x20trung!\x20Thói\x20quen\x20của\x20bạn\x20đang\x20tạo\x20ra\x20động\x20lực.\x20Sự\x20nhất\x20quán\x20nhỏ\x20bé\x20mỗi\x20ngày\x20đang\x20cộng\x20hưởng\x20thành\x20những\x20bước\x20tiến\x20lớn.\x20Bạn\x20đang\x20đi\x20đúng\x20hướng,\x20hãy\x20tiếp\x20tục\x20phát\x20huy.','message','div','.actions-menu','Đã\x20dừng\x20nhạc\x20nền.','oncomplete','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Vui\x20lòng\x20chọn\x20một\x20Chủ\x20đề\x20con\x20để\x20xem\x20Kho\x20Tri\x20Thức.</p>','settings','HẠ\x20NHIỆT','resume','#set_enableSessionNotes','#btnHelpCreateTopic','#genericMessage','youtube-player-container','removeEventListener','note-content','Ẩn\x20giao\x20diện','btn\x20small\x20danger','2gHcNZb','enableWinddown','topicId','#btnClearBg','.modal','transaction','#draggableTimer','Bạn\x20có\x20chắc\x20muốn\x20chuyển\x20sang\x20Kiểu\x20','Dùng\x20AI\x20để\x20tự\x20động\x20định\x20dạng\x20văn\x20bản','🌊\x20Flow','2927620CFsdpX','tasks','default','#set_winddown','long_break','file','cancel','#btnSummarize','#methodEditorId','mousedown','application/json','#set_volume','.txt','summary','backups','#methodEditorTitleInput','#view-','Nghỉ\x20','100\x20giờ!\x20Đây\x20không\x20còn\x20là\x20một\x20thử\x20nghiệm\x20nữa,\x20mà\x20là\x20một\x20sự\x20đầu\x20tư\x20nghiêm\x20túc\x20cho\x20mục\x20tiêu\x20của\x20bạn.\x0a\x0aHãy\x20dành\x20một\x20chút\x20thời\x20gian\x20để\x20nhìn\x20lại:\x20100\x20giờ\x20tập\x20trung\x20này\x20đã\x20giúp\x20bạn\x20tiến\x20xa\x20đến\x20đâu?\x20Năng\x20lượng\x20bạn\x20bỏ\x20ra\x20đang\x20định\x20hình\x20nên\x20kết\x20quả.','selectionEnd','backupDaysToKeep','unshift','-9999px','test','5.000\x20giờ\x20tập\x20trung\x20có\x20chủ\x20đích.\x20Đây\x20là\x20một\x20thành\x20tựu\x20mà\x20rất\x20ít\x20người\x20đạt\x20được.\x0a\x0aTại\x20cột\x20mốc\x20này,\x20câu\x20hỏi\x20không\x20còn\x20là\x20\x27Làm\x20thế\x20nào\x20để\x20tập\x20trung?\x27,\x20mà\x20là\x20\x27Sự\x20tập\x20trung\x20này\x20sẽ\x20được\x20dùng\x20để\x20tạo\x20ra\x20giá\x20trị\x20gì?\x27.\x20Bạn\x20không\x20chỉ\x20làm\x20việc,\x20bạn\x20đang\x20tạo\x20ra\x20di\x20sản.','toLocaleString','__ytApiWatchdog','.sub-row','Lỗi:\x20Gemini\x20API\x20Key\x20không\x20hợp\x20lệ\x20hoặc\x20đã\x20bị\x20thay\x20đổi.\x20Vui\x20lòng\x20kiểm\x20tra\x20lại\x20trong\x20Cài\x20đặt.','\x0a-\x20','0\x20phút','var(--danger)','AudioContext','currentDurations','.tab-content','toggle','&amp;','menu-item','#selectedContext','load','LÀM\x20VIỆC\x20(FLOW)','style','#view-methods','Tên\x20Chủ\x20đề\x20mới?','.actions-menu.show','height','#set_short','topic','segmentTotal','IndexedDB\x20initialized\x20successfully.','Backup\x20failed:','Tự\x20hỏi\x20bản\x20thân:\x20“Mình\x20cảm\x20thấy\x20thế\x20nào\x20lúc\x20này?”','#milestoneMessage','playVideo','</li>','documentElement','customBg','#btnSaveMethod','\x20hidden','selectionStart','#ytSoundVolume','img.youtube.com/vi/','expanded','<li>','#settings-pomodoro','#breakSuggestionDisplay','Thêm\x20Tri\x20thức\x20mới','start','#methodEditorTitle','Cần\x20có\x20nội\x20dung\x20để\x20AI\x20định\x20dạng.','#set_autoStartNext','#timeDisplay','<div\x20class=\x22tiny\x22>Chọn\x20chủ\x20đề\x20con\x20để\x20bắt\x20đầu\x20chat.</div>','Đã\x20lưu\x20âm\x20báo\x20hết\x20NGHỈ\x20DÀI.','autoStartNext','flowtimeBreakRatio','select','play','allow','btn\x20small','idle','btnToggleYtSound','A_short','--bg-image','gain','Đã\x20lưu\x20âm\x20báo\x20hết\x20LÀM\x20VIỆC.','#btnDashboard','OK.\x20Link\x20hợp\x20lệ.\x20Đang\x20chuẩn\x20bị\x20phát...','Hãy\x20đứng\x20dậy\x20vươn\x20vai\x20và\x20duỗi\x20người.','Kiểm\x20tra\x20nhịp\x20thở\x20–\x20nếu\x20gấp\x20gáp,\x20hãy\x20làm\x20chậm\x20lại.','lastPersist','Escape','#importFile','menu-active','errorCode','Sắp\x20xếp\x20lại\x20không\x20gian\x20làm\x20việc\x20của\x20bạn.','textarea','onerror','useYtThumbnailAsBg','250\x20giờ\x20là\x20minh\x20chứng\x20cho\x20sự\x20bền\x20bỉ\x20đáng\x20kinh\x20ngạc.\x20Bạn\x20đã\x20đối\x20mặt\x20với\x20những\x20ngày\x20khó\x20khăn,\x20những\x20lúc\x20mất\x20tập\x20trung,\x20nhưng\x20bạn\x20vẫn\x20quay\x20trở\x20lại.\x20Sức\x20mạnh\x20thực\x20sự\x20nằm\x20ở\x20chính\x20sự\x20kiên\x20trì\x20này.','long','.view','Bạn\x20có\x20chắc\x20muốn\x20xóa\x20tóm\x20tắt\x20này?','insertUnorderedList','.subtopic-btn','keydown','\x20·\x20','#methodEditorContentInput','#btnSummarizeNote','dateISO','Xác\x20nhận\x20phục\x20hồi','closest','#chatMessages'];_0x56f2=function(){return _0x1463a5;};return _0x56f2();}function clampFloat(_0x59cbca,_0x43ffa2,_0x302bfd,_0x3790ff){const _0x4cb00b=_0x2d0238;_0x59cbca=parseFloat(_0x59cbca);if(Number[_0x4cb00b(0x32f)](_0x59cbca))_0x59cbca=_0x3790ff;return Math[_0x4cb00b(0x324)](_0x43ffa2,Math[_0x4cb00b(0x4db)](_0x302bfd,_0x59cbca));}const dbPromise=new Promise((_0x3a55a3,_0x4dc529)=>{const _0x5a47ae=_0x2d0238,_0x3bc23f=indexedDB[_0x5a47ae(0x34c)]('pomodoro_files',0x1);_0x3bc23f[_0x5a47ae(0x209)]=_0x321d63=>_0x321d63[_0x5a47ae(0x4ff)][_0x5a47ae(0x479)][_0x5a47ae(0x4c8)](_0x5a47ae(0x23f)),_0x3bc23f['onsuccess']=_0x2d4ee0=>_0x3a55a3(_0x2d4ee0[_0x5a47ae(0x4ff)][_0x5a47ae(0x479)]),_0x3bc23f['onerror']=_0x447e1e=>_0x4dc529(_0x447e1e);}),fileCache={};function handleFileUpload(_0x7192b1,_0x443cb6){const _0x624743=_0x2d0238;if(!_0x7192b1)return;dbPromise[_0x624743(0x256)](_0x298730=>{const _0x9a4724=_0x624743,_0xe4c370=uid(_0x9a4724(0x3c4)),_0x526ade=_0x298730['transaction'](_0x9a4724(0x23f),_0x9a4724(0x4f7));_0x526ade[_0x9a4724(0x38b)](_0x9a4724(0x23f))[_0x9a4724(0x30c)](_0x7192b1,_0xe4c370),_0x526ade[_0x9a4724(0x3a8)]=()=>_0x443cb6(_0xe4c370),_0x526ade['onerror']=()=>toast(_0x9a4724(0x285));});}function getStoredFileUrl(_0x15ea47){const _0x2435e3=_0x2d0238;if(!_0x15ea47)return Promise[_0x2435e3(0x238)]('');if(fileCache[_0x15ea47])return Promise['resolve'](fileCache[_0x15ea47]);return dbPromise[_0x2435e3(0x256)](_0x368586=>new Promise(_0x14f8a6=>{const _0x37d861=_0x2435e3,_0xb4aa1b=_0x368586[_0x37d861(0x3ba)]('files','readonly'),_0x51f897=_0xb4aa1b[_0x37d861(0x38b)](_0x37d861(0x23f))[_0x37d861(0x2cd)](_0x15ea47);_0x51f897[_0x37d861(0x30d)]=_0x2cfb9c=>{const _0x946ac=_0x37d861,_0x140f45=_0x2cfb9c[_0x946ac(0x4ff)]['result'];if(_0x140f45){const _0x2609fa=URL[_0x946ac(0x306)](_0x140f45);fileCache[_0x15ea47]=_0x2609fa,_0x14f8a6(_0x2609fa);}else _0x14f8a6('');},_0x51f897[_0x37d861(0x420)]=()=>_0x14f8a6('');}));}function applyCustomBg(){const _0x5675b6=_0x2d0238,_0x3c6128=data[_0x5675b6(0x3aa)],_0x1b637d=_0x3c6128[_0x5675b6(0x3f7)],_0x4a9488=_0x3c6128[_0x5675b6(0x31f)],_0x32108b=[_0x5675b6(0x4bf),_0x5675b6(0x319)]['includes'](_0x4a9488),_0x37a7f4=_0x4a9488===_0x5675b6(0x45c)||_0x4a9488===_0x5675b6(0x4fe),_0x249f80=_0x3c6128[_0x5675b6(0x1ea)]||_0x5675b6(0x225);document['body'][_0x5675b6(0x3e8)]['backgroundSize']=_0x249f80,document['body'][_0x5675b6(0x3e8)][_0x5675b6(0x1e9)]=_0x249f80===_0x5675b6(0x254)?_0x5675b6(0x358):'no-repeat';const _0x3c4f20=()=>{const _0x8f5699=_0x5675b6;try{document[_0x8f5699(0x26d)][_0x8f5699(0x3e8)]['backgroundImage']='';}catch(_0x32a476){}};if(_0x1b637d){const _0x31bdc0=_0x1b637d[_0x5675b6(0x49f)]('data:')||_0x1b637d['startsWith'](_0x5675b6(0x2cb))||_0x1b637d[_0x5675b6(0x49f)]('blob:')?Promise[_0x5675b6(0x238)](_0x1b637d):getStoredFileUrl(_0x1b637d);_0x31bdc0['then'](_0x3ebdb3=>{const _0x53082d=_0x5675b6;_0x3ebdb3?document[_0x53082d(0x26d)]['style'][_0x53082d(0x49a)]('--bg-image',_0x53082d(0x241)+_0x3ebdb3+')'):document['body'][_0x53082d(0x3e8)][_0x53082d(0x49a)](_0x53082d(0x412),_0x37a7f4?_0x53082d(0x4d3):''),_0x3c4f20();});}else!_0x32108b?_0x37a7f4?(document['body'][_0x5675b6(0x3e8)][_0x5675b6(0x49a)](_0x5675b6(0x412),_0x5675b6(0x4d3)),_0x3c4f20()):document['body']['style'][_0x5675b6(0x49a)]('--bg-image','radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)'):(document[_0x5675b6(0x26d)][_0x5675b6(0x3e8)][_0x5675b6(0x4dd)](_0x5675b6(0x412)),_0x3c4f20());}function applyPanelOpacity(){const _0x176216=_0x2d0238;document[_0x176216(0x3f6)]['style']['setProperty']('--panel-opacity',data[_0x176216(0x3aa)]['panelOpacity']);}function renderDashboard(){const _0x201a65=_0x2d0238,_0x321bdd=data[_0x201a65(0x2ad)][_0x201a65(0x32e)](_0x2e29ce=>_0x2e29ce['subtopics'][_0x201a65(0x2a1)](_0x41fc89=>({'topic':_0x2e29ce['name'],'subtopic':_0x41fc89[_0x201a65(0x354)],'m':_0x41fc89['stats'][_0x201a65(0x24f)]||0x0,'c':_0x41fc89[_0x201a65(0x221)][_0x201a65(0x487)]||0x0,'t':_0x41fc89['stats'][_0x201a65(0x329)]||0x0}))),_0x5d5817=_0x321bdd[_0x201a65(0x26e)]((_0x5bb6cf,_0x2a3bc8)=>_0x5bb6cf+_0x2a3bc8['m'],0x0),_0x7f315b=_0x321bdd[_0x201a65(0x26e)]((_0xe62c46,_0x5ab20f)=>_0xe62c46+_0x5ab20f['c'],0x0),_0x2d606d=_0x321bdd[_0x201a65(0x26e)]((_0x41fa31,_0x571af8)=>_0x41fa31+_0x571af8['t'],0x0);let _0x2da655=_0x201a65(0x444)+formatDaysHoursMinutes(_0x5d5817)+_0x201a65(0x4f8)+_0x7f315b+_0x201a65(0x492)+_0x2d606d+_0x201a65(0x2c8);_0x321bdd['forEach'](_0x3c9803=>{const _0x2dd4a2=_0x201a65;_0x2da655+=_0x2dd4a2(0x355)+escapeHTML(_0x3c9803[_0x2dd4a2(0x3ee)])+_0x2dd4a2(0x392)+escapeHTML(_0x3c9803[_0x2dd4a2(0x27d)])+'</td><td>'+formatDaysHoursMinutes(_0x3c9803['m'])+_0x2dd4a2(0x392)+_0x3c9803['c']+_0x2dd4a2(0x392)+_0x3c9803['t']+'</td></tr>';}),_0x2da655+=_0x201a65(0x49d);const _0x185f67=$('#dashboardContent');if(_0x185f67)_0x185f67[_0x201a65(0x4b3)]=_0x2da655;}function getMilestones(){const _0x1fbac2=_0x2d0238;return[{'hours':0x5,'title':_0x1fbac2(0x303),'message':_0x1fbac2(0x3a0)},{'hours':0x14,'title':_0x1fbac2(0x503),'message':'Chúc\x20mừng\x20bạn\x20đã\x20làm\x20được\x20điều\x20khó\x20nhất:\x20Bắt\x20đầu\x20và\x20duy\x20trì.\x0a\x0a20\x20giờ\x20không\x20chỉ\x20là\x20thời\x20gian,\x20đó\x20là\x2020\x20giờ\x20bạn\x20đã\x20chiến\x20thắng\x20sự\x20xao\x20nhãng.\x20Bạn\x20đang\x20xây\x20dựng\x20một\x20nền\x20tảng\x20vững\x20chắc\x20cho\x20sự\x20kỷ\x20luật.\x20Hãy\x20tự\x20hào\x20về\x20khởi\x20đầu\x20này.'},{'hours':0x32,'title':_0x1fbac2(0x394),'message':_0x1fbac2(0x3a3)},{'hours':0x64,'title':_0x1fbac2(0x339),'message':_0x1fbac2(0x3d1)},{'hours':0xfa,'title':_0x1fbac2(0x4e8),'message':_0x1fbac2(0x422)},{'hours':0x1f4,'title':_0x1fbac2(0x4b7),'message':'Nửa\x20nghìn\x20giờ\x20tập\x20trung.\x20Bạn\x20đã\x20dành\x20một\x20khoảng\x20thời\x20gian\x20đáng\x20kể\x20để\x20theo\x20đuổi\x20điều\x20quan\x20trọng\x20với\x20mình.\x20Mức\x20độ\x20chuyên\x20tâm\x20này\x20chắc\x20chắn\x20đang\x20tạo\x20ra\x20những\x20kết\x20quả\x20sâu\x20sắc\x20và\x20khác\x20biệt.\x20Thật\x20đáng\x20ngưỡng\x20mộ.'},{'hours':0x3e8,'title':_0x1fbac2(0x38d),'message':'Chào\x20mừng\x20đến\x20Câu\x20lạc\x20bộ\x201000\x20giờ.\x0a\x0aCon\x20số\x20này\x20không\x20chỉ\x20đo\x20lường\x20thời\x20gian,\x20nó\x20đại\x20diện\x20cho\x20sự\x20chuyển\x20hóa.\x20Sự\x20tập\x20trung\x20đã\x20trở\x20thành\x20một\x20phần\x20con\x20người\x20bạn,\x20một\x20\x27siêu\x20năng\x20lực\x27\x20bạn\x20có\x20thể\x20triệu\x20hồi.\x20Hành\x20trình\x20của\x20bạn\x20thực\x20sự\x20truyền\x20cảm\x20hứng.'},{'hours':0x1388,'title':_0x1fbac2(0x317),'message':_0x1fbac2(0x3d7)}][_0x1fbac2(0x201)]((_0x1411e9,_0x2b75b7)=>_0x2b75b7['hours']-_0x1411e9['hours']);}async function checkAndShowMilestones(){const _0x3ebce6=_0x2d0238;if(!data||!data[_0x3ebce6(0x3aa)])return;if(!Array['isArray'](data[_0x3ebce6(0x3aa)][_0x3ebce6(0x4df)]))data[_0x3ebce6(0x3aa)][_0x3ebce6(0x4df)]=[];const _0x1dba49=data[_0x3ebce6(0x2ad)][_0x3ebce6(0x26e)]((_0x2f5c87,_0x1bcab5)=>{return _0x2f5c87+_0x1bcab5['subtopics']['reduce']((_0x5c0884,_0x306ee1)=>{return _0x5c0884+(_0x306ee1['stats']['totalMinutes']||0x0);},0x0);},0x0),_0x2eda31=_0x1dba49/0x3c,_0x457a1a=getMilestones(),_0x2466ac=Array[_0x3ebce6(0x2d9)](data[_0x3ebce6(0x3aa)][_0x3ebce6(0x4df)])?data['settings'][_0x3ebce6(0x4df)]:[],_0x367736=_0x457a1a['filter'](_0x4d8346=>_0x2eda31>=_0x4d8346[_0x3ebce6(0x1f0)]&&!_0x2466ac['includes'](_0x4d8346[_0x3ebce6(0x1f0)]));if(_0x367736[_0x3ebce6(0x21c)]===0x0)return![];const _0xa96cb1=_0x367736['reduce']((_0x4b1691,_0x213529)=>_0x4b1691&&_0x4b1691[_0x3ebce6(0x1f0)]>_0x213529[_0x3ebce6(0x1f0)]?_0x4b1691:_0x213529,null);if(!_0xa96cb1)return![];$('#milestoneTitle')[_0x3ebce6(0x27c)]=_0xa96cb1[_0x3ebce6(0x4d7)],$(_0x3ebce6(0x3f3))['textContent']=_0xa96cb1['message'],$(_0x3ebce6(0x34d))[_0x3ebce6(0x43c)][_0x3ebce6(0x439)]('show');try{trapFocus($('#modalMilestone'));}catch(_0x1e218e){}return data['settings'][_0x3ebce6(0x4df)][_0x3ebce6(0x4f9)](_0xa96cb1[_0x3ebce6(0x1f0)]),await saveData(),!![];}async function seedAchievedMilestones(){const _0x432f86=_0x2d0238;if(!data||!data['settings'])return;!Array[_0x432f86(0x2d9)](data[_0x432f86(0x3aa)]['achievedMilestones'])&&(data[_0x432f86(0x3aa)]['achievedMilestones']=[],await saveData());}async function handleSendMessage(){const _0x26b817=_0x2d0238,_0x4a59df=$('#btnSendMessage'),_0x15fc15=$(_0x26b817(0x311)),_0x3ff050=_0x15fc15[_0x26b817(0x258)][_0x26b817(0x452)](),_0x27d2bc=getCurrentSubtopic();if(!_0x3ff050)return;if(!_0x27d2bc){toast(t(_0x26b817(0x24e)));return;}_0x15fc15[_0x26b817(0x258)]='',_0x4a59df['disabled']=!![],_0x4a59df[_0x26b817(0x4b3)]=_0x26b817(0x493),_0x27d2bc['chatHistory'][_0x26b817(0x4f9)]({'role':'user','text':_0x3ff050}),renderChat();const _0x1fe3f1=await callGeminiAPI(_0x3ff050);_0x1fe3f1&&(_0x27d2bc[_0x26b817(0x1fe)][_0x26b817(0x4f9)]({'role':_0x26b817(0x4cd),'text':_0x1fe3f1}),await saveData(),renderChat()),_0x4a59df['disabled']=![],_0x4a59df[_0x26b817(0x4b3)]=_0x26b817(0x277);}function renderChat(){const _0x54dd04=_0x2d0238,_0x321f94=getCurrentSubtopic(),_0x571c82=$(_0x54dd04(0x42f)),_0x2e69ae=$('#chatInput'),_0x14970a=$('#btnSendMessage');if(!_0x571c82||!_0x2e69ae||!_0x14970a)return;if(!_0x321f94){_0x571c82['innerHTML']=_0x54dd04(0x407),_0x2e69ae[_0x54dd04(0x211)]=!![],_0x14970a[_0x54dd04(0x211)]=!![];return;}_0x2e69ae['disabled']=![],_0x14970a[_0x54dd04(0x211)]=![],_0x571c82[_0x54dd04(0x4b3)]='';if(!_0x321f94[_0x54dd04(0x1fe)]||_0x321f94['chatHistory'][_0x54dd04(0x21c)]===0x0){_0x571c82[_0x54dd04(0x4b3)]=_0x54dd04(0x33d);return;}_0x321f94[_0x54dd04(0x1fe)][_0x54dd04(0x481)](_0x1ab526=>{const _0x599225=_0x54dd04,_0x4e96e9=document[_0x599225(0x255)](_0x599225(0x3a5));_0x4e96e9['className']='chat-msg\x20'+_0x1ab526['role'],_0x4e96e9[_0x599225(0x27c)]=_0x1ab526[_0x599225(0x28e)],_0x571c82[_0x599225(0x2f2)](_0x4e96e9);}),_0x571c82['scrollTop']=_0x571c82[_0x54dd04(0x270)];}async function handleSummarizeNote(){const _0x711535=_0x2d0238,_0x5694e5=$(_0x711535(0x42b)),_0xb59568=$(_0x711535(0x1f8)),_0x612721=_0xb59568['value'][_0x711535(0x452)](),_0x52a0f5=getCurrentSubtopic();if(!_0x612721){toast(_0x711535(0x1e7));return;}const _0x33cf74=_0x5694e5[_0x711535(0x4b3)];_0x5694e5[_0x711535(0x4b3)]=_0x711535(0x493),_0x5694e5[_0x711535(0x211)]=!![];const _0x409386='Dựa\x20vào\x20thông\x20tin\x20sau:\x0a-\x20Chủ\x20đề:\x20\x22'+(_0x52a0f5?.[_0x711535(0x354)]||'không\x20rõ')+_0x711535(0x1ef)+_0x612721+_0x711535(0x22a),_0x29e0f3=await callGeminiAPI(_0x409386);_0x29e0f3&&(_0xb59568[_0x711535(0x258)]+='\x0a\x0a'+_0x29e0f3),_0x5694e5[_0x711535(0x4b3)]=_0x33cf74,_0x5694e5[_0x711535(0x211)]=![];}function clearChat(){const _0x59406b=_0x2d0238,_0x5b8baa=getCurrentSubtopic();if(!_0x5b8baa){toast(t(_0x59406b(0x24e)));return;}showConfirmModal('Xác\x20nhận\x20xóa',_0x59406b(0x2e8),async _0x35f2bd=>{const _0xe4b5b7=_0x59406b;_0x35f2bd&&(_0x5b8baa[_0xe4b5b7(0x1fe)]=[],await saveData(),renderChat(),toast(_0xe4b5b7(0x20b)));});}function _0x1056(_0x43db75,_0x2d4e52){const _0x56f244=_0x56f2();return _0x1056=function(_0x105677,_0x31162b){_0x105677=_0x105677-0x1e5;let _0x2bbc2c=_0x56f244[_0x105677];return _0x2bbc2c;},_0x1056(_0x43db75,_0x2d4e52);}let ytPlayer,ytUserPaused=![],ytFallbackFrame=null,ytFallbackIsPlaying=![];function buildFallbackSrc(_0x700d1e,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x544c9c=_0x2d0238,_0x149491=new URLSearchParams({'autoplay':String(autoplay),'mute':String(mute),'controls':'0','playsinline':'1','loop':'1','playlist':_0x700d1e,'enablejsapi':'1','origin':_0x544c9c(0x1e6)})[_0x544c9c(0x35e)]();return'https://www.youtube.com/embed/'+_0x700d1e+'?'+_0x149491;}function ensureFallbackFrame(){const _0x38fecc=_0x2d0238,_0x50b7c7=document[_0x38fecc(0x215)](_0x38fecc(0x3b0));if(!_0x50b7c7)return null;if(ytFallbackFrame&&ytFallbackFrame[_0x38fecc(0x4e5)])return ytFallbackFrame;const _0x1ace1e=document[_0x38fecc(0x255)]('iframe');return _0x1ace1e['id']=_0x38fecc(0x486),_0x1ace1e[_0x38fecc(0x345)]='1',_0x1ace1e[_0x38fecc(0x3ec)]='1',_0x1ace1e['style'][_0x38fecc(0x267)]=_0x38fecc(0x434),_0x1ace1e[_0x38fecc(0x3e8)][_0x38fecc(0x228)]=_0x38fecc(0x3d5),_0x1ace1e[_0x38fecc(0x3e8)]['left']=_0x38fecc(0x3d5),_0x1ace1e[_0x38fecc(0x40d)]='autoplay;\x20encrypted-media;\x20picture-in-picture',_0x50b7c7[_0x38fecc(0x4b3)]='',_0x50b7c7[_0x38fecc(0x2f2)](_0x1ace1e),ytFallbackFrame=_0x1ace1e,_0x1ace1e;}function fallbackLoadVideo(_0x353007,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x12fcf5=_0x2d0238,_0x2f36e0=document['getElementById'](_0x12fcf5(0x3b0));if(!_0x2f36e0)return;_0x2f36e0[_0x12fcf5(0x4b3)]='';const _0x1f1ec6=document[_0x12fcf5(0x255)](_0x12fcf5(0x350));_0x1f1ec6['id']=_0x12fcf5(0x486),_0x1f1ec6[_0x12fcf5(0x345)]='1',_0x1f1ec6[_0x12fcf5(0x3ec)]='1',_0x1f1ec6[_0x12fcf5(0x3e8)][_0x12fcf5(0x267)]=_0x12fcf5(0x434),_0x1f1ec6['style'][_0x12fcf5(0x228)]=_0x12fcf5(0x3d5),_0x1f1ec6['style']['left']=_0x12fcf5(0x3d5),_0x1f1ec6[_0x12fcf5(0x40d)]='autoplay;\x20encrypted-media;\x20picture-in-picture',_0x1f1ec6['src']=buildFallbackSrc(_0x353007,{'autoplay':autoplay,'mute':mute}),_0x2f36e0['appendChild'](_0x1f1ec6),ytFallbackFrame=_0x1f1ec6,ytFallbackIsPlaying=!!autoplay;try{const _0x1fd0fb=document[_0x12fcf5(0x215)]('btnToggleYtSound');if(_0x1fd0fb)_0x1fd0fb[_0x12fcf5(0x27c)]=ytFallbackIsPlaying?'⏸️':'▶️';}catch(_0x4ea342){}}function fallbackPostMessage(_0x21c4fb,_0x59e3bb=[]){const _0xf9736b=_0x2d0238;try{if(!ytFallbackFrame||!ytFallbackFrame[_0xf9736b(0x32d)])return;ytFallbackFrame[_0xf9736b(0x32d)][_0xf9736b(0x4b6)](JSON[_0xf9736b(0x399)]({'event':_0xf9736b(0x281),'func':_0x21c4fb,'args':_0x59e3bb}),_0xf9736b(0x1e6));}catch(_0x451355){}}function fallbackPlay(){fallbackPostMessage('playVideo');}function fallbackStop(){const _0x1495de=_0x2d0238;try{ytFallbackFrame&&(ytFallbackFrame[_0x1495de(0x342)]=_0x1495de(0x34b),ytFallbackIsPlaying=![]);}catch(_0x2f205f){}}function fallbackPause(){fallbackStop();}function fallbackUnMute(){const _0x3445df=_0x2d0238;fallbackPostMessage(_0x3445df(0x372));}function fallbackMute(){const _0x5a593e=_0x2d0238;fallbackPostMessage(_0x5a593e(0x504));}window[_0x2d0238(0x4ae)]=function(){const _0x101492=_0x2d0238;if(IS_FILE_PROTOCOL){try{window[_0x101492(0x3d9)]&&window[_0x101492(0x3d9)][_0x101492(0x3c5)]();}catch(_0x57993b){}return;}const _0x547113={'height':'1','width':'1','playerVars':{'autoplay':0x0,'controls':0x0,'playsinline':0x1},'events':{'onReady':onPlayerReady,'onStateChange':onPlayerStateChange},'host':_0x101492(0x1e6)};(window[_0x101492(0x387)]['protocol']===_0x101492(0x4a1)||window[_0x101492(0x387)][_0x101492(0x282)]==='https:')&&(_0x547113['origin']=window['location'][_0x101492(0x37d)]);ytPlayer=new YT[(_0x101492(0x44a))](_0x101492(0x3b0),_0x547113);try{window[_0x101492(0x3d9)]&&window[_0x101492(0x3d9)][_0x101492(0x3c5)]();const _0x15dd7a=document['getElementById'](_0x101492(0x335));_0x15dd7a&&(_0x15dd7a[_0x101492(0x27c)]='');}catch(_0x224089){}};let _ytPrimed=![],_ytUnlocked=![];try{_ytUnlocked=localStorage['getItem'](_0x2d0238(0x316))==='1';}catch(_0x1a468b){}function showSoundPermission(){const _0x10ab1c=_0x2d0238,_0xdd115b=document[_0x10ab1c(0x215)](_0x10ab1c(0x27b));if(!_0xdd115b)return;if(_ytUnlocked){_0xdd115b[_0x10ab1c(0x43c)][_0x10ab1c(0x2d2)](_0x10ab1c(0x4f2));return;}_0xdd115b['classList'][_0x10ab1c(0x439)](_0x10ab1c(0x4f2));}function hideSoundPermission(){const _0x2f9729=_0x2d0238,_0x362488=document[_0x2f9729(0x215)](_0x2f9729(0x27b));if(!_0x362488)return;_0x362488[_0x2f9729(0x43c)][_0x2f9729(0x2d2)](_0x2f9729(0x4f2));}function unlockAudioChain(){const _0x34416c=_0x2d0238;try{if(AUDIO_CTX&&typeof AUDIO_CTX['resume']===_0x34416c(0x4ab))AUDIO_CTX[_0x34416c(0x3ac)]();}catch(_0x3c7a7f){}try{if(IS_FILE_PROTOCOL)fallbackUnMute(),fallbackPlay();else ytPlayer&&ytPlayer[_0x34416c(0x372)]&&(ytPlayer[_0x34416c(0x372)](),ytPlayer[_0x34416c(0x3f4)]());}catch(_0x246ce1){}_ytUnlocked=!![];try{localStorage[_0x34416c(0x4d0)](_0x34416c(0x316),'1');}catch(_0x436379){}hideSoundPermission(),toast('Âm\x20thanh\x20đã\x20được\x20bật!');}function onPlayerReady(_0x650071){const _0x467475=_0x2d0238;try{const _0x2cc640=ytPlayer&&ytPlayer['getIframe']?ytPlayer[_0x467475(0x312)]():null;_0x2cc640&&_0x2cc640[_0x467475(0x34e)](_0x467475(0x40d),'autoplay;\x20encrypted-media;\x20picture-in-picture');}catch(_0x5000cd){}try{if(ytPlayer&&ytPlayer[_0x467475(0x31b)])ytPlayer[_0x467475(0x31b)](data&&data[_0x467475(0x3aa)]&&data[_0x467475(0x3aa)]['youtubeVolume']||0x50);}catch(_0x4ea8d1){}try{const _0xdc5527=getActiveVideoId&&getActiveVideoId();if(_0xdc5527&&ytPlayer&&ytPlayer[_0x467475(0x504)]&&ytPlayer[_0x467475(0x3f4)]){ytPlayer[_0x467475(0x504)](),ytPlayer[_0x467475(0x3f4)](),_ytPrimed=!![];const _0x282850=()=>{const _0x5bd682=_0x467475;if(_ytUnlocked)return;try{unlockAudioChain();}catch(_0x35fd05){}window[_0x5bd682(0x3b1)](_0x5bd682(0x45d),_0x282850,!![]),window[_0x5bd682(0x3b1)](_0x5bd682(0x428),_0x282850,!![]);};window['addEventListener']('pointerdown',_0x282850,!![]),window[_0x467475(0x2cf)](_0x467475(0x428),_0x282850,!![]),showSoundPermission();}}catch(_0x14a341){}updateYouTubePlayer();}function onPlayerStateChange(_0x3500a6){const _0x4759dd=_0x2d0238,_0xf05720=$(_0x4759dd(0x2d8));_0x3500a6[_0x4759dd(0x430)]==YT['PlayerState']['PLAYING']?(_0xf05720[_0x4759dd(0x27c)]='⏸️',hideSoundPermission()):_0xf05720[_0x4759dd(0x27c)]='▶️';if(_0x3500a6['data']===YT['PlayerState'][_0x4759dd(0x253)]){if(!ytUserPaused)ytPlayer['playVideo']();}}async function ytFadeTo(_0x308ca5,_0x1ee33b=0xfa){const _0x4e9df3=_0x2d0238;try{if(!ytPlayer||!ytPlayer[_0x4e9df3(0x310)]||!ytPlayer['setVolume'])return;ytPlayer[_0x4e9df3(0x372)]();const _0x3517f9=ytPlayer[_0x4e9df3(0x310)](),_0x5b8588=_0x308ca5-_0x3517f9;if(Math[_0x4e9df3(0x49b)](_0x5b8588)<0x1||_0x1ee33b<=0x0){ytPlayer[_0x4e9df3(0x31b)](_0x308ca5);return;}const _0x41a5ec=performance[_0x4e9df3(0x456)]();await new Promise(_0x96e2a1=>{const _0x2877ff=_0x125cec=>{const _0x1bf7a6=_0x1056,_0x1aed3b=Math[_0x1bf7a6(0x4db)](0x1,(_0x125cec-_0x41a5ec)/_0x1ee33b),_0x2d9071=Math['round'](_0x3517f9+_0x5b8588*_0x1aed3b);ytPlayer['setVolume'](_0x2d9071);if(_0x1aed3b<0x1)requestAnimationFrame(_0x2877ff);else _0x96e2a1();};requestAnimationFrame(_0x2877ff);});}catch(_0x1afde8){}}async function ytFadeInPlay(_0xcc95d0=0xdc){const _0x56b5e1=_0x2d0238;try{const _0x279d7c=Math[_0x56b5e1(0x324)](0x0,Math['min'](0x64,data&&data[_0x56b5e1(0x3aa)]&&data[_0x56b5e1(0x3aa)][_0x56b5e1(0x216)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;ytPlayer[_0x56b5e1(0x372)](),ytPlayer[_0x56b5e1(0x3f4)]();try{ytPlayer[_0x56b5e1(0x31b)](0x0);}catch(_0x26d4b7){}await ytFadeTo(_0x279d7c,_0xcc95d0);}else{const _0x3b30e1=getActiveVideoId();_0x3b30e1&&fallbackLoadVideo(_0x3b30e1,{'autoplay':0x1,'mute':0x0});}}catch(_0x1ca0ae){}}async function ytFadeOutPause(_0x26af0e=0xb4){const _0x37a6df=_0x2d0238;try{const _0x5e2ab2=Math[_0x37a6df(0x324)](0x0,Math[_0x37a6df(0x4db)](0x64,data&&data[_0x37a6df(0x3aa)]&&data[_0x37a6df(0x3aa)][_0x37a6df(0x216)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;await ytFadeTo(0x0,_0x26af0e);try{ytPlayer[_0x37a6df(0x1ff)](),ytPlayer[_0x37a6df(0x31b)](_0x5e2ab2);}catch(_0x17a981){}}else try{fallbackPause();}catch(_0xccb777){}}catch(_0x25b46b){}}async function updateYouTubePlayer(){const _0x2cbdc4=_0x2d0238,_0x693d4b=getActiveVideoId();if(data['settings'][_0x2cbdc4(0x421)]&&_0x693d4b){const _0x1526d6=_0x2cbdc4(0x313)+_0x693d4b+_0x2cbdc4(0x28a),_0x121b79=new Image();_0x121b79[_0x2cbdc4(0x4cc)]=async()=>{const _0x15079e=_0x2cbdc4;data[_0x15079e(0x3aa)][_0x15079e(0x3f7)]=_0x1526d6,await saveData(),applyCustomBg();},_0x121b79[_0x2cbdc4(0x420)]=async()=>{const _0x30559a=_0x2cbdc4,_0x459539='https://img.youtube.com/vi/'+_0x693d4b+_0x30559a(0x2ab);data[_0x30559a(0x3aa)][_0x30559a(0x3f7)]=_0x459539,await saveData(),applyCustomBg();},_0x121b79['src']=_0x1526d6;}else!_0x693d4b&&(data[_0x2cbdc4(0x3aa)][_0x2cbdc4(0x3f7)]='',await saveData(),applyCustomBg());if(IS_FILE_PROTOCOL){if(!_0x693d4b){fallbackStop(),hideSoundPermission();return;}const _0x401618=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x693d4b,{'autoplay':0x1,'mute':_0x401618});!_ytUnlocked&&showSoundPermission();return;}if(!ytPlayer||!ytPlayer[_0x2cbdc4(0x4f3)]){try{ensureYouTubeAPI();}catch(_0x2739fe){}return;}if(!_0x693d4b){if(ytPlayer[_0x2cbdc4(0x234)])ytPlayer['stopVideo']();hideSoundPermission();return;}ytPlayer[_0x2cbdc4(0x4f3)](_0x693d4b),ytPlayer['setVolume'](data[_0x2cbdc4(0x3aa)][_0x2cbdc4(0x216)]);}function toggleYtSound(){const _0x56de93=_0x2d0238;if(!_ytUnlocked){try{ensureAudio();}catch(_0x385f94){}try{unlockAudioChain();}catch(_0x4b23d9){}return;}if(IS_FILE_PROTOCOL){const _0x952525=getActiveVideoId();if(!ytFallbackFrame||!ytFallbackFrame['isConnected']){if(!_0x952525){toast(_0x56de93(0x383));return;}fallbackLoadVideo(_0x952525,{'autoplay':0x1,'mute':0x0}),ytFallbackIsPlaying=!![];try{const _0x544c53=document['getElementById'](_0x56de93(0x410));if(_0x544c53)_0x544c53[_0x56de93(0x27c)]='⏸️';}catch(_0x495b34){}toast(_0x56de93(0x2de));return;}if(ytFallbackIsPlaying)fallbackPostMessage(_0x56de93(0x1ff)),ytFallbackIsPlaying=![],toast('Đã\x20dừng\x20nhạc\x20nền.');else{if(!_0x952525){toast('Chưa\x20có\x20link\x20hợp\x20lệ.\x20Dán\x20link\x20rồi\x20bấm\x20▶️.');return;}fallbackPostMessage(_0x56de93(0x3f4)),ytFallbackIsPlaying=!![],toast('Đang\x20phát\x20nhạc\x20nền...');}try{const _0x1b9c78=document[_0x56de93(0x215)](_0x56de93(0x410));if(_0x1b9c78)_0x1b9c78['textContent']=ytFallbackIsPlaying?'⏸️':'▶️';}catch(_0x3671){}return;}if(!ytPlayer||typeof ytPlayer[_0x56de93(0x4bd)]!==_0x56de93(0x4ab)){try{ensureYouTubeAPI();}catch(_0x4ca567){}return;}const _0x426870=ytPlayer[_0x56de93(0x4bd)]();_0x426870===YT[_0x56de93(0x2e7)]['PLAYING']||_0x426870===YT[_0x56de93(0x2e7)]['BUFFERING']?(ytFadeOutPause(),ytUserPaused=!![],toast(_0x56de93(0x3a7))):(ytFadeInPlay(),ytUserPaused=![],toast(_0x56de93(0x2de)));}function bindEvents(){const _0x9d5c9a=_0x2d0238;try{const _0x2eb14c=document[_0x9d5c9a(0x276)](_0x9d5c9a(0x373));_0x2eb14c&&(_0x2eb14c['innerHTML']='Hãy\x20bắt\x20đầu\x20bằng\x20cách\x20chọn\x20một\x20<strong>Chủ\x20đề\x20con</strong>\x20hoặc\x20tạo\x20Chủ\x20đề.');}catch(_0x2c1261){}on($(_0x9d5c9a(0x261)),_0x9d5c9a(0x4da),toggleBackgroundView),on($(_0x9d5c9a(0x2ec)),'click',()=>{const _0x3f0938=_0x9d5c9a;$(_0x3f0938(0x34d))[_0x3f0938(0x43c)][_0x3f0938(0x2d2)]('show');try{releaseFocus();}catch(_0x31cb2c){}}),on($(_0x9d5c9a(0x500)),'click',()=>showInputModal(_0x9d5c9a(0x3ea),async _0x178610=>{const _0x334c55=_0x9d5c9a;if(!_0x178610)return;data[_0x334c55(0x2ad)][_0x334c55(0x4f9)]({'id':uid('t'),'name':_0x178610,'subtopics':[]}),await saveData(),renderTopics();})),on($(_0x9d5c9a(0x248)),_0x9d5c9a(0x4da),()=>storageManager[_0x9d5c9a(0x218)](data)),on($(_0x9d5c9a(0x41b)),_0x9d5c9a(0x4f0),_0x504d9f=>{const _0x15418a=_0x9d5c9a,_0x40b3d8=_0x504d9f[_0x15418a(0x4ff)][_0x15418a(0x23f)][0x0];if(!_0x40b3d8)return;storageManager[_0x15418a(0x200)](_0x40b3d8)['then'](async _0x5d619e=>{const _0x35ad97=_0x15418a;data=_0x5d619e,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),toast(_0x35ad97(0x2ae)),renderAll();})[_0x15418a(0x24b)](_0x10e7ee=>toast(_0x15418a(0x33e)+_0x10e7ee[_0x15418a(0x3a4)])),_0x504d9f[_0x15418a(0x4ff)]['value']=null;}),on($('#btnRestoreBackup'),_0x9d5c9a(0x4da),()=>{const _0x5ce60e=_0x9d5c9a,_0xe6f4a8=$(_0x5ce60e(0x21e)),_0x282fef=_0xe6f4a8?_0xe6f4a8[_0x5ce60e(0x258)]:'';if(!_0x282fef){toast(_0x5ce60e(0x257));return;}showConfirmModal(_0x5ce60e(0x42d),'Bạn\x20có\x20chắc\x20muốn\x20phục\x20hồi\x20dữ\x20liệu\x20từ\x20ngày\x20'+new Date(_0x282fef)['toLocaleDateString']()+_0x5ce60e(0x29c),_0x3899e7=>{const _0x17baee=_0x5ce60e;_0x3899e7&&storageManager[_0x17baee(0x4e7)](_0x282fef)['then'](_0x234ce4=>{const _0x10f710=_0x17baee;data=_0x234ce4,toast(_0x10f710(0x47a)),setTimeout(()=>window[_0x10f710(0x387)][_0x10f710(0x305)](),0x5dc);})[_0x17baee(0x24b)](_0x2b959f=>{const _0x1905eb=_0x17baee;toast('Lỗi:\x20'+_0x2b959f[_0x1905eb(0x3a4)]);});});}),on($(_0x9d5c9a(0x308)),_0x9d5c9a(0x1ec),_0x807e40=>{const _0x25b93a=_0x9d5c9a,_0x21a2ff=_0x807e40[_0x25b93a(0x4ff)][_0x25b93a(0x258)];applyTheme(_0x21a2ff);if(_0x21a2ff===_0x25b93a(0x45c)||_0x21a2ff===_0x25b93a(0x4fe)){const _0xb3d62f=$('#set_ytThumbAsBg');_0xb3d62f&&(_0xb3d62f['checked']=![],toast(_0x25b93a(0x214),0x7d0));try{document[_0x25b93a(0x26d)][_0x25b93a(0x3e8)][_0x25b93a(0x49a)]('--bg-image','none');}catch(_0x5e9cd5){}}else{const _0x2fe6f1=$(_0x25b93a(0x2fa));_0x2fe6f1&&(_0x2fe6f1[_0x25b93a(0x485)]=!![]);try{updateYouTubePlayer();}catch(_0x45efc3){}}}),on($(_0x9d5c9a(0x443)),_0x9d5c9a(0x4da),openSettings),on($(_0x9d5c9a(0x3ae)),_0x9d5c9a(0x4da),()=>{const _0x1e7465=_0x9d5c9a;switchView('topics'),$(_0x1e7465(0x500))['click']();}),on($(_0x9d5c9a(0x415)),_0x9d5c9a(0x4da),()=>{const _0x5dc50a=_0x9d5c9a;renderDashboard(),$('#modalDashboard')[_0x5dc50a(0x43c)][_0x5dc50a(0x439)]('show');}),on($(_0x9d5c9a(0x227)),'click',()=>{const _0x5f5605=_0x9d5c9a;$('#modalDashboard')['classList'][_0x5f5605(0x2d2)]('show');}),on($(_0x9d5c9a(0x4a9)),_0x9d5c9a(0x4da),closeSettings),on($(_0x9d5c9a(0x2e6)),_0x9d5c9a(0x4da),saveSettings),on($(_0x9d5c9a(0x318)),_0x9d5c9a(0x4da),setDefaults),on($(_0x9d5c9a(0x4b8)),_0x9d5c9a(0x4da),()=>{const _0x442237=_0x9d5c9a;ensureAudio(),playSound(_0x442237(0x48c));}),on($(_0x9d5c9a(0x347)),_0x9d5c9a(0x4da),_0x13fbf8=>{const _0x40d75=_0x9d5c9a;_0x13fbf8[_0x40d75(0x45e)]();const _0xf859b3=$(_0x40d75(0x328));if(_0xf859b3)_0xf859b3[_0x40d75(0x43c)][_0x40d75(0x3e2)](_0x40d75(0x2f4));}),on($(_0x9d5c9a(0x356)),'click',async()=>{const _0x61821c=_0x9d5c9a,_0x109cc1=getCurrentSubtopic();if(!_0x109cc1)return;const _0x131367=pendingNoteSessionId,_0x18a31f=_0x109cc1[_0x61821c(0x3a2)][_0x61821c(0x242)](_0x2b8ebf=>_0x2b8ebf['id']===_0x131367);_0x18a31f&&(_0x18a31f[_0x61821c(0x2c9)]=$(_0x61821c(0x1f8))['value']['trim'](),await saveData(),renderStatsHistory(),toast('Đã\x20lưu\x20ghi\x20chú')),closeNoteModal();}),on($(_0x9d5c9a(0x2f9)),_0x9d5c9a(0x4da),()=>closeNoteModal()),on($(_0x9d5c9a(0x4e0)),_0x9d5c9a(0x4da),addGeneralNote),on($(_0x9d5c9a(0x42b)),'click',handleSummarizeNote),on($(_0x9d5c9a(0x2f7)),'click',handleSendMessage),on($(_0x9d5c9a(0x311)),_0x9d5c9a(0x428),_0x675f12=>{const _0x301002=_0x9d5c9a;if(_0x675f12[_0x301002(0x2a0)]==='Enter')handleSendMessage();}),$$(_0x9d5c9a(0x437))[_0x9d5c9a(0x481)](_0xa21ee3=>{const _0x53e5fd=_0x9d5c9a;on(_0xa21ee3,_0x53e5fd(0x4da),()=>{const _0x2cc85b=_0x53e5fd,_0x4c29ff=_0xa21ee3[_0x2cc85b(0x20e)]['prompt'];$('#chatInput')['value']=_0x4c29ff,$('#chatInput')[_0x2cc85b(0x28d)]();});}),on($('#btnClearChat'),_0x9d5c9a(0x4da),clearChat),on($(_0x9d5c9a(0x43e)),'click',addSubtopicTask),on($('#newSubtopicTaskInput'),'keydown',_0x4d26f6=>{const _0x2caad3=_0x9d5c9a;if(_0x4d26f6[_0x2caad3(0x2a0)]===_0x2caad3(0x33b))addSubtopicTask();}),on($(_0x9d5c9a(0x2d8)),_0x9d5c9a(0x4da),toggleYtSound),on($(_0x9d5c9a(0x2a2)),_0x9d5c9a(0x4da),()=>{ensureAudio(),unlockAudioChain();}),on($(_0x9d5c9a(0x3fb)),_0x9d5c9a(0x1ec),_0x349bb6=>{const _0x1acca8=_0x9d5c9a,_0x25b154=parseInt(_0x349bb6[_0x1acca8(0x4ff)][_0x1acca8(0x258)],0xa);ytPlayer&&ytPlayer[_0x1acca8(0x31b)]&&ytPlayer['setVolume'](_0x25b154);}),on($(_0x9d5c9a(0x464)),_0x9d5c9a(0x1ec),handleYoutubeUrlInput),$$(_0x9d5c9a(0x35c))[_0x9d5c9a(0x481)](_0x34b6fc=>{_0x34b6fc['addEventListener']('click',()=>{const _0x503a3f=_0x1056,_0x1fcabf=_0x34b6fc[_0x503a3f(0x20e)][_0x503a3f(0x45b)],_0x4ba0d2=data?.[_0x503a3f(0x3aa)]?.[_0x503a3f(0x2d1)]||'timer';if(_0x4ba0d2===_0x1fcabf&&_0x1fcabf!==_0x503a3f(0x1f6))switchView(_0x503a3f(0x1f6));else switchView(_0x1fcabf);});}),$$('.tab-btn')[_0x9d5c9a(0x481)](_0x53f04f=>{const _0x25a4f6=_0x9d5c9a;_0x53f04f[_0x25a4f6(0x2cf)](_0x25a4f6(0x4da),()=>{const _0x2c9a90=_0x25a4f6,_0x5ec9ea=_0x53f04f[_0x2c9a90(0x20e)][_0x2c9a90(0x252)],_0x4c91f1=_0x53f04f[_0x2c9a90(0x42e)]('.aux-panel,\x20.modal-card');if(!_0x4c91f1)return;_0x4c91f1[_0x2c9a90(0x4c6)](_0x2c9a90(0x2da))['forEach'](_0x1e562d=>_0x1e562d['classList'][_0x2c9a90(0x2d2)](_0x2c9a90(0x4ec))),_0x53f04f['classList'][_0x2c9a90(0x439)](_0x2c9a90(0x4ec)),_0x4c91f1[_0x2c9a90(0x4c6)](_0x2c9a90(0x3e1))[_0x2c9a90(0x481)](_0x51d89d=>{const _0x3b7cc7=_0x2c9a90;_0x51d89d[_0x3b7cc7(0x43c)]['remove'](_0x3b7cc7(0x4ec)),_0x51d89d[_0x3b7cc7(0x3e8)][_0x3b7cc7(0x4d8)]=_0x3b7cc7(0x4d3);});const _0x3c8e7e=_0x4c91f1['querySelector']('#'+_0x5ec9ea);_0x3c8e7e&&(_0x3c8e7e[_0x2c9a90(0x43c)][_0x2c9a90(0x439)]('active'),_0x3c8e7e['style'][_0x2c9a90(0x4d8)]=_0x2c9a90(0x29b),_0x4c91f1['closest'](_0x2c9a90(0x2fe))&&(_0x3c8e7e['style'][_0x2c9a90(0x4d8)]=_0x2c9a90(0x29d)));});});const _0x86c109=$('#methodEditorContentInput');function _0x15995d(_0x557d94,_0xedcf73=null){const _0x53cebc=_0x9d5c9a;try{document[_0x53cebc(0x2a6)](_0x53cebc(0x2c4),![],!![]);}catch(_0x4930e4){}try{document[_0x53cebc(0x2a6)](_0x557d94,![],_0xedcf73);}catch(_0x43a90e){}if(_0x86c109)_0x86c109[_0x53cebc(0x28d)]();}on($(_0x9d5c9a(0x1f1)),'click',()=>_0x15995d('bold')),on($(_0x9d5c9a(0x20c)),'click',()=>_0x15995d('italic')),on($(_0x9d5c9a(0x334)),_0x9d5c9a(0x4da),()=>_0x15995d(_0x9d5c9a(0x323),'<h4>')),on($(_0x9d5c9a(0x2e4)),'click',()=>_0x15995d(_0x9d5c9a(0x4a8))),on($(_0x9d5c9a(0x22f)),_0x9d5c9a(0x4da),()=>_0x15995d(_0x9d5c9a(0x426)));const _0x268801=$(_0x9d5c9a(0x325)),_0x11e1b9=$(_0x9d5c9a(0x44c));on($(_0x9d5c9a(0x2e0)),_0x9d5c9a(0x4da),_0x16b439=>{const _0x453563=_0x9d5c9a;if(!_0x11e1b9)return;_0x16b439[_0x453563(0x32a)](),_0x11e1b9[_0x453563(0x43c)][_0x453563(0x3e2)](_0x453563(0x2f4));}),$$('.color-swatch')[_0x9d5c9a(0x481)](_0x49448d=>{const _0x530079=_0x9d5c9a;on(_0x49448d,_0x530079(0x4da),_0x5b84c8=>{const _0x1bf690=_0x530079;_0x5b84c8[_0x1bf690(0x45e)]();const _0xd060a5=_0x49448d[_0x1bf690(0x20e)]['color']||'';let _0x47c0e5=_0xd060a5;try{const _0x300a9a=_0xd060a5[_0x1bf690(0x278)](/--[a-zA-Z0-9_-]+/);if(_0x300a9a)_0x47c0e5=getComputedStyle(document[_0x1bf690(0x26d)])['getPropertyValue'](_0x300a9a[0x0])[_0x1bf690(0x452)]();}catch(_0x12a606){}_0x15995d(_0x1bf690(0x472),_0x47c0e5);if(_0x11e1b9)_0x11e1b9[_0x1bf690(0x43c)]['add'](_0x1bf690(0x2f4));});}),on(document,'click',_0x51f00a=>{const _0x2be8d0=_0x9d5c9a;if(!_0x268801||!_0x11e1b9)return;!_0x268801[_0x2be8d0(0x433)](_0x51f00a[_0x2be8d0(0x4ff)])&&!_0x11e1b9[_0x2be8d0(0x43c)][_0x2be8d0(0x433)]('hidden')&&_0x11e1b9[_0x2be8d0(0x43c)][_0x2be8d0(0x439)](_0x2be8d0(0x2f4));});function _0x2755a7(_0x26cd9f){const _0x1bf1d3=_0x9d5c9a,_0x5ab521=getCurrentSubtopic();if(!_0x5ab521){toast(_0x1bf1d3(0x4f1));return;}_0x5ab521[_0x1bf1d3(0x377)]=Array['isArray'](_0x5ab521['methods'])?_0x5ab521[_0x1bf1d3(0x377)]:[];const _0x20264d=_0x5ab521['methods'],_0x3ef192=_0x26cd9f?_0x20264d[_0x1bf1d3(0x242)](_0x5e5290=>_0x5e5290['id']===_0x26cd9f):null;$(_0x1bf1d3(0x3c7))[_0x1bf1d3(0x258)]=_0x3ef192&&_0x3ef192['id']||'',$(_0x1bf1d3(0x403))['textContent']=_0x3ef192?'Chỉnh-sửa\x20Tri\x20thức':_0x1bf1d3(0x401),$(_0x1bf1d3(0x3ce))[_0x1bf1d3(0x258)]=_0x3ef192&&_0x3ef192[_0x1bf1d3(0x4d7)]||'';const _0x25e727=$(_0x1bf1d3(0x42a));if(_0x25e727)_0x25e727[_0x1bf1d3(0x4b3)]=_0x3ef192&&_0x3ef192[_0x1bf1d3(0x2ee)]||'';$(_0x1bf1d3(0x1fa))['classList'][_0x1bf1d3(0x439)](_0x1bf1d3(0x4f2));try{trapFocus($(_0x1bf1d3(0x1fa)));}catch(_0x170d8e){}try{const _0x20a514=$(_0x1bf1d3(0x36d));if(_0x20a514){const _0x39c645=!!(data?.['settings']?.[_0x1bf1d3(0x445)]&&data[_0x1bf1d3(0x3aa)]['apiKey'][_0x1bf1d3(0x452)]());_0x20a514['disabled']=!_0x39c645,_0x20a514[_0x1bf1d3(0x4d7)]=_0x39c645?_0x1bf1d3(0x3bd):_0x1bf1d3(0x4f5);}}catch(_0x3ef2f1){}}on($(_0x9d5c9a(0x4c0)),_0x9d5c9a(0x4da),()=>{const _0x29bb9f=_0x9d5c9a;$('#modalMethodEditor')[_0x29bb9f(0x43c)][_0x29bb9f(0x2d2)](_0x29bb9f(0x4f2));try{releaseFocus();}catch(_0x356322){}}),on($(_0x9d5c9a(0x3f8)),_0x9d5c9a(0x4da),async()=>{const _0x134a3e=_0x9d5c9a,_0x961228=getCurrentSubtopic();if(!_0x961228){toast('Vui\x20lòng\x20chọn\x20một\x20Chủ\x20đề\x20con\x20trước.');return;}_0x961228[_0x134a3e(0x377)]=Array['isArray'](_0x961228['methods'])?_0x961228[_0x134a3e(0x377)]:[];const _0x51ef00=$(_0x134a3e(0x3c7))[_0x134a3e(0x258)]||uid('m'),_0x59aeb5=($(_0x134a3e(0x3ce))['value']||'')['trim'](),_0x1668e4=$(_0x134a3e(0x42a)),_0xfbf717=_0x1668e4?_0x1668e4[_0x134a3e(0x4b3)]||'':'',_0x3577f6=_0x961228[_0x134a3e(0x377)][_0x134a3e(0x468)](_0x248087=>_0x248087['id']===_0x51ef00),_0x1bbdbf={'id':_0x51ef00,'title':_0x59aeb5,'content':_0xfbf717};if(_0x3577f6>=0x0)_0x961228[_0x134a3e(0x377)][_0x3577f6]=_0x1bbdbf;else _0x961228[_0x134a3e(0x377)][_0x134a3e(0x3d4)](_0x1bbdbf);await storageManager[_0x134a3e(0x38a)](_0x134a3e(0x2bf),_0x961228),renderMethods(),$('#modalMethodEditor')[_0x134a3e(0x43c)][_0x134a3e(0x2d2)](_0x134a3e(0x4f2));try{releaseFocus();}catch(_0x50dc4d){}}),on($(_0x9d5c9a(0x36d)),'click',async()=>{const _0x196b97=_0x9d5c9a,_0x3c0576=$('#methodEditorContentInput');if(!_0x3c0576)return;const _0x5a1aa5=(_0x3c0576[_0x196b97(0x27c)]||'')[_0x196b97(0x452)]();if(!_0x5a1aa5||_0x5a1aa5[_0x196b97(0x21c)]<0x14){toast(_0x196b97(0x404));return;}const _0x1221f3=$(_0x196b97(0x36d));_0x1221f3&&(_0x1221f3[_0x196b97(0x211)]=!![],_0x1221f3[_0x196b97(0x4b3)]='<div\x20class=\x22spinner\x22></div>');const _0x5eec32=_0x196b97(0x471)+_0x5a1aa5+'\x22',_0x4a1e77=await callGeminiAPI(_0x5eec32);_0x4a1e77?(_0x3c0576[_0x196b97(0x4b3)]=_0x4a1e77,toast(_0x196b97(0x21d))):toast(_0x196b97(0x4be)),_0x1221f3&&(_0x1221f3['disabled']=![],_0x1221f3['innerHTML']=_0x196b97(0x2b0));}),on($(_0x9d5c9a(0x47c)),_0x9d5c9a(0x4da),()=>{if(!getCurrentSubtopic()){toast('Vui\x20lòng\x20chọn\x20một\x20Chủ\x20đề\x20con\x20trước.');return;}_0x2755a7();});const _0x14f929=document['querySelector'](_0x9d5c9a(0x3e9));_0x14f929&&_0x14f929[_0x9d5c9a(0x2cf)](_0x9d5c9a(0x4da),_0x19bc5c=>{const _0x1cda8b=_0x9d5c9a,_0x53cb0b=_0x19bc5c[_0x1cda8b(0x4ff)][_0x1cda8b(0x42e)]&&_0x19bc5c[_0x1cda8b(0x4ff)][_0x1cda8b(0x42e)](_0x1cda8b(0x34f)),_0x28312e=!_0x53cb0b&&_0x19bc5c[_0x1cda8b(0x4ff)][_0x1cda8b(0x42e)]&&_0x19bc5c[_0x1cda8b(0x4ff)]['closest'](_0x1cda8b(0x290));if(_0x53cb0b){_0x19bc5c[_0x1cda8b(0x45e)](),_0x19bc5c[_0x1cda8b(0x32a)]();const _0x4ff6a3=_0x53cb0b[_0x1cda8b(0x20e)]['id'];if(_0x4ff6a3)_0x2755a7(_0x4ff6a3);return;}if(_0x28312e){_0x19bc5c[_0x1cda8b(0x45e)](),_0x19bc5c['stopPropagation']();const _0x49b655=_0x28312e['dataset']['id'];if(!_0x49b655)return;const _0x19d1a3=getCurrentSubtopic();if(!_0x19d1a3)return;_0x19d1a3[_0x1cda8b(0x377)]=Array[_0x1cda8b(0x2d9)](_0x19d1a3['methods'])?_0x19d1a3[_0x1cda8b(0x377)]:[];const _0xbde294=_0x19d1a3[_0x1cda8b(0x377)][_0x1cda8b(0x242)](_0x37c865=>_0x37c865['id']===_0x49b655);if(!_0xbde294)return;showConfirmModal('Xác\x20nhận\x20xóa',_0x1cda8b(0x210)+(_0xbde294[_0x1cda8b(0x4d7)]||'')+'\x22?',async _0x3f4833=>{const _0x10e144=_0x1cda8b;if(!_0x3f4833)return;_0x19d1a3[_0x10e144(0x377)]=_0x19d1a3['methods'][_0x10e144(0x1f9)](_0x24182c=>_0x24182c['id']!==_0x49b655),await storageManager[_0x10e144(0x38a)](_0x10e144(0x2bf),_0x19d1a3),renderMethods();});}});$$(_0x9d5c9a(0x20d))[_0x9d5c9a(0x481)](_0x57ffde=>{const _0x4f770e=_0x9d5c9a;_0x57ffde[_0x4f770e(0x2cf)](_0x4f770e(0x4da),()=>{const _0x33886f=_0x4f770e;editingPreset=_0x57ffde[_0x33886f(0x20e)][_0x33886f(0x4b9)],highlightPresetSelector(),loadEditingPresetFields();});}),$$(_0x9d5c9a(0x341))['forEach'](_0x45abaa=>{const _0x4a2a1d=_0x9d5c9a;_0x45abaa[_0x4a2a1d(0x2cf)](_0x4a2a1d(0x4da),_0x3c6427=>{const _0x1d057f=_0x4a2a1d,_0x27e6e0=_0x3c6427[_0x1d057f(0x4ff)]['dataset'][_0x1d057f(0x4fb)],_0x30f9c3=data[_0x1d057f(0x3aa)][_0x1d057f(0x4fb)];if(_0x27e6e0===_0x30f9c3)return;timer['state']!=='idle'?showConfirmModal(_0x1d057f(0x497),_0x1d057f(0x3bc)+_0x27e6e0+'?\x20Thao\x20tác\x20này\x20sẽ\x20dừng\x20và\x20đặt\x20lại\x20phiên\x20làm\x20việc\x20hiện\x20tại.',_0x5038c3=>{const _0x508b34=_0x1d057f;_0x5038c3&&(timer[_0x508b34(0x473)](),timer['setPreset'](_0x27e6e0),renderAll(),toast(_0x508b34(0x21f)+_0x27e6e0+'.'));}):(timer[_0x1d057f(0x4b0)](_0x27e6e0),renderAll(),toast('Đã\x20chuyển\x20sang\x20Kiểu\x20'+_0x27e6e0+'.'));});}),on($(_0x9d5c9a(0x24a)),_0x9d5c9a(0x4da),()=>timer[_0x9d5c9a(0x402)]()),on($('#btnFinishFlow'),_0x9d5c9a(0x4da),()=>timer[_0x9d5c9a(0x484)]()),on($(_0x9d5c9a(0x219)),_0x9d5c9a(0x4da),()=>timer[_0x9d5c9a(0x262)]()),on($(_0x9d5c9a(0x463)),_0x9d5c9a(0x4da),()=>timer[_0x9d5c9a(0x3ac)]()),on($(_0x9d5c9a(0x2d3)),'click',()=>timer[_0x9d5c9a(0x2c2)]()),on($(_0x9d5c9a(0x2d5)),'click',()=>timer[_0x9d5c9a(0x473)]()),on($(_0x9d5c9a(0x4b1)),_0x9d5c9a(0x4da),()=>timer['beginBreak']()),on($(_0x9d5c9a(0x340)),_0x9d5c9a(0x4f0),_0x3230ed=>{const _0x1f7a79=_0x9d5c9a;handleFileUpload(_0x3230ed[_0x1f7a79(0x4ff)][_0x1f7a79(0x23f)][0x0],async _0x5da8e2=>{const _0x848681=_0x1f7a79;data['settings'][_0x848681(0x3f7)]=_0x5da8e2,await saveData(),applyCustomBg(),toast(_0x848681(0x24c));}),_0x3230ed[_0x1f7a79(0x4ff)][_0x1f7a79(0x258)]=null;}),on($(_0x9d5c9a(0x3b8)),_0x9d5c9a(0x4da),async()=>{const _0x13e341=_0x9d5c9a;data[_0x13e341(0x3aa)]['customBg']='',data['settings'][_0x13e341(0x421)]=![],await saveData(),applyCustomBg(),toast(_0x13e341(0x236)),$(_0x13e341(0x2fe))[_0x13e341(0x43c)]['contains'](_0x13e341(0x4f2))&&openSettings();}),on($(_0x9d5c9a(0x2ff)),_0x9d5c9a(0x4f0),_0x40defc=>{const _0x2f8bb6=_0x9d5c9a;handleFileUpload(_0x40defc[_0x2f8bb6(0x4ff)]['files'][0x0],async _0x335ae6=>{const _0x3b3939=_0x2f8bb6;data[_0x3b3939(0x3aa)][_0x3b3939(0x25f)]['work_end']=_0x335ae6,await saveData(),toast(_0x3b3939(0x414));}),_0x40defc[_0x2f8bb6(0x4ff)][_0x2f8bb6(0x258)]=null;}),on($('#uploadSoundBreak'),_0x9d5c9a(0x4f0),_0x3b9c2c=>{const _0x1a8905=_0x9d5c9a;handleFileUpload(_0x3b9c2c[_0x1a8905(0x4ff)][_0x1a8905(0x23f)][0x0],async _0x40370f=>{const _0x1daf03=_0x1a8905;data['settings'][_0x1daf03(0x25f)]['break_end']=_0x40370f,await saveData(),toast(_0x1daf03(0x43b));}),_0x3b9c2c[_0x1a8905(0x4ff)][_0x1a8905(0x258)]=null;}),on($(_0x9d5c9a(0x2fc)),_0x9d5c9a(0x4f0),_0x329d83=>{const _0x1ec821=_0x9d5c9a;handleFileUpload(_0x329d83['target'][_0x1ec821(0x23f)][0x0],async _0x36dfa3=>{const _0x33bce6=_0x1ec821;data[_0x33bce6(0x3aa)][_0x33bce6(0x25f)]['long_end']=_0x36dfa3,await saveData(),toast(_0x33bce6(0x408));}),_0x329d83[_0x1ec821(0x4ff)][_0x1ec821(0x258)]=null;}),on($('#btnFullscreen'),_0x9d5c9a(0x4da),toggleFullScreen),document[_0x9d5c9a(0x2cf)](_0x9d5c9a(0x202),updateFullscreenButton),window[_0x9d5c9a(0x2cf)](_0x9d5c9a(0x428),_0x350cfb=>{const _0x12acda=_0x9d5c9a,_0x58163d=(_0x350cfb[_0x12acda(0x4ff)][_0x12acda(0x353)]||'')[_0x12acda(0x48d)](),_0x220d35=[_0x12acda(0x1ec),_0x12acda(0x41f),_0x12acda(0x40b)]['includes'](_0x58163d);if(_0x350cfb[_0x12acda(0x2ca)]===_0x12acda(0x280)&&!_0x220d35){_0x350cfb[_0x12acda(0x45e)]();if(timer[_0x12acda(0x271)]==='idle'||timer[_0x12acda(0x271)]==='paused')timer[_0x12acda(0x402)]();else timer['pause']();}(_0x350cfb[_0x12acda(0x2a0)]==='n'||_0x350cfb[_0x12acda(0x2a0)]==='N')&&(!_0x220d35&&(_0x350cfb[_0x12acda(0x45e)](),timer[_0x12acda(0x2c2)]()));if(_0x350cfb[_0x12acda(0x2a0)]===_0x12acda(0x41a)){$$('.modal')[_0x12acda(0x481)](_0x587787=>_0x587787['classList'][_0x12acda(0x2d2)](_0x12acda(0x4f2)));try{releaseFocus();}catch(_0x40c05f){}}if(_0x350cfb['altKey']&&!_0x220d35){if(_0x350cfb[_0x12acda(0x2a0)]===_0x12acda(0x4ed))_0x350cfb[_0x12acda(0x45e)](),_0x5ad017(0x0,-0xa);else{if(_0x350cfb[_0x12acda(0x2a0)]===_0x12acda(0x338))_0x350cfb[_0x12acda(0x45e)](),_0x5ad017(0x0,0xa);else{if(_0x350cfb[_0x12acda(0x2a0)]==='ArrowLeft')_0x350cfb[_0x12acda(0x45e)](),_0x5ad017(-0xa,0x0);else _0x350cfb[_0x12acda(0x2a0)]===_0x12acda(0x4d9)&&(_0x350cfb['preventDefault'](),_0x5ad017(0xa,0x0));}}}}),$$(_0x9d5c9a(0x3b9))[_0x9d5c9a(0x481)](_0x138d35=>_0x138d35[_0x9d5c9a(0x2cf)](_0x9d5c9a(0x4da),_0x52cce3=>{const _0x54a9e9=_0x9d5c9a;if(_0x52cce3&&_0x52cce3['target']&&_0x52cce3['target']['id']===_0x54a9e9(0x1fc))return;if(_0x52cce3[_0x54a9e9(0x4ff)]===_0x138d35){_0x138d35[_0x54a9e9(0x43c)][_0x54a9e9(0x2d2)](_0x54a9e9(0x4f2));try{releaseFocus();}catch(_0x537066){}}})),window['addEventListener'](_0x9d5c9a(0x4da),_0x1010d8=>{const _0x2fa860=_0x9d5c9a;!_0x1010d8[_0x2fa860(0x4ff)]['closest'](_0x2fa860(0x204))&&!_0x1010d8['target'][_0x2fa860(0x42e)](_0x2fa860(0x3a6))&&closeAllMenus();});try{const _0x19f98e=document[_0x9d5c9a(0x276)](_0x9d5c9a(0x269));if(_0x19f98e)_0x19f98e['addEventListener'](_0x9d5c9a(0x46c),closeAllMenus);}catch(_0x4be13a){}try{window[_0x9d5c9a(0x2cf)](_0x9d5c9a(0x46c),closeAllMenus,!![]);}catch(_0x2fdf00){}window['addEventListener']('beforeunload',()=>timer['persistTimerState'](!![]));try{const _0x23f6d4=Array['from'](document['querySelectorAll']('#view-methods\x20.method-item'));_0x23f6d4['length']&&_0x23f6d4[_0x9d5c9a(0x481)](_0x43fdb8=>{const _0x47e498=_0x9d5c9a;_0x43fdb8[_0x47e498(0x2cf)](_0x47e498(0x3e2),()=>{const _0x1e81f5=_0x47e498;_0x43fdb8['open']&&_0x23f6d4[_0x1e81f5(0x481)](_0x2e081a=>{const _0x33df6c=_0x1e81f5;if(_0x2e081a!==_0x43fdb8)_0x2e081a[_0x33df6c(0x34c)]=![];});});});}catch(_0x582a49){}const _0x34579e=$(_0x9d5c9a(0x3bb));let _0x4f7fc9=![],_0x4a9649,_0x42fa71;_0x34579e&&(_0x34579e[_0x9d5c9a(0x2cf)](_0x9d5c9a(0x3c8),_0x5200a6=>{const _0x31b5de=_0x9d5c9a;_0x4f7fc9=!![];const _0x209ddf=_0x34579e[_0x31b5de(0x349)]();_0x4a9649=_0x5200a6[_0x31b5de(0x2a5)]-_0x209ddf[_0x31b5de(0x4ce)],_0x42fa71=_0x5200a6[_0x31b5de(0x283)]-_0x209ddf[_0x31b5de(0x228)],_0x34579e[_0x31b5de(0x3e8)][_0x31b5de(0x297)]='none';}),document[_0x9d5c9a(0x2cf)](_0x9d5c9a(0x4c3),_0x2b672c=>{const _0x389047=_0x9d5c9a;if(!_0x4f7fc9)return;let _0x583bcc=_0x2b672c[_0x389047(0x2a5)]-_0x4a9649,_0xca4fc3=_0x2b672c[_0x389047(0x283)]-_0x42fa71;const _0x228f92=window[_0x389047(0x454)]-_0x34579e[_0x389047(0x20a)],_0x5e3195=window[_0x389047(0x2aa)]-_0x34579e[_0x389047(0x498)];_0x583bcc=Math[_0x389047(0x324)](0x0,Math[_0x389047(0x4db)](_0x583bcc,_0x228f92)),_0xca4fc3=Math[_0x389047(0x324)](0x0,Math[_0x389047(0x4db)](_0xca4fc3,_0x5e3195)),_0x34579e[_0x389047(0x3e8)]['left']=_0x583bcc+'px',_0x34579e[_0x389047(0x3e8)][_0x389047(0x228)]=_0xca4fc3+'px',_0x34579e['style'][_0x389047(0x455)]='auto',_0x34579e[_0x389047(0x3e8)]['right']=_0x389047(0x254);}),document[_0x9d5c9a(0x2cf)](_0x9d5c9a(0x29f),()=>{const _0xd23d6d=_0x9d5c9a;if(!_0x4f7fc9)return;_0x4f7fc9=![],_0x34579e[_0xd23d6d(0x3e8)][_0xd23d6d(0x297)]='';}));function _0x34a6cb(_0x47ed78){const _0x240e01=_0x9d5c9a,_0x322749=$(_0x240e01(0x3bb));if(!_0x322749)return;_0x322749['style'][_0x240e01(0x267)]=_0x240e01(0x453),_0x322749['style'][_0x240e01(0x297)]='',_0x322749[_0x240e01(0x3e8)][_0x240e01(0x4ce)]=_0x240e01(0x254),_0x322749[_0x240e01(0x3e8)][_0x240e01(0x228)]=_0x240e01(0x254),_0x322749[_0x240e01(0x3e8)][_0x240e01(0x385)]=_0x240e01(0x254),_0x322749[_0x240e01(0x3e8)][_0x240e01(0x455)]=_0x240e01(0x254);const _0x158443=0x10;_0x47ed78==='tl'&&(_0x322749[_0x240e01(0x3e8)][_0x240e01(0x4ce)]=_0x158443+'px',_0x322749['style'][_0x240e01(0x228)]=_0x158443+'px'),_0x47ed78==='tr'&&(_0x322749[_0x240e01(0x3e8)][_0x240e01(0x385)]=_0x158443+'px',_0x322749[_0x240e01(0x3e8)][_0x240e01(0x228)]=_0x158443+'px'),_0x47ed78==='bl'&&(_0x322749[_0x240e01(0x3e8)][_0x240e01(0x4ce)]=_0x158443+'px',_0x322749[_0x240e01(0x3e8)]['bottom']=_0x158443+'px'),_0x47ed78==='br'&&(_0x322749[_0x240e01(0x3e8)][_0x240e01(0x385)]=_0x158443+'px',_0x322749['style']['bottom']=_0x158443+'px');}function _0x5ad017(_0x5308c7,_0x3b1de8){const _0x143d9d=_0x9d5c9a,_0x51b218=$(_0x143d9d(0x3bb));if(!_0x51b218)return;const _0xbc0bd8=_0x51b218[_0x143d9d(0x349)](),_0x3f7941=Math['max'](0x0,Math['min'](_0xbc0bd8[_0x143d9d(0x4ce)]+_0x5308c7,window[_0x143d9d(0x454)]-_0x51b218[_0x143d9d(0x20a)])),_0x20caff=Math[_0x143d9d(0x324)](0x0,Math[_0x143d9d(0x4db)](_0xbc0bd8[_0x143d9d(0x228)]+_0x3b1de8,window[_0x143d9d(0x2aa)]-_0x51b218[_0x143d9d(0x498)]));_0x51b218[_0x143d9d(0x3e8)]['left']=_0x3f7941+'px',_0x51b218[_0x143d9d(0x3e8)][_0x143d9d(0x228)]=_0x20caff+'px',_0x51b218[_0x143d9d(0x3e8)][_0x143d9d(0x385)]=_0x143d9d(0x254),_0x51b218[_0x143d9d(0x3e8)][_0x143d9d(0x455)]=_0x143d9d(0x254);}}function toggleBackgroundView(){const _0x2d0d0b=_0x2d0238,_0x1eade3=document[_0x2d0d0b(0x26d)];_0x1eade3['classList'][_0x2d0d0b(0x3e2)](_0x2d0d0b(0x203));const _0xfc617f=_0x1eade3[_0x2d0d0b(0x43c)]['contains'](_0x2d0d0b(0x203)),_0x59a406=$(_0x2d0d0b(0x261));if(!_0x59a406)return;_0xfc617f?(_0x59a406[_0x2d0d0b(0x4d7)]='Hiện\x20giao\x20diện',_0x59a406[_0x2d0d0b(0x4b3)]='<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M9.88\x209.88a3\x203\x200\x201\x200\x204.24\x204.24\x22/><path\x20d=\x22M10.73\x205.08A10.43\x2010.43\x200\x200\x201\x2012\x205c7\x200\x2010\x207\x2010\x207a13.16\x2013.16\x200\x200\x201-1.67\x202.68\x22/><path\x20d=\x22M6.61\x206.61A13.526\x2013.526\x200\x200\x200\x202\x2012s3\x207\x2010\x207a9.74\x209.74\x200\x200\x200\x205.39-1.61\x22/><line\x20x1=\x222\x22\x20y1=\x222\x22\x20x2=\x2222\x22\x20y2=\x2222\x22/></svg>'):(_0x59a406['title']=_0x2d0d0b(0x3b3),_0x59a406['innerHTML']=_0x2d0d0b(0x36e));}function updateMainViewVisibility(){const _0x158d1a=_0x2d0238,_0x585a25=!!getCurrentSubtopic(),_0x45c0f8=$(_0x158d1a(0x499)),_0x10faba=$(_0x158d1a(0x344));_0x10faba&&_0x10faba[_0x158d1a(0x43c)]['toggle']('hidden',_0x585a25),_0x45c0f8&&(_0x585a25?_0x45c0f8[_0x158d1a(0x43c)][_0x158d1a(0x2d2)](_0x158d1a(0x25e)):_0x45c0f8[_0x158d1a(0x43c)][_0x158d1a(0x439)]('no-subtopic-selected'));}function updatePresetButtonsText(){const _0x269aac=_0x2d0238,_0x4c239b=data[_0x269aac(0x3aa)],_0xa910ca=_0x4c239b[_0x269aac(0x2ed)],_0x461289=_0x4c239b[_0x269aac(0x39f)],_0x587721=_0x4c239b[_0x269aac(0x286)][_0x269aac(0x431)],_0x265477=_0x4c239b[_0x269aac(0x286)][_0x269aac(0x467)],_0x24ad36=$('#btnPresetA'),_0x5ceda1=$(_0x269aac(0x4fc)),_0x5a96ea=$(_0x269aac(0x291));_0x24ad36&&(_0x24ad36['textContent']=_0xa910ca+'×'+_0x587721+_0x269aac(0x2ea)),_0x5ceda1&&(_0x5ceda1[_0x269aac(0x27c)]=_0x461289+'×'+_0x265477+_0x269aac(0x333)),_0x5a96ea&&(_0x5a96ea['textContent']=_0x269aac(0x3be));}function renderAll(){const _0x568658=_0x2d0238;updatePresetButtonsText();const _0x405757=data[_0x568658(0x3aa)]['preset'];$$(_0x568658(0x341))[_0x568658(0x481)](_0x4ee62a=>{const _0x4ef06e=_0x568658,_0x507d9e=_0x4ee62a['dataset'][_0x4ef06e(0x4fb)]===_0x405757;_0x4ee62a['classList'][_0x4ef06e(0x3e2)]('acc',_0x507d9e),_0x4ee62a[_0x4ef06e(0x43c)]['toggle'](_0x4ef06e(0x2c7),!_0x507d9e),_0x4ee62a[_0x4ef06e(0x34e)](_0x4ef06e(0x4dc),_0x507d9e);}),updateMainViewVisibility(),timer[_0x568658(0x4b0)](data[_0x568658(0x3aa)][_0x568658(0x4fb)],{'silent':!![]}),renderTopics(),renderContextBadge(),renderStatsHistory(),renderGeneralNotes(),renderMethods(),renderChat(),applyCustomBg(),applyPanelOpacity(),renderSubtopicTasks(),updateFullscreenButton(),switchView(data[_0x568658(0x3aa)][_0x568658(0x2d1)]);}function toggleFullScreen(){const _0x3c14cf=_0x2d0238;!document['fullscreenElement']?document[_0x3c14cf(0x3f6)]['requestFullscreen']()[_0x3c14cf(0x24b)](_0xa04d8a=>{toast('Lỗi:\x20Không\x20thể\x20bật\x20chế\x20độ\x20toàn\x20màn\x20hình:\x20'+_0xa04d8a['message']);}):document[_0x3c14cf(0x25b)]&&document[_0x3c14cf(0x25b)]();}function updateFullscreenButton(){const _0x302fb0=_0x2d0238,_0x36aa33=$(_0x302fb0(0x2fd));document[_0x302fb0(0x2bc)]?(_0x36aa33['innerHTML']='↙️',_0x36aa33['title']='Thoát\x20toàn\x20màn\x20hình'):(_0x36aa33[_0x302fb0(0x4b3)]='↗️',_0x36aa33[_0x302fb0(0x4d7)]=_0x302fb0(0x386));}async function initializeApp(){const _0x470d07=_0x2d0238;try{await storageManager[_0x470d07(0x22e)]();const [_0x12e829,_0x590bbf,_0xa8dc09]=await Promise['all']([storageManager[_0x470d07(0x363)](),storageManager[_0x470d07(0x231)](_0x470d07(0x2ad)),storageManager[_0x470d07(0x231)]('subtopics')]);let _0x14cee5;if(!_0x12e829){const _0x34826d=JSON[_0x470d07(0x205)](JSON[_0x470d07(0x399)](defaults));await storageManager[_0x470d07(0x315)](_0x34826d[_0x470d07(0x3aa)]);for(const _0x1cd20e of _0x34826d['topics']){const {subtopics:_0x268fe3,..._0x412fcc}=_0x1cd20e;await storageManager[_0x470d07(0x439)](_0x470d07(0x2ad),_0x412fcc);for(const _0x469603 of _0x268fe3){await storageManager['add'](_0x470d07(0x2bf),{..._0x469603,'topicId':_0x1cd20e['id']});}}_0x14cee5=_0x34826d;}else{const _0xb555f4={};for(const _0x368ee9 of _0x590bbf)_0xb555f4[_0x368ee9['id']]={..._0x368ee9,'subtopics':[]};for(const _0x3e009e of _0xa8dc09)_0xb555f4[_0x3e009e[_0x470d07(0x3b7)]]?.[_0x470d07(0x2bf)][_0x470d07(0x4f9)](_0x3e009e);_0x14cee5={'version':defaults[_0x470d07(0x31a)],'settings':_0x12e829,'topics':Object[_0x470d07(0x222)](_0xb555f4)};}data=window[_0x470d07(0x430)]=_0x14cee5,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),renderAll();try{storageManager['autoBackup'](data);}catch(_0x10a747){console[_0x470d07(0x4e1)]('AutoBackup\x20error:',_0x10a747);}bindEvents(),applyTheme();}catch(_0x355b80){console[_0x470d07(0x39b)](_0x470d07(0x322),_0x355b80),toast(_0x470d07(0x457)+_0x355b80[_0x470d07(0x3a4)]);}}callGeminiAPI=async function(_0x3d0f9f,_0x149eb1=0x3,_0x4eb43c=0x3e8){const _0xdb08d0=_0x2d0238,_0x1426fe=data?.[_0xdb08d0(0x3aa)]?.[_0xdb08d0(0x445)]||'';if(!_0x1426fe)return toast(_0xdb08d0(0x27e)),null;const _0x502103=_0xdb08d0(0x4ef)+_0x1426fe,_0x14128d={'contents':[{'role':_0xdb08d0(0x450),'parts':[{'text':_0x3d0f9f}]}]};try{const _0x5ebcec=await fetch(_0x502103,{'method':_0xdb08d0(0x289),'headers':{'Content-Type':_0xdb08d0(0x3c9)},'body':JSON[_0xdb08d0(0x399)](_0x14128d)});if(!_0x5ebcec['ok']){if(_0x5ebcec[_0xdb08d0(0x2f0)]===0x1ad&&_0x149eb1>0x0)return await new Promise(_0x5e54f9=>setTimeout(_0x5e54f9,_0x4eb43c)),callGeminiAPI(_0x3d0f9f,_0x149eb1-0x1,_0x4eb43c*0x2);let _0x29d393=null;try{_0x29d393=await _0x5ebcec['json']();}catch(_0x1ef0ff){}let _0x5b0f17='Lỗi\x20HTTP:\x20'+_0x5ebcec[_0xdb08d0(0x2f0)];if(_0x5ebcec[_0xdb08d0(0x2f0)]===0x190)_0x5b0f17=_0xdb08d0(0x3db);else{if(_0x5ebcec[_0xdb08d0(0x2f0)]===0x1ad)_0x5b0f17=_0xdb08d0(0x229);else _0x29d393?.[_0xdb08d0(0x39b)]?.[_0xdb08d0(0x3a4)]&&(_0x5b0f17='Lỗi\x20từ\x20Gemini:\x20'+_0x29d393[_0xdb08d0(0x39b)]['message']);}return toast(_0x5b0f17,0xfa0),console[_0xdb08d0(0x39b)](_0xdb08d0(0x39e),_0x29d393||_0x5ebcec[_0xdb08d0(0x29e)]),null;}const _0x5d199d=await _0x5ebcec[_0xdb08d0(0x35a)]();if(_0x5d199d[_0xdb08d0(0x451)]&&_0x5d199d[_0xdb08d0(0x451)][0x0]?.[_0xdb08d0(0x2ee)]?.[_0xdb08d0(0x2e5)]?.[0x0]?.['text'])return formatGeminiResponse(_0x5d199d[_0xdb08d0(0x451)][0x0]['content'][_0xdb08d0(0x2e5)][0x0]['text']);else{console[_0xdb08d0(0x39b)]('API\x20response\x20structure\x20is\x20unexpected:',_0x5d199d);if(_0x5d199d[_0xdb08d0(0x4c4)]?.['blockReason'])return _0xdb08d0(0x4ea)+_0x5d199d[_0xdb08d0(0x4c4)][_0xdb08d0(0x395)]+_0xdb08d0(0x2eb);return _0xdb08d0(0x288);}}catch(_0xe192d5){return console[_0xdb08d0(0x39b)](_0xdb08d0(0x331),_0xe192d5),toast('Lỗi\x20mạng\x20khi\x20kết\x20nối\x20đến\x20Gemini.\x20Vui\x20lòng\x20kiểm\x20tra\x20kết\x20nối\x20internet.',0xfa0),null;}},loadLanguage(localStorage[_0x2d0238(0x459)]('lang')||'vi')[_0x2d0238(0x256)](initializeApp);
    </script>
</body>
</html>
